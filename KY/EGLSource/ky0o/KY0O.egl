package ky0o;
import corpcom1.*;
import corpcom2.*;
import corpcom4.*;
import corpcom5.*;
import corpcom6.*;
import corpcom7.*;
import corpx1.*;
import corpx2.*;
import corpy2.*;
import corpz3.*;
import in1.common.*;
import sy.common.*;
import ta.common.*;
import ts.common.*;
//*** PROGRAM=KY0O ****
// ************************************************************
// 
//           CYCLE COUNT
//           Verification REPORT REQUEST
//           ===========================
//           for only UNVERIFIED DOCUMENTS
//           and/or
//           for both VERIFIED/UNVERIFIED SUMMARY
// 
// ************************************************************
// 
// OVERVIEW: This application will submit JCL immediately for
//           execution.  The report will be routed to the
//           online selected printer.
// 
//           notes:
//             1) the online CICS userid will be used as part
//                of the job card
// 
// 
// MAINTENANCE HISTORY:
// ===================
// RVN
// NBR   DATE     BY WHOM    OVERVIEW OF CHANGES:
// --- --------  ----------  ----------------------------------
// 00  02/19/88  Ward Jones  created
// 00  03/13/89  jwood       added noncsp option to calls
// 00  03/13/89  jwood       added xssegtr logic
// 00  10/08/90  mmoreh      tbl changes
// 00  07/31/91  scleme      convert CY0O to KY0O
// 00  01/25/94  S.JOB       ADDED THE EXPANDED LIBRARY CONCAT.
//                           TO INCLUDE PROD.COB2.LOADLIB IN
//                           IN 'S1A' & 'S1B' FOR TA0070
// ************************************************************
// ************************************************************
// *********************
Program KY0O type textUIProgram //VAGen Info - main text program
  {
  includeReferencedFunctions = yes, allowUnqualifiedItemReferences = yes, 
  throwNrfEofExceptions = yes, handleHardIOErrors = no, V60ExceptionCompatibility = yes, 
  I4GLItemsNullable = no, textLiteralDefaultIsString = no, localSQLScope = yes, 
  msgTablePrefix = "CY00", inputRecord = COMMAREA, segmented = yes
  }

  // Data Declarations
  COMMAREA COMMAREA ; // record
  CYUREC CYUREC; // record
  CYWREC CYWREC; // record
  ERRSQLCA ERRSQLCA; // record
  KY0OW01 KY0OW01; // record
  SQLCA SQLCA; // record
  TA1REC TA1REC; // record
  TA2REC TA2REC; // record
  UT1REC UT1REC; // record
  X2CREC X2CREC; // record

  // VAGen Info - items needed for migration
  VAGen_EZESYS char(8);
  VAGen_EZEREPLY num(1);
  VAGen_EZE_WAIT_TIME bin(9,2);
  VAGen_EZE_ITEMLEN int;

  // Use Declarations
  use XWHTBL {deleteAfterUse = yes}; // table
  use XROTBL {deleteAfterUse = yes}; // table
  use KY0OM.KY0OM110 // form
   {
    pfKeyEquate = no
  };

  function main()
    // VAGen Info - initialization needed for migration
    VAGen_EZESYS = VGLib.getVAGSysType();
    KY0O110: KY0O110();


     /* ************************************************************/
     /* *** normal flow to converse map                         ****/
     /* ************************************************************/

    CYWREC.XXXLOCID = "120 "; /* error id location id*/
    goto KY0O120; /* <=== converse map*/

     /* ************************************************************/
     /* *** end of EXECUTE FLOW section                         ****/
     /* ************************************************************/


    KY0O120: KY0O120();


     /* ************************************************************/
     /* *** if either pa1 or pa3 has been pressed:              ****/
     /* *** use the 'set map-name page' (only) to make sure     ****/
     /* *** the screen shows the original data since any input  ****/
     /* *** will not have been transmitted                      ****/
     /* ************************************************************/

    if (converseVar.eventKey is pa1
     || converseVar.eventKey is pa3)
      converseLib.clearScreen();
      
      goto KY0O120; /* <=== re-fresh this screen*/
    end

     /* ************************************************************/
     /* *** if PA2: restart application regardless of status    ****/
     /* ************************************************************/

    if (converseVar.eventKey is pa2)
      goto KY0O110; /* <=== re-start this function*/
    end

     /* ************************************************************/
     /* *** if error: (re-)display the screen                   ****/
     /* ************************************************************/

    if (CYWREC.CYWERRSW == "Y")
      goto KY0O120; /* <=== re-display this screen*/
    end

     /* ************************************************************/
     /* *** if one of these PF keys: go to related process      ****/
     /* ************************************************************/

    if (converseVar.eventKey is enter)
      CYWREC.XXXLOCID = "120 ";
      goto KY0O120; /* <=== converse map*/
    end

     /* ************************************************************/
     /* *** fall thru error - code shouldn't be executed        ****/
     /* ************************************************************/

    CYWREC.CYWERRSW = "Y";
    CYWREC.XXXLOCID = "120Z";
    CYWREC.CYWMSGNO = 0001; /* <--- severe error msg*/
    goto KY0O120; /* <=== display this screen*/

     /* ************************************************************/
     /* *** end of CONVERSE FLOW section                        ****/
     /* ************************************************************/


  end // end main
end // end KY0O

// one time initializations
Function KY0O110()


   /* ************************************************************/
   /* *** standard security checking                          ****/
   /* ************************************************************/

  XSENTRY();

   /* ************************************************************/
   /* *** standard setting of segmented trans id              ****/
   /* ************************************************************/

  XSSEGTR(); /* set segmented transaction id*/

   /* ************************************************************/
   /* *** "clear" map = resets fld values, attr.s & cursor    ****/
   /* ************************************************************/

  converseLib.clearScreen();
  set KY0OM110 initial; /* resets fld values, attr.s & cursor*/

   /* ************************************************************/
   /* *** initialize std working storage & map fields         ****/
   /* ************************************************************/

  set CYWREC empty; /* common working storage fields*/
  set KY0OW01 empty; /* appl. working storage area*/
  set TA1REC empty; /* TA0020 record*/
  set TA2REC empty; /* TA0040 record*/
  set UT1REC empty; /* ut0200 record*/
  set SQLCA empty; /* SQL returned data record*/
  set ERRSQLCA empty; /* TA0020 version of SQLCA*/
  set X2CREC empty; /* current date record*/

   /* ************************************************************/
   /* *** maintenance information:                            ****/
   /* *** =======================                             ****/
   /* *** rvsn   date    update by:    description:           ****/
   /* *** ---- --------  ------------  ---------------------- ****/
   /* ***  00  02/19/88  W. Jones      created                ****/
   /* ************************************************************/

  CYWREC.XXXRVNBR = "00";

  CYWREC.XXXMAPNM = "KY0OM110";
  CYWREC.XXXTITLE = "CC DOC. VERIFICATION RPT REQUEST";

  XSX2CDT(); /* get current ccyymmdd*/

  CYWREC.XXXAPPID = "KY0O"; /* error id appl. name*/
  CYWREC.CYWTALOC = "KY0O110 "; /* TA0020 exec location(2)*/
  CYWREC.CYWTAMAP = "KY0OM110"; /* TA0020 current map name*/

  CYWREC.CYWERRSW = "N"; /* error switch*/
  CYWREC.CYWMSGNO = 0; /* saved msg number*/

   /* ************************************************************/
   /* *** move ws fields to map fields - re: this data will   ****/
   /* *** be needed suring resets and for multiple levels     ****/
   /* ************************************************************/

  KY0OM110.XXXMAPNM = CYWREC.XXXMAPNM;
  KY0OM110.XXXRVNBR = CYWREC.XXXRVNBR;
  KY0OM110.XXXTITLE = CYWREC.XXXTITLE;
  KY0OM110.XXXCURDT = X2CREC.X2CCURSD;

   /* ************************************************************/
   /* *** setup auto commit & sql error handling              ****/
   /* ************************************************************/

  converseVar.commitOnConverse = 1; /* auto commit on converse*/
  VGVar.handleHardIOErrors = 1; /* allows sqlcode handling*/

   /* ************************************************************/
   /* *** setup ws default values & map fields, if any        ****/
   /* ************************************************************/

   /* none at this time*/

   /* ************************************************************/
   /* *** initialize application working storage & switches   ****/
   /* ************************************************************/

  CYWREC.CYWLINPP = 8;

   /* ************************************************************/
   /* *** use commarea warehouse, if not blank                ****/
   /* *** note: set cursor to whse if blank                   ****/
   /* ************************************************************/

  if (COMMAREA.XWHCD > " ")
    KY0OM110.XWHCD = COMMAREA.XWHCD;
  else
    set KY0OM110.XWHCD cursor;
  end

  XSCYSID(); /* get cics user id*/

  if (CYWREC.CYWERRSW == "Y")
    exit stack;
  end

   /* ************************************************************/
   /* *** if whse present: validate keys/whse                 ****/
   /* ***                  setup printers                     ****/
   /* ***                  save keys/whse                     ****/
   /* ************************************************************/

  if (KY0OM110.XWHCD > " ")
    KY0OS1W(); /* <=== whse edit*/
    if (CYWREC.CYWERRSW == "Y")
      CYWREC.XXXLOCID = "110A";
      exit stack;
    end
    KY0OS1P(); /* <=== setup printers*/
    if (CYWREC.CYWERRSW == "Y")
      KY0OW01.XWHCD = " ";
      CYWREC.XXXLOCID = "110B";
      exit stack;
    end
    KY0OSF1(); /* <=== save key values*/
  else
    KY0OS1M(); /* <=== missing whse edit*/
    CYWREC.XXXLOCID = "110C";
    CYWREC.CYWIDX02 = 1;
    while (CYWREC.CYWIDX02 <= CYWREC.CYWLINPP)
      set KY0OM110.XMCYMSEL[CYWIDX02] skip, invisible;
      CYWREC.CYWIDX02 = CYWREC.CYWIDX02 + 1;
    end
    set KY0OM110.KY0OMSPR skip, invisible;
    set KY0OM110.KY0OMOPR skip, invisible;
    set KY0OM110.KY0OMSUD skip, invisible;
    set KY0OM110.KY0OMSVS skip, invisible;
  end

   /* ************************************************************/
   /* *** end of EXECUTE section                              ****/
   /* ************************************************************/


end // end KY0O110

// converse & control key entry
Function KY0O120()


   /* ************************************************************/
   /* *** protect (askip) data fields (if any)                ****/
   /* *** note: cursor is set if error or is map's default    ****/
   /* ************************************************************/

   /* none at this time*/

   /* ************************************************************/
   /* *** if a severe error has occurred (msgno=0001),        ****/
   /* *** execute the set mapname page to refresh map         ****/
   /* *** in order to prevent locking up terminal w/ map error****/
   /* ************************************************************/

  if (CYWREC.CYWMSGNO == 0001)
    converseLib.clearScreen();
    
  end

   /* ************************************************************/
   /* *** setup msg no.  and  error id  on map                ****/
   /* ************************************************************/

  if (CYWREC.CYWMSGNO == 9999)
    converseLib.validationFailed();
  else
    converseLib.validationFailed(CYWREC.CYWMSGNO);
  end
  KY0OM110.XXXERRID = CYWREC.XXXERRID;


  converse KY0OM110 ;


   /* ************************************************************/
   /* *** if either PA1 or PA3 has been pressed, go to flow   ****/
   /* *** if PA2: regardless of status - restart application  ****/
   /* ************************************************************/

  if (converseVar.eventKey is pa1
   || converseVar.eventKey is pa2
   || converseVar.eventKey is pa3)
    exit stack;
  end

   /* ************************************************************/
   /* *** if PF1: go to help application                      ****/
   /* ************************************************************/

  if (converseVar.eventKey is pf1)
    COMMAREA.CATOAP = "GD00";
    XSEXIT();
    CYWREC.CYWERRSW = "Y";
    CYWREC.XXXLOCID = "120A";
    CYWREC.CYWMSGNO = 0;
    KY0OM110.VAGen_EZEMSG = CAMSG;
    exit stack;
  end

   /* ************************************************************/
   /* *** if PF3: go to previous logical level                ****/
   /* ************************************************************/

  if (converseVar.eventKey is pf3)
    COMMAREA.CATOAP = "KY0S";
    XSEXIT();
    CYWREC.CYWERRSW = "Y";
    CYWREC.XXXLOCID = "120B";
    CYWREC.CYWMSGNO = 0;
    KY0OM110.VAGen_EZEMSG = CAMSG;
    exit stack;
  end

   /* ************************************************************/
   /* *** if PF4: go to system main menu                      ****/
   /* ************************************************************/

  if (converseVar.eventKey is pf4)
    XSPF4();
    CYWREC.CYWERRSW = "Y";
    CYWREC.XXXLOCID = "120C";
    CYWREC.CYWMSGNO = 0;
    KY0OM110.VAGen_EZEMSG = CAMSG;
    exit stack;
  end

   /* ************************************************************/
   /* *** if PF5: go to cycle count main menu                 ****/
   /* ************************************************************/

  if (converseVar.eventKey is pf5)
    COMMAREA.CATOAP = "KY0M";
    XSEXIT();
    CYWREC.CYWERRSW = "Y";
    CYWREC.XXXLOCID = "120D";
    CYWREC.CYWMSGNO = 0;
    KY0OM110.VAGen_EZEMSG = CAMSG;
    exit stack;
  end

   /* ************************************************************/
   /* *** if fast path entered: exit immeditately             ****/
   /* ************************************************************/

  if (KY0OM110.CATOAP > " ")
    COMMAREA.CATOAP = KY0OM110.CATOAP;
    COMMAREA.CAITEM = KY0OM110.CAITEM;
    XSEXIT();
    CYWREC.CYWERRSW = "Y";
    CYWREC.XXXLOCID = "120E";
    CYWREC.CYWMSGNO = 0;
    KY0OM110.VAGen_EZEMSG = COMMAREA.CAMSG;
    set KY0OM110.CATOAP cursor, bold;
    exit stack;
  end

   /* ************************************************************/
   /* *** reset std fields and switches                       ****/
   /* ************************************************************/

  CYWREC.CYWMSGNO = 0;
  CYWREC.CYWERRSW = "N";
  CYWREC.CYWSEXSW = "N";
  KY0OM110.VAGen_EZEMSG = " ";
  set KY0OM110.CATOAP initialAttributes;
  set KY0OM110.CAITEM initialAttributes;

   /* ************************************************************/
   /* *** reset key input fld attr.s as orig.ly defined       ****/
   /* ************************************************************/

  set KY0OM110.XWHCD initialAttributes;

   /* ************************************************************/
   /* *** reset data input fld attr.s as orig.ly defined      ****/
   /* ************************************************************/

  set KY0OM110.KY0OMSUD initialAttributes;
  set KY0OM110.KY0OMSVS initialAttributes;

  CYWREC.CYWIDX02 = 1;
  while (CYWREC.CYWIDX02 <= CYWREC.CYWLINPP)
    if (KY0OM110.XROPDEST[CYWIDX02] > " ")
      set KY0OM110.XMCYMSEL[CYWIDX02] initialAttributes;
    end
    CYWREC.CYWIDX02 = CYWREC.CYWIDX02 + 1;
  end

  set KY0OM110.KY0OMSPR initialAttributes;
  set KY0OM110.KY0OMOPR initialAttributes;

   /* ************************************************************/
   /* *** if item data entered: error (option not entered)    ****/
   /* ************************************************************/

  if (KY0OM110.CAITEM > " ")
    CYWREC.CYWERRSW = "Y";
    CYWREC.XXXLOCID = "120F";
    CYWREC.CYWMSGNO = 0002; /* <--- option required msg*/
    set KY0OM110.CAITEM cursor, bold;
    exit stack;
  end

   /* ************************************************************/
   /* *** if ENTER: do edits & process inputs                 ****/
   /* ************************************************************/

  if (converseVar.eventKey is enter)
    KY0OSH1(); /* <=== enter processing*/
    exit stack;
  end

   /* ************************************************************/
   /* *** if any of the following pfkeys:                     ****/
   /* *** xsexit to the specified application                 ****/
   /* *** regardless of previous errors                       ****/
   /* *** re: reset completed & no processing code executed   ****/
   /* ************************************************************/

  if (converseVar.eventKey is pf13)
    COMMAREA.CATOAP = "KY0G";
    XSEXIT();
    CYWREC.CYWERRSW = "Y";
    CYWREC.XXXLOCID = "120G";
    CYWREC.CYWMSGNO = 0;
    KY0OM110.VAGen_EZEMSG = CAMSG;
    exit stack;
  end

  if (converseVar.eventKey is pf14)
    COMMAREA.CATOAP = "KY0N";
    XSEXIT();
    CYWREC.CYWERRSW = "Y";
    CYWREC.XXXLOCID = "120H";
    CYWREC.CYWMSGNO = 0;
    KY0OM110.VAGen_EZEMSG = CAMSG;
    exit stack;
  end

   /* ************************************************************/
   /* *** if this code is executed (control drops thru),      ****/
   /* *** then use invalid pfkey was pressed msg              ****/
   /* ************************************************************/

  CYWREC.CYWERRSW = "Y";
  CYWREC.XXXLOCID = "120P";
  CYWREC.CYWMSGNO = 0004; /* <--- invalid pfkey msg*/

   /* ************************************************************/
   /* *** end of CONVERSE AFTER section                       ****/
   /* ************************************************************/


end // end KY0O120

// submit unver.d doc jcl
Function KY0OS1A()


   /* ************************************************************/
   /* *** create the production jcl in the cyurec array       ****/
   /* *** create the instream data as part of this array      ****/
   /* *** use ta0070 to submit the jcl                        ****/
   /* ************************************************************/

  set CYUREC empty;

  CYUREC.CYUCOUNT = 1;

  KY0OW01.KY0OWLT1 = "//CY";
  KY0OW01.CYWUSRID = CYWREC.CYWUSRID;
  KY0OW01.KY0OWLT2 = " JOB  (CY,MUR2),";
  CYUREC.CYUJCLIN[CYUCOUNT] = KY0OW01.KY0OWJOB;
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//         'CC UNVER.D DOC.S ',         ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//         CLASS=P,                     ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//         MSGCLASS=J                   ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//*                                     ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//**************************************";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//** THIS JOB CREATES CYCLE COUNT     **";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//** UNVERIFIED DOCUMENT RPT          **";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//** VIA ONLINE SUBMITTED REQUESTS    **";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//**************************************";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//*                                     ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  KY0OW01.KY0OWLT3 = "/*OUTPUT CY54 FORMS=CY54,DEST=";
   /* note: printer id has been saved in this lines printer fld*/
  CYUREC.CYUJCLIN[CYUCOUNT] = KY0OW01.KY0OWOUT;
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//*                                     ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//JOBLIB   DD  DSN=PROD.ONETIME.LOADLIB,DISP=SHR";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//         DD  DSN=PROD.COB2.LOADLIB,DISP=SHR";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;


  CYUREC.CYUJCLIN[CYUCOUNT] = "//         DD  DSN=PROD.LOADLIB,DISP=SHR";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//*                                     ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//**************************************";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//** STEP S0010 EXEC.S PROC BATCHQMF  **";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//**************************************";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//*                                     ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//S0010   EXEC BATCHQMF,                ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  KY0OW01.KY0OWLT4 = "//             MEMBER='CY75";
  KY0OW01.KY0OWWH4 = KY0OM110.XWHCD;
  KY0OW01.KY0OWLT5 = "05',";
  CYUREC.CYUJCLIN[CYUCOUNT] = KY0OW01.KY0OWLIN;
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//             CLASS='P',               ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//             FORM='CY54'              ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//*                                 ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//******* END OF JOB STREAM ********";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//                                  ";

   /* ************************************************************/
   /* *** note: final increment of slucount leaves the        ****/
   /* *** correct value in this field for ta0070              ****/
   /* ************************************************************/

   /* ************************************************************/
   /* *** submit the jcl created & saved in the slurec        ****/
   /* *** via ta0070                                          ****/
   /* ************************************************************/

  try
    call "TA0070" (CYUREC) {isNoRefresh = yes, isExternal = yes};
  end

  if (CYUREC.CYURETRN != 0)
    CYWREC.CYWERRSW = "Y";
    CYWREC.XXXLOCID = "S1JA";
    CYWREC.CYWMSGNO = 0058; /* <--- PRINT REQUEST FAILED*/
    set KY0OM110.XWHCD cursor, bold;
  end

   /* ************************************************************/
   /* *** end of STATEMENT GROUP                              ****/
   /* ************************************************************/


end // end KY0OS1A

// submit both summary jcl
Function KY0OS1B()


   /* ************************************************************/
   /* *** create the production jcl in the cyurec array       ****/
   /* *** create the instream data as part of this array      ****/
   /* *** use ta0070 to submit the jcl                        ****/
   /* ************************************************************/

  set CYUREC empty;

  CYUREC.CYUCOUNT = 1;

  KY0OW01.KY0OWLT1 = "//CY";
  KY0OW01.CYWUSRID = CYWREC.CYWUSRID;
  KY0OW01.KY0OWLT2 = " JOB  (CY,MUR2),";
  CYUREC.CYUJCLIN[CYUCOUNT] = KY0OW01.KY0OWJOB;
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//         'CC VER/UNVER SUM ',         ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//         CLASS=P,                     ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//         MSGCLASS=J                   ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//*                                     ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//**************************************";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//** THIS JOB CREATES CYCLE COUNT     **";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//** VER/UNVER SUMMARY RPT            **";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//** VIA ONLINE SUBMITTED REQUESTS    **";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//**************************************";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//*                                     ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  KY0OW01.KY0OWLT3 = "/*OUTPUT CY55 FORMS=CY55,DEST=";
   /* note: printer id has been saved in this lines printer fld*/
  CYUREC.CYUJCLIN[CYUCOUNT] = KY0OW01.KY0OWOUT;
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//*                                     ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//JOBLIB   DD  DSN=PROD.ONETIME.LOADLIB,DISP=SHR";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//         DD  DSN=PROD.COB2.LOADLIB,DISP=SHR";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//         DD  DSN=PROD.LOADLIB,DISP=SHR";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//*                                     ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//**************************************";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//** STEP S0010 EXEC.S PROC BATCHQMF  **";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//**************************************";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//*                                     ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//S0010   EXEC BATCHQMF,                ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  KY0OW01.KY0OWLT4 = "//             MEMBER='CY76";
  KY0OW01.KY0OWWH4 = KY0OM110.XWHCD;
  KY0OW01.KY0OWLT5 = "05',";
  CYUREC.CYUJCLIN[CYUCOUNT] = KY0OW01.KY0OWLIN;
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//             CLASS='P',               ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//             FORM='CY55'              ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//*                                 ";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//******* END OF JOB STREAM ********";
  CYUREC.CYUCOUNT = CYUREC.CYUCOUNT + 1;

  CYUREC.CYUJCLIN[CYUCOUNT] = "//                                  ";

   /* ************************************************************/
   /* *** note: final increment of slucount leaves the        ****/
   /* *** correct value in this field for ta0070              ****/
   /* ************************************************************/

   /* ************************************************************/
   /* *** submit the jcl created & saved in the slurec        ****/
   /* *** via ta0070                                          ****/
   /* ************************************************************/

  try
    call "TA0070" (CYUREC) {isNoRefresh = yes, isExternal = yes};
  end

  if (CYUREC.CYURETRN != 0)
    CYWREC.CYWERRSW = "Y";
    CYWREC.XXXLOCID = "S1JA";
    CYWREC.CYWMSGNO = 0058; /* <--- PRINT REQUEST FAILED*/
    set KY0OM110.XWHCD cursor, bold;
  end

   /* ************************************************************/
   /* *** end of STATEMENT GROUP                              ****/
   /* ************************************************************/


end // end KY0OS1B

// use input printer dest id
Function KY0OS1I()


   /* ************************************************************/
   /* *** make sure selection & printer dest. id are input    ****/
   /* *** note: exit if either fld missing (error)            ****/
   /* *** find dest. id in table                              ****/
   /* *** save dest. id in output jcl line in ws              ****/
   /* ************************************************************/

  if (KY0OM110.KY0OMOPR > " ")
     /* ** next sentence ***/
  else
    CYWREC.CYWERRSW = "Y";
    CYWREC.XXXLOCID = "S1IA";
    CYWREC.CYWMSGNO = 0009; /* <--- requiered field msg*/
    set KY0OM110.KY0OMOPR cursor, bold;
  end

  if (KY0OM110.KY0OMSPR > " ")
     /* ** next sentence ***/
  else
    CYWREC.CYWERRSW = "Y";
    CYWREC.XXXLOCID = "S1IB";
    CYWREC.CYWMSGNO = 0009; /* <--- requiered field msg*/
    set KY0OM110.KY0OMSPR cursor, bold;
  end

  if (CYWREC.CYWERRSW == "Y")
    return;
  end

  if (KY0OM110.KY0OMOPR in XROTBL.XROPDEST)
    if (XROTBL.XXXSTAT[sysVar.arrayIndex] == "A")
      KY0OW01.KY0OWPID = XROTBL.XROPDEST[sysVar.arrayIndex];
    else
      CYWREC.CYWERRSW = "Y";
      CYWREC.XXXLOCID = "S1IC";
      CYWREC.CYWMSGNO = 0010; /* <--- inactive msg*/
      set KY0OM110.KY0OMOPR cursor, bold;
    end
  else
    CYWREC.CYWERRSW = "Y";
    CYWREC.XXXLOCID = "S1ID";
    CYWREC.CYWMSGNO = 0011; /* <--- invalid value msg*/
    set KY0OM110.KY0OMOPR cursor, bold;
  end

   /* ************************************************************/
   /* *** end of STATEMENT GROUP                              ****/
   /* ************************************************************/


end // end KY0OS1I

// setup & submit jcl
Function KY0OS1J()


   /* ************************************************************/
   /* *** if unverified document rpt selected, submit jcl     ****/
   /* *** note: if error submitting, exit immediately         ****/
   /* ************************************************************/

  if (KY0OM110.KY0OMSUD > " ")
    KY0OS1A(); /* <=== submit unver.d doc jcl*/
  end

  if (CYWREC.CYWERRSW == "Y")
    return;
  end

   /* ************************************************************/
   /* *** if verified/unverified summary selected, submit jcl ****/
   /* *** note: submission of both is ok                      ****/
   /* ************************************************************/

  if (KY0OM110.KY0OMSVS > " ")
    KY0OS1B(); /* <=== submit both summary jcl*/
  end

   /* ************************************************************/
   /* *** end of STATEMENT GROUP                              ****/
   /* ************************************************************/


end // end KY0OS1J

// missing whse edit
Function KY0OS1M()


   /* ************************************************************/
   /* *** setup error if whse missing                         ****/
   /* ************************************************************/

  if (KY0OM110.XWHCD > " ")
     /* ** next sentence ***/
  else
    CYWREC.CYWERRSW = "Y";
    CYWREC.XXXLOCID = "S1MA";
    CYWREC.CYWMSGNO = 0009; /* <--- missing required field msg*/
    set KY0OM110.XWHCD cursor, bold;
  end

   /* ************************************************************/
   /* *** end of STATEMENT GROUP                              ****/
   /* ************************************************************/


end // end KY0OS1M

// setup printers
Function KY0OS1P()


   /* ************************************************************/
   /* *** setup selectable printers per whse                  ****/
   /* *** note: make unused printer flds askip,dark           ****/
   /* ************************************************************/

  CYWREC.CYWIDX01 = 1;
  CYWREC.CYWIDX02 = 1;

  while (XROTBL.XROCD[CYWIDX01] != "9999"
   && CYWREC.CYWIDX02 <= CYWREC.CYWLINPP)
    if (XROTBL.XWHCD1[CYWIDX01] == KY0OM110.XWHCD
     || XROTBL.XWHCD2[CYWIDX01] == KY0OM110.XWHCD
     || XROTBL.XWHCD3[CYWIDX01] == KY0OM110.XWHCD)
      if (XROTBL.XXXSTAT[CYWIDX01] == "A")
        KY0OM110.XROPDEST[CYWIDX02] = XROTBL.XROPDEST[CYWIDX01];
        set KY0OM110.XMCYMSEL[CYWIDX02] initialAttributes;
        CYWREC.CYWIDX02 = CYWREC.CYWIDX02 + 1;
      end
    end
    CYWREC.CYWIDX01 = CYWREC.CYWIDX01 + 1;
  end

  if (CYWREC.CYWIDX02 == 1)
    CYWREC.CYWERRSW = "Y";
    CYWREC.XXXLOCID = "S1PA";
    CYWREC.CYWMSGNO = 0054; /* <--- no printer assigned*/
  end

   /* ************************************************************/
   /* *** darken remaining printer fields                     ****/
   /* ************************************************************/

  while (CYWREC.CYWIDX02 <= CYWREC.CYWLINPP)
    set KY0OM110.XMCYMSEL[CYWIDX02] skip, invisible;
    KY0OM110.XROPDEST[CYWIDX02] = " ";
    CYWREC.CYWIDX02 = CYWREC.CYWIDX02 + 1;
  end

   /* ************************************************************/
   /* *** end of STATEMENT GROUP                              ****/
   /* ************************************************************/


end // end KY0OS1P

// save printer destination id
Function KY0OS1S()


   /* ************************************************************/
   /* *** make sure a printer has been selected               ****/
   /* *** note: if more than 1 selected: use the first        ****/
   /* ***       therefore, edit in reverse order to use first ****/
   /* *** note: also save the printer's destination id right  ****/
   /* ***       in the ws jcl line's fld for jcl setup        ****/
   /* ************************************************************/

  CYWREC.CYWIDX01 = 1;
  CYWREC.CYWFTMSW = "Y";

  while (CYWREC.CYWIDX01 <= CYWREC.CYWLINPP)
    if (KY0OM110.XMCYMSEL[CYWIDX01] > " ")
      if (CYWREC.CYWFTMSW == "Y")
        CYWREC.CYWFTMSW = "N";
        KY0OW01.KY0OWPID = KY0OM110.XROPDEST[CYWIDX01];
      else
        CYWREC.CYWERRSW = "Y";
        CYWREC.XXXLOCID = "S1SA";
        CYWREC.CYWMSGNO = 0073; /* <--- can't be entered now*/
        set KY0OM110.XMCYMSEL[CYWIDX01] cursor, bold;
      end
    end
    CYWREC.CYWIDX01 = CYWREC.CYWIDX01 + 1;
  end

  if (CYWREC.CYWFTMSW == "Y")
    if (KY0OM110.KY0OMSPR > " "
     || KY0OM110.KY0OMOPR > " ")
      KY0OS1I(); /* <=== use input printer dest id*/
    else
      CYWREC.CYWERRSW = "Y";
      CYWREC.XXXLOCID = "S1SB";
      CYWREC.CYWMSGNO = 0009; /* <--- missing required field msg*/
      set KY0OM110.XMCYMSEL[1] cursor, bold;
    end
    return;
  end

  if (KY0OM110.KY0OMOPR > " ")
    CYWREC.CYWERRSW = "Y";
    CYWREC.XXXLOCID = "S1SC";
    CYWREC.CYWMSGNO = 0073; /* <--- can't be entered now*/
    set KY0OM110.KY0OMOPR cursor, bold;
  end

  if (KY0OM110.KY0OMSPR > " ")
    CYWREC.CYWERRSW = "Y";
    CYWREC.XXXLOCID = "S1SD";
    CYWREC.CYWMSGNO = 0073; /* <--- can't be entered now*/
    set KY0OM110.KY0OMSPR cursor, bold;
  end

   /* ************************************************************/
   /* *** end of STATEMENT GROUP                              ****/
   /* ************************************************************/


end // end KY0OS1S

// whse edit
Function KY0OS1W()


   /* ************************************************************/
   /* *** if warehouse code in tbl & active: put abrv. on map ****/
   /* ************************************************************/

  if (KY0OM110.XWHCD in XWHTBL.XWHCD)
    if (XWHTBL.XXXSTAT[sysVar.arrayIndex] == "A")
      KY0OM110.XWHABRV = XWHTBL.XWHABRV[sysVar.arrayIndex];
    else
      KY0OM110.XWHABRV = " ";
      CYWREC.CYWERRSW = "Y";
      CYWREC.XXXLOCID = "S1WA";
      CYWREC.CYWMSGNO = 0010; /* <--- inactive msg*/
      set KY0OM110.XWHCD cursor, bold;
    end
  else
    KY0OM110.XWHABRV = " ";
    CYWREC.CYWERRSW = "Y";
    CYWREC.XXXLOCID = "S1WB";
    CYWREC.CYWMSGNO = 0011; /* <--- invalid value msg*/
    set KY0OM110.XWHCD cursor, bold;
  end

   /* ************************************************************/
   /* *** end of STATEMENT GROUP                              ****/
   /* ************************************************************/


end // end KY0OS1W

// key missing input edits
Function KY0OSA1()


   /* ************************************************************/
   /* *** setup error for each missing field                  ****/
   /* *** note: check in reverse order as in edits            ****/
   /* ************************************************************/

   /* none at this time*/

   /* ************************************************************/
   /* *** end of STATEMENT GROUP                              ****/
   /* ************************************************************/


end // end KY0OSA1

// same key edits
Function KY0OSB1()


   /* ************************************************************/
   /* *** check individual map (key) fields versus the last   ****/
   /* *** value saved in ws to set the same key sw.           ****/
   /* *** note: set sw. = N & ezertn on first NOT equal  BUT  ****/
   /* ***       sw. must be set = Y if all compare equal      ****/
   /* ************************************************************/

  if (KY0OM110.XWHCD != KY0OW01.XWHCD)
    CYWREC.CYWSKYSW = "N";
    return;
  end

  CYWREC.CYWSKYSW = "Y";

   /* ************************************************************/
   /* *** end of STATEMENT GROUP                              ****/
   /* ************************************************************/


end // end KY0OSB1

// key field edits
Function KY0OSC1()


   /* ************************************************************/
   /* *** edit all individual fields, even if error detected  ****/
   /* *** note: use reverse order to sync msg, cursor & attr. ****/
   /* ***       do not test for modified fields (CSP resets)  ****/
   /* ************************************************************/

   /* none at this time*/

   /* ************************************************************/
   /* *** end of STATEMENT GROUP                              ****/
   /* ************************************************************/


end // end KY0OSC1

// key relational edits
Function KY0OSD1()


   /* ************************************************************/
   /* *** do relational edits in any order but exit on error  ****/
   /* *** note: all required flds entered & edits = ok        ****/
   /* ************************************************************/

   /* ************************************************************/
   /* *** if both selection flds blank, setup missing fld     ****/
   /* *** error on first fld.                                 ****/
   /* ************************************************************/

  if (KY0OM110.KY0OMSUD > " "
   || KY0OM110.KY0OMSVS > " ")
     /* ** next sentence ***/
  else
    CYWREC.CYWERRSW = "Y";
    CYWREC.XXXLOCID = "SD1A";
    CYWREC.CYWMSGNO = 0009; /* <--- required field msg*/
    set KY0OM110.KY0OMSUD cursor, bold;
  end

   /* ************************************************************/
   /* *** end of STATEMENT GROUP                              ****/
   /* ************************************************************/


end // end KY0OSD1

// save current key value(s)
Function KY0OSF1()


   /* ************************************************************/
   /* *** save current key values in the corresponding ws flds****/
   /* *** and in cyxrec to pass to other appl.s               ****/
   /* ************************************************************/

  COMMAREA.XWHCD = KY0OM110.XWHCD;

  KY0OW01.XWHCD = KY0OM110.XWHCD;

   /* ************************************************************/
   /* *** end of STATEMENT GROUP                              ****/
   /* ************************************************************/


end // end KY0OSF1

// ENTER processing
Function KY0OSH1()


   /* ************************************************************/
   /* *** check for missing fields                            ****/
   /* ************************************************************/

  KY0OS1M(); /* <=== missing whse edit*/

  if (CYWREC.CYWERRSW == "Y")
    return;
  end

   /* ************************************************************/
   /* *** check the key fields for changes                    ****/
   /* *** if key (whse) changes: validate keys/whse           ****/
   /* ***                        save keys/whse               ****/
   /* ***                        re-setup printers            ****/
   /* ***                        exit for (re)select printer  ****/
   /* ************************************************************/

  KY0OSB1(); /* <=== same key edits*/

  if (CYWREC.CYWSKYSW == "N")
    KY0OS1W(); /* <=== whse edit*/
    if (CYWREC.CYWERRSW == "Y")
      return;
    end
    KY0OS1P(); /* <=== setup printers*/
    if (CYWREC.CYWERRSW == "Y")
      KY0OW01.XWHCD = " ";
      return;
    end
    KY0OSF1(); /* <=== save key values*/
    return;
  end

   /* ************************************************************/
   /* *** check for missing fields                            ****/
   /* ************************************************************/

  KY0OSA1(); /* <=== missing input edits*/

  if (CYWREC.CYWERRSW == "Y")
    return;
  end

   /* ************************************************************/
   /* *** no errors: check field edits                        ****/
   /* ************************************************************/

  KY0OSC1(); /* <=== field edits*/

  if (CYWREC.CYWERRSW == "Y")
    return;
  end

   /* ************************************************************/
   /* *** no errors: check relational field edits             ****/
   /* ************************************************************/

  KY0OSD1(); /* <=== relational edits*/

  if (CYWREC.CYWERRSW == "Y")
    return;
  end

   /* ************************************************************/
   /* *** select printer                                      ****/
   /* ************************************************************/

  KY0OS1S(); /* <=== select printer*/

  if (CYWREC.CYWERRSW == "Y")
    return;
  end

   /* ************************************************************/
   /* *** no errors: setup & submit jcl                       ****/
   /* ************************************************************/

  KY0OS1J(); /* <=== setup & submit jcl*/

  if (CYWREC.CYWERRSW == "Y")
    return;
  end

   /* ************************************************************/
   /* *** do not reset the screen but display msg             ****/
   /* ************************************************************/

  CYWREC.CYWMSGNO = 0059; /* <--- print request ok msg*/
  KY0OM110.KY0OMSUD = " ";
  KY0OM110.KY0OMSVS = " ";
  set KY0OM110.KY0OMSUD cursor;

   /* ************************************************************/
   /* *** end of STATEMENT GROUP                              ****/
   /* ************************************************************/


end // end KY0OSH1

//*** RECORD=KY0OW01 ****
// ************************************************************
// 
//           CYCLE COUNT DOCUMENT VERIFICATION
//           =================================
// 
// ************************************************************
// 
// OVERVIEW:
// ========
//           These working storage fields are used for specific
//           application/function purposes.
// 
// 
// MAINTENANCE HISTORY:
// ===================
// 
//   Date     By Whom     Overview of Changes
// --------  -----------  -------------------------------------
// 02-09-88  W. Jones     created
// 
// 
// ************************************************************
// ************************************************************
// ***********************
Record KY0OW01 type basicRecord
  10 KY0OWLK1 KY0OWLK1 ; 
    15 XWHCD XWHCD ; 
  10 KY0OWJOB KY0OWJOB ; 
    15 KY0OWLT1 KY0OWLT1 ; 
    15 CYWUSRID CYWUSRID ; 
    15 KY0OWLT2 KY0OWLT2 ; 
    15 * char(54) ; 
  10 KY0OWOUT KY0OWOUT ; 
    15 KY0OWLT3 KY0OWLT3 ; 
    15 KY0OWPID KY0OWPID ; 
    15 * char(42) ; 
  10 KY0OWLIN KY0OWLIN ; 
    15 KY0OWLT4 KY0OWLT4 ; 
    15 KY0OWWH4 KY0OWWH4 ; 
    15 KY0OWLT5 KY0OWLT5 ; 
    15 * char(47) ; 
  10 KY0OWNFY KY0OWNFY ; 
    15 KY0OWLT9 KY0OWLT9 ; 
    15 KY0OWUSR KY0OWUSR ; 
    15 * char(56) ; 
end // end KY0OW01

// job card jcl line
DataItem KY0OWJOB char(80)  {
  align = right, fillCharacter = "0", inputRequired = no, minimumInput = 1
}
end

// proc symbolic line
DataItem KY0OWLIN char(80)  {
  align = right, fillCharacter = "0", inputRequired = no, minimumInput = 1
}
end

// complete last key
DataItem KY0OWLK1 char(2)  {
  align = right, fillCharacter = "0", inputRequired = no, minimumInput = 1
}
end

// literal 1
DataItem KY0OWLT1 char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// literal 2
DataItem KY0OWLT2 char(16)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// literal 3
DataItem KY0OWLT3 char(30)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// literal 4
DataItem KY0OWLT4 char(27)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// literal 5
DataItem KY0OWLT5 char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// literal 9
DataItem KY0OWLT9 char(18)  {
  align = right, fillCharacter = "0", inputRequired = no, minimumInput = 1
}
end

// notify userid
DataItem KY0OWNFY char(80)  {
  align = right, fillCharacter = "0", inputRequired = no, minimumInput = 1
}
end

// output (dest id) line
DataItem KY0OWOUT char(80)  {
  align = right, fillCharacter = "0", inputRequired = no, minimumInput = 1
}
end

// remote printer id
DataItem KY0OWPID char(8)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// user id for job name
DataItem KY0OWUSR char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// work warehouse code
DataItem KY0OWWH4 char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

