package om0z;
import corpcom1.*;
import corpcom2.*;
import corpcom3.*;
import corpcom4.*;
import corpcom5.*;
import corpcom6.*;
import corpcom7.*;
import corpx1.*;
import corpx2.*;
import corpy2.*;
import corpz3.*;
import dg.common.*;
import fk.common.*;
import fy.common.*;
import ku.common.*;
import ob.common.*;
import om.common.*;
import op.common.*;
import os.common.*;
import pc.common.*;
import pg.common.*;
import pk.common.*;
import pw.common.*;
import sm.common.*;
import sp.common.*;
import sy.common.*;
import ta.common.*;
import tf.common.*;
import vv.common.*;
import ww.common.*;
//*** PROGRAM=OM0Z ****
// This program displays information on the customer xref
// product from the dcust.vcucpx01 table or overrides when they
// exist.
// 
// ;
// maintenance log
// ;
// 09/24/96  DLIDDL   Initial creation.
// 07/28/97  CBRINE   Only insert size 0 record for VORXRF01.
//                    Move 0 to XNX-DEPT-ID-XREF in VCUCPX01.
//                    (EXCEPT FOR PENNEYS)                  .
// 08/20/97  CBRINE   Select size zero in OM0ZS-GET-VORXRF01.
// 10/20/97  JFLOR1   Modified column headings for user.
// 12/01/97  ESHANM   Updating the order item table for any
//                    changes in OM0Z so that first record
//                    of OM0Y will match the record displayed
//                    in OM0S. Included new statement group
//                    OM0ZS-UPD-VITEM001 and modified OM0ZS44
//                    Search for /*tcs
// 01/27/98  JFLOR1   Modified update/inquiry time module
//                    XPOM100.
// 01/27/98  JFLOR1   #178 Increased size of OMWREC to 3505
//                    bytes. Re-compiled application.
// 04/30/99  SVARGH   added parent id '32' for JCP apparel
//                    in stmtgrp OM0ZS-GET-VCUCPX01 look for
//                    *tcs change
// *********************
Program OM0Z type textUIProgram //VAGen Info - main text program
  {
  includeReferencedFunctions = yes, allowUnqualifiedItemReferences = yes, 
  throwNrfEofExceptions = yes, handleHardIOErrors = no, V60ExceptionCompatibility = yes, 
  I4GLItemsNullable = no, textLiteralDefaultIsString = no, localSQLScope = yes, 
  msgTablePrefix = "OP00", inputRecord = COMMAREA, segmented = yes
  }

  // Data Declarations
  COMMAREA COMMAREA ; // record
  ERRSQLCA ERRSQLCA; // record
  KUCREC KUCREC; // record
  OM0ZW01 OM0ZW01; // record
  OM0ZW02 OM0ZW02; // record
  OM0ZW03 OM0ZW03; // record
  OMVREC OMVREC; // record
  OMWREC OMWREC; // record
  OP1REC OP1REC; // record
  OP2REC OP2REC; // record
  OSIREC OSIREC; // record
  SQLCA SQLCA; // record
  SY4REC SY4REC; // record
  SYCREC SYCREC; // record
  TA1REC TA1REC; // record
  TA2REC TA2REC; // record
  TA5REC TA5REC; // record
  TAEREC TAEREC; // record
  VCUCPX01 VCUCPX01; // record
  VOCPOX02 VOCPOX02; // record
  VORXRF01 VORXRF01; // record
  WCU1710 WCU1710; // record
  XX0XW01 XX0XW01; // record

  // VAGen Info - items needed for migration
  VAGen_EZESYS char(8);
  VAGen_EZEREPLY num(1);
  VAGen_EZE_WAIT_TIME bin(9,2);
  VAGen_EZE_ITEMLEN int;

  // Use Declarations
  use XOSTBL {deleteAfterUse = yes}; // table
  use XGPTBL {deleteAfterUse = yes}; // table
  use XQATBL {deleteAfterUse = yes}; // table
  use XDMTBL {deleteAfterUse = yes}; // table
  use OM0ZM.OM0ZM001 // form
   {
    pfKeyEquate = no
  };

  function main()
    // VAGen Info - initialization needed for migration
    VAGen_EZESYS = VGLib.getVAGSysType();
    OM0Z000: OM0Z000();
    goto OM0Z010;
    OM0Z010: OM0Z010();
    goto OM0Z010;
  end // end main
end // end OM0Z

Function OM0Z000()

  XSENTRY(); /**/
                                   /* check CSP and order batch security*/

  XSOMS01(); /* check o/m security*/

  OM0ZS01(); /* initialise application*/

  OM0ZS02(); /* read current TS page*/

  OM0ZS09(); /* locate selected TS entry*/

  OM0ZS-GET-DATA(); /* get database records*/

  OM0ZS10(); /* build map*/

end // end OM0Z000

Function OM0Z010()

  converseLib.clearScreen();
   /* set map page number*/
  converseVar.segmentedMode = 1; /* force segmented converse mode*/

  XPOM100(); /* determine if night time inq is active*/
  OM0ZS30(); /* display xref update question*/
  OM0ZS32(); /* display override literal*/
  OM0ZS34(); /* display size literal*/
  OM0ZS36(); /* display PF23 key if ok to do so*/
  OM0ZS38(); /* display special makeup/dummy msg*/

  converse OM0ZM001 ;

  converseLib.validationFailed(0);
  OM0ZW01.OM0ZWERRFL = "N";
  OM0ZM001.CAMSG = " ";

  OM0ZS40(); /* move 'after converse' map fields to*/

  if (converseVar.eventKey is enter) /* enter key pressed*/
    OM0ZS42(); /* edit map*/
    if (converseVar.validationMsgNum == 0) /* no errors*/
      OM0ZS44(); /* determine db updates*/
    end
  else
    OM0ZS46(); /* process valid PF keys*/
  end

  if (converseVar.validationMsgNum == 0) /* no errors*/
    OM0ZS-UPD-TS(); /* update TS and WS areas*/
    move OM0ZW03 to OM0ZW02 withV60Compat; /* move 'current' map to 'previous' map*/
    OM0ZS16(); /* reset field attributes*/
  end

end // end OM0Z010

// INSERT DCUST.VCUCPX01
Function OM0ZS-ADD-VCUCPX01()

  set SQLCA empty;

  VCUCPX01.ZZZSDT = OM0ZW01.ZZZCHGDT;
  VCUCPX01.ZZZSTM = OM0ZW01.ZZZCHGTM;
  VCUCPX01.ZZZCHGDT = OM0ZW01.ZZZCHGDT;
  VCUCPX01.ZZZCHGTM = OM0ZW01.ZZZCHGTM;
  VCUCPX01.ZZZCHGCT = 0;

  call "VCUCPX01" ("A ", SQLCA, VCUCPX01) {isNoRefresh = yes, isExternal = yes}; /**/

  if (SQLCA.VAGen_SQLCODE == 0) /* check for good return code*/
    OM0ZW01.OM0ZW-XREF-EXISTS = "Y";
    OM0ZM001.CAMSG = "CUSTOMER CROSS REFERENCE SUCCESSFULLY ADDED";
  else /* other return code*/
    TA1REC.TA1DBASE = "DCUST   "; /* data base name*/
    TA1REC.TA1TBLVU = "VCUCPX01"; /* table view*/
    TA1REC.TA1LOCAT[1] = "A       "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "VCUCPX01"; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OM0ZS-AD"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "D-VCUCPX"; /* extra key*/
    OM0ZW01.OM0ZWSYSKE = " ";
    OM0ZW01.OM0ZWPARTN = OP1REC.OP1PARTN; /* order part char*/
    OM0ZW01.OM0ZWCUOID = OP1REC.OP1CUOID; /* customer order number*/
    OM0ZW01.OM0ZWNORID = OP1REC.OP1NORID; /* nike order number*/
    OM0ZW01.OM0ZWLNINB = OP2REC.OP2LNINB;
    OM0ZW01.OM0ZWCOID = OP1REC.KUCCOID;
    OM0ZW01.OM0ZWSTRID = OP1REC.KUMSTRID;
    OM0ZW01.OM0ZWXNXCD = OP1REC.XNXCD;
    TA1REC.TA1TBLKE = OM0ZW01.OM0ZWSYSKE; /* style nbr*/
    OM0ZS1P(); /* purge TS*/
    TA1REC.TA1TYPE = "DB2"; /* abend type*/
    TA1REC.TA1FUNC = "RETN"; /* abend function*/
    set ERRSQLCA empty; /* clear sql area*/
    move SQLCA to ERRSQLCA withV60Compat; /* save original sqlca*/
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes}; /* abend module*/
    COMMAREA.CA-USER-WORKAREA-4K = " "; /* clear user commarea*/
    XSPF4(); /* return to master menu*/
    exit program; /* master menu return failure*/
  end

end // end OM0ZS-ADD-VCUCPX01

// INSERT DORDER.VOCPOX02
Function OM0ZS-ADD-VOCPOX02()

  set SQLCA empty;

  OM0ZS-FMT-VOCPOX02(); /* format override record*/

  VOCPOX02.ZZZSDT = OM0ZW01.ZZZCHGDT;
  VOCPOX02.ZZZSTM = OM0ZW01.ZZZCHGTM;
  VOCPOX02.ZZZCHGDT = OM0ZW01.ZZZCHGDT;
  VOCPOX02.ZZZCHGTM = OM0ZW01.ZZZCHGTM;
  VOCPOX02.ZZZCHGCT = 0;

  call "VOCPOX02" ("A ", SQLCA, VOCPOX02) {isNoRefresh = yes, isExternal = yes}; /**/

  if (SQLCA.VAGen_SQLCODE == 0) /* check for good return code*/
    OM0ZM001.CAMSG = "CUSTOMER CROSS REFERENCE OVERRIDE SUCCESSFULLY ADDED";
    OM0ZW01.OM0ZW-OVRD-EXISTS = "Y";
  else
    TA1REC.TA1DBASE = "DORDER   "; /* data base name*/
    TA1REC.TA1TBLVU = "VOCPOX02"; /* table view*/
    TA1REC.TA1LOCAT[1] = "A       "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "VOCPOX02"; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OM0ZS-AD"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "D-VOCPOX"; /* extra key*/
    OM0ZW01.OM0ZWSYSKE = " ";
    OM0ZW01.OM0ZWPARTN = OP1REC.OP1PARTN; /* order part char*/
    OM0ZW01.OM0ZWCUOID = OP1REC.OP1CUOID; /* customer order number*/
    OM0ZW01.OM0ZWNORID = OP1REC.OP1NORID; /* nike order number*/
    OM0ZW01.OM0ZWLNINB = OP2REC.OP2LNINB; /* line item*/
    OM0ZW01.OM0ZWCOID = OP1REC.KUCCOID;
    OM0ZW01.OM0ZWSTRID = OP1REC.KUMSTRID;
    OM0ZW01.OM0ZWXNXCD = OP1REC.XNXCD;
    TA1REC.TA1TBLKE = OM0ZW01.OM0ZWSYSKE;
    OM0ZS1P(); /* purge TS*/
    TA1REC.TA1TYPE = "DB2"; /* abend type*/
    TA1REC.TA1FUNC = "RETN"; /* abend function*/
    set ERRSQLCA empty; /* clear sql area*/
    move SQLCA to ERRSQLCA withV60Compat; /* save original sqlca*/
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes}; /* abend module*/
    COMMAREA.CA-USER-WORKAREA-4K = " "; /* clear user commarea*/
    XSPF4(); /* return to master menu*/
    exit program; /* master menu return failure*/
  end

end // end OM0ZS-ADD-VOCPOX02

// INSERT DORDER.VORXRF01
Function OM0ZS-ADD-VORXRF01()

  set SQLCA empty;

  OM0ZS-FMT-VORXRF01(); /* format the companion record*/

  VORXRF01.ZZZSDT = OM0ZW01.ZZZCHGDT;
  VORXRF01.ZZZSTM = OM0ZW01.ZZZCHGTM;
  VORXRF01.ZZZCHGDT = OM0ZW01.ZZZCHGDT;
  VORXRF01.ZZZCHGTM = OM0ZW01.ZZZCHGTM;
  VORXRF01.ZZZCHGCT = 0;

  call "VORXRF01" ("A ", SQLCA, VORXRF01) {isNoRefresh = yes, isExternal = yes}; /**/

  if (SQLCA.VAGen_SQLCODE == 0) /* check for good return code*/
    OM0ZW01.OM0ZW-COMP-EXISTS = "Y";
    OM0ZM001.CAMSG = "UPDATE SUCCESSFUL";
  else
    TA1REC.TA1DBASE = "DORDER   "; /* data base name*/
    TA1REC.TA1TBLVU = "VORXRF01"; /* table view*/
    TA1REC.TA1LOCAT[1] = "A       "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "VORXRF01"; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OM0ZS-AD"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "D-VOBXRF"; /* extra key*/
    OM0ZW01.OM0ZWSYSKE = " ";
    OM0ZW01.OM0ZWPARTN = OP1REC.OP1PARTN; /* order part char*/
    OM0ZW01.OM0ZWCUOID = OP1REC.OP1CUOID; /* customer order number*/
    OM0ZW01.OM0ZWNORID = OP1REC.OP1NORID; /* nike order number*/
    OM0ZW01.OM0ZWLNINB = OP2REC.OP2LNINB; /* line item*/
    OM0ZW01.OM0ZWCOID = OP1REC.KUCCOID;
    OM0ZW01.OM0ZWSTRID = OP1REC.KUMSTRID;
    OM0ZW01.OM0ZWXNXCD = OP1REC.XNXCD;
    TA1REC.TA1TBLKE = OM0ZW01.OM0ZWSYSKE;
    OM0ZS1P(); /* purge TS*/
    TA1REC.TA1TYPE = "DB2"; /* abend type*/
    TA1REC.TA1FUNC = "RETN"; /* abend function*/
    set ERRSQLCA empty; /* clear sql area*/
    move SQLCA to ERRSQLCA withV60Compat; /* save original sqlca*/
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes}; /* abend module*/
    COMMAREA.CA-USER-WORKAREA-4K = " "; /* clear user commarea*/
    XSPF4(); /* return to master menu*/
    exit program; /* master menu return failure*/
  end

end // end OM0ZS-ADD-VORXRF01

// DELETE DORDER.VOCPOX02
Function OM0ZS-DEL-VOCPOX02()

  set SQLCA empty;

  call "VOCPOX02" ("D1", SQLCA, VOCPOX02) {isNoRefresh = yes, isExternal = yes}; /**/

  if (SQLCA.VAGen_SQLCODE == 0
   || SQLCA.VAGen_SQLCODE == 100) /* check for good return code*/
    OM0ZW01.OM0ZW-OVRD-EXISTS = "N";
    OM0ZM001.CAMSG = "CUSTOMER CROSS REFERENCE OVERRIDE SUCCESSFULLY DELETED";
  else /* check for other return code*/
    TA1REC.TA1DBASE = "DORDER   "; /* data base name*/
    TA1REC.TA1TBLVU = "VOCPOX02"; /* table view*/
    TA1REC.TA1LOCAT[1] = "D1      "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "VOCPOX02"; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OM0ZS-DE"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "L-VOCPOX"; /* extra key*/
    OM0ZW01.OM0ZWSYSKE = " ";
    OM0ZW01.OM0ZWPARTN = OP1REC.OP1PARTN; /* order part char*/
    OM0ZW01.OM0ZWCUOID = OP1REC.OP1CUOID; /* customer order number*/
    OM0ZW01.OM0ZWNORID = OP1REC.OP1NORID; /* nike order number*/
    OM0ZW01.OM0ZWLNINB = OP2REC.OP2LNINB; /* line item*/
    OM0ZW01.OM0ZWCOID = OP1REC.KUCCOID;
    OM0ZW01.OM0ZWSTRID = OP1REC.KUMSTRID;
    OM0ZW01.OM0ZWXNXCD = OP1REC.XNXCD;
    TA1REC.TA1TBLKE = OM0ZW01.OM0ZWSYSKE;
    OM0ZS1P(); /* purge TS*/
    TA1REC.TA1TYPE = "DB2"; /* abend type*/
    TA1REC.TA1FUNC = "RETN"; /* abend function*/
    set ERRSQLCA empty; /* clear sql area*/
    move SQLCA to ERRSQLCA withV60Compat; /* save original sqlca*/
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes}; /* abend module*/
    COMMAREA.CA-USER-WORKAREA-4K = " "; /* clear user commarea*/
    XSPF4(); /* return to master menu*/
    exit program; /* master menu return failure*/
  end

end // end OM0ZS-DEL-VOCPOX02

// DELETE DORDER.VORXRF01
Function OM0ZS-DEL-VORXRF01()

  set SQLCA empty;

  call "VORXRF01" ("D ", SQLCA, VORXRF01) {isNoRefresh = yes, isExternal = yes}; /**/

  if (SQLCA.VAGen_SQLCODE == 0 /* check for good return code*/
   || SQLCA.VAGen_SQLCODE == 100) /* record doesn't exist*/
    OM0ZW01.OM0ZW-COMP-EXISTS = "N";
    OM0ZM001.CAMSG = "UPDATE SUCCESSFUL";
  else /* record already exists*/
    TA1REC.TA1DBASE = "DORDER   "; /* data base name*/
    TA1REC.TA1TBLVU = "VORXRF01"; /* table view*/
    TA1REC.TA1LOCAT[1] = "D1      "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "VORXRF01"; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OM0ZS-DE"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "L-VORXRF"; /* extra key*/
    OM0ZW01.OM0ZWSYSKE = " ";
    OM0ZW01.OM0ZWPARTN = OP1REC.OP1PARTN; /* order part char*/
    OM0ZW01.OM0ZWCUOID = OP1REC.OP1CUOID; /* customer order number*/
    OM0ZW01.OM0ZWNORID = OP1REC.OP1NORID; /* nike order number*/
    OM0ZW01.OM0ZWLNINB = OP2REC.OP2LNINB; /* line item*/
    OM0ZW01.OM0ZWCOID = OP1REC.KUCCOID;
    OM0ZW01.OM0ZWSTRID = OP1REC.KUMSTRID;
    OM0ZW01.OM0ZWXNXCD = OP1REC.XNXCD;
    TA1REC.TA1TBLKE = OM0ZW01.OM0ZWSYSKE;
    OM0ZS1P(); /* purge TS*/
    TA1REC.TA1TYPE = "DB2"; /* abend type*/
    TA1REC.TA1FUNC = "RETN"; /* abend function*/
    set ERRSQLCA empty; /* clear sql area*/
    move SQLCA to ERRSQLCA withV60Compat; /* save original sqlca*/
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes}; /* abend module*/
    COMMAREA.CA-USER-WORKAREA-4K = " "; /* clear user commarea*/
    XSPF4(); /* return to master menu*/
    exit program; /* master menu return failure*/
  end

end // end OM0ZS-DEL-VORXRF01

// FORMAT VCUCPX01 RECORD
Function OM0ZS-FMT-VCUCPX01()

  VCUCPX01.CU-CUSKU-ID = OM0ZW01.CU-CUSKU-ID;

  if (OM0ZW01.OM0ZW-XREF-EXISTS == "Y") /* /*/
  /* USE WHATEVER DEPT COMING IN FROM XREF*/
  else
    if (KUCREC.KUKPCOID == 29 /* if Penney's apparel, then we want*/
     && OP2REC.XGPCD == "03") /* to keep the dept nbr*/
      VCUCPX01.XNX-DEPT-ID-XREF = OP1REC.XNXCD; /* dept*/
    else
      VCUCPX01.XNX-DEPT-ID-XREF = 0; /* dept*/
    end
  end

  VCUCPX01.XGPCD = OP2REC.XGPCD; /* gpc code*/
  VCUCPX01.SY1STNBR = OP2REC.SY1STNBR; /* style nbr*/
  VCUCPX01.SY2CLRID = OP2REC.SY2CLRID; /* color*/
  VCUCPX01.XDMCD = OP2REC.XDMCD; /* dimension*/
  VCUCPX01.XQACD = OP2REC.XQACD; /* quality code*/
  if (OM0ZW01.OM0ZW-SIZE-LEVEL-CUSTOMER == "Y") /* size level*/
    VCUCPX01.SY5SZID = OMVREC.SY-SZ-ID[OM0ZWTSFS]; /* nk size*/
  else /* product level*/
    VCUCPX01.SY5SZID = 0;
  end

end // end OM0ZS-FMT-VCUCPX01

// FORMAT VOCPOX02 RECORD
Function OM0ZS-FMT-VOCPOX02()

  VOCPOX02.OP1PARTN = OP1REC.OP1PARTN; /* order related fields*/
  VOCPOX02.OP1CUOID = OP1REC.OP1CUOID;
  VOCPOX02.OP1NORID = OP1REC.OP1NORID;
  VOCPOX02.OP2LNINB = OP2REC.OP2LNINB;

  VOCPOX02.CU-CUSKU-ID = OM0ZW01.CU-CUSKU-ID;

  VOCPOX02.SY1STNBR = OP2REC.SY1STNBR; /* style nbr*/
  VOCPOX02.SY2CLRID = OP2REC.SY2CLRID; /* color*/
  VOCPOX02.XDMCD = OP2REC.XDMCD; /* dimension*/
  if (OM0ZW01.OM0ZW-SIZE-LEVEL-CUSTOMER == "Y") /* size level*/
    VOCPOX02.SY5SZID = OMVREC.SY-SZ-ID[OM0ZWTSFS]; /* nk size*/
  else /* product level*/
    VOCPOX02.SY5SZID = 0;
  end

end // end OM0ZS-FMT-VOCPOX02

// FORMAT VORXRF01 RECORD
Function OM0ZS-FMT-VORXRF01()

  VORXRF01.OP1PARTN = OP1REC.OP1PARTN;
  VORXRF01.OP1CUOID = OP1REC.OP1CUOID;
  VORXRF01.OP1NORID = OP1REC.OP1NORID;
  VORXRF01.OP2LNINB = OP2REC.OP2LNINB;
  VORXRF01.CU-BUY-SESN-ID = OM0ZW03.CU-BUY-SESN-ID;
  VORXRF01.OP-SMPL-RQT-ID = OM0ZW03.OP-SMPL-RQT-ID;
  VORXRF01.CU-COST-ID = OM0ZW03.CU-COST-ID;
  VORXRF01.OP-CASE-LOT-NBR = OM0ZW03.OP-CASE-LOT-NBR;
   /* for now, the companion data is at the product level, so only*/
   /* insert 0 size record. this will need to uncommented out when*/
   /* a customer decides to use it at the size level.*/
   /* IF OM0ZW01.OM0ZW-SIZE-LEVEL-CUSTOMER = 'Y';/* size level*/
   /* MOVE OMVREC.SY-SZ-ID(OM0ZWTSFS) TO VORXRF01.SY5SZID;*/
   /* ELSE;                            /* product level*/
  VORXRF01.SY5SZID = 0;
   /* END;*/

end // end OM0ZS-FMT-VORXRF01

// CALCULATE CU-CUSKU-IND
Function OM0ZS-GET-CUSKU()

  set SQLCA empty;

  KUCREC.KUCCOID = OP1REC.KUCCOID;

  call "IO0240" ("S ", SQLCA, KUCREC) {isNoRefresh = yes, isExternal = yes}; /**/

  if (SQLCA.VAGen_SQLCODE == 0) /* check for good return code*/
    OM0ZS07(); /* determine customer info*/
  else
    TA1REC.TA1DBASE = "DCUST   "; /* data base name*/
    TA1REC.TA1TBLVU = "VCMPNY01"; /* table view*/
    TA1REC.TA1LOCAT[1] = "S       "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "IO0240  "; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OM0ZS-GE"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "T-CUSKU "; /* extra key*/
    OM0ZW01.OM0ZWCOID = OP1REC.KUCCOID;
    TA1REC.TA1TBLKE = OM0ZW01.OM0ZWCOID;
    OM0ZS1P(); /* purge TS*/
    TA1REC.TA1TYPE = "DB2"; /* abend type*/
    TA1REC.TA1FUNC = "RETN"; /* abend function*/
    set ERRSQLCA empty; /* clear sql area*/
    move SQLCA to ERRSQLCA withV60Compat; /* save original sqlca*/
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes}; /* abend module*/
    COMMAREA.CA-USER-WORKAREA-4K = " "; /* clear user commarea*/
    XSPF4(); /* return to master menu*/
    exit program; /* master menu return failure*/
  end
end // end OM0ZS-GET-CUSKU

// GET DATABASE RECORDS
Function OM0ZS-GET-DATA()

  OM0ZS-GET-CUSKU(); /* get cusku info*/

   /* OM0ZS-GET-OP1REC;                /* get order hdr record*/

  OM0ZS-GET-OP2REC(); /* get order item record*/

  OM0ZS05(); /* get xref record with overrides*/

  if (WCU1710.WCU1710-XREF-EXISTS-FL[1] == "Y") /* xref rec found*/
    OM0ZW01.OM0ZW-XREF-EXISTS = "Y";
    OM0ZS-GET-VCUCPX01(); /* get xref record without overrides*/
                                   /* (using VCUCPX01)*/
  else /* xref rec not found*/
    OM0ZW01.OM0ZW-XREF-EXISTS = "N";
  end

  if (WCU1710.WCU1710-CU-OVRD-EXISTS-FL[1] == "Y") /* override rec found*/
    OM0ZW01.OM0ZW-OVRD-EXISTS = "Y";
    OM0ZS-GET-VOCPOX02(); /* get override rec without xref rec*/
  else /* override rec not found*/
    OM0ZW01.OM0ZW-OVRD-EXISTS = "N";
  end

  if (WCU1710.OP-SMPL-RQT-ID != " "
   || WCU1710.CU-BUY-SESN-ID != " "
   || WCU1710.CU-COST-ID != " "
   || WCU1710.OP-CASE-LOT-NBR != " ") /* companion record found*/
    OM0ZW01.OM0ZW-COMP-EXISTS = "Y";
    OM0ZS-GET-VORXRF01(); /* get the companion record*/
  else /* companion rec not found*/
    OM0ZW01.OM0ZW-COMP-EXISTS = "N";
  end

end // end OM0ZS-GET-DATA

// GET LINE ITEM
Function OM0ZS-GET-OP2REC()

  set SQLCA empty;
  set OP2REC empty;

  OP2REC.OP1PARTN = OP1REC.OP1PARTN; /* part char*/
  OP2REC.OP1CUOID = OP1REC.OP1CUOID; /* order nbr*/
  OP2REC.OP1NORID = OP1REC.OP1NORID; /* nike ord id*/
  if (OMWREC.OP2LNINB[1] > 0)
    OP2REC.OP2LNINB = OMWREC.OP2LNINB[1]; /* line item nbr*/
  else
    OP2REC.OP2LNINB = OMWREC.OMWLNITX; /* line item nbr*/
  end

  call "IO0440" ("S ", SQLCA, OP2REC) {isNoRefresh = yes, isExternal = yes};

  if (SQLCA.VAGen_SQLCODE == 0) /* good return code*/
     /* next sentence*/
  else /* not good return code*/
    TA1REC.TA1DBASE = "DORDER   "; /* data base name*/
    TA1REC.TA1TBLVU = "VITEM001"; /* table view*/
    TA1REC.TA1LOCAT[1] = "S       "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "IO0440  "; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OM0ZS-GE"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "T-OP2REC"; /* extra key*/
    OM0ZW01.OM0ZWSYSKE = " ";
    OM0ZW01.OM0ZWPARTN = OP1REC.OP1PARTN; /* order part char*/
    OM0ZW01.OM0ZWCUOID = OP1REC.OP1CUOID; /* customer order number*/
    OM0ZW01.OM0ZWNORID = OP1REC.OP1NORID; /* nike order number*/
    OM0ZW01.OM0ZWLNINB = OMWREC.OP2LNINB[1];
    OM0ZW01.OM0ZWCOID = OP1REC.KUCCOID;
    OM0ZW01.OM0ZWSTRID = OP1REC.KUMSTRID;
    OM0ZW01.OM0ZWXNXCD = OP1REC.XNXCD;
    TA1REC.TA1TBLKE = OM0ZW01.OM0ZWSYSKE;
    OM0ZS1P(); /* purge TS*/
    TA1REC.TA1TYPE = "DB2"; /* abend type*/
    TA1REC.TA1FUNC = "RETN"; /* abend function*/
    set ERRSQLCA empty; /* clear sql area*/
    move SQLCA to ERRSQLCA withV60Compat; /* save original sqlca*/
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes}; /* abend module*/
    COMMAREA.CA-USER-WORKAREA-4K = " "; /* clear user commarea*/
    XSPF4(); /* return to master menu*/
    exit program; /* master menu return failure*/
  end
end // end OM0ZS-GET-OP2REC

// GET STYLE/COLOR DESCRIPTION
Function OM0ZS-GET-VCOLOR02()

  set SYCREC empty;
  set SQLCA empty;

  SYCREC.SY1STNBR = WCU1710.WCU1710-IN-SY-STY-NBR; /* style number*/
  SYCREC.SY2CLRID = WCU1710.WCU1710-IN-SY-COLR-CD-ID; /* color id*/
  SYCREC.XDMCD = WCU1710.WCU1710-IN-XDM-DIM-CD; /* dimension*/
  SYCREC.XGPCD = WCU1710.WCU1710-IN-XGP-GPC-CD; /* gpc*/

  call "IO0560" ("S ", SQLCA, SYCREC) {isNoRefresh = yes, isExternal = yes}; /* call i/o mod for inquiry*/

  if (SQLCA.VAGen_SQLCODE == 0   /* check for good rc*/
   || SQLCA.VAGen_SQLCODE == 100 /* product not found*/
   || SQLCA.VAGen_SQLCODE == -911) /* database busy*/
  /* next sentence*/
  else
    TA1REC.TA1DBASE = "DPROD   "; /* data base name*/
    TA1REC.TA1TBLVU = "VCOLOR02"; /* table view*/
    TA1REC.TA1LOCAT[1] = "S       "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "IO0560  "; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OM0ZS-GE"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "T-VCOLOR"; /* statement group*/
    OM0ZW01.OM0ZWSYSKE = " ";
    OM0ZW01.OM0ZWPARTN = OP1REC.OP1PARTN; /* order part char*/
    OM0ZW01.OM0ZWCUOID = OP1REC.OP1CUOID; /* customer order number*/
    OM0ZW01.OM0ZWNORID = OP1REC.OP1NORID; /* nike order number*/
    OM0ZW01.OM0ZWLNINB = OP2REC.OP2LNINB;
    OM0ZW01.OM0ZWCOID = OP1REC.KUCCOID;
    OM0ZW01.OM0ZWSTRID = OP1REC.KUMSTRID;
    OM0ZW01.OM0ZWXNXCD = OP1REC.XNXCD;
    OM0ZW01.OM0ZWSTY = WCU1710.WCU1710-IN-SY-STY-NBR; /* style nbr*/
    TA1REC.TA1TBLKE = OM0ZW01.OM0ZWSYSKE; /* style nbr*/
    OM0ZS1P(); /* purge TS*/
    TA1REC.TA1TYPE = "DB2"; /* abend type*/
    TA1REC.TA1FUNC = "RETN"; /* abend function*/
    set ERRSQLCA empty; /* clear sql area*/
    move SQLCA to ERRSQLCA withV60Compat; /* save original sqlca*/
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes}; /* abend module*/
    COMMAREA.CA-USER-WORKAREA-4K = " "; /* clear user commarea*/
    XSPF4(); /* return to master menu*/
    exit program; /* master menu return failure*/
  end

end // end OM0ZS-GET-VCOLOR02

// GET XREF REC WITHOUT OVERRIDES
Function OM0ZS-GET-VCUCPX01()

  set SQLCA empty;

  VCUCPX01.CU-CUSKU-ID = OM0ZW01.CU-CUSKU-ID;

  VCUCPX01.SY1STNBR = OP2REC.SY1STNBR; /* style nbr*/
  VCUCPX01.SY2CLRID = OP2REC.SY2CLRID; /* color*/
  VCUCPX01.XDMCD = OP2REC.XDMCD; /* dimension*/
  VCUCPX01.XQACD = OP2REC.XQACD; /* quality code*/
  VCUCPX01.XGPCD = OP2REC.XGPCD; /* gpc code*/

   /* tcs change 04/30/99*/
  if ((KUCREC.KUKPCOID == 29 
   || KUCREC.KUKPCOID == 32) /* for penny apparel*/
   && OP2REC.XGPCD == "03")  /* to use the dept nbr*/
    VCUCPX01.XNX-DEPT-ID-XREF = OP1REC.XNXCD; /* dept*/
  else
    VCUCPX01.XNX-DEPT-ID-XREF = 0; /* all other cust don't use dept*/
  end

   /* tcs change 04/30/99*/
  VCUCPX01.CU-PROD-XREF-EDT = OP1REC.OP1CUNDT; /* prod eff date*/
  if (OM0ZW01.OM0ZW-SIZE-LEVEL-CUSTOMER == "Y") /* size level*/
    VCUCPX01.SY5SZID = OMVREC.SY-SZ-ID[OM0ZWTSFS]; /* nk size*/
  else /* product level*/
    VCUCPX01.SY5SZID = 0; /* nk size*/
  end

  call "VCUCPX01" ("SB", SQLCA, VCUCPX01);

  if (SQLCA.VAGen_SQLCODE == 0) /* good return code*/
     /* next sentence*/
  else /* not good return code*/
    TA1REC.TA1DBASE = "DCUST   "; /* data base name*/
    TA1REC.TA1TBLVU = "VCUCPX01"; /* table view*/
    TA1REC.TA1LOCAT[1] = "SB      "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "VCUCPX01"; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OM0ZS-G "; /* statement group*/
    TA1REC.TA1LOCAT[4] = "ET-VCUCP"; /* extra key*/
    OM0ZW01.OM0ZWSYSKE = " ";
    OM0ZW01.OM0ZWPARTN = OP1REC.OP1PARTN; /* order part char*/
    OM0ZW01.OM0ZWCUOID = OP1REC.OP1CUOID; /* customer order number*/
    OM0ZW01.OM0ZWNORID = OP1REC.OP1NORID; /* nike order number*/
    OM0ZW01.OM0ZWLNINB = OP2REC.OP2LNINB; /* line number*/
    OM0ZW01.OM0ZWCOID = OP1REC.KUCCOID;
    OM0ZW01.OM0ZWSTRID = OP1REC.KUMSTRID;
    OM0ZW01.OM0ZWXNXCD = OP1REC.XNXCD;
    TA1REC.TA1TBLKE = OM0ZW01.OM0ZWSYSKE;
    OM0ZS1P(); /* purge TS*/
    TA1REC.TA1TYPE = "DB2"; /* abend type*/
    TA1REC.TA1FUNC = "RETN"; /* abend function*/
    set ERRSQLCA empty; /* clear sql area*/
    move SQLCA to ERRSQLCA withV60Compat; /* save original sqlca*/
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes}; /* abend module*/
    COMMAREA.CA-USER-WORKAREA-4K = " "; /* clear user commarea*/
    XSPF4(); /* return to master menu*/
    exit program; /* master menu return failure*/
  end

end // end OM0ZS-GET-VCUCPX01

// GET XREF OVERRIDE INFO
Function OM0ZS-GET-VOCPOX02()

  set VOCPOX02 empty; /* task record*/
  set SQLCA empty;

  VOCPOX02.OP1PARTN = OP1REC.OP1PARTN; /* ord part char*/
  VOCPOX02.OP1CUOID = OP1REC.OP1CUOID; /* customer order id*/
  VOCPOX02.OP1NORID = OP1REC.OP1NORID; /* nike order id*/
  VOCPOX02.OP2LNINB = OP2REC.OP2LNINB; /* order line item*/
  if (OM0ZW01.OM0ZW-SIZE-LEVEL-CUSTOMER == "Y") /* size level*/
    VOCPOX02.SY5SZID = OMVREC.SY-SZ-ID[OM0ZWTSFS]; /* nike size*/
  else /* product level*/
    VOCPOX02.SY5SZID = 0;
  end

  call "VOCPOX02" ("S ", SQLCA, VOCPOX02) {isNoRefresh = yes, isExternal = yes}; /**/

  if (SQLCA.VAGen_SQLCODE == 0) /* good return code*/
    OM0ZW01.OM0ZW-OVRD-EXISTS = "Y";
  else /* not good return code*/
    if (SQLCA.VAGen_SQLCODE == 100)
      OM0ZW01.OM0ZW-OVRD-EXISTS = "N";
    else
      TA1REC.TA1DBASE = "DORDER   "; /* data base name*/
      TA1REC.TA1TBLVU = "VOCPOX02"; /* table view*/
      TA1REC.TA1LOCAT[2] = "VOCPOX02"; /* i/o mod name*/
      TA1REC.TA1LOCAT[3] = "OM0ZS-GE"; /* statement group*/
      TA1REC.TA1LOCAT[4] = "T-VOCPOX"; /* extra key*/
      OM0ZW01.OM0ZWSYSKE = " ";
      OM0ZW01.OM0ZWPARTN = OP1REC.OP1PARTN; /* order part char*/
      OM0ZW01.OM0ZWCUOID = OP1REC.OP1CUOID; /* customer order number*/
      OM0ZW01.OM0ZWNORID = OP1REC.OP1NORID; /* nike order number*/
      OM0ZW01.OM0ZWLNINB = OP2REC.OP2LNINB;
      OM0ZW01.OM0ZWCOID = OP1REC.KUCCOID;
      OM0ZW01.OM0ZWSTRID = OP1REC.KUMSTRID;
      OM0ZW01.OM0ZWXNXCD = OP1REC.XNXCD;
      TA1REC.TA1TBLKE = OM0ZW01.OM0ZWSYSKE;
      OM0ZS1P(); /* purge TS*/
      TA1REC.TA1TYPE = "DB2"; /* abend type*/
      TA1REC.TA1FUNC = "RETN"; /* abend function*/
      set ERRSQLCA empty; /* clear sql area*/
      move SQLCA to ERRSQLCA withV60Compat; /* save original sqlca*/
      VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
      VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
      sysLib.rollback();
      VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
      
      call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes}; /* abend module*/
      COMMAREA.CA-USER-WORKAREA-4K = " "; /* clear user commarea*/
      XSPF4(); /* return to master menu*/
      exit program; /* master menu return failure*/
    end
  end

end // end OM0ZS-GET-VOCPOX02

// SELECT VORXRF01
Function OM0ZS-GET-VORXRF01()

  set VORXRF01 empty;

  VORXRF01.OP1PARTN = OP1REC.OP1PARTN;
  VORXRF01.OP1CUOID = OP1REC.OP1CUOID;
  VORXRF01.OP1NORID = OP1REC.OP1NORID;
  VORXRF01.OP2LNINB = OP2REC.OP2LNINB;
  VORXRF01.SY5SZID = 0;

  set SQLCA empty;

  call "VORXRF01" ("S ", SQLCA, VORXRF01) {isNoRefresh = yes, isExternal = yes}; /**/

   /* check db2 return code*/

  if (SQLCA.VAGen_SQLCODE == 0) /* check for good rc*/
    OM0ZW01.OM0ZW-COMP-EXISTS = "Y";
  else
    if (SQLCA.VAGen_SQLCODE == 100) /* CHECK FOR GOOD RC*/
      OM0ZW01.OM0ZW-COMP-EXISTS = "N";
    else
      TA1REC.TA1DBASE = "DORDER   "; /* data base name*/
      TA1REC.TA1TBLVU = "VORXRF01"; /* table view*/
      TA1REC.TA1LOCAT[1] = "S       "; /* calling option*/
      TA1REC.TA1LOCAT[2] = "VORXRF01"; /* i/o mod name*/
      TA1REC.TA1LOCAT[3] = "OM0ZS-GE"; /* statement group*/
      TA1REC.TA1LOCAT[4] = "T-VORXRF"; /* extra key*/
      OM0ZW01.OM0ZWSYSKE = " ";
      OM0ZW01.OM0ZWPARTN = OP1REC.OP1PARTN; /* order part char*/
      OM0ZW01.OM0ZWCUOID = OP1REC.OP1CUOID; /* customer order number*/
      OM0ZW01.OM0ZWNORID = OP1REC.OP1NORID; /* nike order number*/
      OM0ZW01.OM0ZWLNINB = OP2REC.OP2LNINB;
      OM0ZW01.OM0ZWCOID = OP1REC.KUCCOID;
      OM0ZW01.OM0ZWSTRID = OP1REC.KUMSTRID;
      OM0ZW01.OM0ZWXNXCD = OP1REC.XNXCD;
      TA1REC.TA1TBLKE = OM0ZW01.OM0ZWSYSKE;
      OM0ZS1P(); /* purge TS*/
      TA1REC.TA1TYPE = "DB2"; /* abend type*/
      TA1REC.TA1FUNC = "RETN"; /* abend function*/
      set ERRSQLCA empty; /* clear sql area*/
      move SQLCA to ERRSQLCA withV60Compat; /* save original sqlca*/
      VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
      VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
      sysLib.rollback();
      VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
      
      call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes}; /* abend module*/
      COMMAREA.CA-USER-WORKAREA-4K = " "; /* clear user commarea*/
      XSPF4(); /* return to master menu*/
      exit program; /* master menu return failure*/
    end
  end

end // end OM0ZS-GET-VORXRF01

// GET SIZE DESCRIPTION
Function OM0ZS-GET-VSCALE01()

  set SY4REC empty;
  set SQLCA empty;

  SY4REC.SY4SZSCL = SYCREC.SY4SZSCL;

  call "IO0040" ("S ", SQLCA, SY4REC) {isNoRefresh = yes, isExternal = yes}; /* call i/o mod for inquiry*/

  if (SQLCA.VAGen_SQLCODE == 0   /* check for good rc*/
   || SQLCA.VAGen_SQLCODE == 100 /* product not found*/
   || SQLCA.VAGen_SQLCODE == -911) /* database busy*/
  /* next sentence*/
  else
    TA1REC.TA1DBASE = "DPROD   "; /* data base name*/
    TA1REC.TA1TBLVU = "VSCALE01"; /* table view*/
    TA1REC.TA1LOCAT[1] = "S       "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "IO0040  "; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OM0ZS-GE"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "T-VSCALE"; /* statement group*/
    OM0ZW01.OM0ZWSYSKE = " ";
    OM0ZW01.OM0ZWPARTN = OP1REC.OP1PARTN; /* order part char*/
    OM0ZW01.OM0ZWCUOID = OP1REC.OP1CUOID; /* customer order number*/
    OM0ZW01.OM0ZWNORID = OP1REC.OP1NORID; /* nike order number*/
    OM0ZW01.OM0ZWLNINB = OP2REC.OP2LNINB;
    OM0ZW01.OM0ZWCOID = OP1REC.KUCCOID;
    OM0ZW01.OM0ZWSTRID = OP1REC.KUMSTRID;
    OM0ZW01.OM0ZWXNXCD = OP1REC.XNXCD;
    OM0ZW01.OM0ZWSTY = WCU1710.WCU1710-IN-SY-STY-NBR; /* style nbr*/
    TA1REC.TA1TBLKE = OM0ZW01.OM0ZWSYSKE; /* style nbr*/
    OM0ZS1P(); /* purge TS*/
    TA1REC.TA1TYPE = "DB2"; /* abend type*/
    TA1REC.TA1FUNC = "RETN"; /* abend function*/
    set ERRSQLCA empty; /* clear sql area*/
    move SQLCA to ERRSQLCA withV60Compat; /* save original sqlca*/
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes}; /* abend module*/
    COMMAREA.CA-USER-WORKAREA-4K = " "; /* clear user commarea*/
    XSPF4(); /* return to master menu*/
    exit program; /* master menu return failure*/
  end

end // end OM0ZS-GET-VSCALE01

// GET WCU1710
Function OM0ZS-GET-WCU1710()

  WCU1710.WCU1710-IN-DORDB-IND = "N"; /* DORDER database*/
  WCU1710-IN-CU-CO-ID = OP1REC.KUCCOID; /* company id*/
  WCU1710-XNX-DEPT-ID-XREF = OP1REC.XNXCD; /* dept*/
  WCU1710-CU-PROD-XREF-EDT = OP1REC.OP1CUNDT; /* product eff date*/

  WCU1710-IN-OP-ORD-PART-CHAR = OP1REC.OP1PARTN; /* ord part char*/
  WCU1710-IN-OP-CUST-ORD-ID = OP1REC.OP1CUOID; /* cust ord id*/
  WCU1710-IN-OP-NIKE-ORD-ID = OP1REC.OP1NORID; /* nike ord id*/
  WCU1710-IN-OP-LINE-ITEM-NBR = OP2REC.OP2LNINB; /* order line item*/

  WCU1710-IN-XGP-GPC-CD = OP2REC.XGPCD; /* gpc code*/
  WCU1710-IN-SY-STY-NBR = OP2REC.SY1STNBR; /* style nbr*/
  WCU1710-IN-SY-COLR-CD-ID = OP2REC.SY2CLRID; /* color*/
  WCU1710-IN-XDM-DIM-CD = OP2REC.XDMCD; /* dimension*/
  WCU1710-IN-SY-SZ-ID = OMVREC.SY-SZ-ID[OM0ZWTSFS]; /* nike size*/
  WCU1710-IN-XQA-QUAL-CD = OP2REC.XQACD; /* quality code*/

  WCU1710-RETURN-CODE = 99;

  call "CU1710" (WCU1710) {isNoRefresh = yes, isExternal = yes}; /* get xref rec for item/size*/

end // end OM0ZS-GET-WCU1710

// REFRESH FROM CUST XREF REC
Function OM0ZS-PF21-MOVES()

  OM0ZM001.CU-CUST-PROD-ID = VCUCPX01.CU-CUST-PROD-ID;
  OM0ZW03.CU-CUST-PROD-ID = VCUCPX01.CU-CUST-PROD-ID;
  set OM0ZM001.CU-CUST-PROD-ID initialAttributes;

  OM0ZM001.CU-PROD-NM = VCUCPX01.CU-PROD-NM;
  OM0ZW03.CU-PROD-NM = VCUCPX01.CU-PROD-NM;
  set OM0ZM001.CU-PROD-NM initialAttributes;

  OM0ZM001.CU-PROD-COLR-NM = VCUCPX01.CU-PROD-COLR-NM;
  OM0ZW03.CU-PROD-COLR-NM = VCUCPX01.CU-PROD-COLR-NM;
  set OM0ZM001.CU-PROD-COLR-NM initialAttributes;

  OM0ZM001.CU-PROD-SZ-ID = VCUCPX01.CU-PROD-SZ-ID;
  OM0ZW03.CU-PROD-SZ-ID = VCUCPX01.CU-PROD-SZ-ID;
  set OM0ZM001.CU-PROD-SZ-ID initialAttributes;

  OM0ZM001.CU-PROD-SZ-NM = VCUCPX01.CU-PROD-SZ-NM;
  OM0ZW03.CU-PROD-SZ-NM = VCUCPX01.CU-PROD-SZ-NM;
  set OM0ZM001.CU-PROD-SZ-NM initialAttributes;

  OM0ZM001.CU-CUST-RTL-PRC = VCUCPX01.CU-CUST-RTL-PRC;
  OM0ZW03.CU-CUST-RTL-PRC = VCUCPX01.CU-CUST-RTL-PRC;
  set OM0ZM001.CU-CUST-RTL-PRC initialAttributes;

  OM0ZM001.CU-CUST-SPCL-PRC = VCUCPX01.CU-CUST-SPCL-PRC;
  OM0ZW03.CU-CUST-SPCL-PRC = VCUCPX01.CU-CUST-SPCL-PRC;
  set OM0ZM001.CU-CUST-SPCL-PRC initialAttributes;

  OM0ZM001.CU-SUGG-RTL-PRC = VCUCPX01.CU-SUGG-RTL-PRC;
  OM0ZW03.CU-SUGG-RTL-PRC = VCUCPX01.CU-SUGG-RTL-PRC;
  set OM0ZM001.CU-SUGG-RTL-PRC initialAttributes;

  OM0ZW01.OM0ZWDT8 = VCUCPX01.CU-SPCL-PRC-EDT;
  OM0ZSDCM();
  OM0ZM001.OM0ZM-CU-SPCL-PRC-EDT = OM0ZW01.OM0ZWDT6;
  OM0ZW03.OM0ZW-CU-SPCL-PRC-EDT-MAP = OM0ZW01.OM0ZWDT6;
  OM0ZW03.CU-SPCL-PRC-EDT = VCUCPX01.CU-SPCL-PRC-EDT;
  set OM0ZM001.OM0ZM-CU-SPCL-PRC-EDT initialAttributes;

  OM0ZM001.CU-VEND-CLS-ID = VCUCPX01.CU-VEND-CLS-ID;
  OM0ZW03.CU-VEND-CLS-ID = VCUCPX01.CU-VEND-CLS-ID;
  set OM0ZM001.CU-VEND-CLS-ID initialAttributes;

  OM0ZM001.CU-SKU-COMNT1 = VCUCPX01.CU-SKU-COMNT1;
  OM0ZW03.CU-SKU-COMNT1 = VCUCPX01.CU-SKU-COMNT1;
  set OM0ZM001.CU-SKU-COMNT1 initialAttributes;

  OM0ZM001.CU-SKU-COMNT2 = VCUCPX01.CU-SKU-COMNT2;
  OM0ZW03.CU-SKU-COMNT2 = VCUCPX01.CU-SKU-COMNT2;
  set OM0ZM001.CU-SKU-COMNT2 initialAttributes;

  OM0ZM001.CU-SKU-COMNT3 = VCUCPX01.CU-SKU-COMNT3;
  OM0ZW03.CU-SKU-COMNT3 = VCUCPX01.CU-SKU-COMNT3;
  set OM0ZM001.CU-SKU-COMNT3 initialAttributes;

end // end OM0ZS-PF21-MOVES

// update temp storage
Function OM0ZS-UPD-TS()

  OMVREC.OM-CU-PROD-ID[OM0ZWTSFS] = OM0ZM001.CU-CUST-PROD-ID;
  OMVREC.OM-CU-PROD-NM[OM0ZWTSFS] = OM0ZM001.CU-PROD-NM;
  OMVREC.OM-CU-PROD-COLR-NM[OM0ZWTSFS] = OM0ZM001.CU-PROD-COLR-NM;
  OMVREC.CU-PROD-SZ-ID[OM0ZWTSFS] = OM0ZM001.CU-PROD-SZ-ID;

  if (OM0ZW01.OM0ZW-OVRD-EXISTS == "Y")
    OMVREC.CU-OVRD-EXISTS-FL[OM0ZWTSFS] = "Y";
  else
    OMVREC.CU-OVRD-EXISTS-FL[OM0ZWTSFS] = "N";
  end

  OM0ZS1U();

end // end OM0ZS-UPD-TS

// UPDATE DCUST.VCUCPX01
Function OM0ZS-UPD-VCUCPX01()

  set SQLCA empty;

  VCUCPX01.ZZZCHGDT = OM0ZW01.ZZZCHGDT;
  VCUCPX01.ZZZCHGTM = OM0ZW01.ZZZCHGTM;

  call "VCUCPX01" ("U ", SQLCA, VCUCPX01) {isNoRefresh = yes, isExternal = yes};

  if (SQLCA.VAGen_SQLCODE == 0) /* check for good return code*/
    OM0ZW01.OM0ZW-XREF-EXISTS = "Y";
    OM0ZM001.CAMSG = "CUSTOMER CROSS REFERENCE SUCCESSFULLY UPDATED";
  else /* other return code*/
    TA1REC.TA1DBASE = "DCUST   "; /* data base name*/
    TA1REC.TA1TBLVU = "VCUCPX01"; /* table view*/
    TA1REC.TA1LOCAT[1] = "U       "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "VCUCPX01"; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OM0ZS-UP"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "D-VCUCPX"; /* extra key*/
    OM0ZW01.OM0ZWSYSKE = " ";
    OM0ZW01.OM0ZWPARTN = OP1REC.OP1PARTN; /* order part char*/
    OM0ZW01.OM0ZWCUOID = OP1REC.OP1CUOID; /* customer order number*/
    OM0ZW01.OM0ZWNORID = OP1REC.OP1NORID; /* nike order number*/
    OM0ZW01.OM0ZWLNINB = OP2REC.OP2LNINB; /* line item*/
    OM0ZW01.OM0ZWCOID = OP1REC.KUCCOID;
    OM0ZW01.OM0ZWSTRID = OP1REC.KUMSTRID;
    OM0ZW01.OM0ZWXNXCD = OP1REC.XNXCD;
    TA1REC.TA1TBLKE = OM0ZW01.OM0ZWSYSKE;
    OM0ZS1P(); /* purge TS*/
    TA1REC.TA1TYPE = "DB2"; /* abend type*/
    TA1REC.TA1FUNC = "RETN"; /* abend function*/
    set ERRSQLCA empty; /* clear sql area*/
    move SQLCA to ERRSQLCA withV60Compat; /* save original sqlca*/
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes}; /* abend module*/
    COMMAREA.CA-USER-WORKAREA-4K = " "; /* clear user commarea*/
    XSPF4(); /* return to master menu*/
    exit program; /* master menu return failure*/
  end

end // end OM0ZS-UPD-VCUCPX01

// UPDATE LINE ITEM
Function OM0ZS-UPD-VITEM001()

  set SQLCA empty;
   /* tcs delete begin (12/01/97)*/
   /* SET OP2REC EMPTY;*/
   /* tcs delete end   (12/01/97)*/

  OP2REC.OP1PARTN = OP1REC.OP1PARTN; /* part char*/
  OP2REC.OP1CUOID = OP1REC.OP1CUOID; /* order nbr*/
  OP2REC.OP1NORID = OP1REC.OP1NORID; /* nike ord id*/
  if (OMWREC.OP2LNINB[1] > 0)
    OP2REC.OP2LNINB = OMWREC.OP2LNINB[1]; /* line item nbr*/
  else
    OP2REC.OP2LNINB = OMWREC.OMWLNITX; /* line item nbr*/
  end

  call "IO0440" ("U3", SQLCA, OP2REC) {isNoRefresh = yes, isExternal = yes};

  if (SQLCA.VAGen_SQLCODE == 0) /* good return code*/
     /* next sentence*/
  else /* not good return code*/
    TA1REC.TA1DBASE = "DORDER   "; /* data base name*/
    TA1REC.TA1TBLVU = "VITEM001"; /* table view*/
    TA1REC.TA1LOCAT[1] = "U3      "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "IO0440  "; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OM0ZS-UP"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "D-VITEM0"; /* extra key*/
    OM0ZW01.OM0ZWSYSKE = " ";
    OM0ZW01.OM0ZWPARTN = OP1REC.OP1PARTN; /* order part char*/
    OM0ZW01.OM0ZWCUOID = OP1REC.OP1CUOID; /* customer order number*/
    OM0ZW01.OM0ZWNORID = OP1REC.OP1NORID; /* nike order number*/
    OM0ZW01.OM0ZWLNINB = OMWREC.OP2LNINB[1];
    OM0ZW01.OM0ZWCOID = OP1REC.KUCCOID;
    OM0ZW01.OM0ZWSTRID = OP1REC.KUMSTRID;
    OM0ZW01.OM0ZWXNXCD = OP1REC.XNXCD;
    TA1REC.TA1TBLKE = OM0ZW01.OM0ZWSYSKE;
    OM0ZS1P(); /* purge TS*/
    TA1REC.TA1TYPE = "DB2"; /* abend type*/
    TA1REC.TA1FUNC = "RETN"; /* abend function*/
    set ERRSQLCA empty; /* clear sql area*/
    move SQLCA to ERRSQLCA withV60Compat; /* save original sqlca*/
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes}; /* abend module*/
    COMMAREA.CA-USER-WORKAREA-4K = " "; /* clear user commarea*/
    XSPF4(); /* return to master menu*/
    exit program; /* master menu return failure*/
  end
end // end OM0ZS-UPD-VITEM001

// UPDATE DORDER.VOCPOX02
Function OM0ZS-UPD-VOCPOX02()

  set SQLCA empty;

  OM0ZS-FMT-VOCPOX02();

  VOCPOX02.ZZZCHGDT = OM0ZW01.ZZZCHGDT;
  VOCPOX02.ZZZCHGTM = OM0ZW01.ZZZCHGTM;

  call "VOCPOX02" ("U1", SQLCA, VOCPOX02) {isNoRefresh = yes, isExternal = yes}; /**/

  if (SQLCA.VAGen_SQLCODE == 0) /* check for good return code*/
    OM0ZM001.CAMSG = "CUSTOMER CROSS REFERENCE OVERRIDE SUCCESSFULLY UPDATED";
    OM0ZW01.OM0ZW-OVRD-EXISTS = "Y";
  else
    TA1REC.TA1DBASE = "DORDER   "; /* data base name*/
    TA1REC.TA1TBLVU = "VOCPOX02"; /* table view*/
    TA1REC.TA1LOCAT[1] = "U1      "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "VOCPOX02"; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OM0ZS-UP"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "D-VOCPOX"; /* extra key*/
    OM0ZW01.OM0ZWSYSKE = " ";
    OM0ZW01.OM0ZWPARTN = OP1REC.OP1PARTN; /* order part char*/
    OM0ZW01.OM0ZWCUOID = OP1REC.OP1CUOID; /* customer order number*/
    OM0ZW01.OM0ZWNORID = OP1REC.OP1NORID; /* nike order number*/
    OM0ZW01.OM0ZWLNINB = OP2REC.OP2LNINB; /* line item*/
    OM0ZW01.OM0ZWCOID = OP1REC.KUCCOID;
    OM0ZW01.OM0ZWSTRID = OP1REC.KUMSTRID;
    OM0ZW01.OM0ZWXNXCD = OP1REC.XNXCD;
    TA1REC.TA1TBLKE = OM0ZW01.OM0ZWSYSKE;
    OM0ZS1P(); /* purge TS*/
    TA1REC.TA1TYPE = "DB2"; /* abend type*/
    TA1REC.TA1FUNC = "RETN"; /* abend function*/
    set ERRSQLCA empty; /* clear sql area*/
    move SQLCA to ERRSQLCA withV60Compat; /* save original sqlca*/
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes}; /* abend module*/
    COMMAREA.CA-USER-WORKAREA-4K = " "; /* clear user commarea*/
    XSPF4(); /* return to master menu*/
    exit program; /* master menu return failure*/
  end

end // end OM0ZS-UPD-VOCPOX02

// UPDATE DORDER.VORXRF01
Function OM0ZS-UPD-VORXRF01()

  set SQLCA empty;

  OM0ZS-FMT-VORXRF01();

  VORXRF01.ZZZCHGDT = OM0ZW01.ZZZCHGDT;
  VORXRF01.ZZZCHGTM = OM0ZW01.ZZZCHGTM;

  call "VORXRF01" ("U ", SQLCA, VORXRF01) {isNoRefresh = yes, isExternal = yes}; /**/

  if (SQLCA.VAGen_SQLCODE == 0) /* check for good return code*/
    OM0ZW01.OM0ZW-COMP-EXISTS = "Y";
    OM0ZM001.CAMSG = "UPDATE SUCCESSFUL";
  else
    TA1REC.TA1DBASE = "DORDER   "; /* data base name*/
    TA1REC.TA1TBLVU = "VORXRF01"; /* table view*/
    TA1REC.TA1LOCAT[1] = "U       "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "VORXRF01"; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OM0ZS-UP"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "D-VOBXRF"; /* extra key*/
    OM0ZW01.OM0ZWSYSKE = " ";
    OM0ZW01.OM0ZWPARTN = OP1REC.OP1PARTN; /* order part char*/
    OM0ZW01.OM0ZWCUOID = OP1REC.OP1CUOID; /* customer order number*/
    OM0ZW01.OM0ZWNORID = OP1REC.OP1NORID; /* nike order number*/
    OM0ZW01.OM0ZWLNINB = OP2REC.OP2LNINB; /* line item*/
    OM0ZW01.OM0ZWCOID = OP1REC.KUCCOID;
    OM0ZW01.OM0ZWSTRID = OP1REC.KUMSTRID;
    OM0ZW01.OM0ZWXNXCD = OP1REC.XNXCD;
    TA1REC.TA1TBLKE = OM0ZW01.OM0ZWSYSKE;
    OM0ZS1P(); /* purge TS*/
    TA1REC.TA1TYPE = "DB2"; /* abend type*/
    TA1REC.TA1FUNC = "RETN"; /* abend function*/
    set ERRSQLCA empty; /* clear sql area*/
    move SQLCA to ERRSQLCA withV60Compat; /* save original sqlca*/
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes}; /* abend module*/
    COMMAREA.CA-USER-WORKAREA-4K = " "; /* clear user commarea*/
    XSPF4(); /* return to master menu*/
    exit program; /* master menu return failure*/
  end

end // end OM0ZS-UPD-VORXRF01

// INITIALIZE RECORDS & MAP
Function OM0ZS01()

  set OP1REC empty;
  set OP2REC empty;
  set OMVREC empty;
  set OMWREC empty;
  set WCU1710 empty;
  set VCUCPX01 empty;
  set VOCPOX02 empty;
  set VORXRF01 empty;
  set KUCREC empty;
  set TA1REC empty;
  set TA2REC empty;
  set TA5REC empty;
  set TAEREC empty;
  set OM0ZW01 empty;
  set OM0ZW02 empty;
  set OM0ZW03 empty;
  set SQLCA empty;
  set ERRSQLCA empty;
  set OM0ZM001 empty;
  set XX0XW01 empty;

  XX0XS01();
  OM0ZW01.ZZZCHGDT = XX0XW01.XX0XWDAT;
  OM0ZW01.ZZZCHGTM = XX0XW01.XX0XWTIM;

  TA1REC.TA1MAP = "OM0ZM001"; /* map name*/

  OMWREC.OMWSGRP = COMMAREA.CA-USER-WORKAREA-4K;
  OP1REC.OP1GROUP = OMWREC.OP1GROUP;

end // end OM0ZS01

// LOCATE CURRENT TS PAGE
Function OM0ZS02()

  TA5REC.TA5RTNCD = 0; /* initialize return code*/
  OM0ZW01.OM0ZWTSFP = 1; /* initialize subscript*/

  while (TA5REC.TA5RTNCD == 0)
    OM0ZS1R();
    if (OMVREC.OMTSPG-FL == "Y")
      return;
    end
    OM0ZW01.OM0ZWTSFP = OM0ZW01.OM0ZWTSFP + 1;
  end

end // end OM0ZS02

// GET XREF REC WITH OVERRIDES
Function OM0ZS05()

  set WCU1710 empty;
  WCU1710.WCU1710-INQUIRY-OPTION = "1";

  OM0ZS-GET-WCU1710();

  if (WCU1710.WCU1710-RETURN-CODE == 0 /* xref rec returned*/
   || WCU1710.WCU1710-RETURN-CODE == 1) /* no xref rec returned*/
  /* next sentence*/
  else
    TA1REC.TA1LOCAT[1] = WCU1710.WCU1710-RETURN-CODE; /* return code*/
    TA1REC.TA1LOCAT[2] = "CU1710  "; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OM0ZS05"; /* statement group*/
    TAEREC.TAEDESC1 = "BAD RETURN FROM CU1710 - RETURN CODE = ";
    TAEREC.TAEDESC2 = WCU1710.WCU1710-RETURN-CODE;
    TA1REC.TA1TYPE = "APPL";
    TA1REC.TA1FUNC = "RETN";
    TA1REC.TA1TBLKE = OP1REC.OP1KEY; /* key fields*/
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    TA1PGMNM = COMMAREA.CACURRAP;
    try
      call "TA0020" (TA1REC, TAEREC) {isExternal = yes};
    end
    XSPF4(); /* return to master menu*/
    exit program; /* master menu failure*/
  end


end // end OM0ZS05

// DETERMINE CUSTOMER INFO
Function OM0ZS07()

   /* determine cu-cusku-id*/

  if (KUCREC.KUCSKIND == "C" || 
  KUCREC.KUCSKIND == "T")
    OM0ZW01.CU-CUSKU-ID = KUCREC.KUCCOID;
  else
    if (KUCREC.KUCSKIND == "P")
      OM0ZW01.CU-CUSKU-ID = KUCREC.KUKPCOID;
    else
      if (KUCREC.KUCSKIND == "R")
        OM0ZW01.CU-CUSKU-ID = KUCREC.KUCGRPID;
      else
        if (KUCREC.KUCSKIND == "G")
          OM0ZW01.CU-CUSKU-ID = 0;
        end
      end
    end
  end

   /* determine size level or product level customer*/

  if (KUCREC.CU-CUSKU-SZ-FL == "Y") /* size level customer*/
    OM0ZW01.OM0ZW-SIZE-LEVEL-CUSTOMER = "Y";
  else /* product level customer*/
    OM0ZW01.OM0ZW-SIZE-LEVEL-CUSTOMER = "N";
  end

end // end OM0ZS07

// LOCATE SELECTED TS ENTRY
Function OM0ZS09()

  OM0ZW01.OM0ZWTSFS = 1; /* initialise subscript*/

  while (OM0ZW01.OM0ZWTSFS <= 11)
    if (OMVREC.OMSEL[OM0ZWTSFS] == "S")
      OMVREC.OMSEL[OM0ZWTSFS] = "V";
      OM0ZS1U(); /* update TS*/
      return;
    end
    OM0ZW01.OM0ZWTSFS = OM0ZW01.OM0ZWTSFS + 1;
  end

end // end OM0ZS09

// BUILD MAP
Function OM0ZS10()

  OM0ZM001.OM0ZM-UPD-XREF-LIT = "DO YOU WANT TO UPDATE KG0E ? (Y/N)";

  if (OM0ZW01.OM0ZW-XREF-EXISTS == "Y") /* xref rec exists*/
    OM0ZM001.OM0ZM-UPD-XREF-QST = "Y"; /**/
  else
    OM0ZM001.OM0ZM-UPD-XREF-QST = " "; /**/
  end

  OM0ZM001.OM0ZM-OVRD-LIT = "OVERRIDES EXIST";
  OM0ZM001.OM0ZM-PF23-LIT = "23:DEL OVRD";

  OM0ZS12(); /* move fields to the map*/
  OM0ZS14(); /* move 'before converse' map fields to*/
                                   /* save area*/
  move OM0ZW02 to OM0ZW03 withV60Compat; /* make 'previous' and 'current' save*/
                                   /* areas equal*/

  OM0ZS16(); /* reset field attributes*/

end // end OM0ZS10

// MOVE FIELDS TO MAP AREA
Function OM0ZS12()

  OM0ZS-GET-VCOLOR02(); /* get style and color descriptions*/

  if (SQLCA.VAGen_SQLCODE == 0) /* description found*/
    OM0ZM001.SY1STYNM = SYCREC.SY1STYNM; /* move short name*/
    OM0ZM001.SY2CLRDS = SYCREC.SY2CLRDS; /* move color abbrev*/
  else
    if (SQLCA.VAGen_SQLCODE == 100) /* description not found*/
      OM0ZM001.SY1STYNM = "INVALID PRODUCT";
      OM0ZM001.SY2CLRDS = " "; /* blank out abbrev*/
    else
      if (SQLCA.VAGen_SQLCODE == -911) /* database busy*/
        OM0ZM001.SY1STYNM = "PRODUCT BUSY";
        OM0ZM001.SY2CLRDS = " "; /* blank out abbrev*/
      end
    end
  end

  if (OM0ZW01.OM0ZW-SIZE-LEVEL-CUSTOMER == "N") /* product level customer*/
    OM0ZM001.SY4IDDSC = "ALL";
  else
    OM0ZS-GET-VSCALE01(); /* get nike size description*/
    if (SQLCA.VAGen_SQLCODE == 0) /* description found*/
      if (WCU1710.WCU1710-IN-SY-SZ-ID == 0)
        OM0ZM001.SY4IDDSC = "ALL";
      else
        sysVar.arrayIndex = WCU1710.WCU1710-IN-SY-SZ-ID;
        OM0ZM001.SY4IDDSC = SY4REC.SY4IDDSC[sysVar.arrayIndex];
      end
    else
      if (SQLCA.VAGen_SQLCODE == 100) /* product not found*/
        OM0ZM001.SY4IDDSC = "UNKWN";
      else
        if (SQLCA.VAGen_SQLCODE == -911) /* database is busy*/
          OM0ZM001.SY4IDDSC = "BUSY";
        end
      end
    end
  end

  if (WCU1710.WCU1710-IN-XGP-GPC-CD == " ")
    OM0ZM001.XGPDESC = " ";
  else
    sysVar.arrayIndex = 1;
    if (WCU1710.WCU1710-IN-XGP-GPC-CD in XGPTBL.XGPCD)
      OM0ZM001.XGPDESC = XGPTBL.XGPDESC[sysVar.arrayIndex]; /* gpc code desc*/
    else
      OM0ZM001.XGPDESC = "UNKNWN";
    end
  end

  if (WCU1710.WCU1710-IN-XQA-QUAL-CD == " ")
    OM0ZM001.XQAABRV = " "; /* space out description*/
  else
    sysVar.arrayIndex = 1;
    if (WCU1710.WCU1710-IN-XQA-QUAL-CD in XQATBL.XQACD)
      OM0ZM001.XQAABRV = XQATBL.XQAABRV[sysVar.arrayIndex];
    else
      OM0ZM001.XQAABRV = "UNKNWN";
    end
  end

  if (WCU1710.WCU1710-IN-XDM-DIM-CD == " ")
    OM0ZM001.XDMABRV = " "; /* space out abbrev*/
  else
    sysVar.arrayIndex = 1;
    if (WCU1710.WCU1710-IN-XDM-DIM-CD in XDMTBL.XDMCD)
      OM0ZM001.XDMABRV = XDMTBL.XDMABRV[sysVar.arrayIndex]; /* dimension abbrev*/
    else
      OM0ZM001.XDMABRV = "UNKNWN";
    end
  end

  OM0ZM001.OM0ZM-CU-PROD-XREF-EDT = OP1REC.OP1CUNDT;
  OM0ZW01.OM0ZWDT8 = WCU1710.CU-SPCL-PRC-EDT[1];
  OM0ZSDCM(); /* convert date to map format*/
  OM0ZM001.OM0ZM-CU-SPCL-PRC-EDT = OM0ZW01.OM0ZWDT6;

  OM0ZM001.XGPCD = WCU1710.WCU1710-IN-XGP-GPC-CD;
  OM0ZM001.OM0ZMPRC = "OM0Z010"; /* process name*/
  OM0ZW01.OM0ZWCUOID = OP1REC.OP1CUOID;
  OM0ZW01.OM0ZWSEP1 = ".";
  OM0ZW01.OM0ZWNORID = OP1REC.OP1NORID;
  OM0ZW01.OM0ZWSEP2 = ".";
  OM0ZW01.OM0ZWLNINB = OP2REC.OP2LNINB;
  OM0ZM001.OMWORDER = OM0ZW01.OM0ZWORD;
  OM0ZM001.OMWCDATE = VGVar.currentShortGregorianDate;
  OM0ZW01.OM0ZWCOID = OP1REC.KUCCOID;
  OM0ZW01.OM0ZWSTRID = OP1REC.KUMSTRID;
  OM0ZW01.OM0ZWXNXCD = OP1REC.XNXCD;
  OM0ZM001.OMWCUST = OM0ZW01.OM0ZWCUST; /* formatted company number*/
  OM0ZM001.OP1CUPO = OP1REC.OP1CUPO; /* purchase order*/
  OM0ZM001.KUMSTRNM = OMWREC.KUMSTRNM; /* store name*/
  OM0ZM001.SY1STNBR = WCU1710.WCU1710-IN-SY-STY-NBR;
  OM0ZM001.SY2CLRID = WCU1710.WCU1710-IN-SY-COLR-CD-ID;
  OM0ZM001.XQACD = WCU1710.WCU1710-IN-XQA-QUAL-CD;
  OM0ZM001.XDMCD = WCU1710.WCU1710-IN-XDM-DIM-CD;
  OM0ZM001.CU-CUST-PROD-ID = WCU1710.CU-CUST-PROD-ID[1];
  OM0ZM001.CU-PROD-NM = WCU1710.CU-PROD-NM[1];
  OM0ZM001.CU-PROD-COLR-NM = WCU1710.CU-PROD-COLR-NM[1];
  OM0ZM001.CU-PROD-SZ-ID = WCU1710.CU-PROD-SZ-ID[1];
  OM0ZM001.CU-PROD-SZ-NM = WCU1710.CU-PROD-SZ-NM[1];
  OM0ZM001.CU-CUST-RTL-PRC = WCU1710.CU-CUST-RTL-PRC[1];
  OM0ZM001.CU-CUST-SPCL-PRC = WCU1710.CU-CUST-SPCL-PRC[1];
  OM0ZM001.CU-SUGG-RTL-PRC = WCU1710.CU-SUGG-RTL-PRC[1];
  OM0ZM001.CU-VEND-CLS-ID = WCU1710.CU-VEND-CLS-ID[1];
  OM0ZM001.ZFC-CRCY-CD = OP1REC.ZFC-CRCY-CD;
  OM0ZM001.CU-SKU-COMNT1 = WCU1710.CU-SKU-COMNT1[1];
  OM0ZM001.CU-SKU-COMNT2 = WCU1710.CU-SKU-COMNT2[1];
  OM0ZM001.CU-SKU-COMNT3 = WCU1710.CU-SKU-COMNT3[1];
  OM0ZM001.OP-CASE-LOT-NBR = WCU1710.OP-CASE-LOT-NBR[1];
  OM0ZM001.CU-BUY-SESN-ID = WCU1710.CU-BUY-SESN-ID[1];
  OM0ZM001.OP-SMPL-RQT-ID = WCU1710.OP-SMPL-RQT-ID[1];
  OM0ZM001.CU-COST-ID = WCU1710.CU-COST-ID[1];

end // end OM0ZS12

// MOVE MAP AREA TO SAVE AREA
Function OM0ZS14()

  OM0ZW02.CU-CUST-PROD-ID = OM0ZM001.CU-CUST-PROD-ID;
  OM0ZW02.CU-PROD-NM = OM0ZM001.CU-PROD-NM;
  OM0ZW02.CU-PROD-COLR-NM = OM0ZM001.CU-PROD-COLR-NM;

  OM0ZW02.CU-PROD-SZ-ID = OM0ZM001.CU-PROD-SZ-ID;
  OM0ZW02.CU-PROD-SZ-NM = OM0ZM001.CU-PROD-SZ-NM;

  OM0ZW02.CU-CUST-RTL-PRC = OM0ZM001.CU-CUST-RTL-PRC;
  OM0ZW02.CU-CUST-SPCL-PRC = OM0ZM001.CU-CUST-SPCL-PRC;
  OM0ZW02.CU-SUGG-RTL-PRC = OM0ZM001.CU-SUGG-RTL-PRC;

  OM0ZW02.OM0ZW-CU-SPCL-PRC-EDT-MAP = OM0ZM001.OM0ZM-CU-SPCL-PRC-EDT;
  OM0ZW01.OM0ZWDT6 = OM0ZM001.OM0ZM-CU-SPCL-PRC-EDT;
  OM0ZSDMC(); /* convert date to db2 format*/
  OM0ZW02.CU-SPCL-PRC-EDT = OM0ZW01.OM0ZWDT8;

  OM0ZW02.CU-VEND-CLS-ID = OM0ZM001.CU-VEND-CLS-ID;

  OM0ZW02.CU-SKU-COMNT1 = OM0ZM001.CU-SKU-COMNT1;
  OM0ZW02.CU-SKU-COMNT2 = OM0ZM001.CU-SKU-COMNT2;
  OM0ZW02.CU-SKU-COMNT3 = OM0ZM001.CU-SKU-COMNT3;

  OM0ZW02.OP-CASE-LOT-NBR = OM0ZM001.OP-CASE-LOT-NBR;
  OM0ZW02.CU-BUY-SESN-ID = OM0ZM001.CU-BUY-SESN-ID;
  OM0ZW02.OP-SMPL-RQT-ID = OM0ZM001.OP-SMPL-RQT-ID;
  OM0ZW02.CU-COST-ID = OM0ZM001.CU-COST-ID;

end // end OM0ZS14

// SET FIELD ATTRIBUTES
Function OM0ZS16()

  if (OMWREC.OMWPF2CH == "N" /* inquiry mode*/
   || OSIREC.OSIMODE == "I") /* night time inquiry mode*/
    OM0ZS20(); /* set fields autoskip*/
  else
    OM0ZS22(); /* set fields defined*/
  end

  OM0ZS24(); /* set override fields bright*/

end // end OM0ZS16

// PURGE TEMP STORAGE
Function OM0ZS1P()
  TA5REC.TA5APPID = "OM0Y"; /* appl identification*/
  TA5REC.TA5FNCCD = "P"; /* function code*/

  call "TA0050" (OMVREC, TA5REC) {isNoRefresh = yes, isExternal = yes}; /* temp storage subroutine*/

  if (TA5REC.TA5RTNCD == 0) /* good return code*/
    OM0ZW01.OM0ZWTSFP = 1;
    OM0ZW01.OM0ZWTSFS = 1;
  else /* not good return code*/
    TA1REC.TA1LOCAT[1] = "OM0ZS1P";
    TA1REC.TA1LOCAT[2] = "TA0050"; /* io mod called*/
    TA1REC.TA1LOCAT[3] = TA5REC.TA5RTNCD; /* return code*/
    TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* subroutine parms*/
    TAEREC.TAEDESC2 = "PROBLEM PURGING TS";
    TA1REC.TA1TYPE = "APPL";
    TA1REC.TA1FUNC = "POST";
    TA1PGMNM = COMMAREA.CACURRAP; /* current application*/
    try
      call "TA0020" (TA1REC, TAEREC) {isExternal = yes};
    end
    converseLib.validationFailed(10); /* database busy*/
    OM0ZW01.OM0ZWERR = "Y"; /* set error flag on*/
  end

end // end OM0ZS1P

// READ TEMP STORAGE
Function OM0ZS1R()

  set OMVREC empty;

  TA5REC.TA5APPID = "OM0Y"; /* application id*/
  TA5REC.TA5FNCCD = "R"; /* function code*/
  TA5REC.TA5TSQIX = OM0ZW01.OM0ZWTSFP; /* current page*/
  OMVREC.OMTSLEN = 874; /* length of record*/

  call "TA0050" (OMVREC, TA5REC) {isNoRefresh = yes, isExternal = yes}; /* TS routine*/

  if (TA5REC.TA5RTNCD == 0) /* good return code*/
  /* next sentence*/
  else
    TA1REC.TA1LOCAT[1] = "OM0ZS1R"; /* statement group*/
    TA1REC.TA1LOCAT[2] = "TA0050"; /* io mod*/
    TA1REC.TA1LOCAT[3] = TA5REC.TA5RTNCD; /* return code*/
    TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* parms*/
    TAEREC.TAEDESC2 = "PROBLEM READING TS"; /* error message*/
    TA1REC.TA1TYPE = "APPL";
    TA1REC.TA1FUNC = "POST";
    TA1PGMNM = COMMAREA.CACURRAP; /* current application*/
    try
      call "TA0020" (TA1REC, TAEREC) {isExternal = yes};
    end
    converseLib.validationFailed(10); /* database busy*/
    OM0ZW01.OM0ZWERR = "Y"; /* set error flag on*/
  end

end // end OM0ZS1R

// UPDATE TS
Function OM0ZS1U()
  TA5REC.TA5APPID = "OM0Y"; /* appl identification*/
  TA5REC.TA5FNCCD = "U"; /* function code*/
  TA5REC.TA5TSQIX = OM0ZW01.OM0ZWTSFP; /* current page*/
  OMVREC.OMTSLEN = 874; /* length of record*/

  call "TA0050" (OMVREC, TA5REC) {isNoRefresh = yes, isExternal = yes};

  if (TA5REC.TA5RTNCD == 0) /* good return code*/
    /* next sentence*/
  else /* not good return code*/
    TA1REC.TA1LOCAT[1] = "OM0ZS1U";
    TA1REC.TA1LOCAT[2] = "TA0050"; /* io mod called*/
    TA1REC.TA1LOCAT[3] = TA5REC.TA5RTNCD; /* return code*/
    TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* subroutine parms*/
    TAEREC.TAEDESC2 = "PROBLEM UPDATING TS";
    TA1REC.TA1TYPE = "APPL";
    TA1REC.TA1FUNC = "POST";
    TA1PGMNM = COMMAREA.CACURRAP; /* current application*/
    try
      call "TA0020" (TA1REC, TAEREC) {isExternal = yes};
    end
    converseLib.validationFailed(10); /* database busy;*/
    OM0ZW01.OM0ZWERR = "Y"; /* set error flag on*/
  end

end // end OM0ZS1U

// SET FIELDS AUTOSKIP
Function OM0ZS20()

  set OM0ZM001.CU-CUST-PROD-ID skip;
  set OM0ZM001.CU-PROD-NM skip;
  set OM0ZM001.CU-PROD-COLR-NM skip;
  set OM0ZM001.CU-PROD-SZ-ID skip;
  set OM0ZM001.CU-PROD-SZ-NM skip;
  set OM0ZM001.CU-BUY-SESN-ID skip;
  set OM0ZM001.OP-SMPL-RQT-ID skip;
  set OM0ZM001.CU-COST-ID skip;
  set OM0ZM001.OP-CASE-LOT-NBR skip;
  set OM0ZM001.SY1STNBR skip;
  set OM0ZM001.SY2CLRID skip;
  set OM0ZM001.SY4IDDSC skip;
  set OM0ZM001.XDMCD skip;
  set OM0ZM001.XGPCD skip;
  set OM0ZM001.XQACD skip;
  set OM0ZM001.CU-CUST-RTL-PRC skip;
  set OM0ZM001.CU-CUST-SPCL-PRC skip;
  set OM0ZM001.CU-SUGG-RTL-PRC skip;
  set OM0ZM001.OM0ZM-CU-SPCL-PRC-EDT skip;
  set OM0ZM001.CU-VEND-CLS-ID skip;
  set OM0ZM001.CU-SKU-COMNT1 skip;
  set OM0ZM001.CU-SKU-COMNT2 skip;
  set OM0ZM001.CU-SKU-COMNT3 skip;
  set OM0ZM001.ZFC-CRCY-CD skip;

end // end OM0ZS20

// SET FIELDS DEFINED
Function OM0ZS22()

  set OM0ZM001.CU-CUST-PROD-ID cursor, initialAttributes;
  set OM0ZM001.CU-PROD-NM initialAttributes;
  set OM0ZM001.CU-PROD-COLR-NM initialAttributes;
  set OM0ZM001.CU-PROD-SZ-ID initialAttributes;
  set OM0ZM001.CU-PROD-SZ-NM initialAttributes;
  set OM0ZM001.CU-BUY-SESN-ID initialAttributes;
  set OM0ZM001.OP-SMPL-RQT-ID initialAttributes;
  set OM0ZM001.CU-COST-ID initialAttributes;
  set OM0ZM001.OP-CASE-LOT-NBR initialAttributes;
  set OM0ZM001.SY1STNBR initialAttributes;
  set OM0ZM001.SY2CLRID initialAttributes;
  set OM0ZM001.SY4IDDSC initialAttributes;
  set OM0ZM001.XDMCD initialAttributes;
  set OM0ZM001.XGPCD initialAttributes;
  set OM0ZM001.XQACD initialAttributes;
  set OM0ZM001.CU-CUST-RTL-PRC initialAttributes;
  set OM0ZM001.CU-CUST-SPCL-PRC initialAttributes;
  set OM0ZM001.CU-SUGG-RTL-PRC initialAttributes;
  set OM0ZM001.OM0ZM-CU-SPCL-PRC-EDT initialAttributes;
  set OM0ZM001.CU-VEND-CLS-ID initialAttributes;
  set OM0ZM001.CU-SKU-COMNT1 initialAttributes;
  set OM0ZM001.CU-SKU-COMNT2 initialAttributes;
  set OM0ZM001.CU-SKU-COMNT3 initialAttributes;
  set OM0ZM001.ZFC-CRCY-CD initialAttributes;

end // end OM0ZS22

// SET OVRD FIELDS BRIGHT
Function OM0ZS24()

  if (OM0ZW01.OM0ZW-OVRD-EXISTS == "Y") /* an override record exists*/

    if (VOCPOX02.CU-PROD-ID-OVRDFL == "Y")
      set OM0ZM001.CU-CUST-PROD-ID reverse;
    end

    if (VOCPOX02.CU-PROD-NM-OVRDFL == "Y")
      set OM0ZM001.CU-PROD-NM reverse;
    end

    if (VOCPOX02.CU-COLR-NM-OVRDFL == "Y")
      set OM0ZM001.CU-PROD-COLR-NM reverse;
    end

    if (VOCPOX02.CU-SZ-ID-OVRDFL == "Y")
      set OM0ZM001.CU-PROD-SZ-ID reverse;
    end

    if (VOCPOX02.CU-SZ-NM-OVRDFL == "Y")
      set OM0ZM001.CU-PROD-SZ-NM reverse;
    end

    if (VOCPOX02.CU-RTL-PRC-OVRDFL == "Y")
      set OM0ZM001.CU-CUST-RTL-PRC reverse;
    end

    if (VOCPOX02.CU-SPCL-PRC-OVRDFL == "Y")
      set OM0ZM001.CU-CUST-SPCL-PRC reverse;
    end

    if (VOCPOX02.CU-SUGG-PRC-OVRDFL == "Y")
      set OM0ZM001.CU-SUGG-RTL-PRC reverse;
    end

    if (VOCPOX02.CU-SPCL-EDT-OVRDFL == "Y")
      set OM0ZM001.OM0ZM-CU-SPCL-PRC-EDT reverse;
    end

    if (VOCPOX02.CU-VEND-CLS-OVRDFL == "Y")
      set OM0ZM001.CU-VEND-CLS-ID reverse;
    end

    if (VOCPOX02.CU-COMNT1-OVRDFL == "Y")
      set OM0ZM001.CU-SKU-COMNT1 reverse;
    end

    if (VOCPOX02.CU-COMNT2-OVRDFL == "Y")
      set OM0ZM001.CU-SKU-COMNT2 reverse;
    end

    if (VOCPOX02.CU-COMNT3-OVRDFL == "Y")
      set OM0ZM001.CU-SKU-COMNT3 reverse;
    end
  end

end // end OM0ZS24

// DETERMINE XREF UPDATE QUESTION
Function OM0ZS30()

  OM0ZM001.OM0ZM-UPD-XREF-QST = " "; /**/

  if (OM0ZW01.OM0ZW-XREF-EXISTS == "N" /* no xref rec exists*/
   || OMWREC.OMWPF2CH == "N"           /* inquiry mode only*/
   || OSIREC.OSIMODE == "I")           /* night time inquiry mode*/
    set OM0ZM001.OM0ZM-UPD-XREF-LIT skip, invisible;
    set OM0ZM001.OM0ZM-UPD-XREF-QST skip, invisible;
  else
    set OM0ZM001.OM0ZM-UPD-XREF-LIT bold, skip;
    set OM0ZM001.OM0ZM-UPD-XREF-QST initialAttributes;
  end

end // end OM0ZS30

// DISPLAY OVERRIDE LITERAL
Function OM0ZS32()

  if (OM0ZW01.OM0ZW-OVRD-EXISTS == "Y") /* override record exists*/
    set OM0ZM001.OM0ZM-OVRD-LIT reverse, skip;
  else /* no override record exists*/
    set OM0ZM001.OM0ZM-OVRD-LIT noHighLight, invisible, skip;
  end

end // end OM0ZS32

// DISPLAY SIZE LITERAL
Function OM0ZS34()

  if (OM0ZW01.OM0ZW-SIZE-LEVEL-CUSTOMER == "Y") /* size level customer*/
    OM0ZM001.OM0ZM-SIZE-LIT = "SIZE LEVEL";
  else
    OM0ZM001.OM0ZM-SIZE-LIT = "PRODUCT LEVEL";
  end

end // end OM0ZS34

// DETERMINE DISPLAY OF PF22 KEY
Function OM0ZS36()

  if (OM0ZW01.OM0ZW-OVRD-EXISTS == "N" /* no ovrd rec exists*/
   || OMWREC.OMWPF2CH == "N"           /* inquiry mode*/
   || OSIREC.OSIMODE == "I")           /* night time inquiry mode*/
    set OM0ZM001.OM0ZM-PF23-LIT skip, invisible;
  else
    set OM0ZM001.OM0ZM-PF23-LIT initialAttributes;
  end

end // end OM0ZS36

// DISPLAY SPCL MAKEUP/DUMMY MSG
Function OM0ZS38()
  if (OMWREC.OMWPF2CH == "Y") /* update mode*/
    if (OM0ZW01.OM0ZW-XREF-EXISTS == "N") /* xref rec doesn't exist*/
      if (OM0ZW01.OM0ZW-OVRD-EXISTS == "Y") /* ovrd rec exists*/
        OM0ZM001.CAMSG = "NOTE: PRODUCT NOT SET UP IN KG0E - ALL CHANGES WILL UPDATE KG0E";
      else /* ovrd rec doesn't exist*/
        OM0ZM001.CAMSG = "NOTE:NO XREF DATA EXISTS - ENTER PROD ID AND HIT ENTER TO CREATE";
      end
    end
  end

end // end OM0ZS38

// MOVE MAP TO SAVE AREA
Function OM0ZS40()

  OM0ZW03.CU-CUST-PROD-ID = OM0ZM001.CU-CUST-PROD-ID;
  OM0ZW03.CU-PROD-NM = OM0ZM001.CU-PROD-NM;
  OM0ZW03.CU-PROD-COLR-NM = OM0ZM001.CU-PROD-COLR-NM;

  OM0ZW03.CU-PROD-SZ-ID = OM0ZM001.CU-PROD-SZ-ID;
  OM0ZW03.CU-PROD-SZ-NM = OM0ZM001.CU-PROD-SZ-NM;

  OM0ZW03.CU-CUST-RTL-PRC = OM0ZM001.CU-CUST-RTL-PRC;
  OM0ZW03.CU-CUST-SPCL-PRC = OM0ZM001.CU-CUST-SPCL-PRC;
  OM0ZW03.CU-SUGG-RTL-PRC = OM0ZM001.CU-SUGG-RTL-PRC;
  OM0ZW03.OM0ZW-CU-SPCL-PRC-EDT-MAP = OM0ZM001.OM0ZM-CU-SPCL-PRC-EDT;
  OM0ZW01.OM0ZWDT6 = OM0ZM001.OM0ZM-CU-SPCL-PRC-EDT;
  OM0ZSDMC(); /* convert date to db2 format*/
  OM0ZW03.CU-SPCL-PRC-EDT = OM0ZW01.OM0ZWDT8;

  OM0ZW03.CU-VEND-CLS-ID = OM0ZM001.CU-VEND-CLS-ID;

  OM0ZW03.CU-SKU-COMNT1 = OM0ZM001.CU-SKU-COMNT1;
  OM0ZW03.CU-SKU-COMNT2 = OM0ZM001.CU-SKU-COMNT2;
  OM0ZW03.CU-SKU-COMNT3 = OM0ZM001.CU-SKU-COMNT3;

  OM0ZW03.OP-CASE-LOT-NBR = OM0ZM001.OP-CASE-LOT-NBR;
  OM0ZW03.CU-BUY-SESN-ID = OM0ZM001.CU-BUY-SESN-ID;
  OM0ZW03.OP-SMPL-RQT-ID = OM0ZM001.OP-SMPL-RQT-ID;
  OM0ZW03.CU-COST-ID = OM0ZM001.CU-COST-ID;

end // end OM0ZS40

// EDIT MAP
Function OM0ZS42()

  OM0ZS50(); /* edit 'update xref' question*/

  OM0ZS52(); /* edit special price effective date*/

  OM0ZS54(); /* edit cust product size*/

  OM0ZS56(); /* edit cust prod id*/

end // end OM0ZS42

// UPDATE RECORDS WHEN NEEDED
Function OM0ZS44()

  OM0ZW01.OM0ZW-XREF-UPDATE = "N";
  OM0ZW01.OM0ZW-OVRD-UPDATE = "N";
  OM0ZW01.OM0ZW-COMP-UPDATE = "N";

  OM0ZW01.OM0ZW-PF23-CONFIRM-FL = "N";

  if (OM0ZW01.OM0ZW-XREF-EXISTS == "Y") /* xref record exists*/
    if (OM0ZM001.OM0ZM-UPD-XREF-QST == "Y") /* user requested update to xref*/
      if (VCUCPX01.CU-PROD-XREF-EDT < OP1REC.OP1CUNDT)
        OM0ZS64(); /* create xref rec*/
      else
        OM0ZS58(); /* update xref;*/
      end
    else
      OM0ZS60(); /* update override*/
    end
    OM0ZS62(); /* update companion*/
  else /* no xref exists*/
    OM0ZS64(); /* create xref rec and do db updates*/
  end

  if (OM0ZW01.OM0ZW-COMP-UPDATE == "I")
    OM0ZS-ADD-VORXRF01();
  end

  if (OM0ZW01.OM0ZW-COMP-UPDATE == "U")
    OM0ZS-UPD-VORXRF01();
  end

  if (OM0ZW01.OM0ZW-COMP-UPDATE == "D")
    OM0ZS-DEL-VORXRF01();
  end

  if (OM0ZW01.OM0ZW-OVRD-UPDATE == "I")
    OM0ZS-ADD-VOCPOX02();
  end

  if (OM0ZW01.OM0ZW-OVRD-UPDATE == "U")
    OM0ZS-UPD-VOCPOX02();
  end

  if (OM0ZW01.OM0ZW-OVRD-UPDATE == "D")
    OM0ZS-DEL-VOCPOX02();
  end

  if (OM0ZW01.OM0ZW-XREF-UPDATE == "I")
    OM0ZS-ADD-VCUCPX01();
  end

  if (OM0ZW01.OM0ZW-XREF-UPDATE == "U")
    OM0ZS-UPD-VCUCPX01();
  end
   /* tcs include begin (11/26/97)*/
  OM0ZS-GET-OP2REC();
  if (OM0ZW01.OM0ZW-SIZE-LEVEL-CUSTOMER == "N") /* product level*/
    OP2REC.KUIPRDID = OM0ZM001.CU-CUST-PROD-ID;
  else /* size level*/
    if (OM0ZW01.OM0ZWTSFS == 1) /* first record from OM0Y*/
      OP2REC.KUIPRDID = OM0ZM001.CU-CUST-PROD-ID;
    else /* if not first record then*/
                                            /* next sentence*/
    end
  end
  OM0ZS-UPD-VITEM001();
   /* tcs include end   (11/26/97)*/

end // end OM0ZS44

// PROCESS PF KEYS
Function OM0ZS46()
  if (converseVar.eventKey is pf23
   || converseVar.eventKey is pf2)
    if (COMMAREA.CACHGFL != "Y") /* user not authorized to make changes*/
      converseLib.validationFailed(352); /* user lacks authorization*/
      OM0ZW01.OM0ZWERRFL = "Y";
      return;
    end
    if (OSIREC.OSIMODE == "I") /* night time inquiry mode in effect*/
      converseLib.validationFailed(533); /* can't change other sales office order*/
      OM0ZW01.OM0ZWERRFL = "Y";
      return;
    end
    if (OP1REC.XSOCD != COMMAREA.XSOCD) /* sales offices don't match*/
      converseLib.validationFailed(355); /* can't change other sales office order*/
      OM0ZW01.OM0ZWERRFL = "Y";
      return;
    end
    if (OP2REC.OP2LNIST in XOSTBL.XOSCD)
      if (XOSTBL.XOSALWCH[sysVar.arrayIndex] == "N") /* can't change line item*/
        converseLib.validationFailed(375); /* line item status doesn't allow change*/
        OM0ZW01.OM0ZWERRFL = "Y";
        return;
      end
    end
    if (converseVar.eventKey is pf23) /* pf23*/
      if (OMWREC.OMWPF2CH == "N") /* currently in inq mode*/
        converseLib.validationFailed(684); /* cannot update in inquiry mode*/
        OM0ZW01.OM0ZWERRFL = "Y";
        return;
      end
      if (OM0ZW01.OM0ZW-OVRD-EXISTS != "Y") /* override doen't exist*/
        converseLib.validationFailed(645); /* invalid pf key*/
        OM0ZW01.OM0ZWERRFL = "Y";
        return;
      end
    end
  end

  if (converseVar.eventKey is pf23)
    if (OM0ZW01.OM0ZW-PF23-CONFIRM-FL == "Y")
      OM0ZS66(); /* process pf23*/
    else
      converseLib.validationFailed(935); /* hit PF23 again to confirm*/
      OM0ZW01.OM0ZW-PF23-CONFIRM-FL = "Y";
      exit stack;
    end
  end

  OM0ZW01.OM0ZW-PF23-CONFIRM-FL = "N";

  OMWREC.OP1GROUP = OP1REC.OP1GROUP;
  COMMAREA.CA-USER-WORKAREA-4K = OMWREC.OMWSGRP;
  COMMAREA.CAFROMAP = COMMAREA.CACURRAP;

  if (converseVar.eventKey is pf2) /* change from inq to chg mode*/
    if (OMWREC.OMWPF2CH == "N") /* currently in inquiry mode*/
      OMWREC.OMWPF2CH = "Y";
      OM0ZS16(); /* set field attributes*/
    end
  end

  if (converseVar.eventKey is pf3) /* transfer to om0m application*/
    COMMAREA.CACURRAP = "OM0M";
    transfer to program "OM0M" passing COMMAREA;
  end

  if (converseVar.eventKey is pf4) /* transfer to main menu application*/
    XSPF4();
  end

  if (converseVar.eventKey is pf9) /* transfer to om0s application*/
    COMMAREA.CACURRAP = "OM0S";
    transfer to program "OM0S" passing COMMAREA;
  end

  if (converseVar.eventKey is pf11) /* transfer to om0y application*/
    COMMAREA.CACURRAP = "OM0Y";
    transfer to program "OM0Y" passing COMMAREA;
  end

  if (converseVar.eventKey is pf12)
    OM0ZS1R(); /* read current TS page*/
    OM0ZS-GET-DATA(); /* get database records*/
    OM0ZS10(); /* rebuild map*/
  end

  if (converseVar.eventKey is pf21 /* pf21 hit*/
   && OM0ZW01.OM0ZW-XREF-EXISTS == "Y") /* xref rec exists*/
    OM0ZS-GET-VCUCPX01(); /* get xref rec without overrides*/
    OM0ZS-PF21-MOVES(); /* move the xref fields to map*/
  end

  if (converseVar.eventKey is pf2
   || converseVar.eventKey is pf3
   || converseVar.eventKey is pf4
   || converseVar.eventKey is pf9
   || converseVar.eventKey is pf11
   || converseVar.eventKey is pf12
   || converseVar.eventKey is pf21
   || converseVar.eventKey is pf23)
    /* next sentence*/
  else
    converseLib.validationFailed(645); /* invalid pf key*/
    OM0ZW01.OM0ZWERRFL = "Y";
  end

end // end OM0ZS46

// EDIT XREF UPDATE QUESTION
Function OM0ZS50()

  if (OMWREC.OMWPF2CH == "N"           /* inquiry mode only*/
   || OM0ZW01.OM0ZW-XREF-EXISTS == "N" /* no xref rec exists*/
   || OSIREC.OSIMODE == "I")           /* night time inquiry mode*/
   /* no edits as question is not displayed*/
  else
    if (OM0ZM001.OM0ZM-UPD-XREF-QST != "Y" && 
    OM0ZM001.OM0ZM-UPD-XREF-QST != "N")
      set OM0ZM001.OM0ZM-UPD-XREF-QST cursor, bold;
      converseLib.validationFailed(848); /* response must be 'y' or 'n'*/
    end
  end

end // end OM0ZS50

// EDIT SPECIAL PRC EFFECTIVE DT
Function OM0ZS52()

  if (OM0ZM001.OM0ZM-CU-SPCL-PRC-EDT == 0)
    return;
  end

  OM0ZW01.OM0ZWDT6 = OM0ZM001.OM0ZM-CU-SPCL-PRC-EDT;

  OM0ZSDED();

  if (TA2REC.TA2RTNCD == 0)
      /* next sentence*/
  else
    converseLib.validationFailed(932); /* special price effective date invalid*/
    OM0ZW01.OM0ZWERRFL = "Y";
    set OM0ZM001.OM0ZM-CU-SPCL-PRC-EDT cursor, bold;
  end

end // end OM0ZS52

// EDIT CUSTOMER PRODUCT SIZE
Function OM0ZS54()

  if (OM0ZW01.OM0ZW-SIZE-LEVEL-CUSTOMER == "N") /* product level customer*/
    if (OM0ZM001.CU-PROD-SZ-ID != " ")
      converseLib.validationFailed(933); /* product level customer - size must be*/
                                   /* spaces*/
      OM0ZW01.OM0ZWERRFL = "Y";
      set OM0ZM001.CU-PROD-SZ-ID cursor, bold;
    end
  end

end // end OM0ZS54

// EDIT CUSTOMER PRODUCT ID
Function OM0ZS56()

  if (OM0ZM001.CU-CUST-PROD-ID == " ")
    converseLib.validationFailed(934); /* required field - cannot be blank*/
    OM0ZW01.OM0ZWERRFL = "Y";
    set OM0ZM001.CU-CUST-PROD-ID cursor, bold;
  end

end // end OM0ZS56

// UPDATE XREF RECORD
Function OM0ZS58()

  if (OM0ZW02.OM0ZW-XREF-OVRD-DATA-FIELDS == 
  OM0ZW03.OM0ZW-XREF-OVRD-DATA-FIELDS)
    return;
  end

  OM0ZW-XREF-UPDATE = "U"; /* update xref rec with changes*/

  OM0ZS-FMT-VCUCPX01(); /* format xref record*/

  if (OM0ZW02.CU-CUST-PROD-ID != OM0ZW03.CU-CUST-PROD-ID)
    VCUCPX01.CU-CUST-PROD-ID = OM0ZW03.CU-CUST-PROD-ID;
  end

  if (OM0ZW02.CU-PROD-NM != OM0ZW03.CU-PROD-NM)
    VCUCPX01.CU-PROD-NM = OM0ZW03.CU-PROD-NM;
  end

  if (OM0ZW02.CU-PROD-COLR-NM != OM0ZW03.CU-PROD-COLR-NM)
    VCUCPX01.CU-PROD-COLR-NM = OM0ZW03.CU-PROD-COLR-NM;
  end

  if (OM0ZW02.CU-PROD-SZ-ID != OM0ZW03.CU-PROD-SZ-ID)
    VCUCPX01.CU-PROD-SZ-ID = OM0ZW03.CU-PROD-SZ-ID;
  end

  if (OM0ZW02.CU-PROD-SZ-NM != OM0ZW03.CU-PROD-SZ-NM)
    VCUCPX01.CU-PROD-SZ-NM = OM0ZW03.CU-PROD-SZ-NM;
  end

  if (OM0ZW02.CU-CUST-RTL-PRC != OM0ZW03.CU-CUST-RTL-PRC)
    VCUCPX01.CU-CUST-RTL-PRC = OM0ZW03.CU-CUST-RTL-PRC;
  end

  if (OM0ZW02.CU-CUST-SPCL-PRC != OM0ZW03.CU-CUST-SPCL-PRC)
    VCUCPX01.CU-CUST-SPCL-PRC = OM0ZW03.CU-CUST-SPCL-PRC;
  end

  if (OM0ZW02.CU-SUGG-RTL-PRC != OM0ZW03.CU-SUGG-RTL-PRC)
    VCUCPX01.CU-SUGG-RTL-PRC = OM0ZW03.CU-SUGG-RTL-PRC;
  end

  if (OM0ZW02.CU-SPCL-PRC-EDT != OM0ZW03.CU-SPCL-PRC-EDT)
    VCUCPX01.CU-SPCL-PRC-EDT = OM0ZW03.CU-SPCL-PRC-EDT;
  end

  if (OM0ZW02.CU-VEND-CLS-ID != OM0ZW03.CU-VEND-CLS-ID)
    VCUCPX01.CU-VEND-CLS-ID = OM0ZW03.CU-VEND-CLS-ID;
  end

  if (OM0ZW02.CU-SKU-COMNT1 != OM0ZW03.CU-SKU-COMNT1)
    VCUCPX01.CU-SKU-COMNT1 = OM0ZW03.CU-SKU-COMNT1;
  end

  if (OM0ZW02.CU-SKU-COMNT2 != OM0ZW03.CU-SKU-COMNT2)
    VCUCPX01.CU-SKU-COMNT2 = OM0ZW03.CU-SKU-COMNT2;
  end

  if (OM0ZW02.CU-SKU-COMNT3 != OM0ZW03.CU-SKU-COMNT3)
    VCUCPX01.CU-SKU-COMNT3 = OM0ZW03.CU-SKU-COMNT3;
  end

  if (OM0ZW01.OM0ZW-OVRD-EXISTS == "Y") /* an override rec exists*/
    if (VOCPOX02.CU-PROD-ID-OVRDFL == "Y") /* field was overidden*/
      if (OM0ZW02.CU-CUST-PROD-ID != OM0ZW03.CU-CUST-PROD-ID)
        VOCPOX02.CU-PROD-ID-OVRDFL = "N";
        VOCPOX02.CU-CUST-PROD-ID = " ";
      end
    end

    if (VOCPOX02.CU-PROD-NM-OVRDFL == "Y") /* field was overidden*/
      if (OM0ZW02.CU-PROD-NM != OM0ZW03.CU-PROD-NM)
        VOCPOX02.CU-PROD-NM-OVRDFL = "N";
        VOCPOX02.CU-PROD-NM = " ";
      end
    end

    if (VOCPOX02.CU-COLR-NM-OVRDFL == "Y") /* field was overidden*/
      if (OM0ZW02.CU-PROD-COLR-NM != OM0ZW03.CU-PROD-COLR-NM)
        VOCPOX02.CU-COLR-NM-OVRDFL = "N";
        VOCPOX02.CU-PROD-COLR-NM = " ";
      end
    end

    if (VOCPOX02.CU-SZ-ID-OVRDFL == "Y") /* field was overidden*/
      if (OM0ZW02.CU-PROD-SZ-ID != OM0ZW03.CU-PROD-SZ-ID)
        VOCPOX02.CU-SZ-ID-OVRDFL = "N";
        VOCPOX02.CU-PROD-SZ-ID = " ";
      end
    end

    if (VOCPOX02.CU-SZ-NM-OVRDFL == "Y") /* field was overidden*/
      if (OM0ZW02.CU-PROD-SZ-NM != OM0ZW03.CU-PROD-SZ-NM)
        VOCPOX02.CU-SZ-NM-OVRDFL = "N";
        VOCPOX02.CU-PROD-SZ-NM = " ";
      end
    end

    if (VOCPOX02.CU-RTL-PRC-OVRDFL == "Y") /* field was overidden*/
      if (OM0ZW02.CU-CUST-RTL-PRC != OM0ZW03.CU-CUST-RTL-PRC)
        VOCPOX02.CU-RTL-PRC-OVRDFL = "N";
        VOCPOX02.CU-CUST-RTL-PRC = 0;
      end
    end

    if (VOCPOX02.CU-SPCL-PRC-OVRDFL == "Y") /* field was overidden*/
      if (OM0ZW02.CU-CUST-SPCL-PRC != OM0ZW03.CU-CUST-SPCL-PRC)
        VOCPOX02.CU-SPCL-PRC-OVRDFL = "N";
        VOCPOX02.CU-CUST-SPCL-PRC = 0;
      end
    end

    if (VOCPOX02.CU-SUGG-PRC-OVRDFL == "Y") /* field was overidden*/
      if (OM0ZW02.CU-SUGG-RTL-PRC != OM0ZW03.CU-SUGG-RTL-PRC)
        VOCPOX02.CU-SUGG-PRC-OVRDFL = "N";
        VOCPOX02.CU-SUGG-RTL-PRC = 0;
      end
    end

    if (VOCPOX02.CU-SPCL-EDT-OVRDFL == "Y") /* field was overidden*/
      if (OM0ZW02.CU-SPCL-PRC-EDT != OM0ZW03.CU-SPCL-PRC-EDT)
        VOCPOX02.CU-SPCL-EDT-OVRDFL = "N";
        VOCPOX02.CU-SPCL-PRC-EDT = 0;
      end
    end

    if (VOCPOX02.CU-VEND-CLS-OVRDFL == "Y") /* field was overidden*/
      if (OM0ZW02.CU-VEND-CLS-ID != OM0ZW03.CU-VEND-CLS-ID)
        VOCPOX02.CU-VEND-CLS-OVRDFL = "N";
        VOCPOX02.CU-VEND-CLS-ID = " ";
      end
    end

    if (VOCPOX02.CU-COMNT1-OVRDFL == "Y") /* field was overidden*/
      if (OM0ZW02.CU-SKU-COMNT1 != OM0ZW03.CU-SKU-COMNT1)
        VOCPOX02.CU-COMNT1-OVRDFL = "N";
        VOCPOX02.CU-SKU-COMNT1 = " ";
      end
    end

    if (VOCPOX02.CU-COMNT2-OVRDFL == "Y") /* field was overidden*/
      if (OM0ZW02.CU-SKU-COMNT2 != OM0ZW03.CU-SKU-COMNT2)
        VOCPOX02.CU-COMNT2-OVRDFL = "N";
        VOCPOX02.CU-SKU-COMNT2 = " ";
      end
    end

    if (VOCPOX02.CU-COMNT3-OVRDFL == "Y") /* field was overidden*/
      if (OM0ZW02.CU-SKU-COMNT3 != OM0ZW03.CU-SKU-COMNT3)
        VOCPOX02.CU-COMNT3-OVRDFL = "N";
        VOCPOX02.CU-SKU-COMNT3 = " ";
      end
    end

    if (VOCPOX02.CU-PROD-ID-OVRDFL == "N"
     && VOCPOX02.CU-PROD-NM-OVRDFL == "N"
     && VOCPOX02.CU-SZ-ID-OVRDFL == "N"
     && VOCPOX02.CU-SZ-NM-OVRDFL == "N"
     && VOCPOX02.CU-VEND-CLS-OVRDFL == "N"
     && VOCPOX02.CU-RTL-PRC-OVRDFL == "N"
     && VOCPOX02.CU-SPCL-PRC-OVRDFL == "N"
     && VOCPOX02.CU-SPCL-EDT-OVRDFL == "N"
     && VOCPOX02.CU-SUGG-PRC-OVRDFL == "N"
     && VOCPOX02.CU-COMNT1-OVRDFL == "N"
     && VOCPOX02.CU-COMNT2-OVRDFL == "N"
     && VOCPOX02.CU-COMNT3-OVRDFL == "N")
      OM0ZW01.OM0ZW-OVRD-UPDATE = "D";
    else
      OM0ZW01.OM0ZW-OVRD-UPDATE = "U";
    end
  end

end // end OM0ZS58

// UPDATE OVERRIDE RECORD
Function OM0ZS60()

  if (OM0ZW02.OM0ZW-XREF-OVRD-DATA-FIELDS == 
  OM0ZW03.OM0ZW-XREF-OVRD-DATA-FIELDS)
    return;
  end

  if (OM0ZW01.OM0ZW-OVRD-EXISTS == "Y")

    OM0ZS-GET-VCUCPX01(); /* get xref rec without overrides*/

    if (OM0ZW02.CU-CUST-PROD-ID != OM0ZW03.CU-CUST-PROD-ID)
      if (OM0ZW03.CU-CUST-PROD-ID == VCUCPX01.CU-CUST-PROD-ID)
        VOCPOX02.CU-PROD-ID-OVRDFL = "N";
        VOCPOX02.CU-CUST-PROD-ID = " ";
      else
        VOCPOX02.CU-PROD-ID-OVRDFL = "Y";
        VOCPOX02.CU-CUST-PROD-ID = OM0ZW03.CU-CUST-PROD-ID;
      end
    end

    if (OM0ZW02.CU-PROD-NM != OM0ZW03.CU-PROD-NM)
      if (OM0ZW03.CU-PROD-NM == VCUCPX01.CU-PROD-NM)
        VOCPOX02.CU-PROD-NM-OVRDFL = "N";
        VOCPOX02.CU-PROD-NM = " ";
      else
        VOCPOX02.CU-PROD-NM-OVRDFL = "Y";
        VOCPOX02.CU-PROD-NM = OM0ZW03.CU-PROD-NM;
      end
    end

    if (OM0ZW02.CU-PROD-COLR-NM != OM0ZW03.CU-PROD-COLR-NM)
      if (OM0ZW03.CU-PROD-COLR-NM == VCUCPX01.CU-PROD-COLR-NM)
        VOCPOX02.CU-COLR-NM-OVRDFL = "N";
        VOCPOX02.CU-PROD-COLR-NM = " ";
      else
        VOCPOX02.CU-COLR-NM-OVRDFL = "Y";
        VOCPOX02.CU-PROD-COLR-NM = OM0ZW03.CU-PROD-COLR-NM;
      end
    end

    if (OM0ZW02.CU-PROD-SZ-ID != OM0ZW03.CU-PROD-SZ-ID)
      if (OM0ZW03.CU-PROD-SZ-ID == VCUCPX01.CU-PROD-SZ-ID)
        VOCPOX02.CU-SZ-ID-OVRDFL = "N";
        VOCPOX02.CU-PROD-SZ-ID = " ";
      else
        VOCPOX02.CU-SZ-ID-OVRDFL = "Y";
        VOCPOX02.CU-PROD-SZ-ID = OM0ZW03.CU-PROD-SZ-ID;
      end
    end

    if (OM0ZW02.CU-PROD-SZ-NM != OM0ZW03.CU-PROD-SZ-NM)
      if (OM0ZW03.CU-PROD-SZ-NM == VCUCPX01.CU-PROD-SZ-NM)
        VOCPOX02.CU-SZ-NM-OVRDFL = "N";
        VOCPOX02.CU-PROD-SZ-NM = " ";
      else
        VOCPOX02.CU-SZ-NM-OVRDFL = "Y";
        VOCPOX02.CU-PROD-SZ-NM = OM0ZW03.CU-PROD-SZ-NM;
      end
    end

    if (OM0ZW02.CU-CUST-RTL-PRC != OM0ZW03.CU-CUST-RTL-PRC)
      if (OM0ZW03.CU-CUST-RTL-PRC == VCUCPX01.CU-CUST-RTL-PRC)
        VOCPOX02.CU-RTL-PRC-OVRDFL = "N";
        VOCPOX02.CU-CUST-RTL-PRC = 0;
      else
        VOCPOX02.CU-RTL-PRC-OVRDFL = "Y";
        VOCPOX02.CU-CUST-RTL-PRC = OM0ZW03.CU-CUST-RTL-PRC;
      end
    end

    if (OM0ZW02.CU-CUST-SPCL-PRC != OM0ZW03.CU-CUST-SPCL-PRC)
      if (OM0ZW03.CU-CUST-SPCL-PRC == VCUCPX01.CU-CUST-SPCL-PRC)
        VOCPOX02.CU-SPCL-PRC-OVRDFL = "N";
        VOCPOX02.CU-CUST-SPCL-PRC = 0;
      else
        VOCPOX02.CU-SPCL-PRC-OVRDFL = "Y";
        VOCPOX02.CU-CUST-SPCL-PRC = OM0ZW03.CU-CUST-SPCL-PRC;
      end
    end

    if (OM0ZW02.CU-SUGG-RTL-PRC != OM0ZW03.CU-SUGG-RTL-PRC)
      if (OM0ZW03.CU-SUGG-RTL-PRC == VCUCPX01.CU-SUGG-RTL-PRC)
        VOCPOX02.CU-SUGG-PRC-OVRDFL = "N";
        VOCPOX02.CU-SUGG-RTL-PRC = 0;
      else
        VOCPOX02.CU-SUGG-PRC-OVRDFL = "Y";
        VOCPOX02.CU-SUGG-RTL-PRC = OM0ZW03.CU-SUGG-RTL-PRC;
      end
    end

    if (OM0ZW02.CU-SPCL-PRC-EDT != OM0ZW03.CU-SPCL-PRC-EDT)

      if (OM0ZW03.CU-SPCL-PRC-EDT == VCUCPX01.CU-SPCL-PRC-EDT)
        VOCPOX02.CU-SPCL-EDT-OVRDFL = "N";
        VOCPOX02.CU-SPCL-PRC-EDT = 0;
      else
        VOCPOX02.CU-SPCL-EDT-OVRDFL = "Y";
        VOCPOX02.CU-SPCL-PRC-EDT = OM0ZW03.CU-SPCL-PRC-EDT;
      end
    end

    if (OM0ZW02.CU-VEND-CLS-ID != OM0ZW03.CU-VEND-CLS-ID)
      if (OM0ZW03.CU-VEND-CLS-ID == VCUCPX01.CU-VEND-CLS-ID)
        VOCPOX02.CU-VEND-CLS-OVRDFL = "N";
        VOCPOX02.CU-VEND-CLS-ID = " ";
      else
        VOCPOX02.CU-VEND-CLS-OVRDFL = "Y";
        VOCPOX02.CU-VEND-CLS-ID = OM0ZW03.CU-VEND-CLS-ID;
      end
    end

    if (OM0ZW02.CU-SKU-COMNT1 != OM0ZW03.CU-SKU-COMNT1)
      if (OM0ZW03.CU-SKU-COMNT1 == VCUCPX01.CU-SKU-COMNT1)
        VOCPOX02.CU-COMNT1-OVRDFL = "N";
        VOCPOX02.CU-SKU-COMNT1 = " ";
      else
        VOCPOX02.CU-COMNT1-OVRDFL = "Y";
        VOCPOX02.CU-SKU-COMNT1 = OM0ZW03.CU-SKU-COMNT1;
      end
    end

    if (OM0ZW02.CU-SKU-COMNT2 != OM0ZW03.CU-SKU-COMNT2)
      if (OM0ZW03.CU-SKU-COMNT2 == VCUCPX01.CU-SKU-COMNT2)
        VOCPOX02.CU-COMNT2-OVRDFL = "N";
        VOCPOX02.CU-SKU-COMNT2 = " ";
      else
        VOCPOX02.CU-COMNT2-OVRDFL = "Y";
        VOCPOX02.CU-SKU-COMNT2 = OM0ZW03.CU-SKU-COMNT2;
      end
    end

    if (OM0ZW02.CU-SKU-COMNT3 != OM0ZW03.CU-SKU-COMNT3)
      if (OM0ZW03.CU-SKU-COMNT3 == VCUCPX01.CU-SKU-COMNT3)
        VOCPOX02.CU-COMNT3-OVRDFL = "N";
        VOCPOX02.CU-SKU-COMNT3 = " ";
      else
        VOCPOX02.CU-COMNT3-OVRDFL = "Y";
        VOCPOX02.CU-SKU-COMNT3 = OM0ZW03.CU-SKU-COMNT3;
      end
    end

    if (VOCPOX02.CU-PROD-ID-OVRDFL == "N"
     && VOCPOX02.CU-PROD-NM-OVRDFL == "N"
     && VOCPOX02.CU-COLR-NM-OVRDFL == "N"
     && VOCPOX02.CU-SZ-ID-OVRDFL == "N"
     && VOCPOX02.CU-SZ-NM-OVRDFL == "N"
     && VOCPOX02.CU-VEND-CLS-OVRDFL == "N"
     && VOCPOX02.CU-RTL-PRC-OVRDFL == "N"
     && VOCPOX02.CU-SPCL-PRC-OVRDFL == "N"
     && VOCPOX02.CU-SPCL-EDT-OVRDFL == "N"
     && VOCPOX02.CU-SUGG-PRC-OVRDFL == "N"
     && VOCPOX02.CU-COMNT1-OVRDFL == "N"
     && VOCPOX02.CU-COMNT2-OVRDFL == "N"
     && VOCPOX02.CU-COMNT3-OVRDFL == "N")
      OM0ZW01.OM0ZW-OVRD-UPDATE = "D";
    else
      OM0ZW01.OM0ZW-OVRD-UPDATE = "U";
    end

  else


    OM0ZW01.OM0ZW-OVRD-UPDATE = "I";

    if (OM0ZW02.CU-CUST-PROD-ID != OM0ZW03.CU-CUST-PROD-ID)
      VOCPOX02.CU-PROD-ID-OVRDFL = "Y";
      VOCPOX02.CU-CUST-PROD-ID = OM0ZW03.CU-CUST-PROD-ID;
    else
      VOCPOX02.CU-PROD-ID-OVRDFL = "N";
    end

    if (OM0ZW02.CU-PROD-NM != OM0ZW03.CU-PROD-NM)
      VOCPOX02.CU-PROD-NM-OVRDFL = "Y";
      VOCPOX02.CU-PROD-NM = OM0ZW03.CU-PROD-NM;
    else
      VOCPOX02.CU-PROD-NM-OVRDFL = "N";
    end

    if (OM0ZW02.CU-PROD-COLR-NM != OM0ZW03.CU-PROD-COLR-NM)
      VOCPOX02.CU-COLR-NM-OVRDFL = "Y";
      VOCPOX02.CU-PROD-COLR-NM = OM0ZW03.CU-PROD-COLR-NM;
    else
      VOCPOX02.CU-COLR-NM-OVRDFL = "N";
    end

    if (OM0ZW02.CU-PROD-SZ-ID != OM0ZW03.CU-PROD-SZ-ID)
      VOCPOX02.CU-SZ-ID-OVRDFL = "Y";
      VOCPOX02.CU-PROD-SZ-ID = OM0ZW03.CU-PROD-SZ-ID;
    else
      VOCPOX02.CU-SZ-ID-OVRDFL = "N";
    end

    if (OM0ZW02.CU-PROD-SZ-NM != OM0ZW03.CU-PROD-SZ-NM)
      VOCPOX02.CU-SZ-NM-OVRDFL = "Y";
      VOCPOX02.CU-PROD-SZ-NM = OM0ZW03.CU-PROD-SZ-NM;
    else
      VOCPOX02.CU-SZ-NM-OVRDFL = "N";
    end

    if (OM0ZW02.CU-CUST-RTL-PRC != OM0ZW03.CU-CUST-RTL-PRC)
      VOCPOX02.CU-RTL-PRC-OVRDFL = "Y";
      VOCPOX02.CU-CUST-RTL-PRC = OM0ZW03.CU-CUST-RTL-PRC;
    else
      VOCPOX02.CU-RTL-PRC-OVRDFL = "N";
    end

    if (OM0ZW02.CU-CUST-SPCL-PRC != OM0ZW03.CU-CUST-SPCL-PRC)
      VOCPOX02.CU-SPCL-PRC-OVRDFL = "Y";
      VOCPOX02.CU-CUST-SPCL-PRC = OM0ZW03.CU-CUST-SPCL-PRC;
    else
      VOCPOX02.CU-SPCL-PRC-OVRDFL = "N";
    end

    if (OM0ZW02.CU-SUGG-RTL-PRC != OM0ZW03.CU-SUGG-RTL-PRC)
      VOCPOX02.CU-SUGG-PRC-OVRDFL = "Y";
      VOCPOX02.CU-SUGG-RTL-PRC = OM0ZW03.CU-SUGG-RTL-PRC;
    else
      VOCPOX02.CU-SUGG-PRC-OVRDFL = "N";
    end

    if (OM0ZW02.CU-SPCL-PRC-EDT != OM0ZW03.CU-SPCL-PRC-EDT)
      VOCPOX02.CU-SPCL-EDT-OVRDFL = "Y";
      VOCPOX02.CU-SPCL-PRC-EDT = OM0ZW03.CU-SPCL-PRC-EDT;
    else
      VOCPOX02.CU-SPCL-EDT-OVRDFL = "N";
    end

    if (OM0ZW02.CU-VEND-CLS-ID != OM0ZW03.CU-VEND-CLS-ID)
      VOCPOX02.CU-VEND-CLS-OVRDFL = "Y";
      VOCPOX02.CU-VEND-CLS-ID = OM0ZW03.CU-VEND-CLS-ID;
    else
      VOCPOX02.CU-VEND-CLS-OVRDFL = "N";
    end

    if (OM0ZW02.CU-SKU-COMNT1 != OM0ZW03.CU-SKU-COMNT1)
      VOCPOX02.CU-COMNT1-OVRDFL = "Y";
      VOCPOX02.CU-SKU-COMNT1 = OM0ZW03.CU-SKU-COMNT1;
    else
      VOCPOX02.CU-COMNT1-OVRDFL = "N";
    end

    if (OM0ZW02.CU-SKU-COMNT2 != OM0ZW03.CU-SKU-COMNT2)
      VOCPOX02.CU-COMNT2-OVRDFL = "Y";
      VOCPOX02.CU-SKU-COMNT2 = OM0ZW03.CU-SKU-COMNT2;
    else
      VOCPOX02.CU-COMNT2-OVRDFL = "N";
    end

    if (OM0ZW02.CU-SKU-COMNT3 != OM0ZW03.CU-SKU-COMNT3)
      VOCPOX02.CU-COMNT3-OVRDFL = "Y";
      VOCPOX02.CU-SKU-COMNT3 = OM0ZW03.CU-SKU-COMNT3;
    else
      VOCPOX02.CU-COMNT3-OVRDFL = "N";
    end
  end

end // end OM0ZS60

// UPDATE COMPANION RECORD
Function OM0ZS62()

  if (OM0ZW03.OM0ZW-COMPANION-DATA-FIELDS != 
  OM0ZW02.OM0ZW-COMPANION-DATA-FIELDS) /* companion fields modified*/
    if (OM0ZW01.OM0ZW-COMP-EXISTS == "Y")
      if (OM0ZW03.OM0ZW-COMPANION-DATA-FIELDS == " ") /* blanked out*/
        OM0ZW01.OM0ZW-COMP-UPDATE = "D"; /* delete companion*/
      else
        OM0ZW01.OM0ZW-COMP-UPDATE = "U"; /* update companion*/
      end
    else
      OM0ZW01.OM0ZW-COMP-UPDATE = "I"; /* insert companion*/
    end
  end

end // end OM0ZS62

// CREATE XREF REC/DO DB UPDATES
Function OM0ZS64()

  OM0ZS-FMT-VCUCPX01(); /* format xref record*/

  VCUCPX01.CU-PROD-XREF-EDT = OP1REC.OP1CUNDT;
  VCUCPX01.CU-CUST-PROD-ID = OM0ZW03.CU-CUST-PROD-ID;
  VCUCPX01.CU-PROD-NM = OM0ZW03.CU-PROD-NM;
  VCUCPX01.CU-PROD-COLR-NM = OM0ZW03.CU-PROD-COLR-NM;
  VCUCPX01.CU-PROD-SZ-ID = OM0ZW03.CU-PROD-SZ-ID;
  VCUCPX01.CU-PROD-SZ-NM = OM0ZW03.CU-PROD-SZ-NM;
  VCUCPX01.CU-CUST-RTL-PRC = OM0ZW03.CU-CUST-RTL-PRC;
  VCUCPX01.CU-CUST-SPCL-PRC = OM0ZW03.CU-CUST-SPCL-PRC;
  VCUCPX01.CU-SUGG-RTL-PRC = OM0ZW03.CU-SUGG-RTL-PRC;
  VCUCPX01.CU-SPCL-PRC-EDT = OM0ZW03.CU-SPCL-PRC-EDT;
  VCUCPX01.CU-VEND-CLS-ID = OM0ZW03.CU-VEND-CLS-ID;
  VCUCPX01.CU-SKU-COMNT1 = OM0ZW03.CU-SKU-COMNT1;
  VCUCPX01.CU-SKU-COMNT2 = OM0ZW03.CU-SKU-COMNT2;
  VCUCPX01.CU-SKU-COMNT3 = OM0ZW03.CU-SKU-COMNT3;
  VCUCPX01.XXX-STAT = "A";

  OM0ZW-XREF-UPDATE = "I"; /* insert xref record*/

  if (OM0ZW01.OM0ZW-OVRD-EXISTS == "Y")
    OM0ZW01.OM0ZW-OVRD-UPDATE = "D"; /* delete override rec*/
  end

end // end OM0ZS64

// PROCESS PF22 KEY
Function OM0ZS66()

  OM0ZS-DEL-VOCPOX02(); /* delete the current override*/

  OM0ZS-GET-VCUCPX01(); /* get xref rec without overrides*/

  OM0ZM001.CU-CUST-PROD-ID = VCUCPX01.CU-CUST-PROD-ID;
  OM0ZW03.CU-CUST-PROD-ID = VCUCPX01.CU-CUST-PROD-ID;

  OM0ZM001.CU-PROD-NM = VCUCPX01.CU-PROD-NM;
  OM0ZW03.CU-PROD-NM = VCUCPX01.CU-PROD-NM;

  OM0ZM001.CU-PROD-COLR-NM = VCUCPX01.CU-PROD-COLR-NM;
  OM0ZW03.CU-PROD-COLR-NM = VCUCPX01.CU-PROD-COLR-NM;

  OM0ZM001.CU-PROD-SZ-ID = VCUCPX01.CU-PROD-SZ-ID;
  OM0ZW03.CU-PROD-SZ-ID = VCUCPX01.CU-PROD-SZ-ID;

  OM0ZM001.CU-PROD-SZ-NM = VCUCPX01.CU-PROD-SZ-NM;
  OM0ZW03.CU-PROD-SZ-NM = VCUCPX01.CU-PROD-SZ-NM;

  OM0ZM001.CU-CUST-RTL-PRC = VCUCPX01.CU-CUST-RTL-PRC;
  OM0ZW03.CU-CUST-RTL-PRC = VCUCPX01.CU-CUST-RTL-PRC;

  OM0ZM001.CU-CUST-SPCL-PRC = VCUCPX01.CU-CUST-SPCL-PRC;
  OM0ZW03.CU-CUST-SPCL-PRC = VCUCPX01.CU-CUST-SPCL-PRC;

  OM0ZM001.CU-SUGG-RTL-PRC = VCUCPX01.CU-SUGG-RTL-PRC;
  OM0ZW03.CU-SUGG-RTL-PRC = VCUCPX01.CU-SUGG-RTL-PRC;

  OM0ZW01.OM0ZWDT8 = VCUCPX01.CU-SPCL-PRC-EDT;
  OM0ZSDCM(); /* convert date to map format*/
  OM0ZM001.OM0ZM-CU-SPCL-PRC-EDT = OM0ZW01.OM0ZWDT6;
  OM0ZW03.OM0ZW-CU-SPCL-PRC-EDT-MAP = OM0ZW01.OM0ZWDT6;
  OM0ZW03.CU-SPCL-PRC-EDT = VCUCPX01.CU-SPCL-PRC-EDT;

  OM0ZM001.CU-VEND-CLS-ID = VCUCPX01.CU-VEND-CLS-ID;
  OM0ZW03.CU-VEND-CLS-ID = VCUCPX01.CU-VEND-CLS-ID;

  OM0ZM001.CU-SKU-COMNT1 = VCUCPX01.CU-SKU-COMNT1;
  OM0ZW03.CU-SKU-COMNT1 = VCUCPX01.CU-SKU-COMNT1;

  OM0ZM001.CU-SKU-COMNT2 = VCUCPX01.CU-SKU-COMNT2;
  OM0ZW03.CU-SKU-COMNT2 = VCUCPX01.CU-SKU-COMNT2;

  OM0ZM001.CU-SKU-COMNT3 = VCUCPX01.CU-SKU-COMNT3;
  OM0ZW03.CU-SKU-COMNT3 = VCUCPX01.CU-SKU-COMNT3;

end // end OM0ZS66

// DB2 TO MAP DATE CONVERSION
Function OM0ZSDCM()

  OM0ZW01.OM0ZWDT6Y = OM0ZW01.OM0ZWDT8Y;
  OM0ZW01.OM0ZWDT6M = OM0ZW01.OM0ZWDT8M;
  OM0ZW01.OM0ZWDT6D = OM0ZW01.OM0ZWDT8D;

end // end OM0ZSDCM

// map to db date convert
Function OM0ZSDED()

  set TA2REC empty;
  TA2REC.TA2GRGA = OM0ZW01.OM0ZWDT6;
  TA2REC.TA2DTOPT = "GREGGREG";
  TA2REC.TA2GRTYP = "A";
  call "TA0040" (TA2REC) {isNoRefresh = yes, isExternal = yes};

end // end OM0ZSDED

// MMDDYY To Comp - no validate
Function OM0ZSDMC()

  if (OM0ZW01.OM0ZWDT6 == 0)
    OM0ZW01.OM0ZWDT8 = 0;
    return;
  end

  OM0ZW01.OM0ZWDT8Y = OM0ZW01.OM0ZWDT6Y;
  OM0ZW01.OM0ZWDT8M = OM0ZW01.OM0ZWDT6M;
  OM0ZW01.OM0ZWDT8D = OM0ZW01.OM0ZWDT6D;

  if (OM0ZW01.OM0ZWDT6Y <= 51)
    OM0ZW01.OM0ZWDT8C = 20;
  else
    OM0ZW01.OM0ZWDT8C = 19;
  end

end // end OM0ZSDMC

Record OM0ZW01 type basicRecord
  10 OM0ZW-WCU1710-EXISTS OM0ZW-WCU1710-EXISTS ; 
  10 OM0ZWERRFL OM0ZWERRFL ; 
  10 OM0ZW-XREF-EXISTS OM0ZW-XREF-EXISTS ; 
  10 OM0ZW-OVRD-EXISTS OM0ZW-OVRD-EXISTS ; 
  10 OM0ZW-COMP-EXISTS OM0ZW-COMP-EXISTS ; 
  10 OM0ZW-OVRD-UPDATE OM0ZW-OVRD-UPDATE ; 
  10 OM0ZW-COMP-UPDATE OM0ZW-COMP-UPDATE ; 
  10 OM0ZW-XREF-UPDATE OM0ZW-XREF-UPDATE ; 
  10 OM0ZW-SIZE-LEVEL-CUSTOMER OM0ZW-SIZE-LEVEL-CUSTOMER ; 
  10 OM0ZW-PF23-CONFIRM-FL OM0ZW-PF23-CONFIRM-FL ; 
  10 CU-CUSKU-ID CU-CUSKU-ID ; 
  10 ZZZCHGDT ZZZCHGDT ; 
  10 ZZZCHGTM ZZZCHGTM ; 
  10 OM0ZWTSFS OM0ZWTSFS ; 
  10 OM0ZWTSFP OM0ZWTSFP ; 
  10 OM0ZWSUB OM0ZWSUB ; 
  10 OM0ZWERR OM0ZWERR ; 
  10 OM0ZWSYSKE OM0ZWSYSKE ; 
    15 OM0ZWPARTN OM0ZWPARTN ; 
    15 OM0ZWORD OM0ZWORD ; 
      20 OM0ZWCUOID OM0ZWCUOID ; 
      20 OM0ZWSEP1 OM0ZWSEP1 ; 
      20 OM0ZWNORID OM0ZWNORID ; 
      20 OM0ZWSEP2 OM0ZWSEP2 ; 
      20 OM0ZWLNINB OM0ZWLNINB ; 
    15 OM0ZWCUST OM0ZWCUST ; 
      20 OM0ZWCOID OM0ZWCOID ; 
      20 OM0ZWSEP5 OM0ZWSEP5 ; 
      20 OM0ZWSTRID OM0ZWSTRID ; 
      20 OM0ZWSEP6 OM0ZWSEP6 ; 
      20 OM0ZWXNXCD OM0ZWXNXCD ; 
    15 OM0ZWSEP7 OM0ZWSEP7 ; 
    15 OM0ZWSTY OM0ZWSTY ; 
  10 OM0ZWDT6 OM0ZWDT6 ; 
    15 OM0ZWDT6M OM0ZWDT6M ; 
    15 OM0ZWDT6D OM0ZWDT6D ; 
    15 OM0ZWDT6Y OM0ZWDT6Y ; 
  10 OM0ZWDT8 OM0ZWDT8 ; 
    15 OM0ZWDT8C OM0ZWDT8C ; 
    15 OM0ZWDT8Y OM0ZWDT8Y ; 
    15 OM0ZWDT8M OM0ZWDT8M ; 
    15 OM0ZWDT8D OM0ZWDT8D ; 
end // end OM0ZW01

//*** RECORD=OM0ZW02 ****
// Previous map detail record.
// ************************************************************
// *               Maintenance History Record                 *
// ************************************************************
// Log #     Date      Name      Description
// -----   --------    ----      -----------
//   001   10/10/96   DLIDDL     Record Creation
// ***********************
Record OM0ZW02 type basicRecord
  5 OM0ZW-PREV-MAP-FIELDS char(267) ; 
    10 OM0ZW-XREF-OVRD-DATA-FIELDS char(221) ; 
      15 CU-CUST-PROD-ID char(25) ; // cu-cust-prod-id
      15 CU-PROD-NM char(30) ; // cu-prod-nm
      15 CU-PROD-COLR-NM char(30) ; // cu-prod-colr-nm
      15 CU-PROD-SZ-ID char(5) ; // cu-prod-sz-id
      15 CU-PROD-SZ-NM char(30) ; // cu-prod-sz-id
      15 CU-CUST-RTL-PRC decimal(13,2) ; // cu-cust-rtl-prc
      15 CU-CUST-SPCL-PRC decimal(13,2) ; // cu-cust-spcl-prc
      15 CU-SUGG-RTL-PRC decimal(13,2) ; // cu-sugg-rtl-prc
      15 OM0ZW-CU-SPCL-PRC-EDT-MAP num(6) ; // cu-spcl-prc-edt
      15 CU-SPCL-PRC-EDT int ; // cu-spcl-prc-edt
      15 CU-VEND-CLS-ID char(10) ; // cu-vend-cls-id
      15 CU-SKU-COMNT1 char(20) ; // cu-sku-comnt1
      15 CU-SKU-COMNT2 char(20) ; // cu-sku-comnt2
      15 CU-SKU-COMNT3 char(20) ; // cu-sku-comnt3
    10 OM0ZW-COMPANION-DATA-FIELDS char(46) ; 
      15 CU-BUY-SESN-ID char(6) ; // cu-buy-sesn-id
      15 OP-SMPL-RQT-ID char(18) ; // op-smpl-rqt-id
      15 CU-COST-ID char(10) ; // cu-cost-id
      15 OP-CASE-LOT-NBR char(12) ; // op-case-lot-nbr
end // end OM0ZW02

//*** RECORD=OM0ZW03 ****
// Current map detail record.
// ************************************************************
// *               Maintenance History Record                 *
// ************************************************************
// Log #     Date      Name      Description
// -----   --------    ----      -----------
//   001   10/10/96   DLIDDL     Record Creation
// ***********************
Record OM0ZW03 type basicRecord
  5 OM0ZW-CURR-MAP-FIELDS char(267) ; 
    10 OM0ZW-XREF-OVRD-DATA-FIELDS char(221) ; 
      15 CU-CUST-PROD-ID char(25) ; // cu-cust-prod-id
      15 CU-PROD-NM char(30) ; // cu-prod-nm
      15 CU-PROD-COLR-NM char(30) ; // cu-prod-colr-nm
      15 CU-PROD-SZ-ID char(5) ; // cu-prod-sz-id
      15 CU-PROD-SZ-NM char(30) ; // cu-prod-sz-id
      15 CU-CUST-RTL-PRC decimal(13,2) ; // cu-cust-rtl-prc
      15 CU-CUST-SPCL-PRC decimal(13,2) ; // cu-cust-spcl-prc
      15 CU-SUGG-RTL-PRC decimal(13,2) ; // cu-sugg-rtl-prc
      15 OM0ZW-CU-SPCL-PRC-EDT-MAP num(6) ; // cu-spcl-prc-edt
      15 CU-SPCL-PRC-EDT int ; // cu-spcl-prc-edt
      15 CU-VEND-CLS-ID char(10) ; // cu-vend-cls-id
      15 CU-SKU-COMNT1 char(20) ; // cu-sku-comnt1
      15 CU-SKU-COMNT2 char(20) ; // cu-sku-comnt2
      15 CU-SKU-COMNT3 char(20) ; // cu-sku-comnt3
    10 OM0ZW-COMPANION-DATA-FIELDS char(46) ; 
      15 CU-BUY-SESN-ID char(6) ; // cu-buy-sesn-id
      15 OP-SMPL-RQT-ID char(18) ; // op-smpl-rqt-id
      15 CU-COST-ID char(10) ; // cu-cost-id
      15 OP-CASE-LOT-NBR char(12) ; // op-case-lot-nbr
end // end OM0ZW03

//*** RECORD=VOCPOX02 ****
//  DB2 TABLE:           DORDER.VOCPOX02
// 
//  COPYLIB MEMBER:      DOCP0X02
// 
//  I/O MOD:             VOCPOX02
// 
//  DATE CREATED:        11-11-96
// 
//  MAINTENANCE LOG:
// 
//    DATE    INIT.      COMMENT
//  --------  -----      --------------------------------------
//  11-11-96  DLIDDL     INITIAL CREATION
// 
// ************************
Record VOCPOX02 type basicRecord
  10 OP1PARTN OP1PARTN ; 
  10 OP1CUOID OP1CUOID ; 
  10 OP1NORID OP1NORID ; 
  10 OP2LNINB OP2LNINB ; 
  10 CU-CUSKU-ID CU-CUSKU-ID ; 
  10 SY1STNBR SY1STNBR ; 
  10 SY2CLRID SY2CLRID ; 
  10 XDMCD XDMCD ; 
  10 SY5SZID SY5SZID ; 
  10 PROD-VALD-STY-FL PROD-VALD-STY-FL ; 
  10 CU-PROD-ID-OVRDFL CU-PROD-ID-OVRDFL ; 
  10 CU-CUST-PROD-ID CU-CUST-PROD-ID ; 
  10 CU-PROD-NM-OVRDFL CU-PROD-NM-OVRDFL ; 
  10 CU-PROD-NM CU-PROD-NM ; 
  10 CU-COLR-NM-OVRDFL CU-COLR-NM-OVRDFL ; 
  10 CU-PROD-COLR-NM CU-PROD-COLR-NM ; 
  10 CU-SZ-ID-OVRDFL CU-SZ-ID-OVRDFL ; 
  10 CU-PROD-SZ-ID CU-PROD-SZ-ID ; 
  10 CU-SZ-NM-OVRDFL CU-SZ-NM-OVRDFL ; 
  10 CU-PROD-SZ-NM CU-PROD-SZ-NM ; 
  10 CU-VEND-CLS-OVRDFL CU-VEND-CLS-OVRDFL ; 
  10 CU-VEND-CLS-ID CU-VEND-CLS-ID ; 
  10 CU-RTL-PRC-OVRDFL CU-RTL-PRC-OVRDFL ; 
  10 CU-CUST-RTL-PRC CU-CUST-RTL-PRC ; 
  10 CU-SPCL-PRC-OVRDFL CU-SPCL-PRC-OVRDFL ; 
  10 CU-CUST-SPCL-PRC CU-CUST-SPCL-PRC ; 
  10 CU-SPCL-EDT-OVRDFL CU-SPCL-EDT-OVRDFL ; 
  10 CU-SPCL-PRC-EDT CU-SPCL-PRC-EDT ; 
  10 CU-SUGG-PRC-OVRDFL CU-SUGG-PRC-OVRDFL ; 
  10 CU-SUGG-RTL-PRC CU-SUGG-RTL-PRC ; 
  10 CU-COMNT1-OVRDFL CU-COMNT1-OVRDFL ; 
  10 CU-SKU-COMNT1 CU-SKU-COMNT1 ; 
  10 CU-COMNT2-OVRDFL CU-COMNT2-OVRDFL ; 
  10 CU-SKU-COMNT2 CU-SKU-COMNT2 ; 
  10 CU-COMNT3-OVRDFL CU-COMNT3-OVRDFL ; 
  10 CU-SKU-COMNT3 CU-SKU-COMNT3 ; 
  10 ZZZSDT ZZZSDT ; 
  10 ZZZSTM ZZZSTM ; 
  10 ZZZCHGDT ZZZCHGDT ; 
  10 ZZZCHGTM ZZZCHGTM ; 
  10 ZZZCHGCT ZZZCHGCT ; 
end // end VOCPOX02

DataItem OM0ZW-COMP-EXISTS char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OM0ZW-COMP-UPDATE char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OM0ZW-OVRD-EXISTS char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OM0ZW-OVRD-UPDATE char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OM0ZW-PF23-CONFIRM-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OM0ZW-SIZE-LEVEL-CUSTOMER char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OM0ZW-WCU1710-EXISTS char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OM0ZW-XREF-EXISTS char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OM0ZW-XREF-UPDATE char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OM0ZWCOID num(8)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem OM0ZWCUOID num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem OM0ZWCUST char(16)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OM0ZWDT6 num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem OM0ZWDT6D num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem OM0ZWDT6M num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem OM0ZWDT6Y num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem OM0ZWDT8 num(8)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem OM0ZWDT8C num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem OM0ZWDT8D num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem OM0ZWDT8M num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem OM0ZWDT8Y num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem OM0ZWERR char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OM0ZWERRFL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OM0ZWLNINB num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem OM0ZWNORID num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem OM0ZWORD char(15)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OM0ZWPARTN char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OM0ZWSEP1 char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OM0ZWSEP2 char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OM0ZWSEP5 char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OM0ZWSEP6 char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OM0ZWSEP7 char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OM0ZWSTRID num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem OM0ZWSTY char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OM0ZWSUB num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem OM0ZWSYSKE char(39)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// current page of temp storage
DataItem OM0ZWTSFP num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem OM0ZWTSFS num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem OM0ZWXNXCD num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

