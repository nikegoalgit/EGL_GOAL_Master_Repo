package ob0v;
import corpcom1.*;
import corpcom2.*;
import corpcom4.*;
import corpcom5.*;
import corpcom6.*;
import corpcom7.*;
import corpx1.*;
import corpx2.*;
import corpy2.*;
import corpz3.*;
import dg.common.*;
import fk.common.*;
import fy.common.*;
import ku.common.*;
import ob.common.*;
import op.common.*;
import pc.common.*;
import pg.common.*;
import pk.common.*;
import pw.common.*;
import sm.common.*;
import sp.common.*;
import sy.common.*;
import ta.common.*;
import tf.common.*;
import vv.common.*;
import ww.common.*;
//*** PROGRAM=OB0V ****
// This program displays information on the customer xref
// product from the dcust.vcucpx01 table or overrides when they
// exist.
// 
// ;
// maintenance log
// ;
// 06/05/95  craine   created
// 08/01/95  DLIDDL   Modified to incorporate Nike Canada into
//                    AIRSPEED - OB0VS12.
// 08/07/95  craine   database changes
// 09/08/95  craine   don't allow dept 9999 when updating cucpx
// 02/14/96  CBRINE   Chg return code check from 1 to 2 in
//                    OB0VS-GET-WCU1700
// 05/20/96  wleong   Regenerated to get new WCU1700 layout
// 09/24/96  DLIDDL   Replaced nikeboth subroutine CU1700 with
//                    CU1710.
// 07/28/97  CBRINE   Move 0 to XNX-DEPT-ID-XREF in VCUCPX01
//                    (EXCEPT FOR PENNEYS)
//                    Only insert size 0 record for VOBXRF01.
// 08/20/97  CBRINE   Select size zero in OB0VS-GET-VOBXRF01.
// 10/08/97  JFLOR1   Modified column headings for user.
// 04/21/99  SGOPAL   Added new parent id 32 for JCP in
//                    OB0VS-GET_VCUCPX01.
// 02/09/00  gsunda   Modified by NKATHI- offshore to validate
//                    customer retail prices field againt
//                    the max value of $999.99
// *********************
Program OB0V type textUIProgram //VAGen Info - main text program
  {
  includeReferencedFunctions = yes, allowUnqualifiedItemReferences = yes, 
  throwNrfEofExceptions = yes, handleHardIOErrors = no, V60ExceptionCompatibility = yes, 
  I4GLItemsNullable = no, textLiteralDefaultIsString = no, localSQLScope = yes, 
  msgTablePrefix = "OB00", inputRecord = COMMAREA, segmented = yes
  }

  // Data Declarations
  COMMAREA COMMAREA ; // record
  ERRSQLCA ERRSQLCA; // record
  KUCREC KUCREC; // record
  OB0VW01 OB0VW01; // record
  OB0VW02 OB0VW02; // record
  OB0VW03 OB0VW03; // record
  OB1REC OB1REC; // record
  OB2REC OB2REC; // record
  OB8REC OB8REC; // record
  OBAREC OBAREC; // record
  OBBREC OBBREC; // record
  OBCREC OBCREC; // record
  OBDREC OBDREC; // record
  OBEREC OBEREC; // record
  OBFEREC OBFEREC; // record
  OBFREC OBFREC; // record
  OBKREC OBKREC; // record
  OBLEREC OBLEREC; // record
  OBVREC OBVREC; // record
  OBWREC OBWREC; // record
  SQLCA SQLCA; // record
  SY4REC SY4REC; // record
  SYCREC SYCREC; // record
  TA1REC TA1REC; // record
  TA2REC TA2REC; // record
  TA5REC TA5REC; // record
  TAEREC TAEREC; // record
  VBCPOX02 VBCPOX02; // record
  VCUCPX01 VCUCPX01; // record
  VOBXRF01 VOBXRF01; // record
  WCU1710 WCU1710; // record
  XX0XW01 XX0XW01; // record

  // VAGen Info - items needed for migration
  VAGen_EZESYS char(8);
  VAGen_EZEREPLY num(1);
  VAGen_EZE_WAIT_TIME bin(9,2);
  VAGen_EZE_ITEMLEN int;

  // Use Declarations
  use XGPTBL {deleteAfterUse = yes}; // table
  use XQATBL {deleteAfterUse = yes}; // table
  use XDMTBL {deleteAfterUse = yes}; // table
  use OB0VM.OB0VM001 // form
   {
    pfKeyEquate = no
  };

  function main()
    // VAGen Info - initialization needed for migration
    VAGen_EZESYS = VGLib.getVAGSysType();
    OB0V000: OB0V000();
    goto OB0V010;
    OB0V010: OB0V010();
    goto OB0V010;
  end // end main
end // end OB0V

Function OB0V000()

  XSENTRY(); /* check CSP and order batch security*/

  XSOBS01();

  OB0VS01(); /* initialise application*/

  OBWREC.OBWER911 = "N"; /* set -911 processing flag*/

  XSOBS02(); /* determine if batch edit is running*/

  XSOBS03(); /* read order header*/

  XSOBT6R(); /* read current TS page*/

  OB0VS-GET-DATA(); /* get database records*/

  OB0VM001.CAMSG = OBWREC.CAMSG;
  OBWREC.CAMSG = " ";

  OB0VS10(); /* build map*/

end // end OB0V000

Function OB0V010()

  converseLib.clearScreen();
   /* set map page number*/
  converseVar.segmentedMode = 1; /* force segmented converse mode*/
  OBWREC.OBWER911 = "Y"; /* -911 processing flag*/

  OB0VS30(); /* display xref update question*/
  OB0VS32(); /* display override literal*/
  OB0VS34(); /* display size literal*/
  OB0VS36(); /* display PF23 key if ok to do so*/
  OB0VS38(); /* display special makeup/dummy msg*/

  converse OB0VM001 ;

  OBWREC.OBWERRFL = "N";
  converseLib.validationFailed(0);
  OBWREC.OBWHELP = OB0VM001.CAMSG;
  OB0VM001.CAMSG = " ";

  OB0VS40(); /* move 'after converse' map fields to*/
                                   /* save area*/

  if (OB1REC.YOBCD != "XL" /* not cancelled*/
   && OB1REC.YOBCD != "CA" /* not cleared availability*/
   && OB1REC.YOBCD != "LP" /* not lost demand reported*/
   && OB1REC.YOBCD != "LD") /* not postponed demand reported*/

    if (converseVar.eventKey is enter) /* enter key pressed*/
      OB0VS42(); /* edit map*/
      if (converseVar.validationMsgNum == 0) /* no errors*/
        OB0VS44(); /* determine db updates*/
      end
    else
      OB0VS46(); /* process valid PF keys*/
    end

    if (converseVar.validationMsgNum == 0) /* no errors*/
      OB0VS-UPD-TS(); /* update TS and WS areas*/
      move OB0VW03 to OB0VW02 withV60Compat; /* move 'current' map to 'previous' map*/
      OB0VS16(); /* reset field attributes*/
    end
  end

end // end OB0V010

// INSERT DORDB.VBCPOX02
Function OB0VS-ADD-VBCPOX02()

  set SQLCA empty;

  OB0VS-FMT-VBCPOX02(); /* format override record*/

  VBCPOX02.ZZZSDT = OBWREC.ZZZCHGDT;
  VBCPOX02.ZZZSTM = OBWREC.ZZZCHGTM;
  VBCPOX02.ZZZCHGDT = OBWREC.ZZZCHGDT;
  VBCPOX02.ZZZCHGTM = OBWREC.ZZZCHGTM;
  VBCPOX02.ZZZCHGCT = 0;

  call "VBCPOX02" ("A ", SQLCA, VBCPOX02) {isNoRefresh = yes, isExternal = yes}; /**/

  if (SQLCA.VAGen_SQLCODE == 0) /* check for good return code*/
    OB0VM001.CAMSG = "CUSTOMER CROSS REFERENCE OVERRIDE SUCCESSFULLY ADDED";
    OB0VW01.OB0VW-OVRD-EXISTS = "Y";
  else
    TA1REC.TA1DBASE = "DORDB   "; /* data base name*/
    TA1REC.TA1TBLVU = "VBCPOX02"; /* table view*/
    TA1REC.TA1LOCAT[1] = "A       "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "VBCPOX02"; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OB0VS-AD"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "D-VBCPOX"; /* extra key*/
    if (SQLCA.VAGen_SQLCODE == -911) /* deadlock*/
      OBWREC.OBWER911 = "Y"; /* show err*/
      XSOBS04(); /* no rollback, restart appl*/
    else
      XSOBEDC(); /* abort routine - no reset done*/
    end
  end

end // end OB0VS-ADD-VBCPOX02

// INSERT DCUST.VCUCPX01
Function OB0VS-ADD-VCUCPX01()

  set SQLCA empty;

  VCUCPX01.ZZZSDT = OBWREC.ZZZCHGDT;
  VCUCPX01.ZZZSTM = OBWREC.ZZZCHGTM;
  VCUCPX01.ZZZCHGDT = OBWREC.ZZZCHGDT;
  VCUCPX01.ZZZCHGTM = OBWREC.ZZZCHGTM;
  VCUCPX01.ZZZCHGCT = 0;

  call "VCUCPX01" ("A ", SQLCA, VCUCPX01) {isNoRefresh = yes, isExternal = yes}; /**/

  if (SQLCA.VAGen_SQLCODE == 0) /* check for good return code*/
    OB0VW01.OB0VW-XREF-EXISTS = "Y";
    OB0VM001.CAMSG = "CUSTOMER CROSS REFERENCE SUCCESSFULLY ADDED";
  else /* other return code*/
    TA1REC.TA1DBASE = "DCUST   "; /* data base name*/
    TA1REC.TA1TBLVU = "VCUCPX01"; /* table view*/
    TA1REC.TA1LOCAT[1] = "A       "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "VCUCPX01"; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OB0VS-AD"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "D-VCUCPX"; /* extra key*/
    if (SQLCA.VAGen_SQLCODE == -911) /* deadlock*/
      OBWREC.OBWER911 = "Y"; /* show err*/
      XSOBS04(); /* no rollback, restart appl*/
    else
      XSOBEDC(); /* abort routine - no reset done*/
    end
  end



end // end OB0VS-ADD-VCUCPX01

// INSERT DORDB.VOBXRF01
Function OB0VS-ADD-VOBXRF01()

  set SQLCA empty;

  OB0VS-FMT-VOBXRF01(); /* format the companion record*/

  VOBXRF01.ZZZSDT = OBWREC.ZZZCHGDT;
  VOBXRF01.ZZZSTM = OBWREC.ZZZCHGTM;
  VOBXRF01.ZZZCHGDT = OBWREC.ZZZCHGDT;
  VOBXRF01.ZZZCHGTM = OBWREC.ZZZCHGTM;
  VOBXRF01.ZZZCHGCT = 0;

  call "VOBXRF01" ("A ", SQLCA, VOBXRF01) {isNoRefresh = yes, isExternal = yes}; /**/

  if (SQLCA.VAGen_SQLCODE == 0 /* check for good return code*/
   || SQLCA.VAGen_SQLCODE == -803) /* row already exists*/
    OB0VW01.OB0VW-COMP-EXISTS = "Y";
    OB0VM001.CAMSG = "UPDATE SUCCESSFUL";
  else
    TA1REC.TA1DBASE = "DORDB   "; /* data base name*/
    TA1REC.TA1TBLVU = "VOBXRF01"; /* table view*/
    TA1REC.TA1LOCAT[1] = "A       "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "VOBXRF01"; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OB0VS-AD"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "D-VOBXRF"; /* extra key*/
    if (SQLCA.VAGen_SQLCODE == -911) /* deadlock*/
      OBWREC.OBWER911 = "Y"; /* show err*/
      XSOBS04(); /* no rollback, restart appl*/
    else
      XSOBEDC(); /* abort routine - no reset done*/
    end
  end

end // end OB0VS-ADD-VOBXRF01

// DELETE DORDB.VBCPOX02
Function OB0VS-DEL-VBCPOX02()

  set SQLCA empty;

  call "VBCPOX02" ("D1", SQLCA, VBCPOX02) {isNoRefresh = yes, isExternal = yes}; /**/

  if (SQLCA.VAGen_SQLCODE == 0
   || SQLCA.VAGen_SQLCODE == 100) /* check for good return code*/
    OB0VW01.OB0VW-OVRD-EXISTS = "N";
    OB0VM001.CAMSG = "CUSTOMER CROSS REFERENCE OVERRIDE SUCCESSFULLY DELETED";
  else /* check for other return code*/
    TA1REC.TA1DBASE = "DORDB   "; /* data base name*/
    TA1REC.TA1TBLVU = "VBCPOX02"; /* table view*/
    TA1REC.TA1LOCAT[1] = "D1      "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "VBCPOX02"; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OB0VS-DE"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "L-VBCPOX"; /* extra key*/
    if (SQLCA.VAGen_SQLCODE == -911) /* deadlock*/
      OBWREC.OBWER911 = "Y"; /* show err*/
      XSOBS04(); /* no rollback, restart appl*/
    else
      XSOBEDC(); /* abort routine - no reset done*/
    end
  end


end // end OB0VS-DEL-VBCPOX02

// DELETE DORDB.VOBXRF01
Function OB0VS-DEL-VOBXRF01()

  set SQLCA empty;

  call "VOBXRF01" ("D ", SQLCA, VOBXRF01) {isNoRefresh = yes, isExternal = yes}; /**/

  if (SQLCA.VAGen_SQLCODE == 0 /* check for good return code*/
   || SQLCA.VAGen_SQLCODE == 100) /* record doesn't exist*/
    OB0VW01.OB0VW-COMP-EXISTS = "N";
    OB0VM001.CAMSG = "UPDATE SUCCESSFUL";
  else /* record already exists*/
    TA1REC.TA1DBASE = "DORDB   "; /* data base name*/
    TA1REC.TA1TBLVU = "VOBXRF01"; /* table view*/
    TA1REC.TA1LOCAT[1] = "D1      "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "VOBXRF01"; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OB0VS-DE"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "L-VOBXRF"; /* extra key*/
    if (SQLCA.VAGen_SQLCODE == -911) /* deadlock*/
      OBWREC.OBWER911 = "Y"; /* show err*/
      XSOBS04(); /* no rollback, restart appl*/
    else
      XSOBEDC(); /* abort routine - no reset done*/
    end
  end

end // end OB0VS-DEL-VOBXRF01

// FORMAT VBCPOX02 RECORD
Function OB0VS-FMT-VBCPOX02()

  VBCPOX02.OP1PARTN = OB1REC.OP1PARTN; /* order related fields*/
  VBCPOX02.OP1CUOID = OB1REC.OP1CUOID;
  VBCPOX02.OP1NORID = OB1REC.OP1NORID;
  VBCPOX02.OP2LNINB = OBWREC.OBWLNINB;

  VBCPOX02.CU-CUSKU-ID = OB0VW01.CU-CUSKU-ID;

  VBCPOX02.SY1STNBR = OB2REC.SY1STNBR; /* style nbr*/
  VBCPOX02.SY2CLRID = OB2REC.SY2CLRID; /* color*/
  VBCPOX02.XDMCD = OB2REC.XDMCD; /* dimension*/
  if (OB0VW01.OB0VW-SIZE-LEVEL-CUSTOMER == "Y") /* size level*/
    VBCPOX02.SY5SZID = OBVREC.SY-SZ-ID[OBWTSF6S]; /* nk size*/
  else /* product level*/
    VBCPOX02.SY5SZID = 0;
  end

end // end OB0VS-FMT-VBCPOX02

// FORMAT VCUCPX01 RECORD
Function OB0VS-FMT-VCUCPX01()

  VCUCPX01.CU-CUSKU-ID = OB0VW01.CU-CUSKU-ID;
  if (KUCREC.KUKPCOID == 29 /* if Penney's apparel, then we want*/
   && OB2REC.XGPCD == "03") /* to keep the dept nbr*/
    VCUCPX01.XNX-DEPT-ID-XREF = OB1REC.XNXCD; /* dept*/
  else
    VCUCPX01.XNX-DEPT-ID-XREF = 0; /* dept*/
  end
  VCUCPX01.XGPCD = OB2REC.XGPCD; /* gpc code*/
  VCUCPX01.SY1STNBR = OB2REC.SY1STNBR; /* style nbr*/
  VCUCPX01.SY2CLRID = OB2REC.SY2CLRID; /* color*/
  VCUCPX01.XDMCD = OB2REC.XDMCD; /* dimension*/
  VCUCPX01.XQACD = OB2REC.XQACD; /* quality code*/
  if (OB0VW01.OB0VW-SIZE-LEVEL-CUSTOMER == "Y") /* size level*/
    VCUCPX01.SY5SZID = OBVREC.SY-SZ-ID[OBWTSF6S]; /* nk size*/
  else /* product level*/
    VCUCPX01.SY5SZID = 0;
  end

end // end OB0VS-FMT-VCUCPX01

// FORMAT VOBXRF01 RECORD
Function OB0VS-FMT-VOBXRF01()

  VOBXRF01.OP1PARTN = OB1REC.OP1PARTN;
  VOBXRF01.OP1CUOID = OB1REC.OP1CUOID;
  VOBXRF01.OP1NORID = OB1REC.OP1NORID;
  VOBXRF01.OP2LNINB = OB2REC.OP2LNINB;
  VOBXRF01.CU-BUY-SESN-ID = OB0VW03.CU-BUY-SESN-ID;
  VOBXRF01.OP-SMPL-RQT-ID = OB0VW03.OP-SMPL-RQT-ID;
  VOBXRF01.CU-COST-ID = OB0VW03.CU-COST-ID;
  VOBXRF01.OP-CASE-LOT-NBR = OB0VW03.OP-CASE-LOT-NBR;
   /* for now, the companion data is at the product level, so only*/
   /* insert 0 size record. this will need to uncommented out when*/
   /* a customer decides to use it at the size level.*/
   /* IF OB0VW01.OB0VW-SIZE-LEVEL-CUSTOMER = 'Y';/* size level*/
   /* MOVE OBVREC.SY-SZ-ID(OBWTSF6S) TO VOBXRF01.SY5SZID;*/
   /* ELSE;                            /* product level*/
  VOBXRF01.SY5SZID = 0;
   /* END;*/

end // end OB0VS-FMT-VOBXRF01

// CALCULATE CU-CUSKU-IND
Function OB0VS-GET-CUSKU()

  set SQLCA empty;

  KUCREC.KUCCOID = OB1REC.KUCCOID;

  call "IO0240" ("S ", SQLCA, KUCREC) {isNoRefresh = yes, isExternal = yes}; /**/

  if (SQLCA.VAGen_SQLCODE == 0) /* check for good return code*/
    OB0VS07(); /* determine customer info*/
  else
    TA1REC.TA1DBASE = "DCUST   "; /* data base name*/
    TA1REC.TA1TBLVU = "VCMPNY01"; /* table view*/
    TA1REC.TA1LOCAT[1] = "S       "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "IO0240  "; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OB0VS55 "; /* statement group*/
    TA1REC.TA1LOCAT[4] = "        "; /* extra key*/
    if (SQLCA.VAGen_SQLCODE == -911) /* deadlock*/
      OBWREC.OBWER911 = "Y"; /* show err*/
      XSOBS04(); /* no rollback, restart appl*/
    else
      XSOBEDC(); /* abort routine - no reset done*/
    end
  end

end // end OB0VS-GET-CUSKU

// GET DATABASE RECORDS
Function OB0VS-GET-DATA()

  OB0VS-GET-CUSKU(); /* get cusku info*/

  OB0VS-GET-OB2REC(); /* get order item record*/

  OB0VS05(); /* get xref record with overrides*/

  if (WCU1710.WCU1710-XREF-EXISTS-FL[1] == "Y") /* xref rec found*/
    OB0VW01.OB0VW-XREF-EXISTS = "Y";
    OB0VS-GET-VCUCPX01(); /* get xref record without overrides*/
                                   /* (using VCUCPX01)*/
  else /* xref rec not found*/
    OB0VW01.OB0VW-XREF-EXISTS = "N";
  end

  if (WCU1710.WCU1710-CU-OVRD-EXISTS-FL[1] == "Y") /* override rec found*/
    OB0VW01.OB0VW-OVRD-EXISTS = "Y";
    OB0VS-GET-VBCPOX02(); /* get override rec without xref rec*/
  else /* override rec not found*/
    OB0VW01.OB0VW-OVRD-EXISTS = "N";
  end

  if (WCU1710.OP-SMPL-RQT-ID != " "
   || WCU1710.CU-BUY-SESN-ID != " "
   || WCU1710.CU-COST-ID != " "
   || WCU1710.OP-CASE-LOT-NBR != " ") /* companion record found*/
    OB0VW01.OB0VW-COMP-EXISTS = "Y";
    OB0VS-GET-VOBXRF01(); /* get the companion record*/
  else /* companion rec not found*/
    OB0VW01.OB0VW-COMP-EXISTS = "N";
  end

end // end OB0VS-GET-DATA

// GET LINE ITEM
Function OB0VS-GET-OB2REC()

  set OB2REC empty; /* order item record*/
  set SQLCA empty;
  set OBKREC empty; /* task record*/

  OB2REC.OP1PARTN = OB1REC.OP1PARTN; /* part char*/
  OB2REC.OP1CUOID = OB1REC.OP1CUOID; /* order nbr*/
  OB2REC.OP1NORID = OB1REC.OP1NORID; /* nike ord id*/
  OB2REC.OP2LNINB = OBWREC.OBWLNINB; /* line item nbr*/

  OBKREC.OBKTASK = "S "; /* select task*/

  call "IO5170" (OBKREC, SQLCA, OB2REC) {isNoRefresh = yes, isExternal = yes}; /* i/o mod-select scan*/

  if (SQLCA.VAGen_SQLCODE == 0) /* good return code*/
     /* next sentence*/
  else /* not good return code*/
    TA1REC.TA1DBASE = "DORDB   "; /* data base name*/
    TA1REC.TA1TBLVU = "VBITEM01"; /* table view*/
    TA1REC.TA1LOCAT[1] = "S       "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "IO5170  "; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OB0VS-GE"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "T-OB2REC"; /* extra key*/
    if (SQLCA.VAGen_SQLCODE == -911) /* deadlock*/
      OBWREC.OBWER911 = "Y"; /* show err*/
      XSOBS04(); /* no rollback, restart appl*/
    else
      XSOBEDC(); /* abort routine - no reset done*/
    end
  end

end // end OB0VS-GET-OB2REC

// GET XREF OVERRIDE INFO
Function OB0VS-GET-VBCPOX02()

  set VBCPOX02 empty; /* task record*/
  set SQLCA empty;

  VBCPOX02.OP1PARTN = OB1REC.OP1PARTN; /* ord part char*/
  VBCPOX02.OP1CUOID = OB1REC.OP1CUOID; /* customer order id*/
  VBCPOX02.OP1NORID = OB1REC.OP1NORID; /* nike order id*/
  VBCPOX02.OP2LNINB = OB2REC.OP2LNINB; /* order line item*/
  if (OB0VW01.OB0VW-SIZE-LEVEL-CUSTOMER == "Y") /* size level*/
    VBCPOX02.SY5SZID = OBVREC.SY-SZ-ID[OBWTSF6S]; /* nike size*/
  else /* product level*/
    VBCPOX02.SY5SZID = 0;
  end

  call "VBCPOX02" ("S ", SQLCA, VBCPOX02) {isNoRefresh = yes, isExternal = yes}; /**/

  if (SQLCA.VAGen_SQLCODE == 0) /* good return code*/
    OB0VW01.OB0VW-OVRD-EXISTS = "Y";
  else /* not good return code*/
    if (SQLCA.VAGen_SQLCODE == 100)
      OB0VW01.OB0VW-OVRD-EXISTS = "N";
    else
      TA1REC.TA1DBASE = "DORDB   "; /* data base name*/
      TA1REC.TA1TBLVU = "VBCPOX02"; /* table view*/
      TA1REC.TA1LOCAT[2] = "VBCPOX02"; /* i/o mod name*/
      TA1REC.TA1LOCAT[3] = "OB0VS-GE"; /* statement group*/
      TA1REC.TA1LOCAT[4] = "T-VBCPOX"; /* extra key*/
      if (SQLCA.VAGen_SQLCODE == -911) /* deadlock*/
        OBWREC.OBWER911 = "Y"; /* show err*/
        XSOBS04(); /* no rollback, restart appl*/
      else
        XSOBEDC(); /* abort routine - no reset done*/
      end
    end
  end

end // end OB0VS-GET-VBCPOX02

// GET STYLE/COLOR DESCRIPTION
Function OB0VS-GET-VCOLOR02()

  set SYCREC empty;
  set SQLCA empty;

  SYCREC.SY1STNBR = WCU1710.WCU1710-IN-SY-STY-NBR; /* style number*/
  SYCREC.SY2CLRID = WCU1710.WCU1710-IN-SY-COLR-CD-ID; /* color id*/
  SYCREC.XDMCD = WCU1710.WCU1710-IN-XDM-DIM-CD; /* dimension*/
  SYCREC.XGPCD = WCU1710.WCU1710-IN-XGP-GPC-CD; /* gpc*/

  call "IO0560" ("S ", SQLCA, SYCREC) {isNoRefresh = yes, isExternal = yes}; /* call i/o mod for inquiry*/

  if (SQLCA.VAGen_SQLCODE == 0   /* check for good rc*/
   || SQLCA.VAGen_SQLCODE == 100 /* product not found*/
   || SQLCA.VAGen_SQLCODE == -911) /* database busy*/
  /* next sentence*/
  else
    TA1REC.TA1DBASE = "DPROD   "; /* data base name*/
    TA1REC.TA1TBLVU = "VCOLOR02"; /* table view*/
    TA1REC.TA1LOCAT[1] = "S       "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "IO0560  "; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OB0VS-GE"; /* statement group*/
    TA1REC.TA1LOCAT[4] = WCU1710.SY-STY-NBR[1]; /* style nbr*/
    XSOBEDC(); /* abort routine - no reset done*/
  end

end // end OB0VS-GET-VCOLOR02

// GET XREF REC WITHOUT OVERRIDES
Function OB0VS-GET-VCUCPX01()

  set SQLCA empty;

  VCUCPX01.CU-CUSKU-ID = OB0VW01.CU-CUSKU-ID;

  VCUCPX01.SY1STNBR = OB2REC.SY1STNBR; /* style nbr*/
  VCUCPX01.SY2CLRID = OB2REC.SY2CLRID; /* color*/
  VCUCPX01.XDMCD = OB2REC.XDMCD; /* dimension*/
  VCUCPX01.XQACD = OB2REC.XQACD; /* quality code*/
  VCUCPX01.XGPCD = OB2REC.XGPCD; /* gpc code*/
   /* tcs include 04/21/99*/
  if ((KUCREC.KUKPCOID == 29 
   || KUCREC.KUKPCOID == 32) /* if Penney's apparel, then we want*/
   && OB2REC.XGPCD == "03")  /* to use the dept nbr*/
    VCUCPX01.XNX-DEPT-ID-XREF = OB1REC.XNXCD; /* dept*/
  else
    VCUCPX01.XNX-DEPT-ID-XREF = 0; /* all other cust don't use dept*/
  end

  VCUCPX01.CU-PROD-XREF-EDT = OB1REC.OP1CUNDT; /* prod eff date*/
  if (OB0VW01.OB0VW-SIZE-LEVEL-CUSTOMER == "Y") /* size level*/
    VCUCPX01.SY5SZID = OBVREC.SY-SZ-ID[OBWTSF6S]; /* nk size*/
  else /* product level*/
    VCUCPX01.SY5SZID = 0; /* nk size*/
  end

  call "VCUCPX01" ("SB", SQLCA, VCUCPX01) {isExternal = yes};

  if (SQLCA.VAGen_SQLCODE == 0) /* good return code*/
     /* next sentence*/
  else /* not good return code*/
    TA1REC.TA1DBASE = "DCUST   "; /* data base name*/
    TA1REC.TA1TBLVU = "VCUCPX01"; /* table view*/
    TA1REC.TA1LOCAT[1] = "SB      "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "VCUCPX01"; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OB0VS47 "; /* statement group*/
    TA1REC.TA1LOCAT[4] = "        "; /* extra key*/
    if (SQLCA.VAGen_SQLCODE == -911) /* deadlock*/
      OBWREC.OBWER911 = "Y"; /* show err*/
      XSOBS04(); /* no rollback, restart appl*/
    else
      XSOBEDC(); /* abort routine - no reset done*/
    end
  end

end // end OB0VS-GET-VCUCPX01

// SELECT VOBXRF01
Function OB0VS-GET-VOBXRF01()

  set VOBXRF01 empty;

  VOBXRF01.OP1PARTN = OB1REC.OP1PARTN;
  VOBXRF01.OP1CUOID = OB1REC.OP1CUOID;
  VOBXRF01.OP1NORID = OB1REC.OP1NORID;
  VOBXRF01.OP2LNINB = OB2REC.OP2LNINB;
  VOBXRF01.SY5SZID = 0;

  set SQLCA empty;

  call "VOBXRF01" ("S ", SQLCA, VOBXRF01) {isNoRefresh = yes, isExternal = yes}; /**/

   /* check db2 return code*/

  if (SQLCA.VAGen_SQLCODE == 0) /* check for good rc*/
    OB0VW01.OB0VW-COMP-EXISTS = "Y";
  else
    if (SQLCA.VAGen_SQLCODE == 100) /* CHECK FOR GOOD RC*/
      OB0VW01.OB0VW-COMP-EXISTS = "N";
    else
      TA1REC.TA1DBASE = "DORDB   "; /* data base name*/
      TA1REC.TA1TBLVU = "VOBXRF01"; /* table view*/
      TA1REC.TA1LOCAT[1] = "S       "; /* calling option*/
      TA1REC.TA1LOCAT[2] = "VOBXRF01"; /* i/o mod name*/
      TA1REC.TA1LOCAT[3] = "OB0VS-GE"; /* statement group*/
      TA1REC.TA1LOCAT[4] = "T-VOBXRF"; /* extra key*/
      if (SQLCA.VAGen_SQLCODE == -911) /* deadlock*/
        OBWREC.OBWER911 = "Y"; /* show err*/
        XSOBS04(); /* no rollback, restart appl*/
      else
        XSOBEDC(); /* abort routine - no reset done*/
      end
    end
  end



end // end OB0VS-GET-VOBXRF01

// GET SIZE DESCRIPTION
Function OB0VS-GET-VSCALE01()

  set SY4REC empty;
  set SQLCA empty;

  SY4REC.SY4SZSCL = SYCREC.SY4SZSCL; /* style number*/

  call "IO0040" ("S ", SQLCA, SY4REC) {isNoRefresh = yes, isExternal = yes}; /* call i/o mod for inquiry*/

  if (SQLCA.VAGen_SQLCODE == 0   /* check for good rc*/
   || SQLCA.VAGen_SQLCODE == 100 /* product not found*/
   || SQLCA.VAGen_SQLCODE == -911) /* database busy*/
  /* next sentence*/
  else
    TA1REC.TA1DBASE = "DPROD   "; /* data base name*/
    TA1REC.TA1TBLVU = "VSCALE01"; /* table view*/
    TA1REC.TA1LOCAT[1] = "S       "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "IO0040  "; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OB0VS-GE"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "T-SY4REC"; /* statement group*/
    XSOBEDC(); /* abort routine - no reset done*/
  end

end // end OB0VS-GET-VSCALE01

// GET WCU1710
Function OB0VS-GET-WCU1710()

  WCU1710.WCU1710-IN-DORDB-IND = "Y"; /* DORDB database*/
  WCU1710-IN-CU-CO-ID = OB1REC.KUCCOID; /* company id*/
  WCU1710-XNX-DEPT-ID-XREF = OB1REC.XNXCD; /* dept*/
  WCU1710-CU-PROD-XREF-EDT = OB1REC.OP1CUNDT; /* product eff date*/

  WCU1710-IN-OP-ORD-PART-CHAR = OB1REC.OP1PARTN; /* ord part char*/
  WCU1710-IN-OP-CUST-ORD-ID = OB1REC.OP1CUOID; /* cust ord id*/
  WCU1710-IN-OP-NIKE-ORD-ID = OB1REC.OP1NORID; /* nike ord id*/
  WCU1710-IN-OP-LINE-ITEM-NBR = OB2REC.OP2LNINB; /* order line item*/

  WCU1710-IN-XGP-GPC-CD = OB2REC.XGPCD; /* gpc code*/
  WCU1710-IN-SY-STY-NBR = OB2REC.SY1STNBR; /* style nbr*/
  WCU1710-IN-SY-COLR-CD-ID = OB2REC.SY2CLRID; /* color*/
  WCU1710-IN-XDM-DIM-CD = OB2REC.XDMCD; /* dimension*/
  WCU1710-IN-SY-SZ-ID = OBVREC.SY-SZ-ID[OBWTSF6S]; /* nike size*/
  WCU1710-IN-XQA-QUAL-CD = OB2REC.XQACD; /* quality code*/

  WCU1710-RETURN-CODE = 99;

  call "CU1710" (WCU1710) {isNoRefresh = yes, isExternal = yes}; /* get xref rec for item/size*/

end // end OB0VS-GET-WCU1710

// REFRESH FROM CUST XREF REC
Function OB0VS-PF21-MOVES()

  OB0VM001.CU-CUST-PROD-ID = VCUCPX01.CU-CUST-PROD-ID;
  OB0VW03.CU-CUST-PROD-ID = VCUCPX01.CU-CUST-PROD-ID;
  set OB0VM001.CU-CUST-PROD-ID initialAttributes;

  OB0VM001.CU-PROD-NM = VCUCPX01.CU-PROD-NM;
  OB0VW03.CU-PROD-NM = VCUCPX01.CU-PROD-NM;
  set OB0VM001.CU-PROD-NM initialAttributes;

  OB0VM001.CU-PROD-COLR-NM = VCUCPX01.CU-PROD-COLR-NM;
  OB0VW03.CU-PROD-COLR-NM = VCUCPX01.CU-PROD-COLR-NM;
  set OB0VM001.CU-PROD-COLR-NM initialAttributes;

  OB0VM001.CU-PROD-SZ-ID = VCUCPX01.CU-PROD-SZ-ID;
  OB0VW03.CU-PROD-SZ-ID = VCUCPX01.CU-PROD-SZ-ID;
  set OB0VM001.CU-PROD-SZ-ID initialAttributes;

  OB0VM001.CU-PROD-SZ-NM = VCUCPX01.CU-PROD-SZ-NM;
  OB0VW03.CU-PROD-SZ-NM = VCUCPX01.CU-PROD-SZ-NM;
  set OB0VM001.CU-PROD-SZ-NM initialAttributes;

  OB0VM001.CU-CUST-RTL-PRC = VCUCPX01.CU-CUST-RTL-PRC;
  OB0VW03.CU-CUST-RTL-PRC = VCUCPX01.CU-CUST-RTL-PRC;
  set OB0VM001.CU-CUST-RTL-PRC initialAttributes;

  OB0VM001.CU-CUST-SPCL-PRC = VCUCPX01.CU-CUST-SPCL-PRC;
  OB0VW03.CU-CUST-SPCL-PRC = VCUCPX01.CU-CUST-SPCL-PRC;
  set OB0VM001.CU-CUST-SPCL-PRC initialAttributes;

  OB0VM001.CU-SUGG-RTL-PRC = VCUCPX01.CU-SUGG-RTL-PRC;
  OB0VW03.CU-SUGG-RTL-PRC = VCUCPX01.CU-SUGG-RTL-PRC;
  set OB0VM001.CU-SUGG-RTL-PRC initialAttributes;

  OBWREC.OBWDT8 = VCUCPX01.CU-SPCL-PRC-EDT;
  XSOBDCM();
  OB0VM001.OB0VM-CU-SPCL-PRC-EDT = OBWREC.OBWDT6;
  OB0VW03.OB0VW-CU-SPCL-PRC-EDT-MAP = OBWREC.OBWDT6;
  OB0VW03.CU-SPCL-PRC-EDT = VCUCPX01.CU-SPCL-PRC-EDT;
  set OB0VM001.OB0VM-CU-SPCL-PRC-EDT initialAttributes;

  OB0VM001.CU-VEND-CLS-ID = VCUCPX01.CU-VEND-CLS-ID;
  OB0VW03.CU-VEND-CLS-ID = VCUCPX01.CU-VEND-CLS-ID;
  set OB0VM001.CU-VEND-CLS-ID initialAttributes;

  OB0VM001.CU-SKU-COMNT1 = VCUCPX01.CU-SKU-COMNT1;
  OB0VW03.CU-SKU-COMNT1 = VCUCPX01.CU-SKU-COMNT1;
  set OB0VM001.CU-SKU-COMNT1 initialAttributes;

  OB0VM001.CU-SKU-COMNT2 = VCUCPX01.CU-SKU-COMNT2;
  OB0VW03.CU-SKU-COMNT2 = VCUCPX01.CU-SKU-COMNT2;
  set OB0VM001.CU-SKU-COMNT2 initialAttributes;

  OB0VM001.CU-SKU-COMNT3 = VCUCPX01.CU-SKU-COMNT3;
  OB0VW03.CU-SKU-COMNT3 = VCUCPX01.CU-SKU-COMNT3;
  set OB0VM001.CU-SKU-COMNT3 initialAttributes;

end // end OB0VS-PF21-MOVES

// update temp storage
Function OB0VS-UPD-TS()


  OBVREC.OBV-CU-PROD-ID[OBWTSF6S] = OB0VM001.CU-CUST-PROD-ID;
  OBVREC.OBV-CU-PROD-NM[OBWTSF6S] = OB0VM001.CU-PROD-NM;
  OBVREC.OBV-CU-PROD-COLR-NM[OBWTSF6S] = OB0VM001.CU-PROD-COLR-NM;
  OBVREC.CU-PROD-SZ-ID[OBWTSF6S] = OB0VM001.CU-PROD-SZ-ID;

  if (OB0VW01.OB0VW-OVRD-EXISTS == "Y")
    OBVREC.CU-OVRD-EXISTS-FL[OBWTSF6S] = "Y";
  else
    OBVREC.CU-OVRD-EXISTS-FL[OBWTSF6S] = "N";
  end

  XSOBT6U();

end // end OB0VS-UPD-TS

// UPDATE DORDB.VBCPOX02
Function OB0VS-UPD-VBCPOX02()

  set SQLCA empty;

  OB0VS-FMT-VBCPOX02();

  VBCPOX02.ZZZCHGDT = OBWREC.ZZZCHGDT;
  VBCPOX02.ZZZCHGTM = OBWREC.ZZZCHGTM;

  call "VBCPOX02" ("U1", SQLCA, VBCPOX02) {isNoRefresh = yes, isExternal = yes}; /**/

  if (SQLCA.VAGen_SQLCODE == 0) /* check for good return code*/
    OB0VM001.CAMSG = "CUSTOMER CROSS REFERENCE OVERRIDE SUCCESSFULLY UPDATED";
    OB0VW01.OB0VW-OVRD-EXISTS = "Y";
  else
    TA1REC.TA1DBASE = "DORDB   "; /* data base name*/
    TA1REC.TA1TBLVU = "VBCPOX02"; /* table view*/
    TA1REC.TA1LOCAT[1] = "U1      "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "VBCPOX02"; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OB0VS-UP"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "D-VBCPOX"; /* extra key*/
    if (SQLCA.VAGen_SQLCODE == -911) /* deadlock*/
      OBWREC.OBWER911 = "Y"; /* show err*/
      XSOBS04(); /* no rollback, restart appl*/
    else
      XSOBEDC(); /* abort routine - no reset done*/
    end
  end


end // end OB0VS-UPD-VBCPOX02

// UPDATE DCUST.VCUCPX01
Function OB0VS-UPD-VCUCPX01()

  set SQLCA empty;

  VCUCPX01.ZZZCHGDT = OBWREC.ZZZCHGDT;
  VCUCPX01.ZZZCHGTM = OBWREC.ZZZCHGTM;

  call "VCUCPX01" ("U ", SQLCA, VCUCPX01) {isNoRefresh = yes, isExternal = yes};

  if (SQLCA.VAGen_SQLCODE == 0) /* check for good return code*/
    OB0VW01.OB0VW-XREF-EXISTS = "Y";
    OB0VM001.CAMSG = "CUSTOMER CROSS REFERENCE SUCCESSFULLY UPDATED";
  else /* other return code*/
    TA1REC.TA1DBASE = "DCUST   "; /* data base name*/
    TA1REC.TA1TBLVU = "VCUCPX01"; /* table view*/
    TA1REC.TA1LOCAT[1] = "U       "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "VCUCPX01"; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OB0VS-UP"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "D-VCUCPX"; /* extra key*/
    if (SQLCA.VAGen_SQLCODE == -911) /* deadlock*/
      OBWREC.OBWER911 = "Y"; /* show err*/
      XSOBS04(); /* no rollback, restart appl*/
    else
      XSOBEDC(); /* abort routine - no reset done*/
    end
  end

end // end OB0VS-UPD-VCUCPX01

// UPDATE DORDB.VOBXRF01
Function OB0VS-UPD-VOBXRF01()

  set SQLCA empty;

  OB0VS-FMT-VOBXRF01();

  VOBXRF01.ZZZCHGDT = OBWREC.ZZZCHGDT;
  VOBXRF01.ZZZCHGTM = OBWREC.ZZZCHGTM;

  call "VOBXRF01" ("U ", SQLCA, VOBXRF01) {isNoRefresh = yes, isExternal = yes}; /**/

  if (SQLCA.VAGen_SQLCODE == 0) /* check for good return code*/
    OB0VW01.OB0VW-COMP-EXISTS = "Y";
    OB0VM001.CAMSG = "UPDATE SUCCESSFUL";
  else
    TA1REC.TA1DBASE = "DORDB   "; /* data base name*/
    TA1REC.TA1TBLVU = "VOBXRF01"; /* table view*/
    TA1REC.TA1LOCAT[1] = "U       "; /* calling option*/
    TA1REC.TA1LOCAT[2] = "VOBXRF01"; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OB0VS-UP"; /* statement group*/
    TA1REC.TA1LOCAT[4] = "D-VOBXRF"; /* extra key*/
    if (SQLCA.VAGen_SQLCODE == -911) /* deadlock*/
      OBWREC.OBWER911 = "Y"; /* show err*/
      XSOBS04(); /* no rollback, restart appl*/
    else
      XSOBEDC(); /* abort routine - no reset done*/
    end
  end

end // end OB0VS-UPD-VOBXRF01

// INITIALIZE RECORDS & MAP
Function OB0VS01()

  set OB1REC empty;
  set OB2REC empty;
  set OBAREC empty;
  set OBBREC empty;
  set OBCREC empty;
  set OBDREC empty;
  set OBEREC empty;
  set OBFREC empty;
  set OB8REC empty;
  set OBVREC empty;
  set OBFEREC empty;
  set OBLEREC empty;
  set WCU1710 empty;
  set VCUCPX01 empty;
  set VBCPOX02 empty;
  set VOBXRF01 empty;
  set KUCREC empty;
  set TA1REC empty;
  set TA2REC empty;
  set TA5REC empty;
  set TAEREC empty;
  set OB0VW01 empty;
  set OB0VW02 empty;
  set OB0VW03 empty;
  set SQLCA empty;
  set ERRSQLCA empty;
  set OB0VM001 empty;
  set XX0XW01 empty;

  XX0XS01();
  OBWREC.ZZZCHGDT = XX0XW01.XX0XWDAT;
  OBWREC.ZZZCHGTM = XX0XW01.XX0XWTIM;

  TA1REC.TA1MAP = "OB0VM001"; /* map name*/

end // end OB0VS01

// GET XREF REC WITH OVERRIDES
Function OB0VS05()

  set WCU1710 empty;
  WCU1710.WCU1710-INQUIRY-OPTION = "1";

  OB0VS-GET-WCU1710();

  if (WCU1710.WCU1710-RETURN-CODE == 0 /* xref rec returned*/
   || WCU1710.WCU1710-RETURN-CODE == 1) /* no xref rec returned*/
  /* next sentence*/
  else
    TA1REC.TA1LOCAT[1] = WCU1710.WCU1710-RETURN-CODE; /* return code*/
    TA1REC.TA1LOCAT[2] = "CU1710  "; /* i/o mod name*/
    TA1REC.TA1LOCAT[3] = "OB0VS17"; /* statement group*/
    TAEREC.TAEDESC1 = "BAD RETURN FROM CU1710 - RETURN CODE = ";
    TAEREC.TAEDESC2 = WCU1710.WCU1710-RETURN-CODE;
    XSOBENR(); /* application return go to main menu*/
  end


end // end OB0VS05

// DETERMINE CUSTOMER INFO
Function OB0VS07()

   /* determine cu-cusku-id*/

  if (KUCREC.KUCSKIND == "C" || 
  KUCREC.KUCSKIND == "T")
    OB0VW01.CU-CUSKU-ID = KUCREC.KUCCOID;
  else
    if (KUCREC.KUCSKIND == "P")
      OB0VW01.CU-CUSKU-ID = KUCREC.KUKPCOID;
    else
      if (KUCREC.KUCSKIND == "R")
        OB0VW01.CU-CUSKU-ID = KUCREC.KUCGRPID;
      else
        if (KUCREC.KUCSKIND == "G")
          OB0VW01.CU-CUSKU-ID = 0;
        end
      end
    end
  end

   /* determine size level or product level customer*/

  if (KUCREC.CU-CUSKU-SZ-FL == "Y") /* size level customer*/
    OB0VW01.OB0VW-SIZE-LEVEL-CUSTOMER = "Y";
  else /* product level customer*/
    OB0VW01.OB0VW-SIZE-LEVEL-CUSTOMER = "N";
  end

end // end OB0VS07

// BUILD MAP
Function OB0VS10()

  OB0VM001.OB0VM-UPD-XREF-LIT = "DO YOU WANT TO UPDATE KG0E ? (Y/N)";

  if (OB0VW01.OB0VW-XREF-EXISTS == "Y") /* xref rec exists*/
    OB0VM001.OB0VM-UPD-XREF-QST = "Y"; /**/
  else
    OB0VM001.OB0VM-UPD-XREF-QST = " "; /**/
  end

  OB0VM001.OB0VM-OVRD-LIT = "OVERRIDES EXIST";
  OB0VM001.OB0VM-PF23-LIT = "23:DEL OVRD";

  OB0VS12(); /* move fields to the map*/
  OB0VS14(); /* move 'before converse' map fields to*/
                                   /* save area*/
  move OB0VW02 to OB0VW03 withV60Compat; /* make 'previous' and 'current' save*/
                                   /* areas equal*/

  OB0VS16(); /* reset field attributes*/

end // end OB0VS10

// MOVE FIELDS TO MAP AREA
Function OB0VS12()

  OB0VS-GET-VCOLOR02(); /* get style and color descriptions*/

  if (SQLCA.VAGen_SQLCODE == 0) /* description found*/
    OB0VM001.SY1STYNM = SYCREC.SY1STYNM; /* move short name*/
    OB0VM001.SY2CLRDS = SYCREC.SY2CLRDS; /* move color abbrev*/
  else
    if (SQLCA.VAGen_SQLCODE == 100) /* description not found*/
      OB0VM001.SY1STYNM = "INVALID PRODUCT";
      OB0VM001.SY2CLRDS = " "; /* blank out abbrev*/
    else
      if (SQLCA.VAGen_SQLCODE == -911) /* database busy*/
        OB0VM001.SY1STYNM = "PRODUCT BUSY";
        OB0VM001.SY2CLRDS = " "; /* blank out abbrev*/
      end
    end
  end

  if (OB0VW01.OB0VW-SIZE-LEVEL-CUSTOMER == "N") /* product level customer*/
    OB0VM001.SY4IDDSC = "ALL";
  else
    OB0VS-GET-VSCALE01(); /* get nike size description*/
    if (SQLCA.VAGen_SQLCODE == 0) /* description found*/
      if (WCU1710.WCU1710-IN-SY-SZ-ID == 0)
        OB0VM001.SY4IDDSC = "ALL";
      else
        sysVar.arrayIndex = WCU1710.WCU1710-IN-SY-SZ-ID;
        OB0VM001.SY4IDDSC = SY4REC.SY4IDDSC[sysVar.arrayIndex];
      end
    else
      if (SQLCA.VAGen_SQLCODE == 100) /* product not found*/
        OB0VM001.SY4IDDSC = "UNKWN";
      else
        if (SQLCA.VAGen_SQLCODE == -911) /* database is busy*/
          OB0VM001.SY4IDDSC = "BUSY";
        end
      end
    end
  end

  if (WCU1710.WCU1710-IN-XGP-GPC-CD == " ")
    OB0VM001.XGPDESC = " ";
  else
    sysVar.arrayIndex = 1;
    if (WCU1710.WCU1710-IN-XGP-GPC-CD in XGPTBL.XGPCD)
      OB0VM001.XGPDESC = XGPTBL.XGPDESC[sysVar.arrayIndex]; /* gpc code desc*/
    else
      OB0VM001.XGPDESC = "UNKNWN";
    end
  end

  if (WCU1710.WCU1710-IN-XQA-QUAL-CD == " ")
    OB0VM001.XQAABRV = " "; /* space out description*/
  else
    sysVar.arrayIndex = 1;
    if (WCU1710.WCU1710-IN-XQA-QUAL-CD in XQATBL.XQACD)
      OB0VM001.XQAABRV = XQATBL.XQAABRV[sysVar.arrayIndex];
    else
      OB0VM001.XQAABRV = "UNKNWN";
    end
  end

  if (WCU1710.WCU1710-IN-XDM-DIM-CD == " ")
    OB0VM001.XDMABRV = " "; /* space out abbrev*/
  else
    sysVar.arrayIndex = 1;
    if (WCU1710.WCU1710-IN-XDM-DIM-CD in XDMTBL.XDMCD)
      OB0VM001.XDMABRV = XDMTBL.XDMABRV[sysVar.arrayIndex]; /* dimension abbrev*/
    else
      OB0VM001.XDMABRV = "UNKNWN";
    end
  end

  OBWREC.OBWDT8 = OB1REC.OP1CUNDT;
  XSOBDCM(); /* convert date to map format*/
  OB0VM001.OB0VM-CU-PROD-XREF-EDT = OBWREC.OBWDT6;

  OBWREC.OBWDT8 = WCU1710.CU-SPCL-PRC-EDT[1];
  XSOBDCM(); /* convert date to map format*/
  OB0VM001.OB0VM-CU-SPCL-PRC-EDT = OBWREC.OBWDT6;

  OB0VM001.XGPCD = WCU1710.WCU1710-IN-XGP-GPC-CD;
  OB0VM001.OB0VMPRC = "OB0V010"; /* process name*/
  OB0VM001.OBWCDATE = OBWREC.OBWCDATE; /* current date*/
  OB0VM001.OBWORDER = OBWREC.OBWORDER; /* formatted order num*/
  OB0VM001.OBWCUST = OBWREC.OBWCUST; /* formatted company number*/
  OB0VM001.OP1CUPO = OBWREC.OP1CUPO; /* purchase order*/
  OB0VM001.KUMSTRNM = OBWREC.KUMSTRNM; /* store name*/
  OB0VM001.SY1STNBR = WCU1710.WCU1710-IN-SY-STY-NBR;
  OB0VM001.SY2CLRID = WCU1710.WCU1710-IN-SY-COLR-CD-ID;
  OB0VM001.XQACD = WCU1710.WCU1710-IN-XQA-QUAL-CD;
  OB0VM001.XDMCD = WCU1710.WCU1710-IN-XDM-DIM-CD;
  OB0VM001.CU-CUST-PROD-ID = WCU1710.CU-CUST-PROD-ID[1];
  OB0VM001.CU-PROD-NM = WCU1710.CU-PROD-NM[1];
  OB0VM001.CU-PROD-COLR-NM = WCU1710.CU-PROD-COLR-NM[1];
  OB0VM001.CU-PROD-SZ-ID = WCU1710.CU-PROD-SZ-ID[1];
  OB0VM001.CU-PROD-SZ-NM = WCU1710.CU-PROD-SZ-NM[1];
  OB0VM001.CU-CUST-RTL-PRC = WCU1710.CU-CUST-RTL-PRC[1];
  OB0VM001.CU-CUST-SPCL-PRC = WCU1710.CU-CUST-SPCL-PRC[1];
  OB0VM001.CU-SUGG-RTL-PRC = WCU1710.CU-SUGG-RTL-PRC[1];
  OB0VM001.CU-VEND-CLS-ID = WCU1710.CU-VEND-CLS-ID[1];
  OB0VM001.ZFC-CRCY-CD = OB1REC.ZFC-CRCY-CD;
  OB0VM001.CU-SKU-COMNT1 = WCU1710.CU-SKU-COMNT1[1];
  OB0VM001.CU-SKU-COMNT2 = WCU1710.CU-SKU-COMNT2[1];
  OB0VM001.CU-SKU-COMNT3 = WCU1710.CU-SKU-COMNT3[1];
  OB0VM001.OP-CASE-LOT-NBR = WCU1710.OP-CASE-LOT-NBR[1];
  OB0VM001.CU-BUY-SESN-ID = WCU1710.CU-BUY-SESN-ID[1];
  OB0VM001.OP-SMPL-RQT-ID = WCU1710.OP-SMPL-RQT-ID[1];
  OB0VM001.CU-COST-ID = WCU1710.CU-COST-ID[1];

end // end OB0VS12

// MOVE MAP AREA TO SAVE AREA
Function OB0VS14()

  OB0VW02.CU-CUST-PROD-ID = OB0VM001.CU-CUST-PROD-ID;
  OB0VW02.CU-PROD-NM = OB0VM001.CU-PROD-NM;
  OB0VW02.CU-PROD-COLR-NM = OB0VM001.CU-PROD-COLR-NM;

  OB0VW02.CU-PROD-SZ-ID = OB0VM001.CU-PROD-SZ-ID;
  OB0VW02.CU-PROD-SZ-NM = OB0VM001.CU-PROD-SZ-NM;

  OB0VW02.CU-CUST-RTL-PRC = OB0VM001.CU-CUST-RTL-PRC;
  OB0VW02.CU-CUST-SPCL-PRC = OB0VM001.CU-CUST-SPCL-PRC;
  OB0VW02.CU-SUGG-RTL-PRC = OB0VM001.CU-SUGG-RTL-PRC;

  OB0VW02.OB0VW-CU-SPCL-PRC-EDT-MAP = OB0VM001.OB0VM-CU-SPCL-PRC-EDT;
  OBWREC.OBWDT6 = OB0VM001.OB0VM-CU-SPCL-PRC-EDT;
  XSOBDMC(); /* convert date to db2 format*/
  OB0VW02.CU-SPCL-PRC-EDT = OBWREC.OBWDT8;

  OB0VW02.CU-VEND-CLS-ID = OB0VM001.CU-VEND-CLS-ID;

  OB0VW02.CU-SKU-COMNT1 = OB0VM001.CU-SKU-COMNT1;
  OB0VW02.CU-SKU-COMNT2 = OB0VM001.CU-SKU-COMNT2;
  OB0VW02.CU-SKU-COMNT3 = OB0VM001.CU-SKU-COMNT3;

  OB0VW02.OP-CASE-LOT-NBR = OB0VM001.OP-CASE-LOT-NBR;
  OB0VW02.CU-BUY-SESN-ID = OB0VM001.CU-BUY-SESN-ID;
  OB0VW02.OP-SMPL-RQT-ID = OB0VM001.OP-SMPL-RQT-ID;
  OB0VW02.CU-COST-ID = OB0VM001.CU-COST-ID;

end // end OB0VS14

// SET FIELD ATTRIBUTES
Function OB0VS16()

  if (OB1REC.YOBCD == "XL" /* cancelled*/
   || OB1REC.YOBCD == "CA" /* cleared availability*/
   || OB1REC.YOBCD == "LP" /* lost demand reported*/
   || OB1REC.YOBCD == "PD") /* postponed demand reported*/
    OB0VS20(); /* set fields autoskip*/
  else
    OB0VS22(); /* set fields defined*/
  end

  OB0VS24(); /* set override fields bright*/

end // end OB0VS16

// SET FIELDS AUTOSKIP
Function OB0VS20()

  set OB0VM001.CU-CUST-PROD-ID skip;
  set OB0VM001.CU-PROD-NM skip;
  set OB0VM001.CU-PROD-COLR-NM skip;
  set OB0VM001.CU-PROD-SZ-ID skip;
  set OB0VM001.CU-PROD-SZ-NM skip;
  set OB0VM001.CU-BUY-SESN-ID skip;
  set OB0VM001.OP-SMPL-RQT-ID skip;
  set OB0VM001.CU-COST-ID skip;
  set OB0VM001.OP-CASE-LOT-NBR skip;
  set OB0VM001.SY1STNBR skip;
  set OB0VM001.SY2CLRID skip;
  set OB0VM001.SY4IDDSC skip;
  set OB0VM001.XDMCD skip;
  set OB0VM001.XGPCD skip;
  set OB0VM001.XQACD skip;
  set OB0VM001.CU-CUST-RTL-PRC skip;
  set OB0VM001.CU-CUST-SPCL-PRC skip;
  set OB0VM001.CU-SUGG-RTL-PRC skip;
  set OB0VM001.OB0VM-CU-SPCL-PRC-EDT skip;
  set OB0VM001.CU-VEND-CLS-ID skip;
  set OB0VM001.CU-SKU-COMNT1 skip;
  set OB0VM001.CU-SKU-COMNT2 skip;
  set OB0VM001.CU-SKU-COMNT3 skip;
  set OB0VM001.ZFC-CRCY-CD skip;

  OB0VM001.CAMSG = "ORDERS IN THIS STATUS ARE VIEW ONLY";

end // end OB0VS20

// SET FIELDS DEFINED
Function OB0VS22()

  set OB0VM001.CU-CUST-PROD-ID cursor, initialAttributes;
  set OB0VM001.CU-PROD-NM initialAttributes;
  set OB0VM001.CU-PROD-COLR-NM initialAttributes;
  set OB0VM001.CU-PROD-SZ-ID initialAttributes;
  set OB0VM001.CU-PROD-SZ-NM initialAttributes;
  set OB0VM001.CU-BUY-SESN-ID initialAttributes;
  set OB0VM001.OP-SMPL-RQT-ID initialAttributes;
  set OB0VM001.CU-COST-ID initialAttributes;
  set OB0VM001.OP-CASE-LOT-NBR initialAttributes;
  set OB0VM001.SY1STNBR initialAttributes;
  set OB0VM001.SY2CLRID initialAttributes;
  set OB0VM001.SY4IDDSC initialAttributes;
  set OB0VM001.XDMCD initialAttributes;
  set OB0VM001.XGPCD initialAttributes;
  set OB0VM001.XQACD initialAttributes;
  set OB0VM001.CU-CUST-RTL-PRC initialAttributes;
  set OB0VM001.CU-CUST-SPCL-PRC initialAttributes;
  set OB0VM001.CU-SUGG-RTL-PRC initialAttributes;
  set OB0VM001.OB0VM-CU-SPCL-PRC-EDT initialAttributes;
  set OB0VM001.CU-VEND-CLS-ID initialAttributes;
  set OB0VM001.CU-SKU-COMNT1 initialAttributes;
  set OB0VM001.CU-SKU-COMNT2 initialAttributes;
  set OB0VM001.CU-SKU-COMNT3 initialAttributes;
  set OB0VM001.ZFC-CRCY-CD initialAttributes;

end // end OB0VS22

// SET OVRD FIELDS BRIGHT
Function OB0VS24()

  if (OB0VW01.OB0VW-OVRD-EXISTS == "N") /* an override record doesn't exist*/

    set OB0VM001.CU-CUST-PROD-ID normal;
    set OB0VM001.CU-PROD-NM normal;
    set OB0VM001.CU-PROD-COLR-NM normal;
    set OB0VM001.CU-PROD-SZ-ID normal;
    set OB0VM001.CU-PROD-SZ-NM normal;
    set OB0VM001.CU-CUST-RTL-PRC normal;
    set OB0VM001.CU-CUST-SPCL-PRC normal;
    set OB0VM001.CU-SUGG-RTL-PRC normal;
    set OB0VM001.OB0VM-CU-SPCL-PRC-EDT normal;
    set OB0VM001.CU-VEND-CLS-ID normal;
    set OB0VM001.CU-SKU-COMNT1 normal;
    set OB0VM001.CU-SKU-COMNT2 normal;
    set OB0VM001.CU-SKU-COMNT3 normal;

  else /* an override record exists so check*/
                                   /* individual fields*/
    if (OB0VW01.OB0VW-XREF-EXISTS == "Y"
    )
      if (OB0VW03.CU-CUST-PROD-ID == VCUCPX01.CU-CUST-PROD-ID)
        set OB0VM001.CU-CUST-PROD-ID normal;
      else
        if (VBCPOX02.CU-PROD-ID-OVRDFL == "Y")
          set OB0VM001.CU-CUST-PROD-ID reverse;
        else
          set OB0VM001.CU-CUST-PROD-ID normal;
        end
      end

      if (OB0VW03.CU-PROD-NM == VCUCPX01.CU-PROD-NM)
        set OB0VM001.CU-PROD-NM normal;
      else
        if (VBCPOX02.CU-PROD-NM-OVRDFL == "Y")
          set OB0VM001.CU-PROD-NM reverse;
        else
          set OB0VM001.CU-PROD-NM normal;
        end
      end

      if (OB0VW03.CU-PROD-COLR-NM == VCUCPX01.CU-PROD-COLR-NM)
        set OB0VM001.CU-PROD-COLR-NM normal;
      else
        if (VBCPOX02.CU-COLR-NM-OVRDFL == "Y")
          set OB0VM001.CU-PROD-COLR-NM reverse;
        else
          set OB0VM001.CU-PROD-COLR-NM normal;
        end
      end

      if (OB0VW03.CU-PROD-SZ-ID == VCUCPX01.CU-PROD-SZ-ID)
        set OB0VM001.CU-PROD-SZ-ID normal;
      else
        if (VBCPOX02.CU-SZ-ID-OVRDFL == "Y")
          set OB0VM001.CU-PROD-SZ-ID reverse;
        else
          set OB0VM001.CU-PROD-SZ-ID normal;
        end
      end

      if (OB0VW03.CU-PROD-SZ-NM == VCUCPX01.CU-PROD-SZ-NM)
        set OB0VM001.CU-PROD-SZ-NM normal;
      else
        if (VBCPOX02.CU-SZ-NM-OVRDFL == "Y")
          set OB0VM001.CU-PROD-SZ-NM reverse;
        else
          set OB0VM001.CU-PROD-SZ-NM normal;
        end
      end

      if (OB0VW03.CU-CUST-RTL-PRC == VCUCPX01.CU-CUST-RTL-PRC)
        set OB0VM001.CU-CUST-RTL-PRC normal;
      else
        if (VBCPOX02.CU-RTL-PRC-OVRDFL == "Y")
          set OB0VM001.CU-CUST-RTL-PRC reverse;
        else
          set OB0VM001.CU-CUST-RTL-PRC normal;
        end
      end

      if (OB0VW03.CU-CUST-SPCL-PRC == VCUCPX01.CU-CUST-SPCL-PRC)
        set OB0VM001.CU-CUST-SPCL-PRC normal;
      else
        if (VBCPOX02.CU-SPCL-PRC-OVRDFL == "Y")
          set OB0VM001.CU-CUST-SPCL-PRC reverse;
        else
          set OB0VM001.CU-CUST-SPCL-PRC normal;
        end
      end

      if (OB0VW03.CU-SUGG-RTL-PRC == VCUCPX01.CU-SUGG-RTL-PRC)
        set OB0VM001.CU-SUGG-RTL-PRC normal;
      else
        if (VBCPOX02.CU-SUGG-PRC-OVRDFL == "Y")
          set OB0VM001.CU-SUGG-RTL-PRC reverse;
        else
          set OB0VM001.CU-SUGG-RTL-PRC normal;
        end
      end

      if (OB0VW03.CU-SPCL-PRC-EDT == VCUCPX01.CU-SPCL-PRC-EDT)
        set OB0VM001.OB0VM-CU-SPCL-PRC-EDT normal;
      else
        if (VBCPOX02.CU-SPCL-EDT-OVRDFL == "Y")
          set OB0VM001.OB0VM-CU-SPCL-PRC-EDT reverse;
        else
          set OB0VM001.OB0VM-CU-SPCL-PRC-EDT normal;
        end
      end

      if (OB0VW03.CU-VEND-CLS-ID == VCUCPX01.CU-VEND-CLS-ID)
        set OB0VM001.CU-VEND-CLS-ID normal;
      else
        if (VBCPOX02.CU-VEND-CLS-OVRDFL == "Y")
          set OB0VM001.CU-VEND-CLS-ID reverse;
        else
          set OB0VM001.CU-VEND-CLS-ID normal;
        end
      end

      if (OB0VW03.CU-SKU-COMNT1 == VCUCPX01.CU-SKU-COMNT1)
        set OB0VM001.CU-SKU-COMNT1 normal;
      else
        if (VBCPOX02.CU-COMNT1-OVRDFL == "Y")
          set OB0VM001.CU-SKU-COMNT1 reverse;
        else
          set OB0VM001.CU-SKU-COMNT1 normal;
        end
      end

      if (OB0VW03.CU-SKU-COMNT2 == VCUCPX01.CU-SKU-COMNT2)
        set OB0VM001.CU-SKU-COMNT2 normal;
      else
        if (VBCPOX02.CU-COMNT2-OVRDFL == "Y")
          set OB0VM001.CU-SKU-COMNT2 reverse;
        else
          set OB0VM001.CU-SKU-COMNT2 normal;
        end
      end

      if (OB0VW03.CU-SKU-COMNT3 == VCUCPX01.CU-SKU-COMNT3)
        set OB0VM001.CU-SKU-COMNT3 normal;
      else
        if (VBCPOX02.CU-COMNT3-OVRDFL == "Y")
          set OB0VM001.CU-SKU-COMNT3 reverse;
        else
          set OB0VM001.CU-SKU-COMNT3 normal;
        end
      end

    else

      if (VBCPOX02.CU-PROD-ID-OVRDFL == "Y")
        set OB0VM001.CU-CUST-PROD-ID reverse;
      else
        set OB0VM001.CU-CUST-PROD-ID normal;
      end

      if (VBCPOX02.CU-PROD-NM-OVRDFL == "Y")
        set OB0VM001.CU-PROD-NM reverse;
      else
        set OB0VM001.CU-PROD-NM normal;
      end

      if (VBCPOX02.CU-COLR-NM-OVRDFL == "Y")
        set OB0VM001.CU-PROD-COLR-NM reverse;
      else
        set OB0VM001.CU-PROD-COLR-NM normal;
      end

      if (VBCPOX02.CU-SZ-ID-OVRDFL == "Y")
        set OB0VM001.CU-PROD-SZ-ID reverse;
      else
        set OB0VM001.CU-PROD-SZ-ID normal;
      end

      if (VBCPOX02.CU-SZ-NM-OVRDFL == "Y")
        set OB0VM001.CU-PROD-SZ-NM reverse;
      else
        set OB0VM001.CU-PROD-SZ-NM normal;
      end

      if (VBCPOX02.CU-RTL-PRC-OVRDFL == "Y")
        set OB0VM001.CU-CUST-RTL-PRC reverse;
      else
        set OB0VM001.CU-CUST-RTL-PRC normal;
      end

      if (VBCPOX02.CU-SPCL-PRC-OVRDFL == "Y")
        set OB0VM001.CU-CUST-SPCL-PRC reverse;
      else
        set OB0VM001.CU-CUST-SPCL-PRC normal;
      end

      if (VBCPOX02.CU-SUGG-PRC-OVRDFL == "Y")
        set OB0VM001.CU-SUGG-RTL-PRC reverse;
      else
        set OB0VM001.CU-SUGG-RTL-PRC normal;
      end

      if (VBCPOX02.CU-SPCL-EDT-OVRDFL == "Y")
        set OB0VM001.OB0VM-CU-SPCL-PRC-EDT reverse;
      else
        set OB0VM001.OB0VM-CU-SPCL-PRC-EDT normal;
      end

      if (VBCPOX02.CU-VEND-CLS-OVRDFL == "Y")
        set OB0VM001.CU-VEND-CLS-ID reverse;
      else
        set OB0VM001.CU-VEND-CLS-ID normal;
      end

      if (OB0VW03.CU-SKU-COMNT1 == VCUCPX01.CU-SKU-COMNT1)
        set OB0VM001.CU-SKU-COMNT1 normal;
      else
        if (VBCPOX02.CU-COMNT1-OVRDFL == "Y")
          set OB0VM001.CU-SKU-COMNT1 reverse;
        else
          set OB0VM001.CU-SKU-COMNT1 normal;
        end
      end

      if (VBCPOX02.CU-COMNT2-OVRDFL == "Y")
        set OB0VM001.CU-SKU-COMNT2 reverse;
      else
        set OB0VM001.CU-SKU-COMNT2 normal;
      end

      if (VBCPOX02.CU-COMNT3-OVRDFL == "Y")
        set OB0VM001.CU-SKU-COMNT3 reverse;
      else
        set OB0VM001.CU-SKU-COMNT3 normal;
      end
    end
  end

end // end OB0VS24

// DETERMINE XREF UPDATE QUESTION
Function OB0VS30()

  OB0VM001.OB0VM-UPD-XREF-QST = " "; /**/

  if (OB1REC.YOBCD == "XL" /* cancelled*/
   || OB1REC.YOBCD == "CA" /* cleared availability*/
   || OB1REC.YOBCD == "LP" /* lost demand*/
   || OB1REC.YOBCD == "PD" /* postponed demand reporting*/
   || OB0VW01.OB0VW-XREF-EXISTS == "N") /* no xref rec exists*/
    set OB0VM001.OB0VM-UPD-XREF-LIT skip, invisible;
    set OB0VM001.OB0VM-UPD-XREF-QST skip, invisible;
  else
    set OB0VM001.OB0VM-UPD-XREF-LIT bold, skip;
    set OB0VM001.OB0VM-UPD-XREF-QST initialAttributes;
  end

end // end OB0VS30

// DISPLAY OVERRIDE LITERAL
Function OB0VS32()

  if (OB0VW01.OB0VW-OVRD-EXISTS == "Y") /* override record exists*/
    set OB0VM001.OB0VM-OVRD-LIT reverse, skip;
  else /* no override record exists*/
    set OB0VM001.OB0VM-OVRD-LIT noHighLight, invisible, skip;
  end

end // end OB0VS32

// DISPLAY SIZE LITERAL
Function OB0VS34()

  if (OB0VW01.OB0VW-SIZE-LEVEL-CUSTOMER == "Y") /* size level customer*/
    OB0VM001.OB0VM-SIZE-LIT = "SIZE LEVEL";
  else
    OB0VM001.OB0VM-SIZE-LIT = "PRODUCT LEVEL";
  end

end // end OB0VS34

// DETERMINE DISPLAY OF PF22 KEY
Function OB0VS36()

  if (OB1REC.YOBCD == "XL" /* cancelled*/
   || OB1REC.YOBCD == "CA" /* cleared availability*/
   || OB1REC.YOBCD == "LP" /* lost demand*/
   || OB1REC.YOBCD == "PD" /* postponed demand reporting*/
   || OB0VW01.OB0VW-OVRD-EXISTS == "N") /* no ovrd rec exists*/
    set OB0VM001.OB0VM-PF23-LIT skip, invisible;
  else
    set OB0VM001.OB0VM-PF23-LIT initialAttributes;
  end

end // end OB0VS36

// DISPLAY SPCL MAKEUP/DUMMY MSG
Function OB0VS38()

  if (OB1REC.YOBCD != "XL" /* cancelled*/
   && OB1REC.YOBCD != "CA" /* cleared availability*/
   && OB1REC.YOBCD != "LP" /* lost demand*/
   && OB1REC.YOBCD != "PD") /* postponed demand reporting*/
    if (OB0VW01.OB0VW-XREF-EXISTS == "N") /* xref rec doesn't exist*/
      if (OB0VW01.OB0VW-OVRD-EXISTS == "Y") /* ovrd rec exists*/
        OB0VM001.CAMSG = "NOTE: PRODUCT NOT SET UP IN KG0E - ALL CHANGES WILL UPDATE KG0E";
      else /* ovrd rec doesn't exist*/
        OB0VM001.CAMSG = "NOTE:NO XREF DATA EXISTS - ENTER PROD ID AND HIT ENTER TO CREATE";
      end
    end
  end

end // end OB0VS38

// MOVE MAP TO SAVE AREA
Function OB0VS40()

  OB0VW03.CU-CUST-PROD-ID = OB0VM001.CU-CUST-PROD-ID;
  OB0VW03.CU-PROD-NM = OB0VM001.CU-PROD-NM;
  OB0VW03.CU-PROD-COLR-NM = OB0VM001.CU-PROD-COLR-NM;

  OB0VW03.CU-PROD-SZ-ID = OB0VM001.CU-PROD-SZ-ID;
  OB0VW03.CU-PROD-SZ-NM = OB0VM001.CU-PROD-SZ-NM;

  OB0VW03.CU-CUST-RTL-PRC = OB0VM001.CU-CUST-RTL-PRC;
  OB0VW03.CU-CUST-SPCL-PRC = OB0VM001.CU-CUST-SPCL-PRC;
  OB0VW03.CU-SUGG-RTL-PRC = OB0VM001.CU-SUGG-RTL-PRC;
  OB0VW03.OB0VW-CU-SPCL-PRC-EDT-MAP = OB0VM001.OB0VM-CU-SPCL-PRC-EDT;
  OBWREC.OBWDT6 = OB0VM001.OB0VM-CU-SPCL-PRC-EDT;
  XSOBDMC(); /* convert date to db2 format*/
  OB0VW03.CU-SPCL-PRC-EDT = OBWREC.OBWDT8;

  OB0VW03.CU-VEND-CLS-ID = OB0VM001.CU-VEND-CLS-ID;

  OB0VW03.CU-SKU-COMNT1 = OB0VM001.CU-SKU-COMNT1;
  OB0VW03.CU-SKU-COMNT2 = OB0VM001.CU-SKU-COMNT2;
  OB0VW03.CU-SKU-COMNT3 = OB0VM001.CU-SKU-COMNT3;

  OB0VW03.OP-CASE-LOT-NBR = OB0VM001.OP-CASE-LOT-NBR;
  OB0VW03.CU-BUY-SESN-ID = OB0VM001.CU-BUY-SESN-ID;
  OB0VW03.OP-SMPL-RQT-ID = OB0VM001.OP-SMPL-RQT-ID;
  OB0VW03.CU-COST-ID = OB0VM001.CU-COST-ID;

end // end OB0VS40

// EDIT MAP
Function OB0VS42()

  OB0VS50(); /* edit 'update xref' question*/

  OB0VS52(); /* edit special price effective date*/

  OB0VS54(); /* edit cust product size*/

  OB0VS56(); /* edit cust prod id*/

end // end OB0VS42

// UPDATE RECORDS WHEN NEEDED
Function OB0VS44()

  OB0VW01.OB0VW-XREF-UPDATE = "N";
  OB0VW01.OB0VW-OVRD-UPDATE = "N";
  OB0VW01.OB0VW-COMP-UPDATE = "N";

  OB0VW01.OB0VW-PF23-CONFIRM-FL = "N";

  if (OB0VW01.OB0VW-XREF-EXISTS == "Y") /* xref record exists*/
    if (OB0VM001.OB0VM-UPD-XREF-QST == "Y") /* user requested update to xref*/
      if (VCUCPX01.CU-PROD-XREF-EDT < OB1REC.OP1CUNDT)
        OB0VS64(); /* create xref rec*/
      else
        OB0VS58(); /* update xref;*/
      end
    else
      OB0VS60(); /* update override*/
    end
    OB0VS62(); /* update companion*/
  else /* no xref exists*/
    OB0VS64(); /* create xref rec and do db updates*/
  end

  if (OB0VW01.OB0VW-COMP-UPDATE == "I")
    OB0VS-ADD-VOBXRF01();
  end

  if (OB0VW01.OB0VW-COMP-UPDATE == "U")
    OB0VS-UPD-VOBXRF01();
  end

  if (OB0VW01.OB0VW-COMP-UPDATE == "D")
    OB0VS-DEL-VOBXRF01();
  end

  if (OB0VW01.OB0VW-OVRD-UPDATE == "I")
    OB0VS-ADD-VBCPOX02();
  end

  if (OB0VW01.OB0VW-OVRD-UPDATE == "U")
    OB0VS-UPD-VBCPOX02();
  end

  if (OB0VW01.OB0VW-OVRD-UPDATE == "D")
    OB0VS-DEL-VBCPOX02();
  end

  if (OB0VW01.OB0VW-XREF-UPDATE == "I")
    OB0VS-ADD-VCUCPX01();
  end

  if (OB0VW01.OB0VW-XREF-UPDATE == "U")
    OB0VS-UPD-VCUCPX01();
  end

end // end OB0VS44

// PROCESS PF KEYS
Function OB0VS46()

  if (converseVar.eventKey is pf23)
    if (OB0VW01.OB0VW-OVRD-EXISTS == "Y")
      if (OB1REC.YOBCD != "XL" /* cancelled*/
       && OB1REC.YOBCD != "CA" /* cleared availability*/
       && OB1REC.YOBCD != "LP" /* lost demand reported*/
       && OB1REC.YOBCD != "PD") /* postponed demand reported*/
        if (OB0VW01.OB0VW-PF23-CONFIRM-FL == "Y")
          OB0VS66(); /* process pf23*/
        else
          converseLib.validationFailed(209); /* hit PF23 again to confirm*/
          OB0VW01.OB0VW-PF23-CONFIRM-FL = "Y";
          exit stack;
        end
      end
    else
      converseLib.validationFailed(1); /* invalid pf key*/
      OBWREC.OBWERRFL = "Y"; /* set 'OB' error flag*/
    end
  end

  OB0VW01.OB0VW-PF23-CONFIRM-FL = "N";

  COMMAREA.CAUSERA = OBWREC.OBWGROUP;

  if (converseVar.eventKey is pf1)
    XSOBP01();
    OB0VM001.CAMSG = OBWREC.OBWHELP; /* to display if no help*/
  end

  if (converseVar.eventKey is pf3)
    XSOBP03();
  end

  if (converseVar.eventKey is pf4)
    XSOBP04();
  end

  if (converseVar.eventKey is pf5)
    XSOBP05();
  end

  if (converseVar.eventKey is pf6)
    XSOBP06();
  end

  if (converseVar.eventKey is pf9)
    XSOBP09();
  end

  if (converseVar.eventKey is pf11)
    XSOBP11();
  end

  if (converseVar.eventKey is pf12)
    XSOBT6R(); /* read current TS page*/
    OB0VS-GET-DATA(); /* get database records*/
    OB0VS10(); /* rebuild map*/
  end

  if (converseVar.eventKey is pf17)
    XSOBP17();
  end

  if (converseVar.eventKey is pf19)
    XSOBP19();
  end

  if (converseVar.eventKey is pf20)
    XSOBP20();
  end

  if (converseVar.eventKey is pf21     /* pf21 hit*/
   && OB0VW01.OB0VW-XREF-EXISTS == "Y" /* xref rec exists*/
   && OB1REC.YOBCD != "XL"             /* cancelled*/
   && OB1REC.YOBCD != "CA"             /* cleared availability*/
   && OB1REC.YOBCD != "LP"             /* lost demand reported*/
   && OB1REC.YOBCD != "PD")            /* postponed demand reported*/
    OB0VS-GET-VCUCPX01(); /* get xref rec without overrides*/
    OB0VS-PF21-MOVES(); /* move the xref fields to map*/
  end

  if (converseVar.eventKey is pf1
   || converseVar.eventKey is pf12
   || converseVar.eventKey is pf21
   || converseVar.eventKey is pf23)
    /* next sentence*/
  else
    converseLib.validationFailed(1); /* invalid pf key*/
    OBWREC.OBWERRFL = "Y"; /* set 'OB' error flag*/
  end

end // end OB0VS46

// EDIT XREF UPDATE QUESTION
Function OB0VS50()

  if (OB1REC.YOBCD == "XL" /* cancelled*/
   || OB1REC.YOBCD == "CA" /* cleared availability*/
   || OB1REC.YOBCD == "LP" /* lost demand*/
   || OB1REC.YOBCD == "PD" /* postponed demand reporting*/
   || OB0VW01.OB0VW-XREF-EXISTS == "N") /* no xref rec exists*/
  /* no edits as question is not displayed*/
  else
    if (OB0VM001.OB0VM-UPD-XREF-QST != "Y" && 
    OB0VM001.OB0VM-UPD-XREF-QST != "N")
      set OB0VM001.OB0VM-UPD-XREF-QST cursor, bold;
      converseLib.validationFailed(018); /* response must be 'y' or 'n'*/
    end
  end

end // end OB0VS50

// EDIT SPECIAL PRC EFFECTIVE DT
Function OB0VS52()

  if (OB0VM001.OB0VM-CU-SPCL-PRC-EDT == 0)
    return;
  end

  OBWREC.OBWDT6 = OB0VM001.OB0VM-CU-SPCL-PRC-EDT;

  XSOBDED();

  if (TA2REC.TA2RTNCD == 0)
      /* next sentence*/
  else
    converseLib.validationFailed(189); /* special price effective date invalid*/
    OBWREC.OBWERRFL = "Y";
    set OB0VM001.OB0VM-CU-SPCL-PRC-EDT cursor, bold;
  end

end // end OB0VS52

// EDIT CUSTOMER PRODUCT SIZE
Function OB0VS54()

  if (OB0VW01.OB0VW-SIZE-LEVEL-CUSTOMER == "N") /* product level customer*/
    if (OB0VM001.CU-PROD-SZ-ID != " ")
      converseLib.validationFailed(211); /* product level customer - size must be*/
                                   /* spaces*/
      OBWREC.OBWERRFL = "Y";
      set OB0VM001.CU-PROD-SZ-ID cursor, bold;
    end
  end

end // end OB0VS54

// EDIT CUSTOMER PRODUCT ID
Function OB0VS56()

  if (OB0VM001.CU-CUST-PROD-ID == " ")
    converseLib.validationFailed(208); /* required field - cannot be blank*/
    OBWREC.OBWERRFL = "Y";
    set OB0VM001.CU-CUST-PROD-ID cursor, bold;
  end

   /* 02/09/00     VALIDATE RETAIL PRICES         START ***/

  if (OB0VM001.CU-CUST-RTL-PRC > 999.99)
    converseLib.validationFailed(258);
    OBWREC.OBWERRFL = "Y";
    set OB0VM001.CU-CUST-RTL-PRC cursor;
  end

  if (OB0VM001.CU-CUST-SPCL-PRC > 999.99)
    converseLib.validationFailed(258);
    OBWREC.OBWERRFL = "Y";
    set OB0VM001.CU-CUST-SPCL-PRC cursor;
  end

  if (OB0VM001.CU-SUGG-RTL-PRC > 999.99)
    converseLib.validationFailed(258);
    OBWREC.OBWERRFL = "Y";
    set OB0VM001.CU-SUGG-RTL-PRC cursor;
  end
   /* 02/09/00     VALIDATE RETAIL PRICES          END   ***/
end // end OB0VS56

// UPDATE XREF RECORD
Function OB0VS58()

  if (OB0VW02.OB0VW-XREF-OVRD-DATA-FIELDS == 
  OB0VW03.OB0VW-XREF-OVRD-DATA-FIELDS)
    return;
  end

  OB0VW-XREF-UPDATE = "U"; /* update xref rec with changes*/

  OB0VS-FMT-VCUCPX01(); /* format xref record*/

  if (OB0VW02.CU-CUST-PROD-ID != OB0VW03.CU-CUST-PROD-ID)
    VCUCPX01.CU-CUST-PROD-ID = OB0VW03.CU-CUST-PROD-ID;
  end

  if (OB0VW02.CU-PROD-NM != OB0VW03.CU-PROD-NM)
    VCUCPX01.CU-PROD-NM = OB0VW03.CU-PROD-NM;
  end

  if (OB0VW02.CU-PROD-COLR-NM != OB0VW03.CU-PROD-COLR-NM)
    VCUCPX01.CU-PROD-COLR-NM = OB0VW03.CU-PROD-COLR-NM;
  end

  if (OB0VW02.CU-PROD-SZ-ID != OB0VW03.CU-PROD-SZ-ID)
    VCUCPX01.CU-PROD-SZ-ID = OB0VW03.CU-PROD-SZ-ID;
  end

  if (OB0VW02.CU-PROD-SZ-NM != OB0VW03.CU-PROD-SZ-NM)
    VCUCPX01.CU-PROD-SZ-NM = OB0VW03.CU-PROD-SZ-NM;
  end

  if (OB0VW02.CU-CUST-RTL-PRC != OB0VW03.CU-CUST-RTL-PRC)
    VCUCPX01.CU-CUST-RTL-PRC = OB0VW03.CU-CUST-RTL-PRC;
  end

  if (OB0VW02.CU-CUST-SPCL-PRC != OB0VW03.CU-CUST-SPCL-PRC)
    VCUCPX01.CU-CUST-SPCL-PRC = OB0VW03.CU-CUST-SPCL-PRC;
  end

  if (OB0VW02.CU-SUGG-RTL-PRC != OB0VW03.CU-SUGG-RTL-PRC)
    VCUCPX01.CU-SUGG-RTL-PRC = OB0VW03.CU-SUGG-RTL-PRC;
  end

  if (OB0VW02.CU-SPCL-PRC-EDT != OB0VW03.CU-SPCL-PRC-EDT)
    VCUCPX01.CU-SPCL-PRC-EDT = OB0VW03.CU-SPCL-PRC-EDT;
  end

  if (OB0VW02.CU-VEND-CLS-ID != OB0VW03.CU-VEND-CLS-ID)
    VCUCPX01.CU-VEND-CLS-ID = OB0VW03.CU-VEND-CLS-ID;
  end

  if (OB0VW02.CU-SKU-COMNT1 != OB0VW03.CU-SKU-COMNT1)
    VCUCPX01.CU-SKU-COMNT1 = OB0VW03.CU-SKU-COMNT1;
  end

  if (OB0VW02.CU-SKU-COMNT2 != OB0VW03.CU-SKU-COMNT2)
    VCUCPX01.CU-SKU-COMNT2 = OB0VW03.CU-SKU-COMNT2;
  end

  if (OB0VW02.CU-SKU-COMNT3 != OB0VW03.CU-SKU-COMNT3)
    VCUCPX01.CU-SKU-COMNT3 = OB0VW03.CU-SKU-COMNT3;
  end

  if (OB0VW01.OB0VW-OVRD-EXISTS == "Y") /* an override rec exists*/
    if (VBCPOX02.CU-PROD-ID-OVRDFL == "Y") /* field was overidden*/
      if (OB0VW02.CU-CUST-PROD-ID != OB0VW03.CU-CUST-PROD-ID)
        VBCPOX02.CU-PROD-ID-OVRDFL = "N";
        VBCPOX02.CU-CUST-PROD-ID = " ";
      end
    end

    if (VBCPOX02.CU-PROD-NM-OVRDFL == "Y") /* field was overidden*/
      if (OB0VW02.CU-PROD-NM != OB0VW03.CU-PROD-NM)
        VBCPOX02.CU-PROD-NM-OVRDFL = "N";
        VBCPOX02.CU-PROD-NM = " ";
      end
    end

    if (VBCPOX02.CU-COLR-NM-OVRDFL == "Y") /* field was overidden*/
      if (OB0VW02.CU-PROD-COLR-NM != OB0VW03.CU-PROD-COLR-NM)
        VBCPOX02.CU-COLR-NM-OVRDFL = "N";
        VBCPOX02.CU-PROD-COLR-NM = " ";
      end
    end

    if (VBCPOX02.CU-SZ-ID-OVRDFL == "Y") /* field was overidden*/
      if (OB0VW02.CU-PROD-SZ-ID != OB0VW03.CU-PROD-SZ-ID)
        VBCPOX02.CU-SZ-ID-OVRDFL = "N";
        VBCPOX02.CU-PROD-SZ-ID = " ";
      end
    end

    if (VBCPOX02.CU-SZ-NM-OVRDFL == "Y") /* field was overidden*/
      if (OB0VW02.CU-PROD-SZ-NM != OB0VW03.CU-PROD-SZ-NM)
        VBCPOX02.CU-SZ-NM-OVRDFL = "N";
        VBCPOX02.CU-PROD-SZ-NM = " ";
      end
    end

    if (VBCPOX02.CU-RTL-PRC-OVRDFL == "Y") /* field was overidden*/
      if (OB0VW02.CU-CUST-RTL-PRC != OB0VW03.CU-CUST-RTL-PRC)
        VBCPOX02.CU-RTL-PRC-OVRDFL = "N";
        VBCPOX02.CU-CUST-RTL-PRC = 0;
      end
    end

    if (VBCPOX02.CU-SPCL-PRC-OVRDFL == "Y") /* field was overidden*/
      if (OB0VW02.CU-CUST-SPCL-PRC != OB0VW03.CU-CUST-SPCL-PRC)
        VBCPOX02.CU-SPCL-PRC-OVRDFL = "N";
        VBCPOX02.CU-CUST-SPCL-PRC = 0;
      end
    end

    if (VBCPOX02.CU-SUGG-PRC-OVRDFL == "Y") /* field was overidden*/
      if (OB0VW02.CU-SUGG-RTL-PRC != OB0VW03.CU-SUGG-RTL-PRC)
        VBCPOX02.CU-SUGG-PRC-OVRDFL = "N";
        VBCPOX02.CU-SUGG-RTL-PRC = 0;
      end
    end

    if (VBCPOX02.CU-SPCL-EDT-OVRDFL == "Y") /* field was overidden*/
      if (OB0VW02.CU-SPCL-PRC-EDT != OB0VW03.CU-SPCL-PRC-EDT)
        VBCPOX02.CU-SPCL-EDT-OVRDFL = "N";
        VBCPOX02.CU-SPCL-PRC-EDT = 0;
      end
    end

    if (VBCPOX02.CU-VEND-CLS-OVRDFL == "Y") /* field was overidden*/
      if (OB0VW02.CU-VEND-CLS-ID != OB0VW03.CU-VEND-CLS-ID)
        VBCPOX02.CU-VEND-CLS-OVRDFL = "N";
        VBCPOX02.CU-VEND-CLS-ID = " ";
      end
    end

    if (VBCPOX02.CU-COMNT1-OVRDFL == "Y") /* field was overidden*/
      if (OB0VW02.CU-SKU-COMNT1 != OB0VW03.CU-SKU-COMNT1)
        VBCPOX02.CU-COMNT1-OVRDFL = "N";
        VBCPOX02.CU-SKU-COMNT1 = " ";
      end
    end

    if (VBCPOX02.CU-COMNT2-OVRDFL == "Y") /* field was overidden*/
      if (OB0VW02.CU-SKU-COMNT2 != OB0VW03.CU-SKU-COMNT2)
        VBCPOX02.CU-COMNT2-OVRDFL = "N";
        VBCPOX02.CU-SKU-COMNT2 = " ";
      end
    end

    if (VBCPOX02.CU-COMNT3-OVRDFL == "Y") /* field was overidden*/
      if (OB0VW02.CU-SKU-COMNT3 != OB0VW03.CU-SKU-COMNT3)
        VBCPOX02.CU-COMNT3-OVRDFL = "N";
        VBCPOX02.CU-SKU-COMNT3 = " ";
      end
    end

    if (VBCPOX02.CU-PROD-ID-OVRDFL == "N"
     && VBCPOX02.CU-PROD-NM-OVRDFL == "N"
     && VBCPOX02.CU-SZ-ID-OVRDFL == "N"
     && VBCPOX02.CU-SZ-NM-OVRDFL == "N"
     && VBCPOX02.CU-VEND-CLS-OVRDFL == "N"
     && VBCPOX02.CU-RTL-PRC-OVRDFL == "N"
     && VBCPOX02.CU-SPCL-PRC-OVRDFL == "N"
     && VBCPOX02.CU-SPCL-EDT-OVRDFL == "N"
     && VBCPOX02.CU-SUGG-PRC-OVRDFL == "N"
     && VBCPOX02.CU-COMNT1-OVRDFL == "N"
     && VBCPOX02.CU-COMNT2-OVRDFL == "N"
     && VBCPOX02.CU-COMNT3-OVRDFL == "N")
      OB0VW01.OB0VW-OVRD-UPDATE = "D";
    else
      OB0VW01.OB0VW-OVRD-UPDATE = "U";
    end
  end

end // end OB0VS58

// UPDATE OVERRIDE RECORD
Function OB0VS60()

  if (OB0VW02.OB0VW-XREF-OVRD-DATA-FIELDS == 
  OB0VW03.OB0VW-XREF-OVRD-DATA-FIELDS)
    return;
  end

  if (OB0VW01.OB0VW-OVRD-EXISTS == "Y")

    OB0VS-GET-VCUCPX01(); /* get xref rec without overrides*/

    if (OB0VW02.CU-CUST-PROD-ID != OB0VW03.CU-CUST-PROD-ID)
      if (OB0VW03.CU-CUST-PROD-ID == VCUCPX01.CU-CUST-PROD-ID)
        VBCPOX02.CU-PROD-ID-OVRDFL = "N";
        VBCPOX02.CU-CUST-PROD-ID = " ";
      else
        VBCPOX02.CU-PROD-ID-OVRDFL = "Y";
        VBCPOX02.CU-CUST-PROD-ID = OB0VW03.CU-CUST-PROD-ID;
      end
    end

    if (OB0VW02.CU-PROD-NM != OB0VW03.CU-PROD-NM)
      if (OB0VW03.CU-PROD-NM == VCUCPX01.CU-PROD-NM)
        VBCPOX02.CU-PROD-NM-OVRDFL = "N";
        VBCPOX02.CU-PROD-NM = " ";
      else
        VBCPOX02.CU-PROD-NM-OVRDFL = "Y";
        VBCPOX02.CU-PROD-NM = OB0VW03.CU-PROD-NM;
      end
    end

    if (OB0VW02.CU-PROD-COLR-NM != OB0VW03.CU-PROD-COLR-NM)
      if (OB0VW03.CU-PROD-COLR-NM == VCUCPX01.CU-PROD-COLR-NM)
        VBCPOX02.CU-COLR-NM-OVRDFL = "N";
        VBCPOX02.CU-PROD-COLR-NM = " ";
      else
        VBCPOX02.CU-COLR-NM-OVRDFL = "Y";
        VBCPOX02.CU-PROD-COLR-NM = OB0VW03.CU-PROD-COLR-NM;
      end
    end

    if (OB0VW02.CU-PROD-SZ-ID != OB0VW03.CU-PROD-SZ-ID)
      if (OB0VW03.CU-PROD-SZ-ID == VCUCPX01.CU-PROD-SZ-ID)
        VBCPOX02.CU-SZ-ID-OVRDFL = "N";
        VBCPOX02.CU-PROD-SZ-ID = " ";
      else
        VBCPOX02.CU-SZ-ID-OVRDFL = "Y";
        VBCPOX02.CU-PROD-SZ-ID = OB0VW03.CU-PROD-SZ-ID;
      end
    end

    if (OB0VW02.CU-PROD-SZ-NM != OB0VW03.CU-PROD-SZ-NM)
      if (OB0VW03.CU-PROD-SZ-NM == VCUCPX01.CU-PROD-SZ-NM)
        VBCPOX02.CU-SZ-NM-OVRDFL = "N";
        VBCPOX02.CU-PROD-SZ-NM = " ";
      else
        VBCPOX02.CU-SZ-NM-OVRDFL = "Y";
        VBCPOX02.CU-PROD-SZ-NM = OB0VW03.CU-PROD-SZ-NM;
      end
    end

    if (OB0VW02.CU-CUST-RTL-PRC != OB0VW03.CU-CUST-RTL-PRC)
      if (OB0VW03.CU-CUST-RTL-PRC == VCUCPX01.CU-CUST-RTL-PRC)
        VBCPOX02.CU-RTL-PRC-OVRDFL = "N";
        VBCPOX02.CU-CUST-RTL-PRC = 0;
      else
        VBCPOX02.CU-RTL-PRC-OVRDFL = "Y";
        VBCPOX02.CU-CUST-RTL-PRC = OB0VW03.CU-CUST-RTL-PRC;
      end
    end

    if (OB0VW02.CU-CUST-SPCL-PRC != OB0VW03.CU-CUST-SPCL-PRC)
      if (OB0VW03.CU-CUST-SPCL-PRC == VCUCPX01.CU-CUST-SPCL-PRC)
        VBCPOX02.CU-SPCL-PRC-OVRDFL = "N";
        VBCPOX02.CU-CUST-SPCL-PRC = 0;
      else
        VBCPOX02.CU-SPCL-PRC-OVRDFL = "Y";
        VBCPOX02.CU-CUST-SPCL-PRC = OB0VW03.CU-CUST-SPCL-PRC;
      end
    end

    if (OB0VW02.CU-SUGG-RTL-PRC != OB0VW03.CU-SUGG-RTL-PRC)
      if (OB0VW03.CU-SUGG-RTL-PRC == VCUCPX01.CU-SUGG-RTL-PRC)
        VBCPOX02.CU-SUGG-PRC-OVRDFL = "N";
        VBCPOX02.CU-SUGG-RTL-PRC = 0;
      else
        VBCPOX02.CU-SUGG-PRC-OVRDFL = "Y";
        VBCPOX02.CU-SUGG-RTL-PRC = OB0VW03.CU-SUGG-RTL-PRC;
      end
    end

    if (OB0VW02.CU-SPCL-PRC-EDT != OB0VW03.CU-SPCL-PRC-EDT)

      if (OB0VW03.CU-SPCL-PRC-EDT == VCUCPX01.CU-SPCL-PRC-EDT)
        VBCPOX02.CU-SPCL-EDT-OVRDFL = "N";
        VBCPOX02.CU-SPCL-PRC-EDT = 0;
      else
        VBCPOX02.CU-SPCL-EDT-OVRDFL = "Y";
        VBCPOX02.CU-SPCL-PRC-EDT = OB0VW03.CU-SPCL-PRC-EDT;
      end
    end

    if (OB0VW02.CU-VEND-CLS-ID != OB0VW03.CU-VEND-CLS-ID)
      if (OB0VW03.CU-VEND-CLS-ID == VCUCPX01.CU-VEND-CLS-ID)
        VBCPOX02.CU-VEND-CLS-OVRDFL = "N";
        VBCPOX02.CU-VEND-CLS-ID = " ";
      else
        VBCPOX02.CU-VEND-CLS-OVRDFL = "Y";
        VBCPOX02.CU-VEND-CLS-ID = OB0VW03.CU-VEND-CLS-ID;
      end
    end

    if (OB0VW02.CU-SKU-COMNT1 != OB0VW03.CU-SKU-COMNT1)
      if (OB0VW03.CU-SKU-COMNT1 == VCUCPX01.CU-SKU-COMNT1)
        VBCPOX02.CU-COMNT1-OVRDFL = "N";
        VBCPOX02.CU-SKU-COMNT1 = " ";
      else
        VBCPOX02.CU-COMNT1-OVRDFL = "Y";
        VBCPOX02.CU-SKU-COMNT1 = OB0VW03.CU-SKU-COMNT1;
      end
    end

    if (OB0VW02.CU-SKU-COMNT2 != OB0VW03.CU-SKU-COMNT2)
      if (OB0VW03.CU-SKU-COMNT2 == VCUCPX01.CU-SKU-COMNT2)
        VBCPOX02.CU-COMNT2-OVRDFL = "N";
        VBCPOX02.CU-SKU-COMNT2 = " ";
      else
        VBCPOX02.CU-COMNT2-OVRDFL = "Y";
        VBCPOX02.CU-SKU-COMNT2 = OB0VW03.CU-SKU-COMNT2;
      end
    end

    if (OB0VW02.CU-SKU-COMNT3 != OB0VW03.CU-SKU-COMNT3)
      if (OB0VW03.CU-SKU-COMNT3 == VCUCPX01.CU-SKU-COMNT3)
        VBCPOX02.CU-COMNT3-OVRDFL = "N";
        VBCPOX02.CU-SKU-COMNT3 = " ";
      else
        VBCPOX02.CU-COMNT3-OVRDFL = "Y";
        VBCPOX02.CU-SKU-COMNT3 = OB0VW03.CU-SKU-COMNT3;
      end
    end

    if (VBCPOX02.CU-PROD-ID-OVRDFL == "N"
     && VBCPOX02.CU-PROD-NM-OVRDFL == "N"
     && VBCPOX02.CU-COLR-NM-OVRDFL == "N"
     && VBCPOX02.CU-SZ-ID-OVRDFL == "N"
     && VBCPOX02.CU-SZ-NM-OVRDFL == "N"
     && VBCPOX02.CU-VEND-CLS-OVRDFL == "N"
     && VBCPOX02.CU-RTL-PRC-OVRDFL == "N"
     && VBCPOX02.CU-SPCL-PRC-OVRDFL == "N"
     && VBCPOX02.CU-SPCL-EDT-OVRDFL == "N"
     && VBCPOX02.CU-SUGG-PRC-OVRDFL == "N"
     && VBCPOX02.CU-COMNT1-OVRDFL == "N"
     && VBCPOX02.CU-COMNT2-OVRDFL == "N"
     && VBCPOX02.CU-COMNT3-OVRDFL == "N")
      OB0VW01.OB0VW-OVRD-UPDATE = "D";
    else
      OB0VW01.OB0VW-OVRD-UPDATE = "U";
    end

  else


    OB0VW01.OB0VW-OVRD-UPDATE = "I";

    if (OB0VW02.CU-CUST-PROD-ID != OB0VW03.CU-CUST-PROD-ID)
      VBCPOX02.CU-PROD-ID-OVRDFL = "Y";
      VBCPOX02.CU-CUST-PROD-ID = OB0VW03.CU-CUST-PROD-ID;
    else
      VBCPOX02.CU-PROD-ID-OVRDFL = "N";
    end

    if (OB0VW02.CU-PROD-NM != OB0VW03.CU-PROD-NM)
      VBCPOX02.CU-PROD-NM-OVRDFL = "Y";
      VBCPOX02.CU-PROD-NM = OB0VW03.CU-PROD-NM;
    else
      VBCPOX02.CU-PROD-NM-OVRDFL = "N";
    end

    if (OB0VW02.CU-PROD-COLR-NM != OB0VW03.CU-PROD-COLR-NM)
      VBCPOX02.CU-COLR-NM-OVRDFL = "Y";
      VBCPOX02.CU-PROD-COLR-NM = OB0VW03.CU-PROD-COLR-NM;
    else
      VBCPOX02.CU-COLR-NM-OVRDFL = "N";
    end

    if (OB0VW02.CU-PROD-SZ-ID != OB0VW03.CU-PROD-SZ-ID)
      VBCPOX02.CU-SZ-ID-OVRDFL = "Y";
      VBCPOX02.CU-PROD-SZ-ID = OB0VW03.CU-PROD-SZ-ID;
    else
      VBCPOX02.CU-SZ-ID-OVRDFL = "N";
    end

    if (OB0VW02.CU-PROD-SZ-NM != OB0VW03.CU-PROD-SZ-NM)
      VBCPOX02.CU-SZ-NM-OVRDFL = "Y";
      VBCPOX02.CU-PROD-SZ-NM = OB0VW03.CU-PROD-SZ-NM;
    else
      VBCPOX02.CU-SZ-NM-OVRDFL = "N";
    end

    if (OB0VW02.CU-CUST-RTL-PRC != OB0VW03.CU-CUST-RTL-PRC)
      VBCPOX02.CU-RTL-PRC-OVRDFL = "Y";
      VBCPOX02.CU-CUST-RTL-PRC = OB0VW03.CU-CUST-RTL-PRC;
    else
      VBCPOX02.CU-RTL-PRC-OVRDFL = "N";
    end

    if (OB0VW02.CU-CUST-SPCL-PRC != OB0VW03.CU-CUST-SPCL-PRC)
      VBCPOX02.CU-SPCL-PRC-OVRDFL = "Y";
      VBCPOX02.CU-CUST-SPCL-PRC = OB0VW03.CU-CUST-SPCL-PRC;
    else
      VBCPOX02.CU-SPCL-PRC-OVRDFL = "N";
    end

    if (OB0VW02.CU-SUGG-RTL-PRC != OB0VW03.CU-SUGG-RTL-PRC)
      VBCPOX02.CU-SUGG-PRC-OVRDFL = "Y";
      VBCPOX02.CU-SUGG-RTL-PRC = OB0VW03.CU-SUGG-RTL-PRC;
    else
      VBCPOX02.CU-SUGG-PRC-OVRDFL = "N";
    end

    if (OB0VW02.CU-SPCL-PRC-EDT != OB0VW03.CU-SPCL-PRC-EDT)
      VBCPOX02.CU-SPCL-EDT-OVRDFL = "Y";
      VBCPOX02.CU-SPCL-PRC-EDT = OB0VW03.CU-SPCL-PRC-EDT;
    else
      VBCPOX02.CU-SPCL-EDT-OVRDFL = "N";
    end

    if (OB0VW02.CU-VEND-CLS-ID != OB0VW03.CU-VEND-CLS-ID)
      VBCPOX02.CU-VEND-CLS-OVRDFL = "Y";
      VBCPOX02.CU-VEND-CLS-ID = OB0VW03.CU-VEND-CLS-ID;
    else
      VBCPOX02.CU-VEND-CLS-OVRDFL = "N";
    end

    if (OB0VW02.CU-SKU-COMNT1 != OB0VW03.CU-SKU-COMNT1)
      VBCPOX02.CU-COMNT1-OVRDFL = "Y";
      VBCPOX02.CU-SKU-COMNT1 = OB0VW03.CU-SKU-COMNT1;
    else
      VBCPOX02.CU-COMNT1-OVRDFL = "N";
    end

    if (OB0VW02.CU-SKU-COMNT2 != OB0VW03.CU-SKU-COMNT2)
      VBCPOX02.CU-COMNT2-OVRDFL = "Y";
      VBCPOX02.CU-SKU-COMNT2 = OB0VW03.CU-SKU-COMNT2;
    else
      VBCPOX02.CU-COMNT2-OVRDFL = "N";
    end

    if (OB0VW02.CU-SKU-COMNT3 != OB0VW03.CU-SKU-COMNT3)
      VBCPOX02.CU-COMNT3-OVRDFL = "Y";
      VBCPOX02.CU-SKU-COMNT3 = OB0VW03.CU-SKU-COMNT3;
    else
      VBCPOX02.CU-COMNT3-OVRDFL = "N";
    end
  end

end // end OB0VS60

// UPDATE COMPANION RECORD
Function OB0VS62()

  if (OB0VW03.OB0VW-COMPANION-DATA-FIELDS != 
  OB0VW02.OB0VW-COMPANION-DATA-FIELDS) /* companion fields modified*/
    if (OB0VW01.OB0VW-COMP-EXISTS == "Y")
      if (OB0VW03.OB0VW-COMPANION-DATA-FIELDS == " ") /* blanked out*/
        OB0VW01.OB0VW-COMP-UPDATE = "D"; /* delete companion*/
      else
        OB0VW01.OB0VW-COMP-UPDATE = "U"; /* update companion*/
      end
    else
      OB0VW01.OB0VW-COMP-UPDATE = "I"; /* insert companion*/
    end
  end

end // end OB0VS62

// CREATE XREF REC/DO DB UPDATES
Function OB0VS64()

  OB0VS-FMT-VCUCPX01(); /* format xref record*/

  VCUCPX01.CU-PROD-XREF-EDT = OB1REC.OP1CUNDT;
  VCUCPX01.CU-CUST-PROD-ID = OB0VW03.CU-CUST-PROD-ID;
  VCUCPX01.CU-PROD-NM = OB0VW03.CU-PROD-NM;
  VCUCPX01.CU-PROD-COLR-NM = OB0VW03.CU-PROD-COLR-NM;
  VCUCPX01.CU-PROD-SZ-ID = OB0VW03.CU-PROD-SZ-ID;
  VCUCPX01.CU-PROD-SZ-NM = OB0VW03.CU-PROD-SZ-NM;
  VCUCPX01.CU-CUST-RTL-PRC = OB0VW03.CU-CUST-RTL-PRC;
  VCUCPX01.CU-CUST-SPCL-PRC = OB0VW03.CU-CUST-SPCL-PRC;
  VCUCPX01.CU-SUGG-RTL-PRC = OB0VW03.CU-SUGG-RTL-PRC;
  VCUCPX01.CU-SPCL-PRC-EDT = OB0VW03.CU-SPCL-PRC-EDT;
  VCUCPX01.CU-VEND-CLS-ID = OB0VW03.CU-VEND-CLS-ID;
  VCUCPX01.CU-SKU-COMNT1 = OB0VW03.CU-SKU-COMNT1;
  VCUCPX01.CU-SKU-COMNT2 = OB0VW03.CU-SKU-COMNT2;
  VCUCPX01.CU-SKU-COMNT3 = OB0VW03.CU-SKU-COMNT3;
  VCUCPX01.XXX-STAT = "A";

  OB0VW-XREF-UPDATE = "I"; /* insert xref record*/

  if (OB0VW01.OB0VW-OVRD-EXISTS == "Y")
    OB0VW01.OB0VW-OVRD-UPDATE = "D"; /* delete override rec*/
  end

end // end OB0VS64

// PROCESS PF22 KEY
Function OB0VS66()

  OB0VS-DEL-VBCPOX02(); /* delete the current override*/

  OB0VS-GET-VCUCPX01(); /* get xref rec without overrides*/

  OB0VM001.CU-CUST-PROD-ID = VCUCPX01.CU-CUST-PROD-ID;
  OB0VW03.CU-CUST-PROD-ID = VCUCPX01.CU-CUST-PROD-ID;

  OB0VM001.CU-PROD-NM = VCUCPX01.CU-PROD-NM;
  OB0VW03.CU-PROD-NM = VCUCPX01.CU-PROD-NM;

  OB0VM001.CU-PROD-COLR-NM = VCUCPX01.CU-PROD-COLR-NM;
  OB0VW03.CU-PROD-COLR-NM = VCUCPX01.CU-PROD-COLR-NM;

  OB0VM001.CU-PROD-SZ-ID = VCUCPX01.CU-PROD-SZ-ID;
  OB0VW03.CU-PROD-SZ-ID = VCUCPX01.CU-PROD-SZ-ID;

  OB0VM001.CU-PROD-SZ-NM = VCUCPX01.CU-PROD-SZ-NM;
  OB0VW03.CU-PROD-SZ-NM = VCUCPX01.CU-PROD-SZ-NM;

  OB0VM001.CU-CUST-RTL-PRC = VCUCPX01.CU-CUST-RTL-PRC;
  OB0VW03.CU-CUST-RTL-PRC = VCUCPX01.CU-CUST-RTL-PRC;

  OB0VM001.CU-CUST-SPCL-PRC = VCUCPX01.CU-CUST-SPCL-PRC;
  OB0VW03.CU-CUST-SPCL-PRC = VCUCPX01.CU-CUST-SPCL-PRC;

  OB0VM001.CU-SUGG-RTL-PRC = VCUCPX01.CU-SUGG-RTL-PRC;
  OB0VW03.CU-SUGG-RTL-PRC = VCUCPX01.CU-SUGG-RTL-PRC;

  OBWREC.OBWDT8 = VCUCPX01.CU-SPCL-PRC-EDT;
  XSOBDCM(); /* convert date to map format*/
  OB0VM001.OB0VM-CU-SPCL-PRC-EDT = OBWREC.OBWDT6;
  OB0VW03.OB0VW-CU-SPCL-PRC-EDT-MAP = OBWREC.OBWDT6;
  OB0VW03.CU-SPCL-PRC-EDT = VCUCPX01.CU-SPCL-PRC-EDT;

  OB0VM001.CU-VEND-CLS-ID = VCUCPX01.CU-VEND-CLS-ID;
  OB0VW03.CU-VEND-CLS-ID = VCUCPX01.CU-VEND-CLS-ID;

  OB0VM001.CU-SKU-COMNT1 = VCUCPX01.CU-SKU-COMNT1;
  OB0VW03.CU-SKU-COMNT1 = VCUCPX01.CU-SKU-COMNT1;

  OB0VM001.CU-SKU-COMNT2 = VCUCPX01.CU-SKU-COMNT2;
  OB0VW03.CU-SKU-COMNT2 = VCUCPX01.CU-SKU-COMNT2;

  OB0VM001.CU-SKU-COMNT3 = VCUCPX01.CU-SKU-COMNT3;
  OB0VW03.CU-SKU-COMNT3 = VCUCPX01.CU-SKU-COMNT3;

end // end OB0VS66

Record OB0VW01 type basicRecord
  10 OB0VW-WCU1710-EXISTS OB0VW-WCU1710-EXISTS ; 
  10 OB0VW-XREF-EXISTS OB0VW-XREF-EXISTS ; 
  10 OB0VW-OVRD-EXISTS OB0VW-OVRD-EXISTS ; 
  10 OB0VW-COMP-EXISTS OB0VW-COMP-EXISTS ; 
  10 OB0VW-OVRD-UPDATE OB0VW-OVRD-UPDATE ; 
  10 OB0VW-COMP-UPDATE OB0VW-COMP-UPDATE ; 
  10 OB0VW-XREF-UPDATE OB0VW-XREF-UPDATE ; 
  10 OB0VW-SIZE-LEVEL-CUSTOMER OB0VW-SIZE-LEVEL-CUSTOMER ; 
  10 OB0VW-PF23-CONFIRM-FL OB0VW-PF23-CONFIRM-FL ; 
  10 CU-CUSKU-ID CU-CUSKU-ID ; 
end // end OB0VW01

//*** RECORD=OB0VW02 ****
// Previous map detail record.
// ************************************************************
// *               Maintenance History Record                 *
// ************************************************************
// Log #     Date      Name      Description
// -----   --------    ----      -----------
//   001   10/10/96   DLIDDL     Record Creation
// ***********************
Record OB0VW02 type basicRecord
  5 OB0VW-PREV-MAP-FIELDS char(267) ; 
    10 OB0VW-XREF-OVRD-DATA-FIELDS char(221) ; 
      15 CU-CUST-PROD-ID char(25) ; // cu-cust-prod-id
      15 CU-PROD-NM char(30) ; // cu-prod-nm
      15 CU-PROD-COLR-NM char(30) ; // cu-prod-colr-nm
      15 CU-PROD-SZ-ID char(5) ; // cu-prod-sz-id
      15 CU-PROD-SZ-NM char(30) ; // cu-prod-sz-id
      15 CU-CUST-RTL-PRC decimal(13,2) ; // cu-cust-rtl-prc
      15 CU-CUST-SPCL-PRC decimal(13,2) ; // cu-cust-spcl-prc
      15 CU-SUGG-RTL-PRC decimal(13,2) ; // cu-sugg-rtl-prc
      15 OB0VW-CU-SPCL-PRC-EDT-MAP num(6) ; // cu-spcl-prc-edt
      15 CU-SPCL-PRC-EDT int ; // cu-spcl-prc-edt
      15 CU-VEND-CLS-ID char(10) ; // cu-vend-cls-id
      15 CU-SKU-COMNT1 char(20) ; // cu-sku-comnt1
      15 CU-SKU-COMNT2 char(20) ; // cu-sku-comnt2
      15 CU-SKU-COMNT3 char(20) ; // cu-sku-comnt3
    10 OB0VW-COMPANION-DATA-FIELDS char(46) ; 
      15 CU-BUY-SESN-ID char(6) ; // cu-buy-sesn-id
      15 OP-SMPL-RQT-ID char(18) ; // op-smpl-rqt-id
      15 CU-COST-ID char(10) ; // cu-cost-id
      15 OP-CASE-LOT-NBR char(12) ; // op-case-lot-nbr
end // end OB0VW02

//*** RECORD=OB0VW03 ****
// Current map detail record.
// ************************************************************
// *               Maintenance History Record                 *
// ************************************************************
// Log #     Date      Name      Description
// -----   --------    ----      -----------
//   001   10/10/96   DLIDDL     Record Creation
// ***********************
Record OB0VW03 type basicRecord
  5 OB0VW-CURR-MAP-FIELDS char(267) ; 
    10 OB0VW-XREF-OVRD-DATA-FIELDS char(221) ; 
      15 CU-CUST-PROD-ID char(25) ; // cu-cust-prod-id
      15 CU-PROD-NM char(30) ; // cu-prod-nm
      15 CU-PROD-COLR-NM char(30) ; // cu-prod-colr-nm
      15 CU-PROD-SZ-ID char(5) ; // cu-prod-sz-id
      15 CU-PROD-SZ-NM char(30) ; // cu-prod-sz-id
      15 CU-CUST-RTL-PRC decimal(13,2) ; // cu-cust-rtl-prc
      15 CU-CUST-SPCL-PRC decimal(13,2) ; // cu-cust-spcl-prc
      15 CU-SUGG-RTL-PRC decimal(13,2) ; // cu-sugg-rtl-prc
      15 OB0VW-CU-SPCL-PRC-EDT-MAP num(6) ; // cu-spcl-prc-edt
      15 CU-SPCL-PRC-EDT int ; // cu-spcl-prc-edt
      15 CU-VEND-CLS-ID char(10) ; // cu-vend-cls-id
      15 CU-SKU-COMNT1 char(20) ; // cu-sku-comnt1
      15 CU-SKU-COMNT2 char(20) ; // cu-sku-comnt2
      15 CU-SKU-COMNT3 char(20) ; // cu-sku-comnt3
    10 OB0VW-COMPANION-DATA-FIELDS char(46) ; 
      15 CU-BUY-SESN-ID char(6) ; // cu-buy-sesn-id
      15 OP-SMPL-RQT-ID char(18) ; // op-smpl-rqt-id
      15 CU-COST-ID char(10) ; // cu-cost-id
      15 OP-CASE-LOT-NBR char(12) ; // op-case-lot-nbr
end // end OB0VW03

// override record exists flag
DataItem OB0VW-COMP-EXISTS char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// update vobxrf01
DataItem OB0VW-COMP-UPDATE char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// override record exists flag
DataItem OB0VW-OVRD-EXISTS char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// update item ovrd xref
DataItem OB0VW-OVRD-UPDATE char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OB0VW-PF23-CONFIRM-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OB0VW-SIZE-LEVEL-CUSTOMER char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// end-of-file-flag
DataItem OB0VW-WCU1710-EXISTS char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem OB0VW-XREF-EXISTS char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// update cust xref
DataItem OB0VW-XREF-UPDATE char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

