package fg05;

import corpcom1.CAUSERID;
import corpcom2.XPCREC;
import corpcom2.XPLREC;
import corpcom2.XX0XW01;
import corpcom2.XX0XW02;
import corpcom3.XPFF001;
import corpcom3.XPTA0P;
import corpcom3.XPXPC01;
import corpcom3.XPXPL01;
import corpcom3.XPXX001;
import corpcom3.XPYPG01;
import corpcom4.XSFFS01;
import corpcom4.XSFFS35;
import corpcom5.COMMAREA;
import corpcom6.SQLCA;
import corpx1.XDMCD;
import corpx1.XDMTBL;
import corpx1.XPCTBL;
import corpx1.XPLTBL;
import corpx2.XPCCD;
import corpx2.XPLCD;
import corpx2.XWSCD;
import corpy2.YPGCD;
import corpy2.YPGTBL;
import fe.common.FE0DTBL;
import ff.common.FF1FUTDT;
import ff.common.FF1REC;
import ff.common.FF2REC;
import ff.common.FF3REC;
import ff.common.FFABEGMO;
import ff.common.FFQMBYMO;
import ff.common.FFWREC;
import ff.common.FFZBEGMO;
import ff.common.FFZBYYMM;
import ff.common.FFZENDMO;
import ff.common.FFZEYYMM;
import ff.common.FFZREC;
import fg.common.FG3REC;
import fg.common.FG9REC;
import sy.common.SY1SSTNM;
import sy.common.SY1STNBR;
import sy.common.SY2CLRAB;
import sy.common.SY2CLRID;
import sy.common.SYBSTGNB;
import ta.common.TA1REC;
import ta.common.TA2REC;
import ta.common.TA3REC;
import ta.common.TA6REC;
import ta.common.TAEREC;
import ta.common.TARJCL;
//*** PROGRAM=FG05 ****
// This application allows the user to submit the Production
// Forecast to GPP via a batch job. This job will be run
// immediately. However, for the forecast to be submitted, the
// "Submit Porduction Forecast" switch must be set to 'y'.
// 
// The user must specify the "season" and either "line" and
// "type" - "line", "type", and "category" - "style group" -
// "style/Color/Dim". If the user doesn't know the code for a
// line, type, or category, he can enter a "?" to ask for help.
// The application fill bring up a pop-up window to show a list
// of lines, types, or categories. so that he can choose from
// there.
// 
// The user may exit to any allowed application, via fast path
// or PF keys.
// 
// -------  --------  ------  ---------------------------------
// CONTROL    DATE     NAME   DESCRIPTION OF CHANGE
// -------  --------  ------  ---------------------------------
// ff-1054   12/8/97  rkudpi   Initial Creation (Clone of FG06)
// FF1631B   06/15/98 BMUSTI   SUBMIT PROD FCST REPORT.
// d980910d  09/23/98 BMUSTI   Modified fg05500.
// d980910d  09/29/98 BMUSTI   modified fg05510.
// ff-1641   10/2/98  rkudpi   changed for 3-season project
// *********************
Program FG05 type textUIProgram //VAGen Info - main text program
  {
  includeReferencedFunctions = yes, allowUnqualifiedItemReferences = yes, 
  throwNrfEofExceptions = yes, handleHardIOErrors = no, V60ExceptionCompatibility = yes, 
  I4GLItemsNullable = no, textLiteralDefaultIsString = no, localSQLScope = yes, 
  msgTablePrefix = "FF00", inputRecord = COMMAREA, segmented = yes
  }

  // Data Declarations
  COMMAREA COMMAREA ; // record
  FF1REC FF1REC; // record
  FF2REC FF2REC; // record
  FF3REC FF3REC; // record
  FFWREC FFWREC; // record
  FFZREC FFZREC; // record
  FG05W00 FG05W00; // record
  FG05W01 FG05W01; // record
  FG05W02 FG05W02; // record
  FG3REC FG3REC; // record
  FG9REC FG9REC; // record
  SQLCA SQLCA; // record
  TA1REC TA1REC; // record
  TA2REC TA2REC; // record
  TA3REC TA3REC; // record
  TA6REC TA6REC; // record
  TAEREC TAEREC; // record
  XPCREC XPCREC; // record
  XPLREC XPLREC; // record
  XX0XW01 XX0XW01; // record
  XX0XW02 XX0XW02; // record

  // VAGen Info - items needed for migration
  VAGen_EZESYS char(8);
  VAGen_EZEREPLY num(1);
  VAGen_EZE_WAIT_TIME bin(9,2);
  VAGen_EZE_ITEMLEN int;

  // Use Declarations
  use XPLTBL; // table
  use XPCTBL; // table
  use YPGTBL; // table
  use XDMTBL; // table
  use FE0DTBL {deleteAfterUse = yes}; // table
  use FG05T01 {deleteAfterUse = yes}; // table
  use FG05TT1 {deleteAfterUse = yes}; // table
  use FG05M.FG05M001 // form
   {
    pfKeyEquate = no
  };

  function main()
    // VAGen Info - initialization needed for migration
    VAGen_EZESYS = VGLib.getVAGSysType();
    XPFF001: XPFF001();
     /* ------------------------------------------------------------*/
     /* Initialize working storage and display storage areas.*/
     /* ------------------------------------------------------------*/
    ;
    set FG05M001 initial; /* M001 input/output*/
    set FG05W00 empty; /* Working storage*/
    set FG05W01 empty; /* M001 display storage*/
    set FG05W02 empty; /* Jcl storage*/
    set SQLCA empty; /* SQL communication area*/
    set TAEREC empty; /* Error diagnosis information*/
    set TA1REC empty; /* Error diagnosis parameters*/
    set XX0XW01 empty; /* Date/time subroutine parameters*/
    ;
    FG05W00.FG05WSWF = "Y"; /* Format the map switch*/
    FG05W01.FG05WLSW = "N"; /* Init LRPS confirm submit switch*/
    ;
    XPLREC.XGPCD = COMMAREA.XGPCD; /* GPC code*/
    XPCREC.XGPCD = COMMAREA.XGPCD; /* GPC code*/
    ;
     /* ------------------------------------------------------------*/
     /* If style code was not passed, default color and dim if they*/
     /* are missing.*/
     /* ------------------------------------------------------------*/
    ;
    if (FFWREC.SY1STNBR == " ") /* If style code is missing*/
      if (FFWREC.SY2CLRID == " ") /* If color code is missing*/
        FFWREC.SY2CLRID = "00"; /* Default value*/
      end
      ;
      if (FFWREC.XDMCD == " ") /* If color code is missing*/
        FFWREC.XDMCD = "00"; /* Default value*/
      end
    end
    ;
     /* ------------------------------------------------------------*/
     /* If type is misssing, default to '01'.*/
     /* ------------------------------------------------------------*/
    ;
    if (FFWREC.YPGCD == "  ") /* No type group*/
      FFWREC.YPGCD = "01"; /* Default value*/
      if (FFWREC.YPGCD in YPGTBL.YPGCD)
        FFWREC.YPGABRV = YPGTBL.YPGABRV[sysVar.arrayIndex];
      end /* Abbreviation*/
    end
    ;
     /* ------------------------------------------------------------*/
     /* Flow to converse the main process used to display a map.*/
     /* ------------------------------------------------------------*/
    ;
    goto FG05001; /* Converse the main process*/
    ;
    ;
    FG05001: FG05001();
     /* ------------------------------------------------------------*/
     /* Flow to converse the main process used to display a map.*/
     /* ------------------------------------------------------------*/
    ;
    goto FG05001; /* Converse the main process*/
    ;
    ;
  end // end main
end // end FG05

// Inquire/maintain a table row
Function FG05001()
   /* ------------------------------------------------------------*/
   /* This is the main process used to display a map.  Processing*/
   /* always returns to the top of this process and falls through*/
   /* subordinate processes until an error is found or a valid*/
   /* request is processed.  Processing sequence is as follows:*/
  ;
   /* 1) Format the map output area and display the map.*/
   /* 2) Check the attention identifier used to respond.*/
   /* 3) Reset highlighted fields to normal intensity.*/
   /* 4) Verify the data that was entered.*/
   /* 5) Process a valid input request.*/
  ;
   /* In all subordinate processes, "EZEFLO" is used to exit to*/
   /* redisplay the map when an error is found.  This is done to*/
   /* minimize the coding effort required to skip subsequent*/
   /* processing under error conditions.*/
   /* ------------------------------------------------------------*/
  ;
  FG05200(); /* Format and display the map*/
  ;
  FG05300(); /* Check attention identifier*/
  ;
  FG05400(); /* Reset fields to normal intensity*/
  ;
  FG05500(); /* Verify the entered data*/
  ;
  FG05600(); /* Process valid input request*/
  ;
  ;
end // end FG05001

// Format and converse the map
Function FG05200()
   /* ------------------------------------------------------------*/
   /* If an error was found, save the error message number.*/
   /* ------------------------------------------------------------*/
  ;
  if (converseVar.validationMsgNum != 0) /* Error was found*/
    ;
    FFWREC.XXXMSGNO = converseVar.validationMsgNum; /* Message number*/
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* If no error, format the data to display.*/
   /* ------------------------------------------------------------*/
  ;
  if (converseVar.validationMsgNum == 0) /* or no error found*/
    ;
    if (FG05W00.FG05WSWF == "Y") /* Map must be formatted*/
      FG05210(); /* Format the data on the map*/
    end
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* Format the current date and any FAST PATH information.*/
   /* ------------------------------------------------------------*/
  ;
  FG05M001.XXXCURDT = VGVar.currentShortGregorianDate; /* Current date*/
  ;
  FG05M001.CATOAP = COMMAREA.CATOAP; /* TO application*/
  FG05M001.CAITEM = COMMAREA.CAITEM; /* Application data*/
  ;
   /* ------------------------------------------------------------*/
   /* If a message to display, indicate sound audible alarm.*/
   /* ------------------------------------------------------------*/
  ;
  if (FFWREC.XXXMSGNO != 0) /* Message to display*/
    ;
    FG05M001.XXXMODID = FFWREC.XXXMODID; /* Module identification*/
    if (FFWREC.XXXMSGNO == 9999)
      converseLib.validationFailed();
    else
      converseLib.validationFailed(FFWREC.XXXMSGNO);
    end /* Message number*/
    ;
    set FG05M001 alarm; /* Indicate sound alarm*/
    ;
  end
  ;
  converse FG05M001 ;
  ;
   /* ------------------------------------------------------------*/
   /* Clear the message fields and save FAST PATH information.*/
   /* ------------------------------------------------------------*/
  ;
  FFWREC.XXXMODID = " "; /* Module identification*/
  FFWREC.XXXMSGNO = 0; /* Message number*/
  ;
  COMMAREA.CATOAP = FG05M001.CATOAP; /* TO application*/
  COMMAREA.CAITEM = FG05M001.CAITEM; /* Application data*/
  ;
  ;
end // end FG05200

// Format the display data
Function FG05210()
   /* ------------------------------------------------------------*/
   /* Clear the fields in the map storage area to be formatted.*/
   /* ------------------------------------------------------------*/
  ;
  set FG05M001 initial; /* M001 input/output area*/
  ;
  FG05W00.FG05WSWF = "N"; /* Format the map switch*/
  ;
   /* ------------------------------------------------------------*/
   /* Format the data in the map from the display storage.*/
   /* ------------------------------------------------------------*/
  ;
  FG05M001.FFZBYYMM = FFWREC.FFABEGMO; /* date range beg month*/
  FG05M001.FFZEYYMM = FFWREC.FFAENDMO; /* date range end month*/
  FG05M001.XPLCD = FFWREC.XPLCD; /* Product line code*/
  FG05M001.XPLABRV = FFWREC.XPLABRV; /* Product line abbreviation*/
  FG05M001.YPGCD = FFWREC.YPGCD; /* Type group code*/
  FG05M001.YPGABRV = FFWREC.YPGABRV; /* Type group abbreviation*/
  FG05M001.XPCCD = FFWREC.XPCCD; /* Category code*/
  FG05M001.XPCABRV = FFWREC.XPCABRV; /* Category short description*/
  FG05M001.SYBSTGNB = FFWREC.SYBSTGNB; /* Style Group number*/
  FG05M001.SYBSTGNM = FFWREC.SYBSTGNM; /* Style Group name*/
  FG05M001.SY1STNBR = FFWREC.SY1STNBR; /* Style number*/
  FG05M001.SY1SSTNM = FFWREC.SY1SSTNM; /* Style name*/
  FG05M001.SY2CLRID = FFWREC.SY2CLRID; /* Color identification*/
  FG05M001.SY2CLRAB = FFWREC.SY2CLRAB; /* Color abbreviation*/
  FG05M001.XDMCD = FFWREC.XDMCD; /* Dimension code*/
   /* bgn tcs*/
  FG05M001.FG05SES1 = FG05W02.FG05SES1; /* sesn code*/
  FG05M001.FG05SES2 = FG05W02.FG05SES2; /* sesn code*/
  FG05M001.FG05SES3 = FG05W02.FG05SES3; /* sesn code*/
  FG05M001.FG05SES4 = FG05W02.FG05SES4; /* sesn code*/
  FG05M001.FG05CRYF = FG05W02.FG05CRYF; /* carry flag*/
  FG05M001.FG05SPLF = FG05W02.FG05SPLF; /* spcl flag*/
   /* end tcs*/
  ;
end // end FG05210

// Check attention identifier
Function FG05300()
   /* ------------------------------------------------------------*/
   /* If CANCEL was requested, clear the map fields and exit.*/
   /* ------------------------------------------------------------*/
  ;
  if (converseVar.eventKey is pa2) /* PA2 was pressed*/
    ;
    FG05W00.FG05WSWF = "Y"; /* Format the map switch*/
    ;
    COMMAREA.CATOAP = " "; /* TO application*/
    COMMAREA.CAITEM = " "; /* Application data*/
    ;
    exit stack; /* Exit to display map*/
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* If FAST PATH was requested, transfer to the application.*/
   /* ------------------------------------------------------------*/
  ;
  if (FG05M001.CATOAP > " ") /* FAST PATH was requested*/
    ;
    if (converseVar.eventKey is enter) /* ENTER was pressed*/
      ;
      XSFFS01(); /* Exit to another application*/
      ;
      set FG05M001.CATOAP cursor, bold; /* Highlight*/
      ;
    else
      ;
      FFWREC.XXXMODID = "300"; /* Module identification*/
      converseLib.validationFailed(36); /* Indicate PF key not valid*/
      ;
    end
    ;
    exit stack; /* Exit to display map*/
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* If HELP, exit to the previous level or exit to the Master*/
   /* Menu was requested, exit to another application.*/
   /* ------------------------------------------------------------*/
  ;
  if (converseVar.eventKey is pf1  /* PF1 was pressed*/
   || converseVar.eventKey is pf3  /* or PF3 was pressed*/
   || converseVar.eventKey is pf5  /* or PF5 was pressed*/
   || converseVar.eventKey is pf13 /* or PF13 was pressed*/
   || converseVar.eventKey is pf18) /* or PF18 was pressed*/
    ;
    if (converseVar.eventKey is pf1) /* PF1 was pressed*/
      COMMAREA.CAITEM = "FG05M001"; /* Application find code*/
    end
    ;
    if (converseVar.eventKey is pf3) /* PF3 was pressed*/
      COMMAREA.CATOAP = "FF03"; /* TO application*/
    end
    ;
    if (converseVar.eventKey is pf13) /* PF13 was pressed*/
      COMMAREA.CATOAP = "FG04"; /* TO application*/
    end
    ;
    if (converseVar.eventKey is pf18) /* PF18 was pressed*/
      COMMAREA.CATOAP = "FF0X"; /* TO application*/
    end
    ;
    XSFFS01(); /* Exit to another application*/
    ;
    exit stack; /* Exit to display map*/
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* Determine whether a valid attention identifier was used to*/
   /* invoke the transaction.  Display an error message to the*/
   /* user if the PF key used is not supported.*/
   /* ------------------------------------------------------------*/
  ;
  if (converseVar.eventKey not enter) /* ENTER was not pressed*/
    ;
    FFWREC.XXXMODID = "300"; /* Module identification*/
    converseLib.validationFailed(3); /* Indicate invalid attention key*/
    ;
    if (converseVar.eventKey is pakey) /* PA key was pressed*/
      converseLib.clearScreen();
       /* Clear screen before display*/
    end
    ;
    exit stack; /* Exit to display map*/
    ;
  end
  ;
  ;
end // end FG05300

// Reset highlighted fields
Function FG05400()
   /* ------------------------------------------------------------*/
   /* Reset field attributes to normal intensity.*/
   /* ------------------------------------------------------------*/
  ;
  set FG05M001.FG05MSJS initialAttributes; /* Submit job switch*/
  set FG05M001.XPLCD initialAttributes; /* Product line code*/
  set FG05M001.YPGCD initialAttributes; /* Type group code*/
  set FG05M001.XPCCD initialAttributes; /* Category code*/
  set FG05M001.SYBSTGNB initialAttributes; /* Style group*/
  set FG05M001.SY1STNBR initialAttributes; /* Style number*/
  set FG05M001.SY2CLRID initialAttributes; /* Color identification*/
  set FG05M001.XDMCD initialAttributes; /* Dimension code*/
  set FG05M001.FFZBYYMM initialAttributes; /* date range beg month*/
  set FG05M001.FFZEYYMM initialAttributes; /* date range end month*/
  set FG05M001.FG05SES1 initialAttributes; /* season range*/
  set FG05M001.FG05SES2 initialAttributes; /* season range*/
  set FG05M001.FG05SES3 initialAttributes; /* season range*/
  set FG05M001.FG05SES4 initialAttributes; /* season range*/
  set FG05M001.FG05CRYF initialAttributes; /* season range*/
  set FG05M001.FG05SPLF initialAttributes; /* season range*/
  set FG05M001.CATOAP initialAttributes; /* Commarea TO application*/
  set FG05M001.CAITEM initialAttributes; /* Commarea application data*/
  ;
   /* ------------------------------------------------------------*/
   /* If no lists were requested, return to the previous process.*/
   /* ------------------------------------------------------------*/
  ;
  if (FG05M001.XPLCD == "?" /* Product line list requested*/
   || FG05M001.YPGCD == "?" /* or type group liest requested*/
   || FG05M001.XPCCD == "?") /* or category list requested*/
    ;
    if (converseVar.eventKey not enter) /* ENTER was not pressed*/
      ;
      FFWREC.XXXMODID = "400"; /* Module identification*/
      converseLib.validationFailed(116); /* Indicate PF key not valid*/
      ;
      exit stack; /* Exit to display map*/
      ;
    end
    ;
  else
    ;
    return; /* Return to previous process*/
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* If requested, display the list of product line codes.*/
   /* ------------------------------------------------------------*/
  ;
  if (FG05M001.XPLCD == "?") /* Product line list requested*/
    ;
    XPXX001(); /* window initialization*/
    XX0XW02.XX0XWHDR = "  LINE"; /* Heading*/
    XX0XW02.XGPCD = COMMAREA.XGPCD; /* GPC code*/
    ;
    while (XX0XW02.XX0XWEND == "N") /* Until end of request*/
      XPXPL01(); /* Display the list*/
    end
    ;
    if (XX0XW02.XX0XWPIX == 0) /* No selection made*/
      ;
      FG05M001.XPLCD = FFWREC.XPLCD; /* Restore prior code*/
      FG05M001.XPLABRV = FFWREC.XPLABRV; /* Abbreviation*/
    else
      FG05M001.XPLCD = XPLTBL.XPLCD[XX0XWPIX]; /* Selected code*/
      FG05M001.XPLABRV = XPLTBL.XPLABRV[XX0XWPIX]; /* Abbreviation*/
      ;
    end
    ;
    set FG05M001.XPLCD cursor; /* Establish cursor position*/
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* If requested, display the list of type group codes.*/
   /* ------------------------------------------------------------*/
  ;
  if (FG05M001.YPGCD == "?") /* Type group list requested*/
    ;
    XPXX001(); /* window initialization*/
    XX0XW02.XX0XWHDR = "  TYPE GROUP"; /* Heading*/
    XX0XW02.YPGFFFL = "Y";
    XX0XW02.XGPCD = COMMAREA.XGPCD; /* GPC code*/
    ;
    while (XX0XW02.XX0XWEND == "N") /* Until end of request*/
      XPYPG01(); /* Display the list*/
    end
    ;
    if (XX0XW02.XX0XWPIX == 0) /* No selection made*/
      ;
      FG05M001.YPGCD = FFWREC.YPGCD; /* Restore prior code*/
      FG05M001.YPGABRV = FFWREC.YPGABRV; /* Abbreviation*/
    else
      FG05M001.YPGCD = YPGTBL.YPGCD[XX0XWPIX]; /* Selected code*/
      FG05M001.YPGABRV = YPGTBL.YPGABRV[XX0XWPIX]; /* Abbreviation*/
      ;
    end
    ;
    set FG05M001.YPGCD cursor; /* Establish cursor position*/
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* If requested, display the list of category codes.*/
   /* ------------------------------------------------------------*/
  ;
  if (FG05M001.XPCCD == "?") /* Category list requested*/
    ;
    XPXX001(); /* window initialization*/
    XX0XW02.XX0XWHDR = "  CATEGORY"; /* Heading*/
    XX0XW02.XGPCD = COMMAREA.XGPCD; /* GPC code*/
    ;
    while (XX0XW02.XX0XWEND == "N") /* Until end of request*/
      XPXPC01(); /* Display the list*/
    end
    ;
    if (XX0XW02.XX0XWPIX == 0) /* No selection made*/
      ;
      FG05M001.XPCCD = FFWREC.XPCCD; /* Restore prior code*/
      FG05M001.XPCABRV = FFWREC.XPCABRV; /* Abbreviation*/
    else
      FG05M001.XPCCD = XPCTBL.XPCCD[XX0XWPIX]; /* Selected code*/
      FG05M001.XPCABRV = XPCTBL.XPCABRV[XX0XWPIX]; /* Abbreviation*/
      ;
    end
    ;
    set FG05M001.XPCCD cursor; /* Establish cursor position*/
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* Indicate that the requested lists have been displayed and*/
   /* that ENTER must be pressed to process any changes.*/
   /* ------------------------------------------------------------*/
  ;
  converseLib.clearScreen();
   /* Clear screen before display*/
  ;
  FFWREC.XXXMODID = "400"; /* Module identification*/
  converseLib.validationFailed(97); /* Indicate press ENTER*/
  ;
  exit stack; /* Exit to display map*/
  ;
  ;
end // end FG05400

// Verify the entered data
Function FG05500()
   /* ------------------------------------------------------------*/
   /* Highlight any application data that was entered.*/
   /* ------------------------------------------------------------*/
  ;
  if (COMMAREA.CAITEM > " ") /* Application data was entered*/
    ;
    FFWREC.XXXMODID = "500"; /* Module identification*/
    set FG05M001.CAITEM cursor, bold; /* Highlight*/
    converseLib.validationFailed(40); /* Enter only with FAST PATH*/
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* Verify that the entered submit switch is Yes or No.*/
   /* ------------------------------------------------------------*/
  ;
  if (FG05M001.FG05MSJS != "Y"
   && FG05M001.FG05MSJS != "N")
    ;
    FFWREC.XXXMODID = "500"; /* Module identification*/
    converseLib.validationFailed(153); /* Indicate value must be 'y' or 'n'*/
    set FG05M001.FG05MSJS cursor, bold; /* Highlighted*/
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* If any of the key fields changed, verify fields.*/
   /* ------------------------------------------------------------*/
    /* bgn tcs*/
  ;
  if (FG05M001.FFZBYYMM != FG05W01.FFZBYYMM /* beg month changed*/
   || FG05M001.FFZEYYMM != FG05W01.FFZEYYMM /* end month changed*/
   || FG05M001.XPLCD != FFWREC.XPLCD        /* Product line changed*/
   || FG05M001.YPGCD != FFWREC.YPGCD        /* or type group changed*/
   || FG05M001.XPCCD != FFWREC.XPCCD        /* or category changed*/
   || FG05M001.SYBSTGNB != FFWREC.SYBSTGNB  /* or style group changed*/
   || FG05M001.SY1STNBR != FFWREC.SY1STNBR  /* or style changed*/
   || FG05M001.SY2CLRID != FFWREC.SY2CLRID  /* or color changed*/
   || FG05M001.XDMCD != FFWREC.XDMCD        /* or dimension changed*/
   || FG05M001.FFZBYYMM == 0                /* beg month missing*/
   || FG05M001.FFZEYYMM == 0                /* end month missing*/
   || FG05M001.FG05SES1 != FG05W01.FG05SES1 
   || FG05M001.FG05SES2 != FG05W01.FG05SES2 
   || FG05M001.FG05SES3 != FG05W01.FG05SES3 
   || FG05M001.FG05SES4 != FG05W01.FG05SES4 
   || FG05M001.FG05CRYF != FG05W01.FG05CRYF 
   || FG05M001.FG05SPLF != FG05W01.FG05SPLF)
    /* end tcs*/
    FG05510(); /* verify key data*/
    ;
    FG05520(); /* verify relationships*/
    ;
    if (FG05M001.XPLCD == "11") /* line code entered*/
      FG05M001.YPGABRV = " "; /* Abbreviation*/
      ;
      FFWREC.XXXMODID = "500"; /* Module identification*/
      set FG05M001.XPLCD cursor, bold; /* Highlight*/
      converseLib.validationFailed(532); /* Indicate missing or invalid*/
      ;
    end
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* If any errors were found, exit to display the map.*/
   /* ------------------------------------------------------------*/
  ;
  if (converseVar.validationMsgNum != 0) /* Errors were found*/
    exit stack; /* Exit to display map*/
  end
  ;
  ;
end // end FG05500

// Verify Key Data
Function FG05510()
   /* ------------------------------------------------------------*/
   /* Verify Key Data*/
   /* ------------------------------------------------------------*/
   /* BGN TCS*/
  FG05W00.FG05W-SESN-ENTERED = "N";
  FG05W00.FG05W-DATE-ENTERED = "N";
  ;
  if (FG05M001.FG05SES1 != "    "
   || FG05M001.FG05SES2 != "    "
   || FG05M001.FG05SES3 != "    "
   || FG05M001.FG05SES4 != "    ")
    FG05W00.FG05W-SESN-ENTERED = "Y";
    FG05W00.FG05SNRN = "S";
    FG05M001.FFZBYYMM = 0;
    FG05M001.FFZEYYMM = 0;
  end
  ;
  if (FG05M001.FFZBYYMM != 0
   || FG05M001.FFZEYYMM != 0)
    FG05W00.FG05W-DATE-ENTERED = "Y";
    FG05W00.FG05SNRN = "R";
  end
   /* bgn tcs*/
  if (FG05W00.FG05W-SESN-ENTERED == "N"
   && FG05W00.FG05W-DATE-ENTERED == "N")
    FFWREC.XXXMODID = "510";
    converseLib.validationFailed(535);
    set FG05M001.FG05SES1 cursor, bold;
    return;
  end
   /* end tcs*/
  ;
  if (FG05W00.FG05W-SESN-ENTERED == "Y"
   && FG05W00.FG05W-DATE-ENTERED == "Y")
    FFWREC.XXXMODID = "510";
    converseLib.validationFailed(536);
    set FG05M001.FG05SES1 cursor, bold;
    return;
  end
   /* ------------------------------------------------------*/
   /* Verify Season Codes entered;*/
   /* ------------------------------------------------------*/
  if (FG05W00.FG05W-SESN-ENTERED == "Y")
    FG05W00.FG05W-LEAST-BEG-MO = FG05W00.FG05W-BUY-CYM;
    FG05W00.FG05W-GRTST-END-MO = 000000;
    if (FG05M001.FG05SES1 != "    ")
      FG05W00.FG05W-SESN-YR = FG05M001.FG05SES1;
      FG05W00.FG05W-BEG-MO = 000000;
      FG05S-VAL-SEASON();
      if (converseVar.validationMsgNum != 0)
        set FG05M001.FG05SES1 cursor, bold;
        return;
      end
    end
    if (FG05M001.FG05SES2 != "    ")
      FG05W00.FG05W-SESN-YR = FG05M001.FG05SES2;
      FG05W00.FG05W-BEG-MO = 000000;
      FG05S-VAL-SEASON();
      if (converseVar.validationMsgNum != 0)
        set FG05M001.FG05SES2 cursor, bold;
        return;
      end
    end
    if (FG05M001.FG05SES3 != "    ")
      FG05W00.FG05W-SESN-YR = FG05M001.FG05SES3;
      FG05W00.FG05W-BEG-MO = 000000;
      FG05S-VAL-SEASON();
      if (converseVar.validationMsgNum != 0)
        set FG05M001.FG05SES3 cursor, bold;
        return;
      end
    end
    if (FG05M001.FG05SES4 != "    ")
      FG05W00.FG05W-SESN-YR = FG05M001.FG05SES4;
      FG05W00.FG05W-BEG-MO = 000000;
      FG05S-VAL-SEASON();
      if (converseVar.validationMsgNum != 0)
        set FG05M001.FG05SES4 cursor, bold;
        return;
      end
    end
  end
  ;
   /* --------------------------------------------------------------------*/
   /* Get future cutoff date and compute buy date +1 + europe*/
   /* -------------------------------------------------------------------*/
  if (FG05W00.FG05SNRN == "S")
    FG05515();
    ;
    FG05W00.FG05W-BUY-DT = FF1REC.FF1FUTDT;
    ;
    FG05W00.FG05W-BUY-MM = FG05W00.FG05W-BUY-MM + 6;
    /* Buy month is futures + 5 ; We require buy-mo + 1 as*/
    /* Also taken into consideration, the offset for Europpe*/
    if (FG05W00.FG05W-BUY-MM > 12)
      FG05W00.FG05W-BUY-MM = FG05W00.FG05W-BUY-MM - 12;
      if (FG05W00.FG05W-BUY-YY == 99)
        FG05W00.FG05W-BUY-CC = FG05W00.FG05W-BUY-CC + 1;
        FG05W00.FG05W-BUY-YY = 00;
      else
        FG05W00.FG05W-BUY-YY = FG05W00.FG05W-BUY-YY + 1;
      end
    end
    ;
    FG05M001.FFZBYYMM = FG05W00.FG05W-BUY-CYM;
    FG05W00.TEMP-DATE = FG05W00.FG05W-BUY-CYM;
    FG05W00.TEMP-MM = FG05W00.TEMP-MM + 11;
    if (FG05W00.TEMP-MM > 12)
      FG05W00.TEMP-MM = FG05W00.TEMP-MM - 12;
      if (FG05W00.TEMP-YY == 99)

        FG05W00.TEMP-CC = FG05W00.TEMP-CC + 1;
        FG05W00.TEMP-YY = 00;
      else
        FG05W00.TEMP-YY = FG05W00.TEMP-YY + 1;
      end
    end
    FG05M001.FFZEYYMM = FG05W00.TEMP-DATE;
  end
   /* bgn tcs*/
  ;
  if (FG05W00.FG05SNRN != "S")
    if (FG05M001.FG05CRYF == "Y")
      FFWREC.XXXMODID = "510";
      converseLib.validationFailed(543);
      set FG05M001.FG05CRYF cursor, bold;
      return;
    end
    ;
    if (FG05M001.FG05SPLF == "Y")
      FFWREC.XXXMODID = "510";
      converseLib.validationFailed(544);
      set FG05M001.FG05SPLF cursor, bold;
      return;
    end
    /* end tcs*/
  else
    if (FG05M001.FG05CRYF != "Y"
     && FG05M001.FG05CRYF != "N")
      FFWREC.XXXMODID = "510";
      converseLib.validationFailed(533);
      set FG05M001.FG05CRYF cursor, bold;
      return;
    end
    ;
    if (FG05M001.FG05SPLF != "Y"
     && FG05M001.FG05SPLF != "N")
      FFWREC.XXXMODID = "510";
      converseLib.validationFailed(534);
      set FG05M001.FG05SPLF cursor, bold;
      return;
    end
  end
   /* END TCS*/
   /* ------------------------------------------------------------*/
   /* If style/color/dim was entered, verify the entered code.*/
   /* ------------------------------------------------------------*/
  ;
  if (FG05M001.SY1STNBR != " ") /* Style entered*/
    ;
    if (FG05M001.YPGCD == "*") /* Type group wilcarded*/
      FFWREC.XXXMODID = "510"; /* Module identification*/
      set FG05M001.YPGCD cursor, bold; /* Highlight*/
      converseLib.validationFailed(118); /* Indicate missing or invalid*/
    else
      /* ------------------------------------------------------------*/
       /* Clear copybook.*/
      /* ------------------------------------------------------------*/
      set FG9REC empty; /* clear record*/
      ;
      /* ------------------------------------------------------------*/
       /* Format key.*/
      /* ------------------------------------------------------------*/
      ;
      FG9REC.SY1STNBR = FG05M001.SY1STNBR; /* style nbr*/
      FG9REC.SY2CLRID = FG05M001.SY2CLRID; /* color id*/
      FG9REC.XDMCD = FG05M001.XDMCD; /* dimension*/
      FG9REC.YSMXDV = "10"; /* division group*/
      ;
      /* ------------------------------------------------------------*/
       /* Select FFSTY.*/
      /* ------------------------------------------------------------*/
      ;
      FG05511(); /* Select PFHST*/
      ;
      if (SQLCA.VAGen_SQLCODE == 0) /* Row found*/
        ;
        FG05M001.SY1SSTNM = FG9REC.SY1SSTNM; /* style name*/
        FG05M001.SY2CLRAB = FG9REC.SY2CLRAB; /* color name*/
        FG05M001.YPGCD = FG9REC.YPGCD; /* type code*/
        FG05M001.SYBSTGNB = FG9REC.SYBSTGNB; /* style group*/
        FG05M001.XPCCD = FG9REC.XPCCD; /* cat code*/
        FG05M001.XPLCD = FG9REC.XPLCD; /* line code*/
        ;
      else
        ;
        if (SQLCA.VAGen_SQLCODE == 100) /* Row not found try NIL*/
          FG9REC.YSMXDV = "20"; /* division group*/
          FG05511(); /* Select PFHST*/
          ;
          if (SQLCA.VAGen_SQLCODE == 0) /* Row found*/
            ;
            FG05M001.SY1SSTNM = FG9REC.SY1SSTNM; /* style name*/
            FG05M001.SY2CLRAB = FG9REC.SY2CLRAB; /* color name*/
            FG05M001.YPGCD = FG9REC.YPGCD; /* type code*/
            FG05M001.SYBSTGNB = FG9REC.SYBSTGNB; /* style group*/
            FG05M001.XPCCD = FG9REC.XPCCD; /* cat code*/
            FG05M001.XPLCD = FG9REC.XPLCD; /* line code*/
            ;
          else
            FFWREC.XXXMODID = "510"; /* Module identification*/
            set FG05M001.XDMCD cursor, bold; /* Highlight*/
            set FG05M001.SY2CLRID cursor, bold; /* Highlight*/
            set FG05M001.SY1STNBR cursor, bold; /* Highlight*/
            converseLib.validationFailed(118); /* Indicate missing or invalid*/
          end
        else
          FFWREC.XXXMODID = "510"; /* Module identification*/
          set FG05M001.XDMCD cursor, bold; /* Highlight*/
          set FG05M001.SY2CLRID cursor, bold; /* Highlight*/
          set FG05M001.SY1STNBR cursor, bold; /* Highlight*/
          converseLib.validationFailed(118); /* Indicate missing or invalid*/
        end
        ;
      end
      ;
    end
    ;
  else
    FG05M001.SY1SSTNM = " "; /* clear style name*/
    FG05M001.SY2CLRID = " "; /* clear color id*/
    FG05M001.SY2CLRAB = " "; /* clear color name*/
    FG05M001.XDMCD = " "; /* clear dimension*/
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* If style group was entered, verify the entered code.*/
   /* ------------------------------------------------------------*/
  ;
  if (FG05M001.SYBSTGNB != " ") /* Style group entered*/
    ;
    if (FG05M001.YPGCD == "*") /* Type group wilcarded*/
      FFWREC.XXXMODID = "510"; /* Module identification*/
      set FG05M001.YPGCD cursor, bold; /* Highlight*/
      converseLib.validationFailed(118); /* Indicate missing or invalid*/
    else
      set FG9REC empty; /* clear record*/
      FG9REC.SYBSTGNB = FG05M001.SYBSTGNB; /* style grp*/
      FG9REC.YPGCD = FG05M001.YPGCD; /* type code*/
      FG9REC.YSMXDV = "*"; /* div grp*/
      ;
      TA1REC.TA1PGMNM = "FG05510"; /* Calling process*/
      ;
      FG05W00.FG05WFND = "N";
      FG05512(); /* Open pfhst cursor for style group*/
      FG05513(); /* Fetch next row in cursor*/
      while (FG05W00.FG05WFND == "N" /* record found*/
       && SQLCA.VAGen_SQLCODE != +100) /* not end of cursor*/
        if (FG05M001.XPCCD == FG9REC.XPCCD) /* category match*/
          FG05W00.FG05WFND = "Y";
        else
          FG05513(); /* fetch next row*/
        end
      end
      ;
      FG05514(); /* Close the cursor*/
      ;
      if (FG05W00.FG05WFND == "Y") /* Row not found*/
        ;
        FG05M001.SYBSTGNM = FG9REC.SYBSTGNM; /* style grp name*/
        FG05M001.XPCCD = FG9REC.XPCCD; /* cat code*/
        FG05M001.XPLCD = FG9REC.XPLCD; /* line code*/
      else
        FG05M001.SYBSTGNM = " "; /* style grp name*/
        FFWREC.XXXMODID = "510"; /* Module identification*/
        set FG05M001.SYBSTGNB cursor, bold; /* Highlight*/
        converseLib.validationFailed(118); /* Indicate missing or invalid*/
        ;
      end
    end
    ;
  else
    ;
    FG05M001.SYBSTGNM = " "; /* style grp name*/
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* If category was entered, verify the entered code.*/
   /* ------------------------------------------------------------*/
  ;
  if (FG05M001.XPCCD != " ") /* category entered*/
    ;
    if (FG05M001.XPCCD in XPCTBL.XPCCD /* Code in table*/
     && XPCTBL.XXXSTAT[sysVar.arrayIndex] == "A") /* and active status*/
      ;
      FG05M001.XPCABRV = XPCTBL.XPCABRV[sysVar.arrayIndex]; /* Abbreviation*/
      ;
    else
      ;
      /* ------------------------------------------------------------*/
       /* If not found or inactive, indicate missing or invalid.*/
      /* ------------------------------------------------------------*/
      ;
      FG05M001.XPCABRV = " "; /* Abbreviation*/
      ;
      FFWREC.XXXMODID = "510"; /* Module identification*/
      set FG05M001.XPCCD cursor, bold; /* Highlight*/
      converseLib.validationFailed(118); /* Indicate missing or invalid*/
      ;
    end
    ;
  else
    FG05M001.XPCABRV = " "; /* Abbreviation*/
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* If type code was entered, verify the entered code.*/
   /* ------------------------------------------------------------*/
  ;
  if (FG05M001.YPGCD == " ") /* type missing*/
    FFWREC.YPGCD = "01"; /* default to '01'*/
    FG05M001.YPGCD = "01"; /* default to '01'*/
  end
  ;
  if (FG05M001.YPGCD == "*") /* Wildcard type grp*/
    FG05M001.YPGABRV = "*ALL*"; /* Abbreviation*/
  else
    if (FG05M001.YPGCD in YPGTBL.YPGCD           /* Code in table*/
     && YPGTBL.XXXSTAT[sysVar.arrayIndex] == "A" /* and active status*/
     && YPGTBL.YPGFFFL[sysVar.arrayIndex] == "Y") /* and flag eq yes*/
      ;
      FG05M001.YPGABRV = YPGTBL.YPGABRV[sysVar.arrayIndex]; /* Abbreviation*/
      ;
    else
      ;
        /* ------------------------------------------------------------*/
        /* If not found or inactive, indicate missing or invalid.*/
        /* ------------------------------------------------------------*/
      ;
      FG05M001.YPGABRV = " "; /* Abbreviation*/
      ;
      FFWREC.XXXMODID = "510"; /* Module identification*/
      set FG05M001.YPGCD cursor, bold; /* Highlight*/
      converseLib.validationFailed(118); /* Indicate missing or invalid*/
      ;
    end
  end
  ;
   /* ------------------------------------------------------------*/
   /* If line code was entered, verify the entered code.*/
   /* ------------------------------------------------------------*/
  ;
  if (FG05M001.XPLCD == "*") /* line code entered*/
    ;
    FG05M001.XPLABRV = "*ALL*"; /* Move 'all' to name*/
    ;
  else
    ;
    if (FG05M001.XPLCD == "11") /* line code entered*/
      FG05M001.YPGABRV = " "; /* Abbreviation*/
      ;
      FFWREC.XXXMODID = "510"; /* Module identification*/
      set FG05M001.XPLCD cursor, bold; /* Highlight*/
      converseLib.validationFailed(532); /* Indicate missing or invalid*/
      ;
    else
      if (FG05M001.XPLCD == " ") /* If line missing*/
        ;
        FG05M001.XPLABRV = " "; /* Abbreviation*/
        ;
      else
        if (FG05M001.XPLCD in XPLTBL.XPLCD /* Code in table*/
         && XPLTBL.XXXSTAT[sysVar.arrayIndex] == "A") /* and active status*/
          ;
          FG05M001.XPLABRV = XPLTBL.XPLABRV[sysVar.arrayIndex]; /* Abbreviation*/
          ;
        else
          ;
          /* ------------------------------------------------------------*/
          /* If not found or inactive, indicate missing or invalid.*/
          /* ------------------------------------------------------------*/
          ;
          FG05M001.XPLABRV = " "; /* Abbreviation*/
          ;
          FFWREC.XXXMODID = "510"; /* Module identification*/
          set FG05M001.XPLCD cursor, bold; /* Highlight*/
          converseLib.validationFailed(118); /* Indicate missing or invalid*/
          ;
        end
        ;
      end
    end
  end
  ;
   /* ------------------------------------------------------------*/
   /* Verify that some level was indicated.*/
   /* ------------------------------------------------------------*/
  ;
  if (FG05M001.XPLCD == " "    /* If line missing*/
   && FG05M001.XPCCD == " "    /* and cat missing*/
   && FG05M001.SYBSTGNB == " " /* and sty grp missing*/
   && FG05M001.SY1STNBR == " ") /* and style missing*/
    ;
    FG05M001.XPLABRV = " "; /* Abbreviation*/
    FG05M001.XPCABRV = " "; /* Abbreviation*/
    FG05M001.SYBSTGNM = " "; /* style grp name*/
    FG05M001.SY1SSTNM = " "; /* clear style name*/
    FG05M001.SY2CLRID = " "; /* clear color id*/
    FG05M001.SY2CLRAB = " "; /* clear color name*/
    ;
    FFWREC.XXXMODID = "510"; /* Module identification*/
    set FG05M001.XPLCD cursor, bold; /* Highlight*/
    set FG05M001.XPCCD bold; /* Highlight*/
    set FG05M001.SYBSTGNB bold; /* Highlight*/
    set FG05M001.XDMCD bold; /* Highlight*/
    set FG05M001.SY2CLRID bold; /* Highlight*/
    set FG05M001.SY1STNBR bold; /* Highlight*/
    converseLib.validationFailed(178); /* Indicate please enter one of these*/
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* Verify Date Range*/
   /* ------------------------------------------------------------*/
  ;
  set FFZREC empty; /* Subroutine parameters*/
  ;
  FFZREC.FFZMONTH = 5; /* Beginning month offset*/
  FFZREC.FFZBYYMM = FG05M001.FFZBYYMM; /* Beginning date*/
  FFZREC.FFZEYYMM = FG05M001.FFZEYYMM; /* Ending date*/
  ;
  XSFFS35(); /* Verify the range*/
  ;
   /* ------------------------------------------------------------*/
   /* If not zero return code, indicate missing or invalid.*/
   /* ------------------------------------------------------------*/
  ;
  if (FFZREC.FFZENDRC != "0") /* Ending date error*/
    ;
    FFWREC.XXXMODID = "510"; /* Module identification*/
    set FG05M001.FFZEYYMM cursor, bold; /* Highlight*/
    ;
    if (FFZREC.FFZENDRC == "1") /* No date entered*/
      converseLib.validationFailed(8); /* Required field missing*/
    else
      ;
      if (FFZREC.FFZENDRC == "2") /* Date is invalid*/
        converseLib.validationFailed(17); /* Invalid date entered*/
      else
        ;
        converseLib.validationFailed(151); /* Date is out of range*/
        ;
      end
      ;
    end
    ;
  end
  ;
  if (FFZREC.FFZBEGRC != "0") /* Beginning date error*/
    ;
    FFWREC.XXXMODID = "510"; /* Module identification*/
    set FG05M001.FFZBYYMM cursor, bold; /* Highlight*/
    ;
    if (FFZREC.FFZBEGRC == "1") /* No date entered*/
      converseLib.validationFailed(8); /* Required field missing*/
    else
      ;
      if (FFZREC.FFZBEGRC == "2") /* Date is invalid*/
        converseLib.validationFailed(17); /* Invalid date entered*/
      else
        ;
        converseLib.validationFailed(151); /* Date is out of range*/
        ;
      end
      ;
    end
    ;
  end
  ;
  ;
end // end FG05510

// Select Row - PFHST
Function FG05511()
   /* ------------------------------------------------------------*/
   /* Get Next Row - Style Table*/
   /* ------------------------------------------------------------*/
  ;
  try
    call "IO5430" ("S ", SQLCA, FG9REC) {isNoRefresh = yes, isExternal = yes};
  end
  ;
   /* ------------------------------------------------------------*/
   /* If successful, Return to previous process*/
   /* ------------------------------------------------------------*/
  ;
  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (SQLCA.VAGen_SQLCODE == 0 /* normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/
      ;
      return; /* Return to previous process*/
      ;
    end
  end
  ;
   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that a system error has occurred.*/
   /* ------------------------------------------------------------*/
  ;
  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/
  ;
  FFWREC.XXXMODID = "511"; /* Module identification*/
  ;
  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/
    ;
    converseLib.validationFailed(47); /* Indicate not available*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/
    ;
  else
    ;
    converseLib.validationFailed(01); /* Indicate system error*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/
    ;
    converseLib.clearScreen();
     /* Clear screen before display*/
    ;
  end
  ;
  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "SELECT TABLE ROW";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = FFWREC.XXXMODID; /* Program number*/
  TA1REC.TA1DBASE = "DFCAST  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VPFHST01"; /* Table view name*/
  TA1REC.TA1TBLKE = FG9REC.FG9KEY; /* Table key*/
  ;
  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/
  ;
  exit stack; /* Exit to display map*/
  ;
  ;
end // end FG05511

// Open  'S1' PFHST
Function FG05512()
   /* ------------------------------------------------------------*/
   /* Select the set of rows from Footwear Forecast Style Table.*/
   /* ------------------------------------------------------------*/
  ;
  try
    call "IO5430" ("S1", SQLCA, FG9REC) {isNoRefresh = yes, isExternal = yes};
  end /* Select table set*/
  ;
   /* ------------------------------------------------------------*/
   /* If successful, continue to fetch the first selected row.*/
   /* ------------------------------------------------------------*/
  ;
  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/
    ;
     /* NEXT SENTENCE               ; Next sentence*/
    ;
  else
    ;
    /* ------------------------------------------------------------*/
     /* If data not available, post an error message and return.*/
     /* Otherwise, indicate that a system error has occurred.*/
    /* ------------------------------------------------------------*/
    ;
    TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
    TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/
    ;
    TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
    TA1REC.TA1LOC = "FG05512 SELECT STYLE GROUP SET";
    TA1REC.TA1DBASE = "DFCAST  "; /* Data base name*/
    TA1REC.TA1TBLVU = "VPFHST01"; /* Table view name*/
    TA1REC.TA1TBLKE = FG9REC.FG9KEY; /* Table key*/
    ;
    if (sysVar.errorCode == "00000000" /* Call successful*/
     && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/
      ;
      TA1REC.TA1FUNC = "POST"; /* Termination function*/
      call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/
      ;
      converseLib.validationFailed(47); /* Data in use by another*/
      ;
    else
      ;
      TA1REC.TA1FUNC = "RETN"; /* Termination function*/
      call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/
      ;
      converseLib.validationFailed(1); /* System error occurred*/
      ;
    end
    ;
    FFWREC.XXXMODID = "512"; /* Module identification*/
    ;
    exit stack; /* Exit to display map*/
    ;
  end
  ;
end // end FG05512

// Fetch 'N1' PFHST
Function FG05513()
   /* ------------------------------------------------------------*/
   /* Fetch the first row from the Footwear Forecast Style Table.*/
   /* ------------------------------------------------------------*/
  ;
  try
    call "IO5430" ("N1", SQLCA, FG9REC) {isNoRefresh = yes, isExternal = yes};
  end /* Fetch table row*/
  ;
   /* ------------------------------------------------------------*/
   /* Save the SQL commarea from the fetch.*/
   /* ------------------------------------------------------------*/
  ;
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* Commarea from fetch*/
  ;
   /* ------------------------------------------------------------*/
   /* If successful or row not found, continue to close the set.*/
   /* ------------------------------------------------------------*/
  ;
  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/
    ;
     /* NEXT SENTENCE               ; Next sentence*/
    ;
  else
    ;
    if (sysVar.errorCode == "00000000" /* Call successful*/
     && SQLCA.VAGen_SQLCODE == 100)    /* and row not found*/
      ;
      FG9REC.SYBSTGNM = "??????"; /* Default style group name*/
      ;
    else
      ;
      /* ------------------------------------------------------------*/
       /* If data not available, post an error message and return.*/
       /* Otherwise, indicate that a system error has occurred.*/
      /* ------------------------------------------------------------*/
      ;
      TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
      ;
      TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
      TA1REC.TA1LOC = "FG05513 FETCH NEXT ROW IN PFHST";
      TA1REC.TA1DBASE = "DFCAST  "; /* Data base name*/
      TA1REC.TA1TBLVU = "VPFHST01"; /* Table view name*/
      TA1REC.TA1TBLKE = FG9REC.FG9KEY; /* Table key*/
      ;
      if (sysVar.errorCode == "00000000" /* Call successful*/
       && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/
        ;
        TA1REC.TA1FUNC = "POST"; /* Termination function*/
        call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes};
                                   /* Error diagnosis routine*/
        ;
        converseLib.validationFailed(47); /* Data in use by another*/
        ;
      else
        ;
        TA1REC.TA1FUNC = "RETN"; /* Termination function*/
        call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/
        ;
        converseLib.validationFailed(1); /* System error occurred*/
        ;
      end
      ;
      FFWREC.XXXMODID = "513"; /* Module identification*/
      ;
      exit stack; /* Exit to display map*/
      ;
    end
    ;
  end
  ;
end // end FG05513

// Close 'C1' PFHST
Function FG05514()
   /* ------------------------------------------------------------*/
   /* Close the set of rows from Production Style/Color Table.*/
   /* ------------------------------------------------------------*/
  ;
  try
    call "IO5430" ("C1", SQLCA, FG9REC) {isNoRefresh = yes, isExternal = yes};
  end /* Close table set*/
  ;
   /* ------------------------------------------------------------*/
   /* If successful, restore SQLCA and return to calling process.*/
   /* ------------------------------------------------------------*/
  ;
  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/
    ;
    /* ------------------------------------------------------------*/
     /* Restore the SQL commarea from the fetch.*/
    /* ------------------------------------------------------------*/
    ;
    SQLCA.SQLCAREC = TAEREC.SQLCAREC; /* Commarea from fetch*/
    ;
    return; /* Return to previous process*/
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that a system error has occurred.*/
   /* ------------------------------------------------------------*/
  ;
  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/
  ;
  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "FG05514 CLOSE STYLE GROUP SET";
  TA1REC.TA1DBASE = "DFCAST  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VPFHST01"; /* Table view name*/
  TA1REC.TA1TBLKE = FG9REC.FG9KEY; /* Table key*/
  ;
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/
  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/
  ;
  FFWREC.XXXMODID = "514"; /* Module identification*/
  converseLib.validationFailed(1); /* System error occurred*/
  ;
  exit stack; /* Exit to display map*/
  ;
  ;
end // end FG05514

// Get futures cutoff date
Function FG05515()
  ;
  set FF1REC empty; /* Clear up the storage row*/
  ;
  try
    call "IO3660" ("S ", SQLCA, FF1REC) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/
  ;
   /* ------------------------------------------------------------*/
   /* If successful or not found, return to the previous process.*/
   /* ------------------------------------------------------------*/
  ;
  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* Row not found*/
      return; /* Return to previous process*/
    end
  end
  ;
   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that a system error has occurred.*/
   /* ------------------------------------------------------------*/
  ;
  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL Commarea*/
  ;
  FFWREC.XXXMODID = "126"; /* Module identification*/
  ;
  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/
    converseLib.validationFailed(47); /* Indicate not available*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/
  else
    converseLib.validationFailed(01); /* Indicate system error*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/
    converseLib.clearScreen();
     /* Clear screen before display*/
  end
  ;
  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "SELECT THE TABLE ROW";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = FFWREC.XXXMODID; /* Program number*/
  TA1REC.TA1DBASE = "DFCAST  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VFFCTL01"; /* Table view name*/
  ;
  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/
  ;
  exit stack; /* Exit to display map*/
  ;
  ;
end // end FG05515

// Verify Relationships
Function FG05520()
   /* ------------------------------------------------------------*/
   /* Verify that key is in FFXRF.*/
   /* ------------------------------------------------------------*/
  ;
  if (converseVar.validationMsgNum == 0) /* If there are no errors*/
    ;
    /* ------------------------------------------------------------*/
     /* Clear the row storage area.*/
    /* ------------------------------------------------------------*/
    ;
    set FF2REC empty; /* clear DFCAST.VFFXRF01 record.*/
    ;
    /* ------------------------------------------------------------*/
     /* Format keys for call to DFCAST.VFFXRF01.*/
    /* ------------------------------------------------------------*/
    ;
    if (FG05M001.XPCCD == " ") /* category not entered*/
      FF2REC.XPCCD = "*"; /* category*/
    else
      FF2REC.XPCCD = FG05M001.XPCCD; /* category*/
    end
    ;
    if (FG05M001.XPLCD == " ") /* line not entered*/
      FF2REC.XPLCD = "*"; /* line*/
    else
      FF2REC.XPLCD = FG05M001.XPLCD; /* line*/
    end
    ;
    FF2REC.YSMXDV = "*"; /* division*/
    ;
    if (FG05M001.YPGCD == " ") /* type grp not entered*/
      FF2REC.YPGCD = "*"; /* type grp*/
    else
      FF2REC.YPGCD = FG05M001.YPGCD; /* type grp*/
    end
    ;
    /* ------------------------------------------------------------*/
     /* Select the row to display from the table.*/
    /* ------------------------------------------------------------*/
    ;
    FG05521(); /* Open cursor for DFCAST.VFFXRF01*/
    ;
    FG05522(); /* fetch FFXRF*/
    ;
    /* ------------------------------------------------------------*/
     /* If successful, close FFXRF.*/
    /* ------------------------------------------------------------*/
    ;
    if (SQLCA.VAGen_SQLCODE != 0) /* Row not found code*/
      ;
      /* ------------------------------------------------------------*/
       /* If not found, indicate invalid.*/
      /* ------------------------------------------------------------*/
      ;
      FFWREC.XXXMODID = "520"; /* Module identification*/
      if (FG05M001.XPCCD != " ") /* category entered*/
        set FG05M001.XPCCD bold; /* set cursor*/
      end
      set FG05M001.YPGCD bold; /* Highlight*/
      if (FG05M001.XPLCD != " ") /* line entered*/
        set FG05M001.XPLCD cursor, bold; /* set cursor*/
      end
      converseLib.validationFailed(203); /* Indicate invalid relationship*/
      ;
    else
      ;
      if (FG05M001.XPCCD != " ") /* category entered*/
        FG05M001.XPLCD = FF2REC.XPLCD; /* save line code*/
        if (FF2REC.XPLCD in XPLTBL.XPLCD)
          FG05M001.XPLABRV = XPLTBL.XPLABRV[sysVar.arrayIndex];
        end
        ;
        if (FG05M001.YPGCD != "*") /* If type not wildcard*/
          FG05M001.YPGCD = FF2REC.YPGCD; /* save type code*/
          if (FF2REC.YPGCD in YPGTBL.YPGCD)
            FG05M001.YPGABRV = YPGTBL.YPGABRV[sysVar.arrayIndex];
          end
        end
        ;
      end
    end
    ;
    FG05523(); /* close cursor*/
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* If Style/Color entered, verify that key is in PFHST.*/
   /* ------------------------------------------------------------*/
  ;
  if (FG05M001.SY1STNBR != " " /* style nbr entered*/
   && converseVar.validationMsgNum == 0) /* If there are no errors*/
    ;
    /* ------------------------------------------------------------*/
     /* Clear the row storage area.*/
    /* ------------------------------------------------------------*/
    ;
    set FG9REC empty; /* clear DFCAST.VPFHST01 record.*/
    ;
    /* ------------------------------------------------------------*/
     /* Format keys for call to DFCAST.VPFHST01.*/
    /* ------------------------------------------------------------*/
    ;
    FG9REC.SY1STNBR = FG05M001.SY1STNBR; /* style nbr*/
    FG9REC.SY2CLRID = FG05M001.SY2CLRID; /* color id*/
    FG9REC.XDMCD = FG05M001.XDMCD; /* dimension*/
    FG9REC.YSMXDV = "10"; /* division grp*/
    ;
    /* ------------------------------------------------------------*/
     /* Select the row to display from the table.*/
    /* ------------------------------------------------------------*/
    ;
    FG05511(); /* Fetch row - DFCAST.Vpfhst01*/
    ;
    if (SQLCA.VAGen_SQLCODE == 0) /* Row found*/
      ;
      if (FG05M001.SYBSTGNB != " " /* style group entered*/
       && FG9REC.SYBSTGNB != FG05M001.SYBSTGNB) /* style grp nbr*/
        FFWREC.XXXMODID = "520"; /* Module identification*/
        set FG05M001.XDMCD bold; /* Highlight*/
        set FG05M001.SY2CLRID bold; /* Highlight*/
        set FG05M001.SY1STNBR bold; /* Highlight*/
        set FG05M001.SYBSTGNB bold; /* Highlight*/
        converseLib.validationFailed(203); /* Indicate invalid relationship*/
      end
      ;
      if (FG05M001.XPCCD != " " /* cat cd entered*/
       && FG9REC.XPCCD != FG05M001.XPCCD) /* category*/
        FFWREC.XXXMODID = "520"; /* Module identification*/
        set FG05M001.XDMCD bold; /* Highlight*/
        set FG05M001.SY2CLRID bold; /* Highlight*/
        set FG05M001.SY1STNBR bold; /* Highlight*/
        set FG05M001.XPCCD cursor, bold; /* Highlight*/
        converseLib.validationFailed(203); /* Indicate invalid relationship*/
      end
      ;
      if (FG05M001.XPLCD != " " /* line cd entered*/
       && FG9REC.XPLCD != FG05M001.XPLCD) /* line*/
        FFWREC.XXXMODID = "520"; /* Module identification*/
        set FG05M001.XDMCD bold; /* Highlight*/
        set FG05M001.SY2CLRID bold; /* Highlight*/
        set FG05M001.SY1STNBR bold; /* Highlight*/
        set FG05M001.XPLCD cursor, bold; /* Highlight*/
        converseLib.validationFailed(203); /* Indicate invalid relationship*/
      end
      ;
      if (FG05M001.YPGCD != " " /* type cd entered*/
       && FG9REC.YPGCD != FG05M001.YPGCD) /* type*/
        FFWREC.XXXMODID = "520"; /* Module identification*/
        set FG05M001.XDMCD bold; /* Highlight*/
        set FG05M001.SY2CLRID bold; /* Highlight*/
        set FG05M001.SY1STNBR bold; /* Highlight*/
        set FG05M001.YPGCD cursor, bold; /* Highlight*/
        converseLib.validationFailed(203); /* Indicate invalid relationship*/
      end
      ;
    else
      ;
      if (SQLCA.VAGen_SQLCODE == 100) /* Row not found*/
        ;
        /* ------------------------------------------------------------*/
         /* If not found, try NIL*/
        /* ------------------------------------------------------------*/
        ;
        FG9REC.YSMXDV = "20"; /* division grp*/
        ;
        FG05511(); /* Fetch row - DFCAST.VPFHST01*/
        ;
        if (SQLCA.VAGen_SQLCODE == 0) /* Row found*/
          ;
          if (FG05M001.SYBSTGNB != " " /* style group entered*/
           && FG9REC.SYBSTGNB != FG05M001.SYBSTGNB) /* style grp nbr*/
            FFWREC.XXXMODID = "520"; /* Module identification*/
            set FG05M001.XDMCD bold; /* Highlight*/
            set FG05M001.SY2CLRID bold; /* Highlight*/
            set FG05M001.SY1STNBR bold; /* Highlight*/
            set FG05M001.SYBSTGNB bold; /* Highlight*/
            converseLib.validationFailed(203); /* Indicate invalid relationship*/
          end
          ;
          if (FG05M001.XPCCD != " " /* cat cd entered*/
           && FG9REC.XPCCD != FG05M001.XPCCD) /* category*/
            FFWREC.XXXMODID = "520"; /* Module identification*/
            set FG05M001.XDMCD bold; /* Highlight*/
            set FG05M001.SY2CLRID bold; /* Highlight*/
            set FG05M001.SY1STNBR bold; /* Highlight*/
            set FG05M001.XPCCD cursor, bold; /* Highlight*/
            converseLib.validationFailed(203); /* Indicate invalid relationship*/
          end
          ;
          if (FG05M001.XPLCD != " " /* line cd entered*/
           && FG9REC.XPLCD != FG05M001.XPLCD) /* line*/
            FFWREC.XXXMODID = "520"; /* Module identification*/
            set FG05M001.XDMCD bold; /* Highlight*/
            set FG05M001.SY2CLRID bold; /* Highlight*/
            set FG05M001.SY1STNBR bold; /* Highlight*/
            set FG05M001.XPLCD cursor, bold; /* Highlight*/
            converseLib.validationFailed(203); /* Indicate invalid relationship*/
          end
          ;
          if (FG05M001.YPGCD != " " /* type cd entered*/
           && FG9REC.YPGCD != FG05M001.YPGCD) /* type*/
            FFWREC.XXXMODID = "520"; /* Module identification*/
            set FG05M001.XDMCD bold; /* Highlight*/
            set FG05M001.SY2CLRID bold; /* Highlight*/
            set FG05M001.SY1STNBR bold; /* Highlight*/
            set FG05M001.YPGCD cursor, bold; /* Highlight*/
            converseLib.validationFailed(203); /* Indicate invalid relationship*/
          end
        else
          ;
          FFWREC.XXXMODID = "520"; /* Module identification*/
          set FG05M001.XDMCD bold; /* Highlight*/
          set FG05M001.SY2CLRID bold; /* Highlight*/
          set FG05M001.SY1STNBR cursor, bold; /* Highlight*/
          converseLib.validationFailed(203); /* Indicate invalid relationship*/
          ;
        end
      else
        ;
        FFWREC.XXXMODID = "520"; /* Module identification*/
        set FG05M001.XDMCD bold; /* Highlight*/
        set FG05M001.SY2CLRID bold; /* Highlight*/
        set FG05M001.SY1STNBR cursor, bold; /* Highlight*/
        converseLib.validationFailed(203); /* Indicate invalid relationship*/
        ;
      end
    end
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* If Style Group entered, verify that key is in PFHST.*/
   /* ------------------------------------------------------------*/
  ;
  if (FG05M001.SYBSTGNB != " " /* style grp entered*/
   && converseVar.validationMsgNum == 0) /* If there are no errors*/
    ;
    /* ------------------------------------------------------------*/
     /* Clear the row storage area.*/
    /* ------------------------------------------------------------*/
    set FG9REC empty; /* clear DFCAST.VPFHST01 record.*/
    ;
    /* ------------------------------------------------------------*/
     /* Format keys for call to DFCAST.VPFHST01.*/
    /* ------------------------------------------------------------*/
    ;
    FG9REC.SYBSTGNB = FG05M001.SYBSTGNB; /* style grp nbr*/
    FG9REC.YPGCD = FG05M001.YPGCD; /* type grp nbr*/
    FG9REC.YSMXDV = "10"; /* div group*/
    ;
    TA1REC.TA1PGMNM = "FG05520"; /* Calling process*/
    ;
    /* ------------------------------------------------------------*/
     /* Select the row to display from the table.*/
    /* ------------------------------------------------------------*/
    ;
    FG05W00.FG05WFND = "N";
    FG05512(); /* Open pfhst cursor for style group*/
    FG05513(); /* Fetch next row in cursor*/
    ;
    FG05W00.FG05WFND = "N";
    while (SQLCA.VAGen_SQLCODE != +100 /* until end of cursor*/
     && FG05W00.FG05WFND == "N") /* or row is found*/
      if (FG05M001.XPCCD == FG9REC.XPCCD)
        FG05W00.FG05WFND = "Y";
      else
        FG05513();
      end
      ;
    end
    ;
    FG05514(); /* Close the cursor*/
    ;
    /* ------------------------------------------------------------*/
     /* If not successful, try NIL.*/
    /* ------------------------------------------------------------*/
    ;
    if (FG05W00.FG05WFND == "N") /* Row not found*/
      ;
      FG9REC.YSMXDV = "20"; /* div group*/
      FG05W00.FG05WFND = "N";
      FG05512(); /* Open pfhst cursor for style group*/
      FG05513(); /* Fetch next row in cursor*/
      ;
      FG05W00.FG05WFND = "N";
      while (SQLCA.VAGen_SQLCODE != +100 /* until end of cursor*/
       && FG05W00.FG05WFND == "N") /* or row is found*/
        if (FG05M001.XPCCD == FG9REC.XPCCD)
          FG05W00.FG05WFND = "Y";
        end
        ;
        FG05513();
        ;
      end
      ;
      FG05514(); /* Close the cursor*/
      ;
    end
    ;
    /* ------------------------------------------------------------*/
     /* If row found, verify relationship.*/
    /* ------------------------------------------------------------*/
    ;
    if (FG05W00.FG05WFND == "Y") /* Row found*/
      ;
      if (FG05M001.XPCCD != " "
      
       && FG9REC.XPCCD != FG05M001.XPCCD) /* category*/
        FFWREC.XXXMODID = "520"; /* Module identification*/
        set FG05M001.SYBSTGNB bold; /* Highlight*/
        set FG05M001.XPCCD cursor, bold; /* Highlight*/
        converseLib.validationFailed(203); /* Indicate invalid relationship*/
      end
      ;
      if (FG05M001.XPLCD != " "
       && FG9REC.XPLCD != FG05M001.XPLCD) /* line*/
        FFWREC.XXXMODID = "520"; /* Module identification*/
        set FG05M001.SYBSTGNB bold; /* Highlight*/
        set FG05M001.XPLCD cursor, bold; /* Highlight*/
        converseLib.validationFailed(203); /* Indicate invalid relationship*/
      end
      ;
    else
      ;
      FFWREC.XXXMODID = "520"; /* Module identification*/
      set FG05M001.SYBSTGNB bold; /* Highlight*/
      set FG05M001.YPGCD cursor, bold; /* Highlight*/
      converseLib.validationFailed(203); /* Indicate invalid relationship*/
      ;
    end
    ;
  end
  ;
end // end FG05520

// Open FFXRF
Function FG05521()
   /* ------------------------------------------------------------*/
   /* Open FFXRF*/
   /* ------------------------------------------------------------*/
  ;
  try
    call "IO4000" ("S1", SQLCA, FF2REC) {isNoRefresh = yes, isExternal = yes};
  end
  ;
   /* ------------------------------------------------------------*/
   /* If successful, return to the previous process.*/
   /* ------------------------------------------------------------*/
  ;
  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (SQLCA.VAGen_SQLCODE == 0) /* and normal return code*/
      ;
      return; /* Return to previous process*/
    end
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that a system error has occurred.*/
   /* ------------------------------------------------------------*/
  ;
  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/
  ;
  FFWREC.XXXMODID = "521"; /* Module identification*/
  ;
  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/
    ;
    converseLib.validationFailed(47); /* 'Resources unavailable'*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/
    ;
  else
    ;
    converseLib.validationFailed(01); /* 'Error - Please nofity programming'*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/
    ;
    converseLib.clearScreen();
     /* Clear screen before display*/
    ;
  end
  ;
  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "OPEN CURSOR";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = FFWREC.XXXMODID; /* Program number*/
  TA1REC.TA1DBASE = "DFCAST  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VFFXRF01"; /* Table view name*/
  TA1REC.TA1TBLKE = FF2REC.FF2KEY; /* Table key*/
  ;
  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/
  ;
  exit stack; /* Exit to display map*/
  ;
  ;
end // end FG05521

// Fetch FFXRF
Function FG05522()
   /* ------------------------------------------------------------*/
   /* Fetch Next Row Xref Table*/
   /* ------------------------------------------------------------*/
  ;
  try
    call "IO4000" ("N1", SQLCA, FF2REC) {isNoRefresh = yes, isExternal = yes};
  end
  ;
   /* ------------------------------------------------------------*/
   /* If successful, Return to previous process*/
   /* ------------------------------------------------------------*/
  ;
  if (sysVar.errorCode == "00000000") /* Call successful*/
    ;
    if (SQLCA.VAGen_SQLCODE == 0 /* normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* row not found*/
      return; /* Return to previous process*/
    end
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that a system error has occurred.*/
   /* ------------------------------------------------------------*/
  ;
  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/
  ;
  FFWREC.XXXMODID = "522"; /* Module identification*/
  ;
  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/
    ;
    converseLib.validationFailed(47); /* Indicate not available*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/
    ;
  else
    ;
    converseLib.validationFailed(01); /* Indicate system error*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/
    ;
    converseLib.clearScreen();
     /* Clear screen before display*/
    ;
  end
  ;
  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "FETCH ROW";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = FFWREC.XXXMODID; /* Program number*/
  TA1REC.TA1DBASE = "DFCAST  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VFFXRF01"; /* Table view name*/
  TA1REC.TA1TBLKE = FF2REC.FF2KEY; /* Table key*/
  ;
  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/
  ;
  exit stack; /* Exit to display map*/
  ;
  ;
end // end FG05522

// Close Cursor - FFXRF
Function FG05523()
   /* ------------------------------------------------------------*/
   /* Close FFXRF*/
   /* ------------------------------------------------------------*/
  ;
  try
    call "IO4000" ("C1", SQLCA, FF2REC) {isNoRefresh = yes, isExternal = yes};
  end /* Close table set*/
  ;
   /* ------------------------------------------------------------*/
   /* If successful, return to the previous process.*/
   /* ------------------------------------------------------------*/
  ;
  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/
    ;
    return; /* Return to previous process*/
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that a system error has occurred.*/
   /* ------------------------------------------------------------*/
  ;
  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/
  ;
  FFWREC.XXXMODID = "523"; /* Module identification*/
  converseLib.validationFailed(01); /* 'Error - Please nofity programming'*/
  ;
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/
  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "CLOSE CURSOR";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = FFWREC.XXXMODID; /* Program number*/
  TA1REC.TA1DBASE = "DFCAST   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VFFXRF01"; /* Table view name*/
  ;
  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/
  ;
  exit stack; /* Exit to display map*/
  ;
  ;
end // end FG05523

// Process valid input request
Function FG05600()
   /* ------------------------------------------------------------*/
   /* Save the fields that were entered by the user.*/
   /* ------------------------------------------------------------*/
  ;
  FG05W00.FG05WSWF = "Y"; /* Format the map switch*/
  ;
  FFWREC.FFABEGMO = FFZREC.FFZBEGMO; /* beg month*/
  FFWREC.FFAENDMO = FFZREC.FFZENDMO; /* end month*/
  FG05W01.FFZBYYMM = FG05M001.FFZBYYMM; /* beg month*/
  FG05W01.FFZEYYMM = FG05M001.FFZEYYMM; /* end month*/
  FFWREC.XPLCD = FG05M001.XPLCD; /* line code*/
  FFWREC.XPLABRV = FG05M001.XPLABRV; /* line abrv*/
  FFWREC.YPGCD = FG05M001.YPGCD; /* type code*/
  FFWREC.YPGABRV = FG05M001.YPGABRV; /* type abrv*/
  FFWREC.XPCCD = FG05M001.XPCCD; /* category code*/
  FFWREC.XPCABRV = FG05M001.XPCABRV; /* category abrv*/
  FFWREC.SYBSTGNB = FG05M001.SYBSTGNB; /* style group nbr*/
  FFWREC.SYBSTGNM = FG05M001.SYBSTGNM; /* style group name*/
  FFWREC.SY1STNBR = FG05M001.SY1STNBR; /* style nbr*/
  FFWREC.SY1SSTNM = FG05M001.SY1SSTNM; /* style name*/
  FFWREC.SY2CLRID = FG05M001.SY2CLRID; /* color id*/
  FFWREC.SY2CLRAB = FG05M001.SY2CLRAB; /* color abrv*/
  FFWREC.XDMCD = FG05M001.XDMCD; /* dimension code*/
  FG05W01.FG05MSJS = FG05M001.FG05MSJS; /* submit job switch*/
  FG05W01.FG05SES1 = FG05M001.FG05SES1; /* season*/
  FG05W01.FG05SES2 = FG05M001.FG05SES2; /* season*/
  FG05W01.FG05SES3 = FG05M001.FG05SES3; /* season*/
  FG05W01.FG05SES4 = FG05M001.FG05SES4; /* season*/
  FG05W01.FG05CRYF = FG05M001.FG05CRYF; /* carryover flag*/
  FG05W01.FG05SPLF = FG05M001.FG05SPLF; /* specialty flag*/
  ;
   /* ------------------------------------------------------------*/
   /* If Submit Job Switch eq 'y' and key has changed, submit*/
   /* the JCL to run the batch job.*/
   /* ------------------------------------------------------------*/
  ;
  if (FFZREC.FFZBEGMO != FG05W02.FFZBEGMO   /* beg month changed*/
   || FFZREC.FFZENDMO != FG05W02.FFZENDMO   /* end month changed*/
   || FG05M001.XPLCD != FG05W02.XPLCD       /* Product line changed*/
   || FG05M001.YPGCD != FG05W02.YPGCD       /* or type group changed*/
   || FG05M001.XPCCD != FG05W02.XPCCD       /* or category changed*/
   || FG05M001.SYBSTGNB != FG05W02.SYBSTGNB /* or style group changed*/
   || FG05M001.SY1STNBR != FG05W02.SY1STNBR /* or style changed*/
   || FG05M001.SY2CLRID != FG05W02.SY2CLRID /* or color changed*/
   || FG05M001.XDMCD != FG05W02.XDMCD       /* or dimension changed*/
   || FG05M001.FG05SES1 != FG05W02.FG05SES1 /* or season changed*/
   || FG05M001.FG05SES2 != FG05W02.FG05SES2 /* or season changed*/
   || FG05M001.FG05SES3 != FG05W02.FG05SES3 /* or season changed*/
   || FG05M001.FG05SES4 != FG05W02.FG05SES4 /* or season changed*/
   || FG05M001.FG05CRYF != FG05W02.FG05CRYF /* or carryover change*/
   || FG05M001.FG05SPLF != FG05W02.FG05SPLF /* or specialty chang*/
  )                                        
    if (FG05W01.FG05MSJS == "Y") /* Submit Job*/
      FG05610();
      FG05W01.FG05MSJS = "N"; /* submit job switch*/
    else
      FFWREC.XXXMODID = "600"; /* Module identification*/
      converseLib.validationFailed(302); /* Switch must be 'Y' to prcs*/
      set FG05M001.FG05MSJS cursor, bold; /* set cursor*/
      exit stack; /* Exit to display map*/
    end
  else
    ;
    /* bgn tcs*/
    if (FG05M001.FG05MSJS == "Y") /**/
      /* end tcs*/
      FFWREC.XXXMODID = "600"; /* Module identification*/
      FFWREC.XXXMSGNO = 313; /* Forecast already submitted*/
    else
      FFWREC.XXXMODID = "600"; /* Module identification*/
      converseLib.validationFailed(302); /* Switch must be 'Y' to prcs*/
      set FG05M001.FG05MSJS cursor, bold; /* set cursor*/
      /* end tcs*/
      ;
    end
  end
  ;
end // end FG05600

// Submit a batch job
Function FG05610()
  ;
   /* ------------------------------------------------------------*/
   /* Call sub-routine to find which environment*/
   /* the program is executing in, development*/
   /* or production.*/
   /* ------------------------------------------------------------*/
  set TA3REC empty;
  TA3REC.TA3OPTN = "ASSIGN ";
  try
    call "TA0230" (TA3REC) {isNoRefresh = yes, isExternal = yes};
  end
  ;
  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA3REC.TA3RTNCD == 0)          /* Good return code*/
    if (TA3REC.TA3RGNID == "03") /* if on production system*/
      FG05611(); /* format production jcl*/
    else
      FG05612(); /* format development jcl*/
    end
  else
    ;
    FFWREC.XXXMODID = "610"; /* module identification*/
    FFWREC.XXXMSGNO = 87; /* Error encountered with print request*/
    exit stack;
  end
  ;
end // end FG05610

// Submit prod JCL FF7201
Function FG05611()
  ;
   /* ------------------------------------------------------------*/
   /* Initialize the work area and index to be used.*/
   /* ------------------------------------------------------------*/
  ;
  set TA6REC empty; /* Subroutine work area*/
  ;
  TA6REC.TA6INDEX = 1; /* Initialize index*/
  ;
   /* ------------------------------------------------------------*/
   /* Format JCL and parameters into the subroutine work area.*/
   /* ------------------------------------------------------------*/
  ;
  while (TA6REC.TA6INDEX > 0) /* Until end of table*/
    ;
    if (FG05T01.TARTYPE[TA6INDEX] == "P") /* Parameters statement*/
      ;
      /* ------------------------------------------------------------*/
       /* Format the variable parameters entered by the user.*/
      /* ------------------------------------------------------------*/
      ;
      FG05W02.YPGCD = FG05M001.YPGCD; /* Type group*/
      FG05W02.XPLCD = FG05M001.XPLCD; /* Product line*/
      FG05W02.XPCCD = FG05M001.XPCCD; /* Category*/
      FG05W02.SYBSTGNB = FG05M001.SYBSTGNB; /* Style group*/
      FG05W02.SY1STNBR = FG05M001.SY1STNBR; /* Style number*/
      FG05W02.SY2CLRID = FG05M001.SY2CLRID; /* Color id*/
      FG05W02.XDMCD = FG05M001.XDMCD; /* Dimension code*/
      FG05W02.FFZBEGMO = FFZREC.FFZBEGMO; /* Actual buy month*/
      FG05W02.FFZENDMO = FFZREC.FFZENDMO; /* Actual buy month*/
      FG05W02.CAUSERID = COMMAREA.CAUSERID; /* User id*/
      FG05W02.FG05SES1 = FG05M001.FG05SES1; /* Season code*/
      FG05W02.FG05SES2 = FG05M001.FG05SES2; /* Season code*/
      FG05W02.FG05SES3 = FG05M001.FG05SES3; /* Season code*/
      FG05W02.FG05SES4 = FG05M001.FG05SES4; /* Season code*/
      FG05W02.FG05CRYF = FG05M001.FG05CRYF; /* Carryover Flag*/
      FG05W02.FG05SPLF = FG05M001.FG05SPLF; /* Specialty Flag*/
      FG05W02.FG05SNRN = FG05W00.FG05SNRN; /* Season or Range*/
      ;
      TA6REC.TARJCL[TA6INDEX] = FG05W02.TARJCL; /* Parameters*/
      ;
    else
      ;
      /* ------------------------------------------------------------*/
       /* Format the Job Control Language statement from the table.*/
      /* ------------------------------------------------------------*/
      ;
      TA6REC.TARJCL[TA6INDEX] = FG05T01.TARJCL[TA6INDEX]; /* JCL*/
      TA6REC.TARTYPE[TA6INDEX] = FG05T01.TARTYPE[TA6INDEX]; /* Type*/
      ;
    end
    ;
    /* ------------------------------------------------------------*/
     /* If not end of table, increment the table index.*/
    /* ------------------------------------------------------------*/
    ;
    if (FG05T01.TARJCL[TA6INDEX] == "/*EOF") /* End of table*/
      ;
      TA6REC.TA6INDEX = 0; /* Indicate end of table*/
    else
      TA6REC.TA6INDEX = TA6REC.TA6INDEX + 1; /* Increment index*/
      ;
    end
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* Submit the JCL and parameters for batch execution.*/
   /* ------------------------------------------------------------*/
  ;
  TA6REC.TA6SUBSW = "S"; /* Tailor and submit JCL*/
  TA6REC.TA6MSGSW = "Y"; /* EOJ online msg switch*/
  ;
  XPTA0P(); /* Print Request Subroutine*/
  ;
   /* ------------------------------------------------------------*/
   /* If a successful, return to the previous process.*/
   /* ------------------------------------------------------------*/
  ;
  FFWREC.XXXMODID = "611"; /* Module identification*/
  ;
  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA6REC.TA6RTNCD == "0")        /* and normal return*/
    ;
    FFWREC.XXXMSGNO = 76; /* Indicate job was submitted*/
    ;
    return; /* Return to previous process*/
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that a system error has occurred.*/
   /* ------------------------------------------------------------*/
  ;
  converseLib.validationFailed(1); /* Indicate system error*/
  ;
  exit stack; /* Exit to display map*/
  ;
  ;
end // end FG05611

// Submit test JCL FF7201
Function FG05612()
   /* submit test JCL*/
  ;
   /* ------------------------------------------------------------*/
   /* Initialize the work area and index to be used.*/
   /* ------------------------------------------------------------*/
  ;
  set TA6REC empty; /* Subroutine work area*/
  ;
  TA6REC.TA6INDEX = 1; /* Initialize index*/
  ;
   /* ------------------------------------------------------------*/
   /* Format JCL and parameters into the subroutine work area.*/
   /* ------------------------------------------------------------*/
  ;
  while (TA6REC.TA6INDEX > 0) /* Until end of table*/
    ;
    if (FG05TT1.TARTYPE[TA6INDEX] == "P") /* Parameters statement*/
      ;
      /* ------------------------------------------------------------*/
       /* Format the variable parameters entered by the user.*/
      /* ------------------------------------------------------------*/
      ;
      FG05W02.YPGCD = FG05M001.YPGCD; /* Type group*/
      FG05W02.XPLCD = FG05M001.XPLCD; /* Product line*/
      FG05W02.XPCCD = FG05M001.XPCCD; /* Category*/
      FG05W02.SYBSTGNB = FG05M001.SYBSTGNB; /* Style group*/
      FG05W02.SY1STNBR = FG05M001.SY1STNBR; /* Style number*/
      FG05W02.SY2CLRID = FG05M001.SY2CLRID; /* Color id*/
      FG05W02.XDMCD = FG05M001.XDMCD; /* Dimension code*/
      FG05W02.FFZBEGMO = FFZREC.FFZBEGMO; /* Actual buy month*/
      FG05W02.FFZENDMO = FFZREC.FFZENDMO; /* Actual buy month*/
      FG05W02.CAUSERID = COMMAREA.CAUSERID; /* User id*/
      FG05W02.FG05SES1 = FG05M001.FG05SES1; /* Season code*/
      FG05W02.FG05SES2 = FG05M001.FG05SES2; /* Season code*/
      FG05W02.FG05SES3 = FG05M001.FG05SES3; /* Season code*/
      FG05W02.FG05SES4 = FG05M001.FG05SES4; /* Season code*/
      FG05W02.FG05CRYF = FG05M001.FG05CRYF; /* Carryover Flag*/
      FG05W02.FG05SPLF = FG05M001.FG05SPLF; /* Specialty Flag*/
      FG05W02.FG05SNRN = FG05W00.FG05SNRN; /* Season or Range*/
      ;
      TA6REC.TARJCL[TA6INDEX] = FG05W02.TARJCL; /* Parameters*/
      ;
    else
      ;
      /* ------------------------------------------------------------*/
       /* Format the Job Control Language statement from the table.*/
      /* ------------------------------------------------------------*/
      ;
      TA6REC.TARJCL[TA6INDEX] = FG05TT1.TARJCL[TA6INDEX]; /* JCL*/
      TA6REC.TARTYPE[TA6INDEX] = FG05TT1.TARTYPE[TA6INDEX]; /* Type*/
      ;
    end
    ;
    /* ------------------------------------------------------------*/
     /* If not end of table, increment the table index.*/
    /* ------------------------------------------------------------*/
    ;
    if (FG05TT1.TARJCL[TA6INDEX] == "/*EOF") /* End of table*/
      ;
      TA6REC.TA6INDEX = 0; /* Indicate end of table*/
    else
      TA6REC.TA6INDEX = TA6REC.TA6INDEX + 1; /* Increment index*/
      ;
    end
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* Submit the JCL and parameters for batch execution.*/
   /* ------------------------------------------------------------*/
  ;
  TA6REC.TA6SUBSW = "S"; /* Tailor and submit JCL*/
  TA6REC.TA6MSGSW = "Y"; /* EOJ online msg switch*/
  ;
  XPTA0P(); /* Print Request Subroutine*/
  ;
   /* ------------------------------------------------------------*/
   /* If a successful, return to the previous process.*/
   /* ------------------------------------------------------------*/
  ;
  FFWREC.XXXMODID = "612"; /* Module identification*/
  ;
  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA6REC.TA6RTNCD == "0")        /* and normal return*/
    ;
    FFWREC.XXXMSGNO = 76; /* Indicate job was submitted*/
    ;
    return; /* Return to previous process*/
    ;
  end
  ;
   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that a system error has occurred.*/
   /* ------------------------------------------------------------*/
  ;
  converseLib.validationFailed(1); /* Indicate system error*/
  ;
  exit stack; /* Exit to display map*/
  ;
  ;
end // end FG05612

// VALIDATE SEASON CODE
Function FG05S-VAL-SEASON()
  if (FG05W00.FG05W-YR not numeric)
    FFWREC.XXXMODID = "510";
    converseLib.validationFailed(537);
    return;
  end
  ;
  if (FG05W00.FG05W-SESN in FE0DTBL.FE0DSESN)
    FG05W00.FG05W-BEG-MM = FE0DTBL.FE0DBMON[sysVar.arrayIndex];
  end
  if (sysVar.arrayIndex == 0)
    FFWREC.XXXMODID = "510";
    converseLib.validationFailed(537);
    return;
  else
    FG05W00.FG05W-END-YY = FG05W00.FG05W-YR;
    FG05W00.FG05W-END-MM = FE0DTBL.FE0DEMON[sysVar.arrayIndex];
    if (FG05W00.FG05W-END-YY > 57)
      FG05W00.FG05W-END-CC = 19;
    else
      FG05W00.FG05W-END-CC = 20;
    end
    if (FG05W00.FG05W-END-MO > FG05W00.FG05W-GRTST-END-MO)
      FG05W00.FG05W-GRTST-END-MO = FG05W00.FG05W-END-MO;
    end
   /* IF FG05W00.FG05W-SESN = 'SP';*/
   /* IF FG05W00.FG05W-YR = 00;*/
   /* MOVE 99 TO FG05W00.FG05W-YR;*/
   /* ELSE;*/
   /* MOVE FG05W00.FG05W-YR TO FG05W00.FG05W-TEMP-YR;*/
   /* FG05W00.FG05W-TEMP-YR = FG05W00.FG05W-TEMP-YR - 1;*/
   /* MOVE FG05W00.FG05W-TEMP-YR TO FG05W00.FG05W-YR;*/
   /* END;*/
   /* END;*/
    FG05W00.FG05W-BEG-YY = FG05W00.FG05W-YR;
    if (FG05W00.FG05W-BEG-YY > 57)
      FG05W00.FG05W-BEG-CC = 19;
    else
      FG05W00.FG05W-BEG-CC = 20;
    end
    if (FG05W00.FG05W-BEG-MO < FG05W00.FG05W-LEAST-BEG-MO)
      FG05W00.FG05W-LEAST-BEG-MO = FG05W00.FG05W-BEG-MO;
    end
  end
  ;
  if (FG05W00.FG05W-LEAST-BEG-MO < FG05W00.FG05W-BUY-CYM)
    if (FG05W00.FG05W-END-MO < FG05W00.FG05W-BUY-CYM)
      FFWREC.XXXMODID = "510";
      converseLib.validationFailed(540);
      return;
    else
      FG05W00.FG05W-LEAST-BEG-MO = FG05W00.FG05W-BUY-CYM;
    end
  end
end // end FG05S-VAL-SEASON

//*** RECORD=FG05W00 ****
// ----------------------------
// Application working storage.
// ----------------------------
// ***********************
Record FG05W00 type basicRecord
  10 FG05WSWF FG05WSWF ; 
  10 FG05WSWZ FG05WSWZ ; 
  10 FG05WSWT FG05WSWT ; 
  10 FG05WIXM FG05WIXM ; 
  10 FFABEGMO FFABEGMO ; 
  10 FFQMBYMO FFQMBYMO ; 
  10 FF1FUTDT FF1FUTDT ; 
  10 FG05WBYM FG05WBYM ; 
  10 XWSCD XWSCD ; 
  10 FG05WFND FG05WFND ; 
  10 FG05WBEG FG05WBEG ; 
    15 FG05WBCC FG05WBCC ; 
    15 FG05WBDT FG05WBDT ; 
      20 FG05WBYY FG05WBYY ; 
      20 FG05WBMM FG05WBMM ; 
  10 FG05WEND FG05WEND ; 
    15 FG05WECC FG05WECC ; 
    15 FG05WEDT FG05WEDT ; 
      20 FG05WEYY FG05WEYY ; 
      20 FG05WEMM FG05WEMM ; 
  10 FG05WCUR FG05WCUR ; 
    15 FG05WCCC FG05WCCC ; 
    15 FG05WCYY FG05WCYY ; 
    15 FG05WCMM FG05WCMM ; 
  10 FG05WSDT FG05WSDT ; 
    15 FG05WSYY FG05WSYY ; 
    15 FG05WSMM FG05WSMM ; 
    15 FG05WSDD FG05WSDD ; 
  10 FG05WFLG FG05WFLG ; 
  10 FG05W-SESN-ENTERED FG05W-SESN-ENTERED ; 
  10 FG05W-DATE-ENTERED FG05W-DATE-ENTERED ; 
  10 FG05SNRN FG05SNRN ; 
  10 FG05W-BUY-DT FG05W-BUY-DT ; 
    15 * num(1) ; // First time switch
    15 FG05W-BUY-CYM FG05W-BUY-CYM ; 
      20 FG05W-BUY-CC FG05W-BUY-CC ; 
      20 FG05W-BUY-YY FG05W-BUY-YY ; 
      20 FG05W-BUY-MM FG05W-BUY-MM ; 
    15 FG05W-BUY-DD FG05W-BUY-DD ; 
  10 FG05W-TEMP-YR FG05W-TEMP-YR ; 
  10 FG05W-SESN-YR FG05W-SESN-YR ; 
    15 FG05W-SESN FG05W-SESN ; 
    15 FG05W-YR FG05W-YR ; 
  10 TEMP-DATE TEMP-DATE ; 
    15 TEMP-CC TEMP-CC ; 
    15 TEMP-YY TEMP-YY ; 
    15 TEMP-MM TEMP-MM ; 
  10 FG05W-BEG-MO FG05W-BEG-MO ; 
    15 FG05W-BEG-CC FG05W-BEG-CC ; 
    15 FG05W-BEG-YY FG05W-BEG-YY ; 
    15 FG05W-BEG-MM FG05W-BEG-MM ; 
  10 FG05W-LEAST-BEG-MO FG05W-LEAST-BEG-MO ; 
    15 FG05W-LEAST-BEG-CC FG05W-LEAST-BEG-CC ; 
    15 FG05W-LEAST-BEG-YY FG05W-LEAST-BEG-YY ; 
    15 FG05W-LEAST-BEG-MM FG05W-LEAST-BEG-MM ; 
  10 FG05W-END-MO FG05W-END-MO ; 
    15 FG05W-END-CC FG05W-END-CC ; 
    15 FG05W-END-YY FG05W-END-YY ; 
    15 FG05W-END-MM FG05W-END-MM ; 
  10 FG05W-GRTST-END-MO FG05W-GRTST-END-MO ; 
    15 FG05W-GRTST-END-CC FG05W-GRTST-END-CC ; 
    15 FG05W-GRTST-END-YY FG05W-GRTST-END-YY ; 
    15 FG05W-GRTST-END-MM FG05W-GRTST-END-MM ; 
end // end FG05W00

//*** RECORD=FG05W01 ****
// ------------------------
// Map 001 display storage.
// ------------------------
// ***********************
Record FG05W01 type basicRecord
  10 SY1SSTNM SY1SSTNM ; 
  10 SY2CLRAB SY2CLRAB ; 
  10 FFZBYYMM FFZBYYMM ; 
  10 FFZEYYMM FFZEYYMM ; 
  10 FG05MSJS FG05MSJS ; 
  10 FG05WLSW FG05WLSW ; 
  10 FG05SES1 FG05SES1 ; 
  10 FG05SES2 FG05SES2 ; 
  10 FG05SES3 FG05SES3 ; 
  10 FG05SES4 FG05SES4 ; 
  10 FG05CRYF FG05CRYF ; 
  10 FG05SPLF FG05SPLF ; 
end // end FG05W01

//*** RECORD=FG05W02 ****
// ----------------------------
// Application working storage.
// ----------------------------
// ***********************
Record FG05W02 type basicRecord
  10 TARJCL TARJCL ; 
    15 YPGCD YPGCD ; 
    15 XPLCD XPLCD ; 
    15 XPCCD XPCCD ; 
    15 SYBSTGNB SYBSTGNB ; 
    15 SY1STNBR SY1STNBR ; 
    15 SY2CLRID SY2CLRID ; 
    15 XDMCD XDMCD ; 
    15 FFZBEGMO FFZBEGMO ; 
    15 FFZENDMO FFZENDMO ; 
    15 CAUSERID CAUSERID ; 
    15 FG05SES1 FG05SES1 ; 
    15 FG05SES2 FG05SES2 ; 
    15 FG05SES3 FG05SES3 ; 
    15 FG05SES4 FG05SES4 ; 
    15 FG05CRYF FG05CRYF ; 
    15 FG05SPLF FG05SPLF ; 
    15 FG05SNRN FG05SNRN ; 
    15 * char(18) ; 
end // end FG05W02

// submit job switch
DataItem FG05CRYF char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// submit job switch
DataItem FG05MSJS char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// submit job switch
DataItem FG05SES1 char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// submit job switch
DataItem FG05SES2 char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// submit job switch
DataItem FG05SES3 char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// submit job switch
DataItem FG05SES4 char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// First time switch
DataItem FG05SNRN char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// submit job switch
DataItem FG05SPLF char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// First time switch
DataItem FG05W-BEG-CC num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-BEG-MM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-BEG-MO num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-BEG-YY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-BUY-CC num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-BUY-CYM num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-BUY-DD num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-BUY-DT num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-BUY-MM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-BUY-YY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-DATE-ENTERED char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// First time switch
DataItem FG05W-END-CC num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-END-MM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-END-MO num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-END-YY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-GRTST-END-CC num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-GRTST-END-MM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-GRTST-END-MO num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-GRTST-END-YY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-LEAST-BEG-CC num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-LEAST-BEG-MM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-LEAST-BEG-MO num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-LEAST-BEG-YY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-SESN char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// First time switch
DataItem FG05W-SESN-ENTERED char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// First time switch
DataItem FG05W-SESN-YR char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// First time switch
DataItem FG05W-TEMP-YR num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem FG05W-YR char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Century
DataItem FG05WBCC num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = "0", inputRequired = no
}
end

DataItem FG05WBDT num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem FG05WBEG num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem FG05WBMM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// date range beg month
DataItem FG05WBYM num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem FG05WBYY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// Century
DataItem FG05WCCC num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = "0", inputRequired = no
}
end

DataItem FG05WCMM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem FG05WCUR num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem FG05WCYY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// Century
DataItem FG05WECC num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = "0", inputRequired = no
}
end

DataItem FG05WEDT num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem FG05WEMM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem FG05WEND num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem FG05WEYY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem FG05WFLG char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// record found switch
DataItem FG05WFND char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Season index
DataItem FG05WIXM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// submit job switch
DataItem FG05WLSW char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem FG05WSDD num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem FG05WSDT num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem FG05WSMM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// Format the map switch
DataItem FG05WSWF char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// First time switch
DataItem FG05WSWT char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Tentative buy qty zero flag
DataItem FG05WSWZ char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem FG05WSYY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem TEMP-CC num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem TEMP-DATE num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem TEMP-MM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// First time switch
DataItem TEMP-YY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

