package os0n;

import corpcom4.XSENTRY;
import corpcom4.XSEXIT;
import corpcom4.XSPF4;
import corpcom4.XSSEGTR;
import corpcom5.COMMAREA;
import corpcom5.ERRSQLCA;
import corpcom6.SQLCA;
import ku.common.KUCREC;
import ku.common.KUJREC;
import ku.common.KUKREC;
import os.common.OSRREC;
import os.common.OSUREC;
import os.common.OSWWREC;
import ta.common.TA1REC;
import ta.common.TA2REC;
import ta.common.TA5REC;
import ta.common.TAEREC;
import vv.common.VBASGN02;
//*** PROGRAM=OS0N ****
// OVERVIEW:
// POSSIBLE STATEMENT GROUP MEANINGS:
//    OS0NS-DEC-X  = DECLARE NEW RECORD SET
//    OS0NS-FET-X  = FETCH NEXT RECORD
//    OS0NS-CLS-X  = CLOSE RECORD CURSOR
//    OS0NS-BLD-X  = BUILD RECORD
//    OS0NS-LOAD-X = LOAD RECORD
//    OS0NS-GET-X  = SELECT RECORD
//    OS0NS-EDT-X  = EDIT FIELD
//    OS0NS-UPD-X  = UPDATE RECORD
// 
// 
// **  statement group naming is flexible and may not have
//     any meaning especially after several enhancements.
// 
// ********************************************************
// *     M A I N T E N A N C E     L O G                  *
// ********************************************************
// *
// * DATE        NAME          DESCRIPTION OF CHANGE
// *
// * 04/18/94   SCHASE     Created.
// * 09/28/94   SCHASE     Adjusted PF3/PF4 when errors occur.
// *                       os0ns-trnfsr-cntl, os0n010
// * 11/29/94   CBRINE     Added OSWW-MSG-NBR to OSWWREC.
// * 02/13/95   SCHASE     Removed GPC Code as selection field
// *                       on map.  Force the GPC Code to be
// *                       always selected. OS0NM001, OS0NS-EDT
// *                       -MAP, OS0NS-FMT-BASGN01, OS0NS-LOAD-
// *                       MAP, OS0NS-RESET-ATTRIB.
// * 02/23/95   schase     added code to convert need dates
// *                       into CCYYMMDD format. OS0NS-FMT-
// *                       VBASGN01.
// * 03/12/96   nfield     Added sales rep id to map OS0NM001,
// *                       OS0NS-LOAD-MAP, OS0NS-RESET-ATTRIB.
// *                       Added OS0NS-EDT-SREP-SEL.
// *                       Changed OS0NS-FMT-BASGN01,
// *                               OS0NS-EDT-MAP
// *                       Changed to use VBASGN02
// * 12/30/96   nfield     Changed OS0NS-LOAD-MAP and added
// *                       OS0NS-CONVERT-DATE to fix problem
// *                       with screen date presentation.
// * 12/30/97   klee       Changed current date processing
// * 03/13/98   KLEE       Changed screen layout. Added
// *            SATYAM     ability to select by parent co.
// *                       Modified by Klee and tested by
// *                       Srinivas.
// *********************
Program OS0N type textUIProgram //VAGen Info - main text program
  {
  includeReferencedFunctions = yes, allowUnqualifiedItemReferences = yes, 
  throwNrfEofExceptions = yes, handleHardIOErrors = no, V60ExceptionCompatibility = yes, 
  I4GLItemsNullable = no, textLiteralDefaultIsString = no, localSQLScope = yes, 
  msgTablePrefix = "OP00", inputRecord = COMMAREA, segmented = yes
  }

  // Data Declarations
  COMMAREA COMMAREA ; // record
  ERRSQLCA ERRSQLCA; // record
  KUCREC KUCREC; // record
  KUJREC KUJREC; // record
  KUKREC KUKREC; // record
  OS0NW01 OS0NW01; // record
  OSRREC OSRREC; // record
  OSUREC OSUREC; // record
  OSWWREC OSWWREC; // record
  SQLCA SQLCA; // record
  TA1REC TA1REC; // record
  TA2REC TA2REC; // record
  TA5REC TA5REC; // record
  TAEREC TAEREC; // record
  VBASGN02 VBASGN02; // record

  // VAGen Info - items needed for migration
  VAGen_EZESYS char(8);
  VAGen_EZEREPLY num(1);
  VAGen_EZE_WAIT_TIME bin(9,2);
  VAGen_EZE_ITEMLEN int;

  // Use Declarations
  use OS0NM.OS0NM001 // form
   {
    pfKeyEquate = no
  };

  function main()
    // VAGen Info - initialization needed for migration
    VAGen_EZESYS = VGLib.getVAGSysType();
    OS0N000: OS0N000();
    goto OS0N010;
    OS0N010: OS0N010();
    goto OS0N010;
  end // end main
end // end OS0N

// main execute process
Function OS0N000()
     /* Check csp security*/
  ;
  XSENTRY();
  XSSEGTR(); /* set os0n segmented trans id*/
  ;
     /* Initialize application - init records, save map name*/
  ;
  OS0NS-INIT-OS0N();
  ;
     /* Build map for display*/
  ;
  OS0NS-BLD-MAP();
  ;
  ;
end // end OS0N000

// converse/ after process
Function OS0N010()
  ;
  converseLib.clearScreen();
   /* set map to scroll properly*/
  converseVar.segmentedMode = 1; /* force segmented converse mode*/
  ;
  converse OS0NM001 ;
  ;
     /* Init error stuff*/
  ;
  OSWWREC.OSWWERFL = "N";
  converseLib.validationFailed(0);
  ;
  ;
     /* Reset field attributes*/
  ;
  OS0NS-RESET-ATTRIB();
  ;
  ;
     /* Edit map*/
  ;
  OS0NS-EDT-MAP();
  ;
  ;
     /* Update map*/
  ;
  if (converseVar.eventKey is enter /* CONTINUE*/
   || converseVar.eventKey is pf3   /* return to os0m appl*/
   || converseVar.eventKey is pf4   /* return to om0m appl*/
   || converseVar.eventKey is pf10) /* goto os0p appl*/
    if (OSWWREC.OSWWERFL == "N") /* no errors*/
      if (OS0NW01.OS0NW-CHG-FLAG == "Y") /* map field changed*/
        OS0NS-UPD-MAP();
      end
    end
  end
  ;
  ;
     /* Transfer to another application*/
  ;
  OS0NS-TRNSFR-CNTL(); /* transfer to requested application.*/
  ;
  ;
end // end OS0N010

// Build OS0N Map
Function OS0NS-BLD-MAP()
  ;
     /* build map headings*/
  ;
  OS0NS-FMT-HEADINGS();
  ;
    /* display existing bulk assignment id*/
  ;
  OS0NS-GET-VBASGN02(); /* select from vbasgn01*/
  OS0NS-LOAD-MAP(); /* load values to map*/
  ;
     /* reset field attributes*/
  ;
  OS0NS-RESET-ATTRIB();
  ;
  ;
end // end OS0NS-BLD-MAP

// CALL SUBPROGRAM OS1030
Function OS0NS-CALL-OS1030()
  ;
  call "OS1030" (OSUREC) {isNoRefresh = yes, isExternal = yes};
  ;
  if (OSUREC.OSU-RETURN-CODE == 00)
     /* next sentence*/
  else
    if (OSUREC.OSU-RETURN-CODE == 01)
      OSWWREC.OSWWERFL = "Y"; /* set error flag*/
      converseLib.validationFailed(875); /* value is incompatible with draw criteria*/
    else
      if (OSUREC.OSU-RETURN-CODE == 02)
        OSWWREC.OSWWERFL = "Y"; /* set error flag*/
        converseLib.validationFailed(010); /* database busy try again*/
      else
        if (OSUREC.OSU-RETURN-CODE == 03)
          if (OSWWREC.OSWWFRMAP == "OS0L") /* came from os0l appl*/
            OS0NS-PRG-TMP-STOR(); /* purge temp storage*/
          end
          TA1REC.TA1TYPE = "DB2 ";
          TA1REC.TA1FUNC = "RETN";
          TA1REC.TA1PGMNM = "OS0N    ";
          TA1REC.TA1LOCAT[1] = "OS0NS-CA";
          TA1REC.TA1LOCAT[2] = "LL-OS103";
          TA1REC.TA1LOCAT[3] = "0 OS1030";
          TA1REC.TA1DBASE = "DCUST   ";
          TA1REC.TA1TBLVU = "VCMPNY01";
          ;
          call "TA0020" (TA1REC, SQLCA) {isExternal = yes};
          ;
          COMMAREA.CAUSERA = " ";
          ;
          XSPF4();
          exit program;
        end
      end
    end
  end
  ;
  ;
end // end OS0NS-CALL-OS1030

// CLOSE KUCREC CURSOR
Function OS0NS-CLS-KUCREC()
  ;
  ;
  set SQLCA empty;
  ;
  call "IO0240" ("C1", SQLCA, KUCREC) {isNoRefresh = yes, isExternal = yes};
  ;
  if (SQLCA.VAGen_SQLCODE == 0
  ) /* next sentence*/
  else
    if (SQLCA.VAGen_SQLCODE == -911)
      OSWWREC.OSWWERFL = "Y";
      converseLib.validationFailed(010); /* database busy*/
    else
      if (OSWWREC.OSWWFRMAP == "OS0L") /* came from os0l appl*/
        OS0NS-PRG-TMP-STOR(); /* purge temp storage*/
      end
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "OS0N    ";
      TA1REC.TA1LOCAT[1] = "OS0NS-CL";
      TA1REC.TA1LOCAT[2] = "S-KUCREC";
      TA1REC.TA1LOCAT[3] = " IO0240 ";
      TA1REC.TA1LOCAT[4] = "C1      ";
      TA1REC.TA1DBASE = "DCUST   ";
      TA1REC.TA1TBLVU = "VCMPNY01";
      TA1REC.TA1TBLKE = OS0NW01.OS0NW-KUCREC-POST;
      ;
      call "TA0020" (TA1REC, SQLCA) {isExternal = yes};
      ;
      COMMAREA.CAUSERA = " ";
      ;
      XSPF4();
      exit program;
    end
  end
  ;
  ;
end // end OS0NS-CLS-KUCREC

// CLOSE KUCREC CURSOR
Function OS0NS-CLS-KUCREC2()
  ;
  ;
  set SQLCA empty;
  ;
  call "IO0240" ("C2", SQLCA, KUCREC) {isNoRefresh = yes, isExternal = yes};
  ;
  if (SQLCA.VAGen_SQLCODE == 0
  ) /* next sentence*/
  else
    if (SQLCA.VAGen_SQLCODE == -911)
      OSWWREC.OSWWERFL = "Y";
      converseLib.validationFailed(010); /* database busy*/
    else
      if (OSWWREC.OSWWFRMAP == "OS0L") /* came from os0l appl*/
        OS0NS-PRG-TMP-STOR(); /* purge temp storage*/
      end
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "OS0N    ";
      TA1REC.TA1LOCAT[1] = "OS0NS-CL";
      TA1REC.TA1LOCAT[2] = "S-KUCREC";
      TA1REC.TA1LOCAT[3] = " IO0240 ";
      TA1REC.TA1LOCAT[4] = "C2      ";
      TA1REC.TA1DBASE = "DCUST   ";
      TA1REC.TA1TBLVU = "VCMPNY01";
      TA1REC.TA1TBLKE = OS0NW01.OS0NW-KUCREC-POST;
      ;
      call "TA0020" (TA1REC, SQLCA) {isExternal = yes};
      ;
      COMMAREA.CAUSERA = " ";
      ;
      XSPF4();
      exit program;
    end
  end
  ;
  ;
end // end OS0NS-CLS-KUCREC2

// CONVERT MMDDYY TO COMP FORMAT
Function OS0NS-CONVERT-DATE()
    /* convert DB2 date to screen format*/
  ;
  ;
  ;
   /* the calling stmt group must move the DB2 date*/
   /* to OSWWREC.OSWWDT8 before entering this routine*/
  ;
  if (OSWWREC.OSWWDT8 == 0)
    OSWWREC.OSWWDT6 = 0;
    return;
  end
  ;
  ;
  OSWWREC.OSWWDT6Y = OSWWREC.OSWWDT8Y;
  OSWWREC.OSWWDT6M = OSWWREC.OSWWDT8M;
  OSWWREC.OSWWDT6D = OSWWREC.OSWWDT8D;
  ;
  ;
   /* the calling stmt group needs to move*/
   /* OSWWREC.OSWWDT6 to the comp date field.*/
  ;
end // end OS0NS-CONVERT-DATE

// DECLARE KUCREC CURSOR
Function OS0NS-DEC-KUCREC()
  ;
  ;
  set SQLCA empty;
  ;
  call "IO0240" ("S1", SQLCA, KUCREC) {isNoRefresh = yes, isExternal = yes};
  ;
  if (SQLCA.VAGen_SQLCODE == 0)
    /* continue*/
  else
    if (SQLCA.VAGen_SQLCODE == -911)
      OSWWREC.OSWWERFL = "Y";
      converseLib.validationFailed(010); /* database busy*/
    else
      if (OSWWREC.OSWWFRMAP == "OS0L") /* came from os0l application*/
        OS0NS-PRG-TMP-STOR(); /* purge os0l temp storage*/
      end
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "OS0N    ";
      TA1REC.TA1LOCAT[1] = "OS0NS-DE";
      TA1REC.TA1LOCAT[2] = "C-KUCREC";
      TA1REC.TA1LOCAT[3] = " IO0240 ";
      TA1REC.TA1LOCAT[4] = "S1      ";
      TA1REC.TA1DBASE = "DCUST   ";
      TA1REC.TA1TBLVU = "VCMPNY01";
      TA1REC.TA1TBLKE = OS0NW01.OS0NW-KUCREC-POST;
      ;
      call "TA0020" (TA1REC, SQLCA) {isExternal = yes};
      ;
      COMMAREA.CAUSERA = " ";
      ;
      XSPF4();
      exit program;
    end
  end
  ;
  ;
end // end OS0NS-DEC-KUCREC

// DECLARE KUCREC CURSOR
Function OS0NS-DEC-KUCREC2()
  ;
  ;
  set SQLCA empty;
  ;
  call "IO0240" ("S2", SQLCA, KUCREC) {isNoRefresh = yes, isExternal = yes};
  ;
  if (SQLCA.VAGen_SQLCODE == 0)
    /* continue*/
  else
    if (SQLCA.VAGen_SQLCODE == -911)
      OSWWREC.OSWWERFL = "Y";
      converseLib.validationFailed(010); /* database busy*/
    else
      if (OSWWREC.OSWWFRMAP == "OS0L") /* came from os0l application*/
        OS0NS-PRG-TMP-STOR(); /* purge os0l temp storage*/
      end
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "OS0N    ";
      TA1REC.TA1LOCAT[1] = "OS0NS-DE";
      TA1REC.TA1LOCAT[2] = "C-KUCREC";
      TA1REC.TA1LOCAT[3] = " IO0240 ";
      TA1REC.TA1LOCAT[4] = "S2      ";
      TA1REC.TA1DBASE = "DCUST   ";
      TA1REC.TA1TBLVU = "VCMPNY01";
      TA1REC.TA1TBLKE = OS0NW01.OS0NW-KUCREC-POST;
      ;
      call "TA0020" (TA1REC, SQLCA) {isExternal = yes};
      ;
      COMMAREA.CAUSERA = " ";
      ;
      XSPF4();
      exit program;
    end
  end
  ;
  ;
end // end OS0NS-DEC-KUCREC2

// EDIT BEGINNING NEED DATE
Function OS0NS-EDT-BEG-NEED()
  ;
    /* verify date is a valid date*/
  ;
  OSWWREC.OSWWDT6 = OS0NM001.OB-NEED-BULK-BDT; /* frmt oswwrec MMDDYY*/
  ;
  OS0NS-VALIDATE-DT(); /* validate date*/
  ;
  if (TA2REC.TA2RTNCD == 0) /* good return*/
    VBASGN02.OB-NEED-BULK-BDT = OSWWREC.OSWWDT8; /* frmt begin date*/
  else
    set OS0NM001.OB-NEED-BULK-BDT cursor, bold;
    VBASGN02.OB-NEED-BULK-BDT = 0; /* frmt begin date*/
  end
  ;
  ;
end // end OS0NS-EDT-BEG-NEED

// EDIT COMPANY SELECTION
Function OS0NS-EDT-CO-SEL()
  ;
    /* Verify that more than one were selected*/
  ;
  if (OS0NM001.OB-SEL-GRPCO-ID-FL != " ") /* tried to select company group*/
    converseLib.validationFailed(834); /* mult selections not allowed*/
    OSWWREC.OSWWERFL = "Y"; /* set error flag*/
    set OS0NM001.OB-SEL-CO-ID-FL cursor, bold;
  end
  ;
  if (OS0NM001.OB-SEL-PNTCO-ID-FL != " ") /* tried to select parent company*/
    converseLib.validationFailed(834); /* mult selections not allowed*/
    OSWWREC.OSWWERFL = "Y"; /* set error flag*/
    set OS0NM001.OB-SEL-CO-ID-FL cursor, bold;
  end
  ;
    /* Edit Company Selection Flag*/
  ;
  if (OS0NM001.OB-SEL-CO-ID-FL == "S"
   || OS0NM001.OB-SEL-CO-ID-FL == " ")
    /* next sentence*/
  else
    converseLib.validationFailed(864); /* invalid selection option*/
    OSWWREC.OSWWERFL = "Y"; /* set error flag*/
    set OS0NM001.OB-SEL-CO-ID-FL cursor, bold;
  end
  ;
    /* Edit Company Selection Flag in relationship to entered companies*/
  ;
  if (OS0NM001.CU-GRP-CO-ID1 > 0 /* group exists*/
   || OS0NM001.CU-GRP-CO-ID2 > 0 /* group exists*/
   || OS0NM001.CU-GRP-CO-ID3 > 0 /* group exists*/
   || OS0NM001.CU-GRP-CO-ID4 > 0 /* group exists*/
   || OS0NM001.CU-GRP-CO-ID5 > 0 /* group exists*/
   || OS0NM001.CU-PNT-CO-ID1 > 0 /* parent exists*/
   || OS0NM001.CU-PNT-CO-ID2 > 0 /* parent exists*/
   || OS0NM001.CU-PNT-CO-ID3 > 0 /* parent exists*/
   || OS0NM001.CU-PNT-CO-ID4 > 0 /* parent exists*/
   || OS0NM001.CU-PNT-CO-ID5 > 0) /* parent exists*/
    if (OS0NM001.OB-SEL-CO-ID-FL == "S")
      OSWWREC.OSWWERFL = "Y";
      converseLib.validationFailed(874); /* invalid selection for other additional values*/
      set OS0NM001.OB-SEL-CO-ID-FL cursor, bold;
    end
  end
  ;
end // end OS0NS-EDT-CO-SEL

// EDIT GROUP/PARENT/COMPNY COMBO
Function OS0NS-EDT-CU-COMBO()
  ;
    /* verify that atleast one group/parent/company was entered*/
  ;
  if (OS0NM001.OB-SEL-GRPCO-ID-FL == " "
   && OS0NM001.OB-SEL-PNTCO-ID-FL == " "
   && OS0NM001.OB-SEL-CO-ID-FL == " ")
    converseLib.validationFailed(855); /* Atleast one group/parent/company*/
    OSWWREC.OSWWERFL = "Y"; /* is required*/
    set OS0NM001.OB-SEL-GRPCO-ID-FL cursor, bold;
    set OS0NM001.OB-SEL-PNTCO-ID-FL bold;
    set OS0NM001.OB-SEL-CO-ID-FL bold;
  end
  ;
  ;
end // end OS0NS-EDT-CU-COMBO

// EDIT DEPARTMENT SELECTION
Function OS0NS-EDT-DEPT-SEL()
  ;
    /* Edit Department Self ID Selection Flag*/
  ;
  if (OS0NM001.OB-SEL-DEPT-ID-FL == "S"
   || OS0NM001.OB-SEL-DEPT-ID-FL == " ")
    /* next sentence*/
  else
    converseLib.validationFailed(864); /* invalid selection option*/
    OSWWREC.OSWWERFL = "Y"; /* set error flag*/
    set OS0NM001.OB-SEL-DEPT-ID-FL cursor, bold;
  end
  ;
  ;
end // end OS0NS-EDT-DEPT-SEL

// EDIT ENDING NEED DATE
Function OS0NS-EDT-END-NEED()
  ;
    /* verify date is a valid date*/
  ;
  OSWWREC.OSWWDT6 = OS0NM001.OB-NEED-BULK-XDT; /* frmt oswwrec MMDDYY*/
  ;
  OS0NS-VALIDATE-DT(); /* validate date*/
  ;
  if (TA2REC.TA2RTNCD == 0) /* good return*/
    VBASGN02.OB-NEED-BULK-XDT = OSWWREC.OSWWDT8; /* frmt ending date*/
  else
    set OS0NM001.OB-NEED-BULK-XDT cursor, bold;
    VBASGN02.OB-NEED-BULK-XDT = 0; /* frmt ending date*/
  end
  ;
  ;
end // end OS0NS-EDT-END-NEED

// EDIT COMPANY GROUP SELECTION
Function OS0NS-EDT-GRP-SEL()
  ;
    /* Verify that more than one selection was attempted*/
  ;
  if (OS0NM001.OB-SEL-PNTCO-ID-FL != " ") /* tried to select parent company*/
    converseLib.validationFailed(834); /* mult selections not allowed*/
    OSWWREC.OSWWERFL = "Y"; /* set error flag*/
    set OS0NM001.OB-SEL-GRPCO-ID-FL cursor, bold;
  end
  ;
  if (OS0NM001.OB-SEL-CO-ID-FL != " ") /* tried to select company*/
    converseLib.validationFailed(834); /* mult selections not allowed*/
    OSWWREC.OSWWERFL = "Y"; /* set error flag*/
    set OS0NM001.OB-SEL-GRPCO-ID-FL cursor, bold;
  end
  ;
    /* Edit Company Group Selection Flag*/
  ;
  if (OS0NM001.OB-SEL-GRPCO-ID-FL == "S"
   || OS0NM001.OB-SEL-GRPCO-ID-FL == " ")
    /* next sentence*/
  else
    converseLib.validationFailed(864); /* invalid selection option*/
    OSWWREC.OSWWERFL = "Y"; /* set error flag*/
    set OS0NM001.OB-SEL-GRPCO-ID-FL cursor, bold;
  end
  ;
    /* edit group selection in relationship to additional groups entered*/
  ;
  if (OS0NM001.CU-PNT-CO-ID1 > 0 /* parent exists*/
   || OS0NM001.CU-PNT-CO-ID2 > 0 /* parent exists*/
   || OS0NM001.CU-PNT-CO-ID3 > 0 /* parent exists*/
   || OS0NM001.CU-PNT-CO-ID4 > 0 /* parent exists*/
   || OS0NM001.CU-PNT-CO-ID5 > 0 /* parent exists*/
   || OS0NM001.CU-CO-ID1 > 0     /* company exists*/
   || OS0NM001.CU-CO-ID2 > 0     /* company exists*/
   || OS0NM001.CU-CO-ID3 > 0     /* company exists*/
   || OS0NM001.CU-CO-ID4 > 0     /* company exists*/
   || OS0NM001.CU-CO-ID5 > 0)    /* company exists*/
    if (OS0NM001.OB-SEL-GRPCO-ID-FL == "S")
      OSWWREC.OSWWERFL = "Y";
      converseLib.validationFailed(874); /* invalid selection for other additional values*/
      set OS0NM001.OB-SEL-GRPCO-ID-FL cursor, bold;
    end
  end
  ;
  ;
end // end OS0NS-EDT-GRP-SEL

// EDIT CUSTOMER ID
Function OS0NS-EDT-KUCCOID()
  ;
  ;
    /* verify company exists*/
  ;
  OS0NS-GET-KUCREC(); /* select company*/
  ;
  ;
end // end OS0NS-EDT-KUCCOID

// EDIT COMPANY GROUP ID
Function OS0NS-EDT-KUCGRPID()
  ;
  ;
    /* verify company group exists*/
  ;
  OS0NS-DEC-KUCREC(); /* declare company group*/
  ;
  OS0NS-FET-KUCREC(); /* fetch first company group*/
  ;
  if (SQLCA.VAGen_SQLCODE == 0)
    /* next sentence*/
  else
    if (SQLCA.VAGen_SQLCODE == 100)
      OSWWREC.OSWWERFL = "Y"; /* set error on*/
      converseLib.validationFailed(835); /* company group does not exist*/
    end
  end
  ;
  OS0NS-CLS-KUCREC(); /* close company group cursor*/
  ;
  ;
end // end OS0NS-EDT-KUCGRPID

// EDIT COMPANY GROUP ID
Function OS0NS-EDT-KUKPCOID()
  ;
    /* verify parent company exists*/
  ;
  OS0NS-DEC-KUCREC2(); /* declare company parent*/
  ;
  OS0NS-FET-KUCREC2(); /* fetch first company parent*/
  ;
  if (SQLCA.VAGen_SQLCODE == 0)
    /* next sentence*/
  else
    if (SQLCA.VAGen_SQLCODE == 100)
      OSWWREC.OSWWERFL = "Y"; /* set error on*/
      converseLib.validationFailed(836); /* company parent does not exist*/
    end
  end
  ;
  OS0NS-CLS-KUCREC2(); /* close company parent cursor*/
  ;
  ;
end // end OS0NS-EDT-KUKPCOID

// EDIT OS0N MAP
Function OS0NS-EDT-MAP()
  ;
  OS0NW01.OS0NW-CHG-FLAG = "N"; /* init change flag*/
  converseLib.validationFailed(0);
  ;
    /* Edit Need Date Selection Flag*/
  ;
  if (OS0NM001.OB-SEL-NEED-DT-FL != VBASGN02.OB-SEL-NEED-DT-FL
   || OS0NM001.OB-SEL-NEED-DT-FL == "S")
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    OS0NS-EDT-ND-SEL();
  end
  ;
    /* Edit Ending Need Date*/
  ;
  if (OS0NM001.OB-NEED-BULK-XDT == 0
   || OS0NM001.OB-NEED-BULK-XDT == "MMDDYY")
     /* next sentence*/
  else
    if (OS0NM001.OB-NEED-BULK-XDT == 0)
      if (OS0NM001.OB-SEL-NEED-DT-FL == " ")
       /* next sentence*/
      else
        if (OS0NM001.OB-SEL-NEED-DT-FL == "S")
          OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
          OS0NS-EDT-END-NEED();
        end
      end
    else
      OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
      OS0NS-EDT-END-NEED();
    end
  end
  ;
    /* Edit Beginning Need Date*/
  ;
  if (OS0NM001.OB-NEED-BULK-BDT == 0
   || OS0NM001.OB-NEED-BULK-BDT == "MMDDYY")
     /* next sentence*/
  else
    if (OS0NM001.OB-NEED-BULK-BDT == 0)
      if (OS0NM001.OB-SEL-NEED-DT-FL == " ")
       /* next sentence*/
      else
        if (OS0NM001.OB-SEL-NEED-DT-FL == "S")
          OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
          OS0NS-EDT-BEG-NEED();
        end
      end
    else
      OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
      OS0NS-EDT-BEG-NEED();
    end
  end
  ;
    /* Edit Need Date for valid range*/
  ;
  if (OS0NW01.OS0NW-CHG-FLAG == "Y") /* field changed*/
    OS0NS-EDT-NEED-RNG();
  end
  ;
    /* Edit Need Flag and PO Flag*/
  ;
  if (OS0NM001.OB-SEL-NEED-DT-FL == "S")
    if (OS0NM001.OB-SEL-CUST-PO-FL == "S")
      converseLib.validationFailed(947); /* po and need dt not allowed @ same time*/
      OSWWREC.OSWWERFL = "Y"; /* set error flag*/
      set OS0NM001.OB-SEL-CUST-PO-FL cursor, bold;
      set OS0NM001.OB-SEL-NEED-DT-FL bold;
      set OS0NM001.OB-CUST-PO-NBR bold;
      set OS0NM001.OB-NEED-BULK-BDT bold;
      set OS0NM001.OB-NEED-BULK-XDT bold;
    end
  end
  ;
    /* Edit Need Flag and need dates*/
  ;
    /* IF OS0NM001.OB-SEL-NEED-DT-FL = 'S';*/
    /* IF OS0NM001.OB-NEED-BULK-BDT = 0;*/
    /* MOVE 959 TO EZEMNO;/* beginning need date required*/
    /* MOVE 'Y' TO OSWWREC.OSWWERFL; /* set error flag*/
    /* SET OS0NM001.OB-NEED-BULK-BDT CURSOR,BRIGHT;*/
    /* IF OS0NM001.OB-NEED-BULK-XDT = 0;*/
    /* MOVE 961 TO EZEMNO;/* beginning need date required*/
    /* MOVE 'Y' TO OSWWREC.OSWWERFL; /* set error flag*/
    /* SET OS0NM001.OB-NEED-BULK-XDT BRIGHT;*/
    /* END;*/
    /* END;*/
    /* IF OS0NM001.OB-NEED-BULK-XDT = 0;*/
    /* MOVE 960 TO EZEMNO;/* beginning need date required*/
    /* MOVE 'Y' TO OSWWREC.OSWWERFL; /* set error flag*/
    /* SET OS0NM001.OB-NEED-BULK-XDT CURSOR,BRIGHT;*/
    /* END;*/
    /* END;*/
  ;
  ;
  ;
    /* Edit Sales Program Selection Flag*/
  ;
  if (OS0NM001.OB-SEL-SPGM-ID-FL != VBASGN02.OB-SEL-SPGM-ID-FL) /* sel chgd*/
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    OS0NS-EDT-SPGM-SEL();
  end
  ;
    /* Edit Customer PO Selection Flag*/
  ;
  if (OS0NM001.OB-SEL-CUST-PO-FL != VBASGN02.OB-SEL-CUST-PO-FL) /* sel chgd*/
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    OS0NS-EDT-PO-SEL();
  end
  ;
  ;
    /* Edit Sales rep ID Selection Flag*/
  ;
  if (OS0NM001.OB-SEL-SREP-ID-FL != VBASGN02.OB-SEL-SREP-ID-FL) /* sel chgd*/
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    OS0NS-EDT-SREP-SEL();
  end
  ;
    /* Edit Department Self ID Selection Flag*/
  ;
  if (OS0NM001.OB-SEL-DEPT-ID-FL != VBASGN02.OB-SEL-DEPT-ID-FL) /* sel chgd*/
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    OS0NS-EDT-DEPT-SEL();
  end
  ;
    /* verify group company and dept*/
  ;
   /* IF OS0NM001.OB-SEL-GRPCO-ID-FL = 'S'*/
   /* OR OS0NM001.OB-SEL-PNTCO-ID-FL = 'S';*/
   /* IF OS0NM001.OB-SEL-DEPT-ID-FL ^= 'S';*/
   /* MOVE 957 TO EZEMNO;      /* Dept required when parent/cmpny used*/
   /* MOVE 'Y' TO OSWWREC.OSWWERFL;       /*   is required*/
   /* SET OS0NM001.OB-SEL-DEPT-ID-FL CURSOR,BRIGHT;*/
   /* END;*/
   /* END;*/
  ;
  ;
    /* Edit Department Occurance 5*/
  ;
  if (OS0NM001.XNX-DEPT-ID-XREF5 > 0)
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    set KUJREC empty;
    KUJREC.XNXCD = OS0NM001.XNX-DEPT-ID-XREF5; /* frmt dept id*/
    OS0NW01.OS0NW-KUJREC-POST = OS0NM001.XNX-DEPT-ID-XREF5;
    OS0NS-EDT-XNX-DEPT();
    if (converseVar.validationMsgNum == 841) /* department does not exist*/
      set OS0NM001.XNX-DEPT-ID-XREF5 cursor, bold; /* postion cursor*/
    else
      set OSUREC empty;
      OSUREC.OSU-EDIT-DEPT = OS0NM001.XNX-DEPT-ID-XREF5;
      OS0NS-VALDTE-EXTRA();
      if (converseVar.validationMsgNum == 875) /* value is incompatible with draw*/
                                   /* criteria*/
        set OS0NM001.XNX-DEPT-ID-XREF5 cursor, bold;
      end
    end
  end
  ;
  if (converseVar.validationMsgNum > 0) /* msg exists*/
    OS0NW01.OS0NW-EZEMNO = converseVar.validationMsgNum; /* save msg*/
    converseLib.validationFailed(0);
  else
    converseLib.validationFailed(0); /* clear msgs for next edits*/
  end
  ;
    /* Edit Department Occurance 4*/
  ;
  if (OS0NM001.XNX-DEPT-ID-XREF4 > 0)
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    set KUJREC empty;
    KUJREC.XNXCD = OS0NM001.XNX-DEPT-ID-XREF4; /* frmt dept id*/
    OS0NW01.OS0NW-KUJREC-POST = OS0NM001.XNX-DEPT-ID-XREF4;
    OS0NS-EDT-XNX-DEPT();
    if (converseVar.validationMsgNum == 841) /* department does not exist*/
      set OS0NM001.XNX-DEPT-ID-XREF4 cursor, bold; /* postion cursor*/
    else
      set OSUREC empty;
      OSUREC.OSU-EDIT-DEPT = OS0NM001.XNX-DEPT-ID-XREF4;
      OS0NS-VALDTE-EXTRA();
      if (converseVar.validationMsgNum == 875) /* value is incompatible with draw*/
                                   /* criteria*/
        set OS0NM001.XNX-DEPT-ID-XREF4 cursor, bold;
      end
    end
  end
  ;
  if (converseVar.validationMsgNum > 0) /* msg exists*/
    OS0NW01.OS0NW-EZEMNO = converseVar.validationMsgNum; /* save msg*/
    converseLib.validationFailed(0);
  else
    converseLib.validationFailed(0); /* clear msgs for next edits*/
  end
    /* Edit Department Occurance 3*/
  ;
  if (OS0NM001.XNX-DEPT-ID-XREF3 > 0)
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    set KUJREC empty;
    KUJREC.XNXCD = OS0NM001.XNX-DEPT-ID-XREF3; /* frmt dept id*/
    OS0NW01.OS0NW-KUJREC-POST = OS0NM001.XNX-DEPT-ID-XREF3;
    OS0NS-EDT-XNX-DEPT();
    if (converseVar.validationMsgNum == 841) /* department does not exist*/
      set OS0NM001.XNX-DEPT-ID-XREF3 cursor, bold; /* postion cursor*/
    else
      set OSUREC empty;
      OSUREC.OSU-EDIT-DEPT = OS0NM001.XNX-DEPT-ID-XREF3;
      OS0NS-VALDTE-EXTRA();
      if (converseVar.validationMsgNum == 875) /* value is incompatible with draw*/
                                   /* criteria*/
        set OS0NM001.XNX-DEPT-ID-XREF3 cursor, bold;
      end
    end
  end
  ;
  if (converseVar.validationMsgNum > 0) /* msg exists*/
    OS0NW01.OS0NW-EZEMNO = converseVar.validationMsgNum; /* save msg*/
    converseLib.validationFailed(0);
  else
    converseLib.validationFailed(0); /* clear msgs for next edits*/
  end
  ;
    /* Edit Department Occurance 2*/
  ;
  if (OS0NM001.XNX-DEPT-ID-XREF2 > 0)
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    set KUJREC empty;
    KUJREC.XNXCD = OS0NM001.XNX-DEPT-ID-XREF2; /* frmt dept id*/
    OS0NW01.OS0NW-KUJREC-POST = OS0NM001.XNX-DEPT-ID-XREF2;
    OS0NS-EDT-XNX-DEPT();
    if (converseVar.validationMsgNum == 841) /* department does not exist*/
      set OS0NM001.XNX-DEPT-ID-XREF2 cursor, bold; /* postion cursor*/
    else
      set OSUREC empty;
      OSUREC.OSU-EDIT-DEPT = OS0NM001.XNX-DEPT-ID-XREF2;
      OS0NS-VALDTE-EXTRA();
      if (converseVar.validationMsgNum == 875) /* value is incompatible with draw*/
                                   /* criteria*/
        set OS0NM001.XNX-DEPT-ID-XREF2 cursor, bold;
      end
    end
  end
  ;
  if (converseVar.validationMsgNum > 0) /* msg exists*/
    OS0NW01.OS0NW-EZEMNO = converseVar.validationMsgNum; /* save msg*/
    converseLib.validationFailed(0);
  else
    converseLib.validationFailed(0); /* clear msgs for next edits*/
  end
  ;
    /* Edit Department Occurance 1*/
  ;
  if (OS0NM001.XNX-DEPT-ID-XREF1 > 0)
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    set KUJREC empty;
    KUJREC.XNXCD = OS0NM001.XNX-DEPT-ID-XREF1; /* frmt dept id*/
    OS0NW01.OS0NW-KUJREC-POST = OS0NM001.XNX-DEPT-ID-XREF1;
    OS0NS-EDT-XNX-DEPT();
    if (converseVar.validationMsgNum == 841) /* department does not exist*/
      set OS0NM001.XNX-DEPT-ID-XREF1 cursor, bold; /* postion cursor*/
    else
      set OSUREC empty;
      OSUREC.OSU-EDIT-DEPT = OS0NM001.XNX-DEPT-ID-XREF1;
      OS0NS-VALDTE-EXTRA();
      if (converseVar.validationMsgNum == 875) /* value is incompatible with draw*/
                                   /* criteria*/
        set OS0NM001.XNX-DEPT-ID-XREF1 cursor, bold;
      end
    end
  end
  ;
  if (converseVar.validationMsgNum > 0) /* msg exists*/
    OS0NW01.OS0NW-EZEMNO = converseVar.validationMsgNum; /* save msg*/
    converseLib.validationFailed(0);
  else
    converseLib.validationFailed(0); /* clear msgs for next edits*/
  end
  ;
    /* Edit Department ID Selection Flag*/
  ;
  if (OS0NM001.OB-SEL-XNX-ID-FL != " ")
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    OS0NS-EDT-XNX-SEL();
  end
  ;
    /* Edit Store Selection Flag*/
  ;
  if (OS0NM001.OB-SEL-STOR-ID-FL != VBASGN02.OB-SEL-STOR-ID-FL) /* sel chgd*/
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    OS0NS-EDT-STOR-SEL();
  end
  ;
  ;
  if (converseVar.validationMsgNum > 0) /* msg exists*/
    OS0NW01.OS0NW-EZEMNO = converseVar.validationMsgNum; /* save msg*/
    converseLib.validationFailed(0);
  else
    converseLib.validationFailed(0); /* clear msgs for next edits*/
  end
  ;
    /* Validate Company Occurance 5*/
  ;
  if (OS0NM001.CU-CO-ID5 > 0) /* company entered*/
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    set KUCREC empty;
    KUCREC.KUCCOID = OS0NM001.CU-CO-ID5; /* format company id key*/
    OS0NW01.OS0NW-KUCREC-POST = OS0NM001.CU-CO-ID5; /* fmt error key*/
    OS0NS-EDT-KUCCOID(); /* verify company exists*/
    if (converseVar.validationMsgNum == 837) /* company does not exist*/
      set OS0NM001.CU-CO-ID5 cursor, bold; /* postion cursor*/
    else
      set OSUREC empty;
      OSUREC.OSU-EDIT-COMP = OS0NM001.CU-CO-ID5;
      OS0NS-VALDTE-EXTRA();
      if (converseVar.validationMsgNum == 875) /* value is incompatible with draw*/
                                   /* criteria*/
        set OS0NM001.CU-CO-ID5 cursor, bold;
      end
    end
  end
  ;
  if (converseVar.validationMsgNum > 0) /* msg exists*/
    OS0NW01.OS0NW-EZEMNO = converseVar.validationMsgNum; /* save msg*/
    converseLib.validationFailed(0);
  else
    converseLib.validationFailed(0); /* clear msgs for next edits*/
  end
  ;
    /* Validate Company Occurance 4*/
  ;
  if (OS0NM001.CU-CO-ID4 > 0) /* company entered*/
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    set KUCREC empty;
    KUCREC.KUCCOID = OS0NM001.CU-CO-ID4; /* format company id key*/
    OS0NW01.OS0NW-KUCREC-POST = OS0NM001.CU-CO-ID4; /* fmt error key*/
    OS0NS-EDT-KUCCOID(); /* verify company exists*/
    if (converseVar.validationMsgNum == 837) /* company does not exist*/
      set OS0NM001.CU-CO-ID4 cursor, bold; /* postion cursor*/
    else
      set OSUREC empty;
      OSUREC.OSU-EDIT-COMP = OS0NM001.CU-CO-ID4;
      OS0NS-VALDTE-EXTRA();
      if (converseVar.validationMsgNum == 875) /* value is incompatible with draw*/
                                   /* criteria*/
        set OS0NM001.CU-CO-ID4 cursor, bold;
      end
    end
  end
  ;
  if (converseVar.validationMsgNum > 0) /* msg exists*/
    OS0NW01.OS0NW-EZEMNO = converseVar.validationMsgNum; /* save msg*/
    converseLib.validationFailed(0);
  else
    converseLib.validationFailed(0); /* clear msgs for next edits*/
  end
  ;
    /* Validate Company Occurance 3*/
  ;
  if (OS0NM001.CU-CO-ID3 > 0) /* company entered*/
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    set KUCREC empty;
    KUCREC.KUCCOID = OS0NM001.CU-CO-ID3; /* format company id key*/
    OS0NW01.OS0NW-KUCREC-POST = OS0NM001.CU-CO-ID3; /* fmt error key*/
    OS0NS-EDT-KUCCOID(); /* verify company exists*/
    if (converseVar.validationMsgNum == 837) /* company does not exist*/
      set OS0NM001.CU-CO-ID3 cursor, bold; /* postion cursor*/
    else
      set OSUREC empty;
      OSUREC.OSU-EDIT-COMP = OS0NM001.CU-CO-ID3;
      OS0NS-VALDTE-EXTRA();
      if (converseVar.validationMsgNum == 875) /* value is incompatible with draw*/
                                   /* criteria*/
        set OS0NM001.CU-CO-ID3 cursor, bold;
      end
    end
  end
  ;
  if (converseVar.validationMsgNum > 0) /* msg exists*/
    OS0NW01.OS0NW-EZEMNO = converseVar.validationMsgNum; /* save msg*/
    converseLib.validationFailed(0);
  else
    converseLib.validationFailed(0); /* clear msgs for next edits*/
  end
  ;
    /* Validate Company Occurance 2*/
  ;
  if (OS0NM001.CU-CO-ID2 > 0) /* company entered*/
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    set KUCREC empty;
    KUCREC.KUCCOID = OS0NM001.CU-CO-ID2; /* format company id key*/
    OS0NW01.OS0NW-KUCREC-POST = OS0NM001.CU-CO-ID2; /* fmt error key*/
    OS0NS-EDT-KUCCOID(); /* verify company exists*/
    if (converseVar.validationMsgNum == 837) /* company does not exist*/
      set OS0NM001.CU-CO-ID2 cursor, bold; /* postion cursor*/
    else
      set OSUREC empty;
      OSUREC.OSU-EDIT-COMP = OS0NM001.CU-CO-ID2;
      OS0NS-VALDTE-EXTRA();
      if (converseVar.validationMsgNum == 875) /* value is incompatible with draw*/
                                   /* criteria*/
        set OS0NM001.CU-CO-ID2 cursor, bold;
      end
    end
  end
  ;
  if (converseVar.validationMsgNum > 0) /* msg exists*/
    OS0NW01.OS0NW-EZEMNO = converseVar.validationMsgNum; /* save msg*/
    converseLib.validationFailed(0);
  else
    converseLib.validationFailed(0); /* clear msgs for next edits*/
  end
  ;
    /* Validate Company Occurance 1*/
  ;
  if (OS0NM001.CU-CO-ID1 > 0) /* company entered*/
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    set KUCREC empty;
    KUCREC.KUCCOID = OS0NM001.CU-CO-ID1; /* format company id key*/
    OS0NW01.OS0NW-KUCREC-POST = OS0NM001.CU-CO-ID1; /* fmt error key*/
    OS0NS-EDT-KUCCOID(); /* verify company exists*/
    if (converseVar.validationMsgNum == 837) /* company does not exist*/
      set OS0NM001.CU-CO-ID1 cursor, bold; /* postion cursor*/
    else
      set OSUREC empty;
      OSUREC.OSU-EDIT-COMP = OS0NM001.CU-CO-ID1;
      OS0NS-VALDTE-EXTRA();
      if (converseVar.validationMsgNum == 875) /* value is incompatible with draw*/
                                   /* criteria*/
        set OS0NM001.CU-CO-ID1 cursor, bold;
      end
    end
  end
  ;
  if (converseVar.validationMsgNum > 0) /* msg exists*/
    OS0NW01.OS0NW-EZEMNO = converseVar.validationMsgNum; /* save msg*/
    converseLib.validationFailed(0);
  else
    converseLib.validationFailed(0); /* clear msgs for next edits*/
  end
  ;
    /* Edit Company Selection Flag*/
  ;
  if (OS0NM001.OB-SEL-CO-ID-FL != " ")
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    OS0NS-EDT-CO-SEL();
  end
  ;
    /* Validate Parent Company Occurance 5*/
  ;
  if (OS0NM001.CU-PNT-CO-ID5 > 0) /* parent company entered*/
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    set KUKREC empty;
    KUKREC.KUKPCOID = OS0NM001.CU-PNT-CO-ID5; /* format company id ky*/
    OS0NW01.OS0NW-KUKREC-POST = OS0NM001.CU-PNT-CO-ID5; /* fmt err ky*/
    OS0NS-EDT-KUKPCOID(); /* verify company exists*/
    if (converseVar.validationMsgNum == 836) /* parent company does not exist*/
      set OS0NM001.CU-PNT-CO-ID5 cursor, bold; /* postion cursor*/
    else
      set OSUREC empty;
      OSUREC.OSU-EDIT-PARENT = OS0NM001.CU-PNT-CO-ID5;
      OS0NS-VALDTE-EXTRA();
      if (converseVar.validationMsgNum == 875) /* value is incompatible with draw*/
                                   /* criteria*/
        set OS0NM001.CU-PNT-CO-ID5 cursor, bold;
      end
    end
  end
  ;
  if (converseVar.validationMsgNum > 0) /* msg exists*/
    OS0NW01.OS0NW-EZEMNO = converseVar.validationMsgNum; /* save msg*/
    converseLib.validationFailed(0);
  else
    converseLib.validationFailed(0); /* clear msgs for next edits*/
  end
  ;
    /* Validate Parent Company Occurance 4*/
  ;
  if (OS0NM001.CU-PNT-CO-ID4 > 0) /* parent company entered*/
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    set KUKREC empty;
    KUKREC.KUKPCOID = OS0NM001.CU-PNT-CO-ID4; /* format company id ky*/
    OS0NW01.OS0NW-KUKREC-POST = OS0NM001.CU-PNT-CO-ID4; /* fmt err ky*/
    OS0NS-EDT-KUKPCOID(); /* verify company exists*/
    if (converseVar.validationMsgNum == 836) /* parent company does not exist*/
      set OS0NM001.CU-PNT-CO-ID4 cursor, bold; /* postion cursor*/
    else
      set OSUREC empty;
      OSUREC.OSU-EDIT-PARENT = OS0NM001.CU-PNT-CO-ID4;
      OS0NS-VALDTE-EXTRA();
      if (converseVar.validationMsgNum == 875) /* value is incompatible with draw*/
                                   /* criteria*/
        set OS0NM001.CU-PNT-CO-ID4 cursor, bold;
      end
    end
  end
  ;
  if (converseVar.validationMsgNum > 0) /* msg exists*/
    OS0NW01.OS0NW-EZEMNO = converseVar.validationMsgNum; /* save msg*/
    converseLib.validationFailed(0);
  else
    converseLib.validationFailed(0); /* clear msgs for next edits*/
  end
  ;
    /* Validate Parent Company Occurance 3*/
  ;
  if (OS0NM001.CU-PNT-CO-ID3 > 0) /* parent company entered*/
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    set KUKREC empty;
    KUKREC.KUKPCOID = OS0NM001.CU-PNT-CO-ID3; /* format company id ky*/
    OS0NW01.OS0NW-KUKREC-POST = OS0NM001.CU-PNT-CO-ID3; /* fmt err ky*/
    OS0NS-EDT-KUKPCOID(); /* verify company exists*/
    if (converseVar.validationMsgNum == 836) /* parent company does not exist*/
      set OS0NM001.CU-PNT-CO-ID3 cursor, bold; /* postion cursor*/
    else
      set OSUREC empty;
      OSUREC.OSU-EDIT-PARENT = OS0NM001.CU-PNT-CO-ID3;
      OS0NS-VALDTE-EXTRA();
      if (converseVar.validationMsgNum == 875) /* value is incompatible with draw*/
                                   /* criteria*/
        set OS0NM001.CU-PNT-CO-ID3 cursor, bold;
      end
    end
  end
  ;
  if (converseVar.validationMsgNum > 0) /* msg exists*/
    OS0NW01.OS0NW-EZEMNO = converseVar.validationMsgNum; /* save msg*/
    converseLib.validationFailed(0);
  else
    converseLib.validationFailed(0); /* clear msgs for next edits*/
  end
  ;
    /* Validate Parent Company Occurance 2*/
  ;
  if (OS0NM001.CU-PNT-CO-ID2 > 0) /* parent company entered*/
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    set KUKREC empty;
    KUKREC.KUKPCOID = OS0NM001.CU-PNT-CO-ID2; /* format company id ky*/
    OS0NW01.OS0NW-KUKREC-POST = OS0NM001.CU-PNT-CO-ID2; /* fmt err ky*/
    OS0NS-EDT-KUKPCOID(); /* verify company exists*/
    if (converseVar.validationMsgNum == 836) /* parent company does not exist*/
      set OS0NM001.CU-PNT-CO-ID2 cursor, bold; /* postion cursor*/
    else
      set OSUREC empty;
      OSUREC.OSU-EDIT-PARENT = OS0NM001.CU-PNT-CO-ID2;
      OS0NS-VALDTE-EXTRA();
      if (converseVar.validationMsgNum == 875) /* value is incompatible with draw*/
                                   /* criteria*/
        set OS0NM001.CU-PNT-CO-ID2 cursor, bold;
      end
    end
  end
  ;
  if (converseVar.validationMsgNum > 0) /* msg exists*/
    OS0NW01.OS0NW-EZEMNO = converseVar.validationMsgNum; /* save msg*/
    converseLib.validationFailed(0);
  else
    converseLib.validationFailed(0); /* clear msgs for next edits*/
  end
  ;
    /* Validate Parent Company Occurance 1*/
  ;
  if (OS0NM001.CU-PNT-CO-ID1 > 0) /* parent company entered*/
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    set KUKREC empty;
    KUCREC.KUKPCOID = OS0NM001.CU-PNT-CO-ID1; /* format company id ky*/
    OS0NW01.OS0NW-KUKREC-POST = OS0NM001.CU-PNT-CO-ID1; /* fmt err ky*/
    OS0NS-EDT-KUKPCOID(); /* verify company exists*/
    if (converseVar.validationMsgNum == 836) /* parent company does not exist*/
      set OS0NM001.CU-PNT-CO-ID1 cursor, bold; /* postion cursor*/
    else
      set OSUREC empty;
      OSUREC.OSU-EDIT-PARENT = OS0NM001.CU-PNT-CO-ID1;
      OS0NS-VALDTE-EXTRA();
      if (converseVar.validationMsgNum == 875) /* value is incompatible with draw*/
                                   /* criteria*/
        set OS0NM001.CU-PNT-CO-ID1 cursor, bold;
      else
        if (OS0NM001.OB-SEL-PNTCO-ID-FL == "S") /* parent company selected*/
          OSWWREC.KUCCOID = KUCREC.KUCCOID;
        end
      end
    end
  end
  ;
  if (converseVar.validationMsgNum > 0) /* msg exists*/
    OS0NW01.OS0NW-EZEMNO = converseVar.validationMsgNum; /* save msg*/
    converseLib.validationFailed(0);
  else
    converseLib.validationFailed(0); /* clear msgs for next edits*/
  end
  ;
  ;
    /* Edit Parent Company Selection Flag*/
  ;
  if (OS0NM001.OB-SEL-PNTCO-ID-FL != " ")
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    OS0NS-EDT-PNT-SEL();
  end
  ;
    /* Validate Group Company Occurance 5*/
  ;
  if (OS0NM001.CU-GRP-CO-ID5 > 0) /* group company entered*/
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    set KUCREC empty;
    KUCREC.KUCGRPID = OS0NM001.CU-GRP-CO-ID5; /* format company id ky*/
    OS0NW01.OS0NW-KUCREC-POST = OS0NM001.CU-GRP-CO-ID5; /* fmt err ky*/
    OS0NS-EDT-KUCGRPID(); /* verify company exists*/
    if (converseVar.validationMsgNum == 835) /* company group does not exist*/
      set OS0NM001.CU-GRP-CO-ID5 cursor, bold; /* postion cursor*/
    else
      set OSUREC empty;
      OSUREC.OSU-EDIT-GROUP = OS0NM001.CU-GRP-CO-ID5;
      OS0NS-VALDTE-EXTRA();
      if (converseVar.validationMsgNum == 875) /* value is incompatible with draw*/
                                   /* criteria*/
        set OS0NM001.CU-GRP-CO-ID5 cursor, bold;
      end
    end
  end
  ;
  if (converseVar.validationMsgNum > 0) /* msg exists*/
    OS0NW01.OS0NW-EZEMNO = converseVar.validationMsgNum; /* save msg*/
    converseLib.validationFailed(0);
  else
    converseLib.validationFailed(0); /* clear msgs for next edits*/
  end
  ;
    /* Validate Group Company Occurance 4*/
  ;
  if (OS0NM001.CU-GRP-CO-ID4 > 0) /* group company entered*/
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    set KUCREC empty;
    KUCREC.KUCGRPID = OS0NM001.CU-GRP-CO-ID4; /* format company id ky*/
    OS0NW01.OS0NW-KUCREC-POST = OS0NM001.CU-GRP-CO-ID4; /* fmt err ky*/
    OS0NS-EDT-KUCGRPID(); /* verify company exists*/
    if (converseVar.validationMsgNum == 835) /* company group does not exist*/
      set OS0NM001.CU-GRP-CO-ID4 cursor, bold; /* postion cursor*/
    else
      set OSUREC empty;
      OSUREC.OSU-EDIT-GROUP = OS0NM001.CU-GRP-CO-ID4;
      OS0NS-VALDTE-EXTRA();
      if (converseVar.validationMsgNum == 875) /* value is incompatible with draw*/
                                   /* criteria*/
        set OS0NM001.CU-GRP-CO-ID4 cursor, bold;
      end
    end
  end
  ;
  if (converseVar.validationMsgNum > 0) /* msg exists*/
    OS0NW01.OS0NW-EZEMNO = converseVar.validationMsgNum; /* save msg*/
    converseLib.validationFailed(0);
  else
    converseLib.validationFailed(0); /* clear msgs for next edits*/
  end
  ;
    /* Validate Group Comapny Occurance 3*/
  ;
  if (OS0NM001.CU-GRP-CO-ID3 > 0) /* group company entered*/
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    set KUCREC empty;
    KUCREC.KUCGRPID = OS0NM001.CU-GRP-CO-ID3; /* format company id ky*/
    OS0NW01.OS0NW-KUCREC-POST = OS0NM001.CU-GRP-CO-ID3; /* fmt err ky*/
    OS0NS-EDT-KUCGRPID(); /* verify company exists*/
    if (converseVar.validationMsgNum == 835) /* company group does not exist*/
      set OS0NM001.CU-GRP-CO-ID3 cursor, bold; /* postion cursor*/
    else
      set OSUREC empty;
      OSUREC.OSU-EDIT-GROUP = OS0NM001.CU-GRP-CO-ID3;
      OS0NS-VALDTE-EXTRA();
      if (converseVar.validationMsgNum == 875) /* value is incompatible with draw*/
                                   /* criteria*/
        set OS0NM001.CU-GRP-CO-ID3 cursor, bold;
      end
    end
  end
  ;
  if (converseVar.validationMsgNum > 0) /* msg exists*/
    OS0NW01.OS0NW-EZEMNO = converseVar.validationMsgNum; /* save msg*/
    converseLib.validationFailed(0);
  else
    converseLib.validationFailed(0); /* clear msgs for next edits*/
  end
  ;
    /* Validate Group Company Occurance 2*/
  ;
  if (OS0NM001.CU-GRP-CO-ID2 > 0) /* group company entered*/
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    set KUCREC empty;
    KUCREC.KUCGRPID = OS0NM001.CU-GRP-CO-ID2; /* format company id ky*/
    OS0NW01.OS0NW-KUCREC-POST = OS0NM001.CU-GRP-CO-ID2; /* fmt err ky*/
    OS0NS-EDT-KUCGRPID(); /* verify company exists*/
    if (converseVar.validationMsgNum == 835) /* company group does not exist*/
      set OS0NM001.CU-GRP-CO-ID2 cursor, bold; /* postion cursor*/
    else
      set OSUREC empty;
      OSUREC.OSU-EDIT-GROUP = OS0NM001.CU-GRP-CO-ID2;
      OS0NS-VALDTE-EXTRA();
      if (converseVar.validationMsgNum == 875) /* value is incompatible with draw*/
                                   /* criteria*/
        set OS0NM001.CU-GRP-CO-ID2 cursor, bold;
      end
    end
  end
  ;
  if (converseVar.validationMsgNum > 0) /* msg exists*/
    OS0NW01.OS0NW-EZEMNO = converseVar.validationMsgNum; /* save msg*/
    converseLib.validationFailed(0);
  else
    converseLib.validationFailed(0); /* clear msgs for next edits*/
  end
  ;
    /* Validate Group Company Occurance 1*/
  ;
  if (OS0NM001.CU-GRP-CO-ID1 > 0) /* group company entered*/
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    set KUCREC empty;
    KUCREC.KUCGRPID = OS0NM001.CU-GRP-CO-ID1; /* format company id ky*/
    OS0NW01.OS0NW-KUCREC-POST = OS0NM001.CU-GRP-CO-ID1; /* fmt err ky*/
    OS0NS-EDT-KUCGRPID(); /* verify company exists*/
    if (converseVar.validationMsgNum == 835) /* company group does not exist*/
      set OS0NM001.CU-GRP-CO-ID1 cursor, bold; /* postion cursor*/
    else
      set OSUREC empty;
      OSUREC.OSU-EDIT-GROUP = OS0NM001.CU-GRP-CO-ID1;
      OS0NS-VALDTE-EXTRA();
      if (converseVar.validationMsgNum == 875) /* value is incompatible with draw*/
                                   /* criteria*/
        set OS0NM001.CU-GRP-CO-ID1 cursor, bold;
      else
        if (OS0NM001.OB-SEL-GRPCO-ID-FL == "S")
          OSWWREC.KUCCOID = KUCREC.KUCCOID;
        end
      end
    end
  end
  ;
    /* Edit Group Company Selection Flag*/
  ;
  if (OS0NM001.OB-SEL-GRPCO-ID-FL != " ")
    OS0NW01.OS0NW-CHG-FLAG = "Y"; /* field changed*/
    OS0NS-EDT-GRP-SEL();
  end
  ;
    /* Edit Group/Parent/Company Combination*/
  ;
  OS0NS-EDT-CU-COMBO();
  ;
  ;
  if (OS0NW01.OS0NW-EZEMNO > 0 /* msg exists*/
   && converseVar.validationMsgNum == 0) /* save msg*/
    if (OS0NW01.OS0NW-EZEMNO == 9999)
      converseLib.validationFailed();
    else
      converseLib.validationFailed(OS0NW01.OS0NW-EZEMNO);
    end /* format saved error msg*/
  end
  ;
  ;
end // end OS0NS-EDT-MAP

// CONVERT DB DATE TO MMDDYY
Function OS0NS-EDT-MMDDYY()
   /* Edit MMDDYY date*/
  ;
   /* move the map date to OSWWREC.OSWWDT6 before entering*/
   /* this routine*/
   /* the calling stmt grp must handle the return code*/
   /* processing*/
  ;
  set TA2REC empty;
  TA2REC.TA2GRGA = OSWWREC.OSWWDT6;
  TA2REC.TA2DTOPT = "GREGGREG";
  TA2REC.TA2GRTYP = "A";
  call "TA0040" (TA2REC) {isNoRefresh = yes, isExternal = yes};
  ;
end // end OS0NS-EDT-MMDDYY

// EDIT NEED DATE SELECTION
Function OS0NS-EDT-ND-SEL()
  ;
    /* Edit Need Date Selection Flag*/
  ;
  if (OS0NM001.OB-SEL-NEED-DT-FL == "S" /* no ending date entered*/
   || OS0NM001.OB-SEL-NEED-DT-FL == " ")
    /* next sentence*/
  else
    converseLib.validationFailed(864); /* invalid selection option*/
    OSWWREC.OSWWERFL = "Y"; /* set error flag*/
    set OS0NM001.OB-SEL-NEED-DT-FL cursor, bold;
  end
  ;
  ;
end // end OS0NS-EDT-ND-SEL

// EDIT NEED DATE RANGE
Function OS0NS-EDT-NEED-RNG()
  ;
    /* verify that the need date was selected*/
  ;
  if (OS0NM001.OB-SEL-NEED-DT-FL == "S") /* need date was selected*/
    OSWWREC.OB-NEED-DT-SEL-FL = "S";
  end
  ;
end // end OS0NS-EDT-NEED-RNG

// EDIT PARENT COMPANY SELECTION
Function OS0NS-EDT-PNT-SEL()
  ;
    /* Verify that more than one were selected*/
  ;
  if (OS0NM001.OB-SEL-GRPCO-ID-FL != " ") /* tried to select group also*/
    converseLib.validationFailed(834); /* cannot select more than one*/
    OSWWREC.OSWWERFL = "Y"; /* set error flag*/
    set OS0NM001.OB-SEL-PNTCO-ID-FL cursor, bold;
  end
  ;
  if (OS0NM001.OB-SEL-CO-ID-FL != " ") /* tried to select company also*/
    converseLib.validationFailed(834); /* cannot select more than one*/
    OSWWREC.OSWWERFL = "Y"; /* set error flag*/
    set OS0NM001.OB-SEL-PNTCO-ID-FL cursor, bold;
  end
  ;
    /* Edit Parent Company Selection Flag*/
  ;
  if (OS0NM001.OB-SEL-PNTCO-ID-FL == "S"
   || OS0NM001.OB-SEL-PNTCO-ID-FL == " ")
    /* next sentence*/
  else
    converseLib.validationFailed(864); /* invalid selection option*/
    OSWWREC.OSWWERFL = "Y"; /* set error flag*/
    set OS0NM001.OB-SEL-PNTCO-ID-FL cursor, bold;
  end
  ;
    /* edit parent selection flag in relationship to additional parents*/
  ;
  if (OS0NM001.CU-GRP-CO-ID1 > 0 /* group entered*/
   || OS0NM001.CU-GRP-CO-ID2 > 0 /* group entered*/
   || OS0NM001.CU-GRP-CO-ID3 > 0 /* group entered*/
   || OS0NM001.CU-GRP-CO-ID4 > 0 /* group entered*/
   || OS0NM001.CU-GRP-CO-ID5 > 0 /* group entered*/
   || OS0NM001.CU-CO-ID1 > 0     /* company entered*/
   || OS0NM001.CU-CO-ID2 > 0     /* company entered*/
   || OS0NM001.CU-CO-ID3 > 0     /* company entered*/
   || OS0NM001.CU-CO-ID4 > 0     /* company entered*/
   || OS0NM001.CU-CO-ID5 > 0)    /* company entered*/
    if (OS0NM001.OB-SEL-PNTCO-ID-FL == "S")
      converseLib.validationFailed(874); /* invalid selection for other additional values*/
      OSWWREC.OSWWERFL = "Y"; /* set error flag*/
      set OS0NM001.OB-SEL-PNTCO-ID-FL cursor, bold;
    end
  end
  ;
  ;
end // end OS0NS-EDT-PNT-SEL

// EDIT CUST PO SELECTION
Function OS0NS-EDT-PO-SEL()
  ;
    /* Edit Customer PO Selection Flag*/
  ;
  if (OS0NM001.OB-SEL-CUST-PO-FL == "S"
   || OS0NM001.OB-SEL-CUST-PO-FL == " ")
    /* next sentence*/
  else
    converseLib.validationFailed(864); /* invalid selection option*/
    OSWWREC.OSWWERFL = "Y"; /* set error flag*/
    set OS0NM001.OB-SEL-CUST-PO-FL cursor, bold;
  end
  ;
  ;
end // end OS0NS-EDT-PO-SEL

// EDIT SALES PROGRAM SELECTION
Function OS0NS-EDT-SPGM-SEL()
  ;
    /* Edit Sales Program Selection Flag*/
  ;
  if (OS0NM001.OB-SEL-SPGM-ID-FL == "S" /* no ending date entered*/
   || OS0NM001.OB-SEL-SPGM-ID-FL == " ")
    /* next sentence*/
  else
    converseLib.validationFailed(864); /* invalid selection option*/
    OSWWREC.OSWWERFL = "Y"; /* set error flag*/
    set OS0NM001.OB-SEL-SPGM-ID-FL cursor, bold;
  end
  ;
  ;
end // end OS0NS-EDT-SPGM-SEL

// EDIT SALES REP ID SELECTION
Function OS0NS-EDT-SREP-SEL()
  ;
    /* Edit Sales Rep Id Selection Flag*/
  ;
  if (OS0NM001.OB-SEL-SREP-ID-FL == "S"
   || OS0NM001.OB-SEL-SREP-ID-FL == " ")
    /* next sentence*/
  else
    converseLib.validationFailed(864); /* invalid selection option*/
    OSWWREC.OSWWERFL = "Y"; /* set error flag*/
    set OS0NM001.OB-SEL-SREP-ID-FL cursor, bold;
  end
  ;
  ;
end // end OS0NS-EDT-SREP-SEL

// EDIT STORE SELECTION
Function OS0NS-EDT-STOR-SEL()
  ;
    /* Edit Store Selection Flag*/
  ;
  if (OS0NM001.OB-SEL-STOR-ID-FL == "S"
   || OS0NM001.OB-SEL-STOR-ID-FL == " ")
    /* next sentence*/
  else
    converseLib.validationFailed(864); /* invalid selection option*/
    OSWWREC.OSWWERFL = "Y"; /* set error flag*/
    set OS0NM001.OB-SEL-STOR-ID-FL cursor, bold;
  end
  ;
  ;
end // end OS0NS-EDT-STOR-SEL

// EDIT DEPARTMENT ID
Function OS0NS-EDT-XNX-DEPT()
  ;
    /* Edit Selection for Department*/
  ;
  if (OS0NM001.OB-SEL-XNX-ID-FL == "S") /* selection was made*/
     /* next sentence*/
  else
    OSWWREC.OSWWERFL = "Y"; /* set error flag*/
    converseLib.validationFailed(866); /* selection is required*/
    set OS0NM001.OB-SEL-XNX-ID-FL cursor, bold; /* postion cursor*/
  end
  ;
  ;
end // end OS0NS-EDT-XNX-DEPT

// EDIT DEPARTMENT SELECTION
Function OS0NS-EDT-XNX-SEL()
  ;
    /* Edit Department ID Selection Flag*/
  ;
  if (OS0NM001.OB-SEL-XNX-ID-FL == "S"
   || OS0NM001.OB-SEL-XNX-ID-FL == " ")
    /* next sentence*/
  else
    converseLib.validationFailed(864); /* invalid selection option*/
    OSWWREC.OSWWERFL = "Y"; /* set error flag*/
    set OS0NM001.OB-SEL-XNX-ID-FL cursor, bold;
  end
  ;
    /* Edit Department Selection Flag in relationship to additional depts*/
  ;
  if (OS0NM001.XNX-DEPT-ID-XREF1 > 0 /* dept entered*/
   || OS0NM001.XNX-DEPT-ID-XREF2 > 0 /* dept entered*/
   || OS0NM001.XNX-DEPT-ID-XREF3 > 0 /* dept entered*/
   || OS0NM001.XNX-DEPT-ID-XREF3 > 0 /* dept entered*/
   || OS0NM001.XNX-DEPT-ID-XREF3 > 0) /* dept entered*/
    if (OS0NM001.OB-SEL-XNX-ID-FL == " ")
      converseLib.validationFailed(874); /* selection is required for additional values*/
      OSWWREC.OSWWERFL = "Y"; /* set error flag*/
      set OS0NM001.OB-SEL-XNX-ID-FL cursor, bold;
    end
  end
  ;
  ;
end // end OS0NS-EDT-XNX-SEL

// FETCH NEXT KUCREC RECORD
Function OS0NS-FET-KUCREC()
  ;
  ;
  set SQLCA empty;
  ;
  call "IO0240" ("N1", SQLCA, KUCREC) {isNoRefresh = yes, isExternal = yes};
  ;
  if (SQLCA.VAGen_SQLCODE == 0
   || SQLCA.VAGen_SQLCODE == 100)
   /* next sentence*/
  else
    if (SQLCA.VAGen_SQLCODE == -911)
      OSWWREC.OSWWERFL = "Y";
      converseLib.validationFailed(010); /* database busy*/
    else
      if (OSWWREC.OSWWFRMAP == "OS0L") /* came from os0l appl*/
        OS0NS-PRG-TMP-STOR(); /* purge os0l temp storage*/
      end
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "OS0N    ";
      TA1REC.TA1LOCAT[1] = "OS0NS-FE";
      TA1REC.TA1LOCAT[2] = "T-KUCREC";
      TA1REC.TA1LOCAT[3] = " IO0240 ";
      TA1REC.TA1LOCAT[4] = "N1      ";
      TA1REC.TA1DBASE = "DCUST   ";
      TA1REC.TA1TBLVU = "VCMPNY01";
      TA1REC.TA1TBLKE = OS0NW01.OS0NW-KUCREC-POST;
      ;
      call "TA0020" (TA1REC, SQLCA) {isExternal = yes};
      ;
      COMMAREA.CAUSERA = " ";
      ;
      XSPF4();
      exit program;
    end
  end
  ;
  ;
end // end OS0NS-FET-KUCREC

// FETCH NEXT KUCREC RECORD
Function OS0NS-FET-KUCREC2()
  ;
  set SQLCA empty;
  ;
  call "IO0240" ("N2", SQLCA, KUCREC) {isNoRefresh = yes, isExternal = yes};
  ;
  if (SQLCA.VAGen_SQLCODE == 0
   || SQLCA.VAGen_SQLCODE == 100)
   /* next sentence*/
  else
    if (SQLCA.VAGen_SQLCODE == -911)
      OSWWREC.OSWWERFL = "Y";
      converseLib.validationFailed(010); /* database busy*/
    else
      if (OSWWREC.OSWWFRMAP == "OS0L") /* came from os0l appl*/
        OS0NS-PRG-TMP-STOR(); /* purge os0l temp storage*/
      end
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "OS0N    ";
      TA1REC.TA1LOCAT[1] = "OS0NS-FE";
      TA1REC.TA1LOCAT[2] = "T-KUCREC";
      TA1REC.TA1LOCAT[3] = " IO0240 ";
      TA1REC.TA1LOCAT[4] = "N2      ";
      TA1REC.TA1DBASE = "DCUST   ";
      TA1REC.TA1TBLVU = "VCMPNY01";
      TA1REC.TA1TBLKE = OS0NW01.OS0NW-KUCREC-POST;
      ;
      call "TA0020" (TA1REC, SQLCA) {isExternal = yes};
      ;
      COMMAREA.CAUSERA = " ";
      ;
      XSPF4();
      exit program;
    end
  end
  ;
end // end OS0NS-FET-KUCREC2

// BUILD OS0N MAP HEADINGS
Function OS0NS-FMT-HEADINGS()
  ;
  OS0NM001.OS0NM-MAP-DTE = OSWWREC.OSWWCDAT; /* formatted current date*/
  ;
  ;
end // end OS0NS-FMT-HEADINGS

// FORMAT VBASGN01 RECORD
Function OS0NS-FMT-VBASGN02()
  ;
  VBASGN02.OB-BULK-ASGN-ID = OS0NM001.OB-BULK-ASGN-ID;
  OSWWREC.OB-BULK-ASGN-ID = OS0NM001.OB-BULK-ASGN-ID;
  VBASGN02.OB-BULK-ASGN-DESC = OS0NM001.OB-BULK-ASGN-DESC;
  ;
  VBASGN02.OB-SEL-GRPCO-ID-FL = OS0NM001.OB-SEL-GRPCO-ID-FL;
  VBASGN02.CU-GRP-CO-ID1 = OS0NM001.CU-GRP-CO-ID1;
  VBASGN02.CU-GRP-CO-ID2 = OS0NM001.CU-GRP-CO-ID2;
  VBASGN02.CU-GRP-CO-ID3 = OS0NM001.CU-GRP-CO-ID3;
  VBASGN02.CU-GRP-CO-ID4 = OS0NM001.CU-GRP-CO-ID4;
  VBASGN02.CU-GRP-CO-ID5 = OS0NM001.CU-GRP-CO-ID5;
  ;
  VBASGN02.OB-SEL-PNTCO-ID-FL = OS0NM001.OB-SEL-PNTCO-ID-FL;
  VBASGN02.CU-PNT-CO-ID1 = OS0NM001.CU-PNT-CO-ID1;
  VBASGN02.CU-PNT-CO-ID2 = OS0NM001.CU-PNT-CO-ID2;
  VBASGN02.CU-PNT-CO-ID3 = OS0NM001.CU-PNT-CO-ID3;
  VBASGN02.CU-PNT-CO-ID4 = OS0NM001.CU-PNT-CO-ID4;
  VBASGN02.CU-PNT-CO-ID5 = OS0NM001.CU-PNT-CO-ID5;
  ;
  VBASGN02.OB-SEL-CO-ID-FL = OS0NM001.OB-SEL-CO-ID-FL;
  VBASGN02.CU-CO-ID1 = OS0NM001.CU-CO-ID1;
  VBASGN02.CU-CO-ID2 = OS0NM001.CU-CO-ID2;
  VBASGN02.CU-CO-ID3 = OS0NM001.CU-CO-ID3;
  VBASGN02.CU-CO-ID4 = OS0NM001.CU-CO-ID4;
  VBASGN02.CU-CO-ID5 = OS0NM001.CU-CO-ID5;
  ;
  VBASGN02.OB-SEL-STOR-ID-FL = OS0NM001.OB-SEL-STOR-ID-FL;
  VBASGN02.OB-SEL-XNX-ID-FL = OS0NM001.OB-SEL-XNX-ID-FL;
  VBASGN02.XNX-DEPT-ID-XREF1 = OS0NM001.XNX-DEPT-ID-XREF1;
  VBASGN02.XNX-DEPT-ID-XREF2 = OS0NM001.XNX-DEPT-ID-XREF2;
  VBASGN02.XNX-DEPT-ID-XREF3 = OS0NM001.XNX-DEPT-ID-XREF3;
  VBASGN02.XNX-DEPT-ID-XREF4 = OS0NM001.XNX-DEPT-ID-XREF4;
  VBASGN02.XNX-DEPT-ID-XREF5 = OS0NM001.XNX-DEPT-ID-XREF5;
  ;
  VBASGN02.OB-SEL-DEPT-ID-FL = OS0NM001.OB-SEL-DEPT-ID-FL;
  VBASGN02.OB-SEL-XGP-CD-FL = "S";
  VBASGN02.OB-SEL-SREP-ID-FL = OS0NM001.OB-SEL-SREP-ID-FL;
  VBASGN02.OB-SEL-CUST-PO-FL = OS0NM001.OB-SEL-CUST-PO-FL;
  VBASGN02.OB-SEL-SPGM-ID-FL = OS0NM001.OB-SEL-SPGM-ID-FL;
  VBASGN02.OB-SEL-NEED-DT-FL = OS0NM001.OB-SEL-NEED-DT-FL;
  ;
  OSWWREC.OSWWDT6 = OS0NM001.OB-NEED-BULK-BDT;
  OS0NS-MMDDYY-COMP();
  VBASGN02.OB-NEED-BULK-BDT = OSWWREC.OSWWDT8;
  OSWWREC.OB-NEED-BULK-BDT = OSWWREC.OSWWDT8; /* to dt*/
  ;
  OSWWREC.OP1CUNDT = OS0NM001.OB-NEED-BULK-BDT; /* from dt*/
  ;
  OSWWREC.OSWWDT6 = OS0NM001.OB-NEED-BULK-XDT;
  OS0NS-MMDDYY-COMP();
  VBASGN02.OB-NEED-BULK-XDT = OSWWREC.OSWWDT8;
  OSWWREC.OB-NEED-BULK-XDT = OSWWREC.OSWWDT8; /* to dt*/
  ;
  OSWWREC.OP1CUPO = OS0NM001.OB-CUST-PO-NBR; /* po number*/
  OSWWREC.XNXCD = OS0NM001.XNX-DEPT-ID-XREF1; /* department number*/
  OSWWREC.KUMSTRID = OS0NM001.OB-STOR-ID; /* store id*/
  OSWWREC.XGPCD = OS0NM001.OB-GPC-CODE; /* gpc code*/
  ;
    /* default to the oldest bulk first flag if no flag is set*/
  ;
  if (VBASGN02.OB-ASGN-OLDEST-FL == " "
   && VBASGN02.OB-ASGN-MO-FWD-FL == " "
   && VBASGN02.OB-ASGN-MO-BWD-FL == " "
   && VBASGN02.OB-ASGN-MO-ONLY-FL == " ")
    VBASGN02.OB-ASGN-OLDEST-FL = "Y";
  end
  ;
end // end OS0NS-FMT-VBASGN02

// GET CURRENT DATE
Function OS0NS-GET-CURR-DTE()
  ;
  ;
  set TA2REC empty;
  ;
  TA2REC.TA2DTOPT = "GETDATE";
  call "TA0040" (TA2REC) {isNoRefresh = yes, isExternal = yes};
  ;
  ;
end // end OS0NS-GET-CURR-DTE

// Get KUCREC VIA IO For KUCCOID
Function OS0NS-GET-KUCREC()
  ;
  ;
  set SQLCA empty;
  ;
  call "IO0240" ("S ", SQLCA, KUCREC) {isNoRefresh = yes, isExternal = yes};
  ;
  if (SQLCA.VAGen_SQLCODE == 0)
    /* continue*/
  else
    if (SQLCA.VAGen_SQLCODE == 100)
      converseLib.validationFailed(835); /* invalid company*/
      OSWWREC.OSWWERFL = "Y";
    else
      if (SQLCA.VAGen_SQLCODE == -911)
        converseLib.validationFailed(010); /* database busy*/
        OSWWREC.OSWWERFL = "Y";
      else
        if (OSWWREC.OSWWFRMAP == "OS0L") /* came from os0l appl*/
          OS0NS-PRG-TMP-STOR(); /* purge os0l temp storage*/
        end
        TA1REC.TA1TYPE = "DB2 ";
        TA1REC.TA1FUNC = "RETN";
        TA1REC.TA1PGMNM = "OS0N    ";
        TA1REC.TA1LOCAT[1] = "OS0NS-GE";
        TA1REC.TA1LOCAT[2] = "T-KUCREC";
        TA1REC.TA1LOCAT[3] = " IO0240 ";
        TA1REC.TA1LOCAT[4] = "S       ";
        TA1REC.TA1DBASE = "DCUST   ";
        TA1REC.TA1TBLVU = "VCMPNY01";
        TA1REC.TA1TBLKE = OS0NW01.OS0NW-KUCREC-POST;
        ;
        call "TA0020" (TA1REC, SQLCA) {isExternal = yes};
        ;
        COMMAREA.CAUSERA = " ";
        ;
        XSPF4();
        exit program;
      end
    end
  end
  ;
  ;
end // end OS0NS-GET-KUCREC

// GET VBASGN01 VIA IO7200
Function OS0NS-GET-VBASGN02()
  ;
  ;
  set SQLCA empty;
  set VBASGN02 empty;
  ;
  VBASGN02.OB-BULK-ASGN-ID = OSWWREC.OB-BULK-ASGN-ID;
  OS0NW01.OS0NW-VBASGN02-POST = OSWWREC.OB-BULK-ASGN-ID;
  ;
  call "VBASGN02" ("S ", SQLCA, VBASGN02) {isNoRefresh = yes, isExternal = yes};
  ;
  if (SQLCA.VAGen_SQLCODE == 0)
    /* continue*/
  else
    if (SQLCA.VAGen_SQLCODE == -911)
      OSWWREC.OSWWERFL = "Y";
      converseLib.validationFailed(010); /* database busy*/
    else
      if (OSWWREC.OSWWFRMAP == "OS0L") /* came from os0l appl*/
        OS0NS-PRG-TMP-STOR(); /* purge os0l temp storage*/
      end
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "OS0N    ";
      TA1REC.TA1LOCAT[1] = "OS0NS-GE";
      TA1REC.TA1LOCAT[2] = "T-VBASGN";
      TA1REC.TA1LOCAT[3] = "02 VBASG";
      TA1REC.TA1LOCAT[4] = "N02 S   ";
      TA1REC.TA1DBASE = "DORDB   ";
      TA1REC.TA1TBLVU = "VBASGN02";
      TA1REC.TA1TBLKE = OS0NW01.OS0NW-VBASGN02-POST;
      ;
      call "TA0020" (TA1REC, SQLCA) {isExternal = yes};
      ;
      COMMAREA.CAUSERA = " ";
      ;
      XSPF4();
      exit program;
    end
  end
  ;
  ;
end // end OS0NS-GET-VBASGN02

// INITIALIZE OS0N APPLICATION
Function OS0NS-INIT-OS0N()
  ;
  set VBASGN02 empty; /* bulk assignment record*/
  set SQLCA empty; /* return code from DB2*/
  set ERRSQLCA empty; /* return code from non-db2*/
  set TAEREC empty; /* diags for non db2*/
  set TA1REC empty; /* diagnostic record*/
  set OS0NW01 empty; /* working storage*/
  ;
  OSWWREC.OSWWGRP = COMMAREA.CAUSERA; /* init common working storage*/
  ;
    /* verify that they came from os0k application*/
  ;
  if (OSWWREC.OSWWINIT != "OS0K") /* did not come from os0k*/
    transfer to program "OS0K" passing COMMAREA;
    exit program;
  end
  ;
  OSWWREC.OSWWCDAT = VGVar.currentShortGregorianDate;
  ;
  TA1REC.TA1MAP = "OS0NM001"; /* map name for diags*/
  ;
  if (OSWWREC.OSWWFRMAP == "OS0L") /* processing os0l loop*/
     /* next sentence*/
  else
    OSWWREC.OSWWFRMAP = "OS0N"; /* format from appl as os0n*/
  end
  ;
  ;
end // end OS0NS-INIT-OS0N

// LOAD MAP FROM VBASGN01
Function OS0NS-LOAD-MAP()
  ;
  OS0NM001.OB-BULK-ASGN-ID = VBASGN02.OB-BULK-ASGN-ID;
  OS0NM001.OB-BULK-ASGN-DESC = VBASGN02.OB-BULK-ASGN-DESC;
  ;
  OS0NM001.OB-SEL-GRPCO-ID-FL = VBASGN02.OB-SEL-GRPCO-ID-FL;
  OS0NM001.CU-GRP-CO-ID1 = VBASGN02.CU-GRP-CO-ID1;
  OS0NM001.CU-GRP-CO-ID2 = VBASGN02.CU-GRP-CO-ID2;
  OS0NM001.CU-GRP-CO-ID3 = VBASGN02.CU-GRP-CO-ID3;
  OS0NM001.CU-GRP-CO-ID4 = VBASGN02.CU-GRP-CO-ID4;
  OS0NM001.CU-GRP-CO-ID5 = VBASGN02.CU-GRP-CO-ID5;
  ;
  OS0NM001.OB-SEL-PNTCO-ID-FL = VBASGN02.OB-SEL-PNTCO-ID-FL;
  OS0NM001.CU-PNT-CO-ID1 = VBASGN02.CU-PNT-CO-ID1;
  OS0NM001.CU-PNT-CO-ID2 = VBASGN02.CU-PNT-CO-ID2;
  OS0NM001.CU-PNT-CO-ID3 = VBASGN02.CU-PNT-CO-ID3;
  OS0NM001.CU-PNT-CO-ID4 = VBASGN02.CU-PNT-CO-ID4;
  OS0NM001.CU-PNT-CO-ID5 = VBASGN02.CU-PNT-CO-ID5;
  ;
  OS0NM001.OB-SEL-CO-ID-FL = VBASGN02.OB-SEL-CO-ID-FL;
  OS0NM001.CU-CO-ID1 = VBASGN02.CU-CO-ID1;
  OS0NM001.CU-CO-ID2 = VBASGN02.CU-CO-ID2;
  OS0NM001.CU-CO-ID3 = VBASGN02.CU-CO-ID3;
  OS0NM001.CU-CO-ID4 = VBASGN02.CU-CO-ID4;
  OS0NM001.CU-CO-ID5 = VBASGN02.CU-CO-ID5;
  ;
  OS0NM001.OB-GPC-CODE = VBASGN02.XGPCD;
  ;
  OS0NM001.OB-SEL-STOR-ID-FL = VBASGN02.OB-SEL-STOR-ID-FL;
  OS0NM001.OB-SEL-XNX-ID-FL = VBASGN02.OB-SEL-XNX-ID-FL;
  OS0NM001.XNX-DEPT-ID-XREF1 = VBASGN02.XNX-DEPT-ID-XREF1;
  OS0NM001.XNX-DEPT-ID-XREF2 = VBASGN02.XNX-DEPT-ID-XREF2;
  OS0NM001.XNX-DEPT-ID-XREF3 = VBASGN02.XNX-DEPT-ID-XREF3;
  OS0NM001.XNX-DEPT-ID-XREF4 = VBASGN02.XNX-DEPT-ID-XREF4;
  OS0NM001.XNX-DEPT-ID-XREF5 = VBASGN02.XNX-DEPT-ID-XREF5;
  ;
  OS0NM001.OB-SEL-DEPT-ID-FL = VBASGN02.OB-SEL-DEPT-ID-FL;
  OS0NM001.OB-SEL-CUST-PO-FL = VBASGN02.OB-SEL-CUST-PO-FL;
  OS0NM001.OB-SEL-SREP-ID-FL = VBASGN02.OB-SEL-SREP-ID-FL;
  OS0NM001.OB-SEL-SPGM-ID-FL = VBASGN02.OB-SEL-SPGM-ID-FL;
  OS0NM001.OB-SEL-NEED-DT-FL = VBASGN02.OB-SEL-NEED-DT-FL;
  ;
    /* CONVERT THE NEED DATES TO SCREEN FORMAT*/
  ;
  OSWWREC.OSWWDT8 = VBASGN02.OB-NEED-BULK-BDT;
  OS0NS-CONVERT-DATE();
  OS0NM001.OB-NEED-BULK-BDT = OSWWREC.OSWWDT6;
  OSWWREC.OSWWDT8 = VBASGN02.OB-NEED-BULK-XDT;
  OS0NS-CONVERT-DATE();
  OS0NM001.OB-NEED-BULK-XDT = OSWWREC.OSWWDT6;
  ;
  if (COMMAREA.CAFROMAP == "OS0P") /* returning from os0p*/
    OS0NM001.OB-GPC-CODE = OSWWREC.XGPCD;
    OS0NM001.OB-GPC-CODE = OSWWREC.XGPCD;
    OS0NM001.OB-STOR-ID = OSWWREC.KUMSTRID;
    OS0NM001.OB-CUST-PO-NBR = OSWWREC.OP1CUPO;
   /* MOVE OSWWREC.OB-NEED-BULK-BDT TO OS0NM001.OB-NEED-BULK-BDT;*/
   /* MOVE OSWWREC.OB-NEED-BULK-XDT TO OS0NM001.OB-NEED-BULK-XDT;*/
   /* IF OSWWREC.OP1CUNDT = 0;                        /* no need dt*/
   /* MOVE OSWWREC.OP1CUNDT TO OSWWREC.OSWWDT8;*/
   /* OS0NS-CONVERT-DATE;*/
   /* MOVE OSWWREC.OSWWDT6 TO OS0NM001.OB-NEED-BULK-BDT;*/
   /* END;*/
    if (OSWWREC.OSWWERFL == "Y") /* error from pgm os0p*/
      if (OSWWREC.OSWW-MSG-NBR == 9999)
        converseLib.validationFailed();
      else
        converseLib.validationFailed(OSWWREC.OSWW-MSG-NBR);
      end
      OSWWREC.OSWWERFL = " "; /* reset error flag*/
      OSWWREC.OSWW-MSG-NBR = " "; /* reset msg number*/
    end
  end
  ;
end // end OS0NS-LOAD-MAP

// CONVERT MMDDYY TO COMP FORMAT
Function OS0NS-MMDDYY-COMP()
    /* convert MMDDYY date to comp (DB2 date)*/
  ;
  ;
  ;
   /* the calling stmt group must move the MMDDYY date*/
   /* to OSWWREC.OSWWDT6 before entering this routine*/
  ;
  if (OSWWREC.OSWWDT6 == 0)
    OSWWREC.OSWWDT8 = 0;
    return;
  end
  ;
  ;
  OSWWREC.OSWWDT8Y = OSWWREC.OSWWDT6Y;
  OSWWREC.OSWWDT8M = OSWWREC.OSWWDT6M;
  OSWWREC.OSWWDT8D = OSWWREC.OSWWDT6D;
  ;
  if (OSWWREC.OSWWDT6Y <= 51)
    OSWWREC.OSWWDT8C = 20;
  else
    OSWWREC.OSWWDT8C = 19;
  end
  ;
   /* the calling stmt group needs to move*/
   /* OSWWREC.OSWWDT8 to the comp date field.*/
  ;
end // end OS0NS-MMDDYY-COMP

// Non-DB2 Post Routine TA0020
Function OS0NS-POST-NO-ROLL()
       /* Non-DB2 post routine*/
  ;
  ;
   /* the following fields will be filled in by the*/
   /* calling stmt group before entering this routine*/
     /* ta1locat(1) = transaction type  ie: 'ss' 'sn'*/
     /* ta1locat(2) = i/o mod name*/
     /* ta1locat(3) = calling stmt group name*/
     /* ta1locat(4) = programmers option(extra key data)*/
     /* taerec.taedesc1 = programmers opiton (additional key data*/
     /* taerec.taedesc2 = messages*/
     /* ta1map = appl's mapname and should be initilized*/
              /* in the programs init process.*/
   /* return code processing will also be handled by the*/
   /* calling stmt group.*/
  ;
  TA1REC.TA1TYPE = "APPL";
  TA1REC.TA1FUNC = "POST";
  TA1PGMNM = COMMAREA.CACURRAP; /* current application*/
  try
    call "TA0020" (TA1REC, TAEREC) {isExternal = yes};
  end
  ;
end // end OS0NS-POST-NO-ROLL

// Purge Bulk Asgnmnt Temp Storag
Function OS0NS-PRG-TMP-STOR()
  ;
  ;
  ;
   /* purge temporary storage 1*/
  ;
  TA5REC.TA5APPID = "OSFL"; /* appl identification*/
  TA5REC.TA5FNCCD = "P"; /* function code*/
  call "TA0050" (OSRREC, TA5REC) {isNoRefresh = yes, isExternal = yes}; /* temp storage subroutine*/
  ;
  if (TA5REC.TA5RTNCD == 0)
    OSWWREC.OSWWTF1P = 1;
    OSWWREC.OSWWTF1S = 1;
    OSWWREC.OSWWTF1M = 1;
  else
    TA1REC.TA1LOCAT[1] = "PRGE TS1";
    TA1REC.TA1LOCAT[2] = "TA0050"; /* io mod called*/
    TA1REC.TA1LOCAT[3] = TA5REC.TA5RTNCD; /* return code*/
    TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* subroutine parms*/
    OS0NS-POST-NO-ROLL(); /* post,  no rollback, non db2*/
    ;
    ;
  end
end // end OS0NS-PRG-TMP-STOR

// RESET FIELD ATTRIBUTES
Function OS0NS-RESET-ATTRIB()
  ;
     /* set heading attributes*/
  ;
  set OS0NM001.OB-BULK-ASGN-ID initialAttributes;
  set OS0NM001.OB-BULK-ASGN-DESC initialAttributes;
  ;
  set OS0NM001.OB-SEL-GRPCO-ID-FL cursor, initialAttributes;
  set OS0NM001.CU-GRP-CO-ID1 initialAttributes;
  set OS0NM001.CU-GRP-CO-ID2 initialAttributes;
  set OS0NM001.CU-GRP-CO-ID3 initialAttributes;
  set OS0NM001.CU-GRP-CO-ID4 initialAttributes;
  set OS0NM001.CU-GRP-CO-ID5 initialAttributes;
  ;
  set OS0NM001.OB-SEL-PNTCO-ID-FL initialAttributes;
  set OS0NM001.CU-PNT-CO-ID1 initialAttributes;
  set OS0NM001.CU-PNT-CO-ID2 initialAttributes;
  set OS0NM001.CU-PNT-CO-ID3 initialAttributes;
  set OS0NM001.CU-PNT-CO-ID4 initialAttributes;
  set OS0NM001.CU-PNT-CO-ID5 initialAttributes;
  ;
  set OS0NM001.OB-SEL-CO-ID-FL initialAttributes;
  set OS0NM001.CU-CO-ID1 initialAttributes;
  set OS0NM001.CU-CO-ID2 initialAttributes;
  set OS0NM001.CU-CO-ID3 initialAttributes;
  set OS0NM001.CU-CO-ID4 initialAttributes;
  set OS0NM001.CU-CO-ID5 initialAttributes;
  ;
  set OS0NM001.OB-GPC-CODE initialAttributes;
  set OS0NM001.OB-CUST-PO-NBR initialAttributes;
  ;
  set OS0NM001.OB-SEL-STOR-ID-FL initialAttributes;
  set OS0NM001.OB-SEL-XNX-ID-FL initialAttributes;
  set OS0NM001.XNX-DEPT-ID-XREF1 initialAttributes;
  set OS0NM001.XNX-DEPT-ID-XREF2 initialAttributes;
  set OS0NM001.XNX-DEPT-ID-XREF3 initialAttributes;
  set OS0NM001.XNX-DEPT-ID-XREF4 initialAttributes;
  set OS0NM001.XNX-DEPT-ID-XREF5 initialAttributes;
  ;
  set OS0NM001.OB-SEL-DEPT-ID-FL initialAttributes;
  set OS0NM001.OB-SEL-CUST-PO-FL initialAttributes;
  set OS0NM001.OB-SEL-SREP-ID-FL initialAttributes;
  set OS0NM001.OB-SEL-SPGM-ID-FL initialAttributes;
  set OS0NM001.OB-SEL-NEED-DT-FL initialAttributes;
  set OS0NM001.OB-NEED-BULK-BDT initialAttributes;
  set OS0NM001.OB-NEED-BULK-XDT initialAttributes;
  ;
  ;
end // end OS0NS-RESET-ATTRIB

// TRANSFER CONTROL TO OTHER APPL
Function OS0NS-TRNSFR-CNTL()
  ;
  COMMAREA.CAUSERA = OSWWREC.OSWWGRP;
  ;
  if (converseVar.eventKey is pf3)
   /* AND OSWWREC.OSWWERFL = 'N';*/
    COMMAREA.CATOAP = "OS0M"; /* Define Bulk Asgnmnt - Draw Criteria*/
    XSEXIT();
    ;
  end
  ;
  if (converseVar.eventKey is pf4)
   /* AND OSWWREC.OSWWERFL = 'N';*/
    if (OSWWREC.OSWWFRMAP == "OS0L") /* came from os0l application*/
      OS0NS-PRG-TMP-STOR(); /* purge os0l temp storage*/
    end
    COMMAREA.CAUSERA = " ";
    XSPF4();
  end
  ;
   /* IF EZEAID IS PF10*/
   /* AND OSWWREC.OSWWERFL = 'N';*/
   /* MOVE 'OS0N' TO COMMAREA.CAFROMAP;*/
   /* MOVE 'OS0P' TO COMMAREA.CATOAP;  /* draw order information*/
   /* XSEXIT;*/
  ;
   /* END;*/
  ;
  if (converseVar.eventKey is enter
   || converseVar.eventKey is pf3
   || converseVar.eventKey is pf4
   || converseVar.eventKey is pf12)
     /* next sentence - there may be errors*/
  else
    converseLib.validationFailed(002); /* invalid pf key*/
    OSWWREC.OSWWERFL = "Y"; /* set error flag*/
  end
  ;
  if (converseVar.eventKey is enter
   && OSWWREC.OSWWERFL == "N"
   && OS0NM001.OB-SEL-CUST-PO-FL == "S")
    COMMAREA.CAFROMAP = "OS0N";
    COMMAREA.CATOAP = "OS0P";
    XSEXIT();
  end
  ;
  if (converseVar.eventKey is enter
   && OSWWREC.OSWWERFL == "N")
    COMMAREA.CATOAP = "OS0O";
    XSEXIT();
  end
  ;
end // end OS0NS-TRNSFR-CNTL

// UPDATE OS0N MAP
Function OS0NS-UPD-MAP()
  ;
  ;
  OS0NS-GET-CURR-DTE(); /* get current date/time*/
  ;
  OS0NS-FMT-VBASGN02(); /* format VBASGN01 record*/
  ;
  OS0NS-UPD-VBASGN02(); /* update existing bulk asgnmnt*/
  ;
  ;
end // end OS0NS-UPD-MAP

// UPDATE VBASGN01 RECORD
Function OS0NS-UPD-VBASGN02()
  ;
  ;
  set SQLCA empty;
  ;
  call "VBASGN02" ("U ", SQLCA, VBASGN02) {isNoRefresh = yes, isExternal = yes};
  ;
  if (SQLCA.VAGen_SQLCODE == 0)
   /* next sentence*/
  else
    if (SQLCA.VAGen_SQLCODE == 100)
      OSWWREC.OSWWERFL = "Y";
      converseLib.validationFailed(330); /* reenter changes again*/
      OS0NS-GET-VBASGN02(); /* reread vbasgn02 record*/
    else
      if (SQLCA.VAGen_SQLCODE == -911)
        OSWWREC.OSWWERFL = "Y";
        converseLib.validationFailed(010); /* database busy*/
      else
        if (OSWWREC.OSWWFRMAP == "OS0L") /* came from os0l appl*/
          OS0NS-PRG-TMP-STOR(); /* purge os0l temp storage*/
        end
        TA1REC.TA1TYPE = "DB2 ";
        TA1REC.TA1FUNC = "RETN";
        TA1REC.TA1PGMNM = "OS0N";
        TA1REC.TA1LOCAT[1] = "OS0NS-UP";
        TA1REC.TA1LOCAT[2] = "D-VBASGN";
        TA1REC.TA1LOCAT[3] = "01 U    ";
        TA1REC.TA1LOCAT[4] = "VBASGN02";
        TA1REC.TA1DBASE = "DORDB   ";
        TA1REC.TA1TBLVU = "VBASGN02";
        TA1REC.TA1TBLKE = VBASGN02.OB-BULK-ASGN-ID;
        ;
        call "TA0020" (TA1REC, SQLCA) {isExternal = yes};
        ;
        COMMAREA.CAUSERA = " ";
        ;
        XSPF4();
        exit program;
      end
    end
  end
  ;
  ;
end // end OS0NS-UPD-VBASGN02

// VALIDATE ADDITIONAL FIELD VALU
Function OS0NS-VALDTE-EXTRA()
  ;
    /* validate additional group/parent/company/department entered*/
    /* by calling subprogram OS1030 which will attempt to match the*/
    /* editing field value to the same corresponding field value that*/
    /* was identified on the draw criteria.*/
  ;
  OSUREC.OSU-DRAW-GROUP = VBASGN02.KUCGRPID;
  OSUREC.OSU-DRAW-PARENT = VBASGN02.KUKPCOID;
  OSUREC.OSU-DRAW-COMP = VBASGN02.KUCCOID;
  OSUREC.OSU-RETURN-CODE = 99;
  ;
  OS0NS-CALL-OS1030(); /* call OS1030 subprogram*/
  ;
  ;
end // end OS0NS-VALDTE-EXTRA

// VALIDIATE DATE
Function OS0NS-VALIDATE-DT()
  ;
  ;
    /* Edit MMDDYY Map Date*/
  ;
  OS0NS-EDT-MMDDYY();
  ;
  if (TA2REC.TA2RTNCD == 0) /* good return*/
    OS0NS-MMDDYY-COMP(); /* convert MMDDYY to comp*/
  else
    converseLib.validationFailed(849); /* date entered is invalid*/
    OSWWREC.OSWWERFL = "Y"; /* set error flag*/
  end
  ;
  ;
end // end OS0NS-VALIDATE-DT

//*** RECORD=OS0NW01 ****
//     Working Storage Record for OS0L.
// 
// ************************************************************
// *    MAINTENANCE LOG
// ************************************************************
// 
//   05/02/94    schase     initial creation
// ***********************
Record OS0NW01 type basicRecord
  10 OS0NW-CHG-FLAG OS0NW-CHG-FLAG ; 
  10 OS0NW-KUCREC-POST OS0NW-KUCREC-POST ; 
  10 OS0NW-KUKREC-POST OS0NW-KUKREC-POST ; 
  10 OS0NW-KUJREC-POST OS0NW-KUJREC-POST ; 
  10 OS0NW-VBASGN02-POST OS0NW-VBASGN02-POST ; 
  10 OS0NW-EZEMNO OS0NW-EZEMNO ; 
end // end OS0NW01

// Map Field Changed Flag
DataItem OS0NW-CHG-FLAG char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// hold field for ezemno values
DataItem OS0NW-EZEMNO num(3)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// Company error post key
DataItem OS0NW-KUCREC-POST num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// Department ID post key
DataItem OS0NW-KUJREC-POST num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// Parent company post key
DataItem OS0NW-KUKREC-POST num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// Bulk assignment id post key
DataItem OS0NW-VBASGN02-POST char(10)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

