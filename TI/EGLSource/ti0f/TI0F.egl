package ti0f;
import corpcom1.*;
import corpcom2.*;
import corpcom3.*;
import corpcom4.*;
import corpcom5.*;
import corpcom6.*;
import corpcom7.*;
import corpx1.*;
import corpx2.*;
import corpy2.*;
import corpz3.*;
import dg.common.*;
import fk.common.*;
import fy.common.*;
import in1.common.*;
import ku.common.*;
import ob.common.*;
import op.common.*;
import pc.common.*;
import pg.common.*;
import pk.common.*;
import pw.common.*;
import sm.common.*;
import sp.common.*;
import sy.common.*;
import ta.common.*;
import tf.common.*;
import ti.common.*;
import ts.common.*;
import vv.common.*;
//*** PROGRAM=TI0F ****
// This application allows a user to inquire and maintain rows
// in a DB2 table.
// 
// There are two different screens that may be displayed.
// 
// The first screen displayed to the user allows specification
// of the search criteria to be used to list the rows in the
// table.  The list is displayed and the user may page backward
// and forward to view the information.
// 
// When a line is selected on the screen, the second screen is
// displayed, showing all information for that table row.
// 
// If the user has sufficient security to change the data, the
// modifiable fields remain unprotected.  Otherwise, they are
// protected from modification by the user.
// 
// If any data is modified, it is verified and, if complete and
// correct, the table row is updated with the changed data.
// The screen is redisplayed to the user, indicating that the
// update is completed.
// 
// If more that one line was selected on the first screen, the
// next selection is displayed when the user presses the ENTER
// key without making any change to the displayed data.
// 
// When the user exits the second screen (either via PF3 key or
// after all selections have been viewed) the first screen is
// redisplayed, indicating the selections that were viewed.
// 
// The user may exit to any allowed application, via FAST PATH
// or PF key, at any time.
// 
// -------  --------  ------  ---------------------------------
// CONTROL    DATE    USERID  DESCRIPTION OF CHANGE
// -------  --------  ------  ---------------------------------
// NEW      06/30/96  bharri  New application.
//          12/06/96  bharri  corrected page number on TI0Fm003
//          12/20/96  bharri  added review cycle functionality
//          12/12/98  bharri  re-genned for table changes
//          12/23/98  jkenne  added resend function
// *********************
Program TI0F type textUIProgram //VAGen Info - main text program
  {
  includeReferencedFunctions = yes, allowUnqualifiedItemReferences = yes, 
  throwNrfEofExceptions = yes, handleHardIOErrors = no, V60ExceptionCompatibility = yes, 
  I4GLItemsNullable = no, textLiteralDefaultIsString = no, localSQLScope = yes, 
  msgTablePrefix = "TI00", inputRecord = COMMAREA, segmented = yes
  }

  // Data Declarations
  COMMAREA COMMAREA ; // record
  FY1REC FY1REC; // record
  KUCREC KUCREC; // record
  KUNREC KUNREC; // record
  OP1REC OP1REC; // record
  OP2REC OP2REC; // record
  PC2REC PC2REC; // record
  PC3REC PC3REC; // record
  SQLCA SQLCA; // record
  SY1REC SY1REC; // record
  SY2REC SY2REC; // record
  SY4REC SY4REC; // record
  SYCREC SYCREC; // record
  TA1REC TA1REC; // record
  TA2REC TA2REC; // record
  TA5REC TA5REC; // record
  TAEREC TAEREC; // record
  TI0FW00 TI0FW00; // record
  TI0FW01 TI0FW01; // record
  TI0FW02 TI0FW02; // record
  TI0FW03 TI0FW03; // record
  TI0FW04 TI0FW04; // record
  TI0FW05 TI0FW05; // record
  TI0FW06 TI0FW06; // record
  TI0FW07 TI0FW07; // record
  TI0FWCA1 TI0FWCA1; // record
  TI0FWCA2 TI0FWCA2; // record
  TIWREC TIWREC; // record
  TIXREC TIXREC; // record
  VTHMSG01 VTHMSG01; // record
  VTIMSG01 VTIMSG01; // record
  VTODCD01 VTODCD01; // record
  VTOHDR01 VTOHDR01; // record
  VTOITM01 VTOITM01; // record
  VTOMSG01 VTOMSG01; // record
  VTOPCD01 VTOPCD01; // record
  VTORQT01 VTORQT01; // record
  VTOSCD01 VTOSCD01; // record
  VTOXCD01 VTOXCD01; // record
  VTRMSG01 VTRMSG01; // record
  VTSPXM01 VTSPXM01; // record
  VXCL0001 VXCL0001; // record
  XCTREC XCTREC; // record
  XGPREC XGPREC; // record
  XHDREC XHDREC; // record
  XPCREC XPCREC; // record
  XSTREC XSTREC; // record
  XX0XW01 XX0XW01; // record

  // VAGen Info - items needed for migration
  VAGen_EZESYS char(8);
  VAGen_EZEREPLY num(1);
  VAGen_EZE_WAIT_TIME bin(9,2);
  VAGen_EZE_ITEMLEN int;

  // Use Declarations
  use XFCTBL {deleteAfterUse = yes}; // table
  use XCLTBL {deleteAfterUse = yes}; // table
  use XCTTBL {deleteAfterUse = yes}; // table
  use XGPTBL; // table
  use XHDTBL {deleteAfterUse = yes}; // table
  use XPCTBL; // table
  use XSTTBL {deleteAfterUse = yes}; // table
  use TI0FM.TI0FM001,  // forms
      TI0FM.TI0FM002, 
      TI0FM.TI0FM003, 
      TI0FM.TI0FM004, 
      TI0FM.TI0FM005, 
      TI0FM.TI0FM006, 
      TI0FM.TI0FM007
   {
    pfKeyEquate = no
  };

  function main()
    // VAGen Info - initialization needed for migration
    VAGen_EZESYS = VGLib.getVAGSysType();
    XPTI-00000: XPTI-00000();
    if (COMMAREA.CAFRMSYS == "GD")

      TI0FWCA1.TI0FWCA1-REC = COMMAREA.CA-USER-WORKAREA-2K-B;

      TI0FW00.TI0FW00-REC = TI0FWCA1.TI0FWCA1-TI0FW00;

      TI0FW02.TI0FW02-REC = TI0FWCA1.TI0FWCA1-TI0FW02;

      TI0FWCA2.TI0FWCA2-REC = COMMAREA.CA-USER-WORKAREA-2K-C;

      TI0FW01.TI0FW01-REC = TI0FWCA2.TI0FWCA2-TI0FW01;

      TI0FW03.TI0FW03-REC = TI0FWCA2.TI0FWCA2-TI0FW03;

      TI0FW04.TI0FW04-REC = TI0FWCA2.TI0FWCA2-TI0FW04;

      TI0FW05.TI0FW05-REC = TI0FWCA2.TI0FWCA2-TI0FW05;

      TIWREC.CAUSERA = COMMAREA.CAUSERA;

      TIWREC.XXX-MSG-LOC-ID = TI0FWCA1.XXX-MSG-LOC-ID;

      TIWREC.XXX-MSG-NBR = TI0FWCA1.XXX-MSG-NBR;

      TIWREC.TI-CUTK-XMIT-CD = TI0FWCA1.TI-CUTK-XMIT-CD;

    else
      set TI0FM001 initial;
      set TI0FM002 initial;
      set TI0FM003 initial;
      set TI0FM004 initial;
      set TI0FM005 initial;
      set TI0FM006 initial;
      set TI0FM007 initial;
      set TI0FW00 empty; /* Working storage*/
      set TI0FW01 empty; /* M001 display storage*/

      TI0FW01.TI0FW-TI-CUTK-SEND-CD1 = "*";

      TI0FW01.TI0FW-TI-CUTK-SEND-CD2 = "*";

      TI0FM001.TI0FW-TI-CUTK-SEND-CD1 = "*";

      TI0FM001.TI0FW-TI-CUTK-SEND-CD2 = "*";

      set TI0FW02 empty; /* M002 display storage*/
      set TI0FW03 empty; /* M002 display storage*/
      set TI0FW04 empty; /* M002 display storage*/
      set TI0FW05 empty; /* M002 display storage*/
      set TI0FW06 empty; /* M002 display storage*/
      set TI0FW07 empty; /* M002 display storage*/
      set SQLCA empty; /* SQL communication area*/
      set TAEREC empty; /* Error diagnosis information*/
      set TA1REC empty; /* Error diagnosis parameters*/
      set TA5REC empty; /* Temporary storage parameters*/
      set XPCREC empty; /* Product category table row*/
      set XX0XW01 empty; /* Date/time subroutine parameters*/

      TI0FW00.XXX-RQT-DATA-FL = "Y"; /* Request for data flag*/
      TI0FW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

      TI0FW00.XXX-MAP-DSP-CD = "1"; /* Map to be displayed*/

      TI0FW00.XXX-TEMP-STG-LNTH = 1024; /* Temporary storage length*/
      TI0FW00.XXX-INX-LMT-NBR = 12; /* Number of lines on a page*/

    end

    goto TI0F-00000; /* Converse the main process*/
    TI0F-00000: TI0F-00000();
     /* ------------------------------------------------------------*/
     /* Flow to converse the main process used to display a map.*/
     /* ------------------------------------------------------------*/

    goto TI0F-00000; /* Converse the main process*/


  end // end main
end // end TI0F

// Determine which map to display
Function TI0F-00000()
   /* ------------------------------------------------------------*/
   /* This is the main process used to display a map.  Processing*/
   /* always returns to the top of this process and falls through*/
   /* subordinate processes until an error is found or a valid*/
   /* request is processed.  Processing sequence is as follows:*/

   /* 1) If specified, display the map that was requested.*/
   /* 2) Otherwise, indicate error and exit to System Menu.*/

   /* In all subordinate processes, "EZEFLO" is used to exit to*/
   /* redisplay the map when an error is found.  This is done to*/
   /* minimize the coding effort required to skip subsequent*/
   /* processing under error conditions.*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-MAP-DSP-CD == "1") /* Map 1 was requested*/

  /* MOVE 'Y' TO TI0FW00.XXX-RQT-DATA-FL;*/

    TI0F-10000(); /* Display selection criteria screen*/

    exit stack; /* Exit to display map*/

  end

  if (TI0FW00.XXX-MAP-DSP-CD == "2") /* Map 2 was requested*/

    TI0F-20000(); /* Display sales Summary Screen*/

    exit stack; /* Exit to display map*/

  end

  if (TI0FW00.XXX-MAP-DSP-CD == "3") /* Map 3 was requested*/

    TI0F-30000(); /* Display production summary screen*/

    exit stack; /* Exit to display map*/

  end

  if (TI0FW00.XXX-MAP-DSP-CD == "4") /* Map 4 was requested*/

    TI0F-40000(); /* Display detail screen*/

    exit stack; /* Exit to display map*/

  end

  if (TI0FW00.XXX-MAP-DSP-CD == "5" /* Map 5 was requested*/
  )                                
    TI0F-50000(); /* Display detail sizes array screen*/

   /* Exit to display map*/
    exit stack;
  end
  if (TI0FW00.XXX-MAP-DSP-CD == "6")

    TI0F-60000();

    exit stack;

  end

  if (TI0FW00.XXX-MAP-DSP-CD == "7")

    TI0F-70000();

    exit stack;

  end

  TIWREC.XXX-MSG-LOC-ID = "00000"; /* Message location*/
  TIWREC.XXX-MSG-NBR = 10; /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "INVALID MAP NUMBER REQUESTED"; /* Description*/
  TA1REC.TA1MAPNO = TI0FW00.XXX-MAP-DSP-CD; /* Map requested*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  COMMAREA.CATOAP = "TI0M"; /* System Menu*/

  XSTIS-EXIT(); /* Exit to another application*/
end // end TI0F-00000

// Determine which map to display
Function TI0F-10000()
   /* ------------------------------------------------------------*/
   /* This is the main process used to display a map.  Processing*/
   /* always returns to the top of this process and falls through*/
   /* subordinate processes until an error is found or a valid*/
   /* request is processed.  Processing sequence is as follows:*/

   /* 1) If specified, display the map that was requested.*/
   /* 2) Otherwise, indicate error and exit to System Menu.*/

   /* In all subordinate processes, "EZEFLO" is used to exit to*/
   /* redisplay the map when an error is found.  This is done to*/
   /* minimize the coding effort required to skip subsequent*/
   /* processing under error conditions.*/
   /* ------------------------------------------------------------*/

  TI0F-11000(); /* Obtain the data to display*/

  TI0F-12000(); /* Format and display the map*/

  TI0F-13000(); /* Check attention identifier*/

  TI0F-14000(); /* Verify the entered data*/

  TI0F-15000(); /* Process valid input request*/
end // end TI0F-10000

// Obtain the data to display
Function TI0F-11000()
   /* ------------------------------------------------------------*/
   /* If data was not requested or an error was found, return to*/
   /* the previous process.*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-RQT-DATA-FL != "Y" /* Data was not requested*/
   || converseVar.validationMsgNum != 0) /* or an error was found*/

    return; /* Return to previous process*/

  end

  TI0FW00.TI0FW-A-ROW-WAS-SELECTED-FL = "N";

   /* ------------------------------------------------------------*/
   /* Clear the map display storage area and save all the fields.*/
   /* ------------------------------------------------------------*/

  set TI0FW01 empty; /* M001 storage*/

  TI0FW01.TI0FW-TI-CUTK-SEND-CD1 = "*";

  TI0FW01.TI0FW-TI-CUTK-SEND-CD2 = "*";

  TI0FW00.XXX-MAP-FMAT-FL = "Y"; /* Format map flag*/

  TI0FW01.XGP-GPC-CD = TI0FM001.XGP-GPC-CD;
  TI0FW01.CU-CO-ID = TI0FM001.CU-CO-ID;
  TI0FW01.TI0FW-CU-STOR-ID = TI0FM001.TI0FW-CU-STOR-ID;
  TI0FW01.TI0FW-XNX-DEPT-ID-XREF = TI0FM001.TI0FW-XNX-DEPT-ID-XREF;
  TI0FW01.TI0FW-OP-CUST-PO1 = TI0FM001.TI0FW-OP-CUST-PO1;
  TI0FW01.TI0FW-SY-STY-CD1 = TI0FM001.TI0FW-SY-STY-CD1;
  TI0FW01.TI0FW-SY-COLR-CD-ID1 = TI0FM001.TI0FW-SY-COLR-CD-ID1;
  TI0FW01.OP-CUST-ORD-ID = TI0FM001.OP-CUST-ORD-ID;
  TI0FW01.OP-NIKE-ORD-ID = TI0FM001.OP-NIKE-ORD-ID;
  TI0FW01.TI0FW-CUST-NEED-DT-FROM = TI0FM001.TI0FW-CUST-NEED-DT-FROM;
  TI0FW01.TI0FW-CUST-NEED-DT-TO = TI0FM001.TI0FW-CUST-NEED-DT-TO;
  TI0FW01.XHD-HNDL-CD = TI0FM001.XHD-HNDL-CD;
  TI0FW01.TI0FW-TI-CUTK-SEND-CD1 = TI0FM001.TI0FW-TI-CUTK-SEND-CD1;
  TI0FW01.TI0FW-PO-ID-MO-RNG-YY = TI0FM001.TI0FW-PO-ID-MO-RNG-YY;
  TI0FW01.TI0FW-PO-ID-MO-RNG-BLD-MM = TI0FM001.TI0FW-PO-ID-MO-RNG-BLD-MM;
  TI0FW01.TI0FW-PO-ID-MO-RNG-SHP-MM = TI0FM001.TI0FW-PO-ID-MO-RNG-SHP-MM;
  TI0FW01.FY-FCTY-CD = TI0FM001.FY-FCTY-CD;
  TI0FW01.PC-PO-NBR = TI0FM001.PC-PO-NBR;
  TI0FW01.XCT-CTRY-CD = TI0FM001.XCT-CTRY-CD;
  TI0FW01.TI0FW-SY-STY-CD2 = TI0FM001.TI0FW-SY-STY-CD2;
  TI0FW01.TI0FW-SY-COLR-CD-ID2 = TI0FM001.TI0FW-SY-COLR-CD-ID2;
  TI0FW01.PC-PRDCU-ID = TI0FM001.PC-PRDCU-ID;
  TI0FW01.TI0FW-OP-CUST-PO2 = TI0FM001.TI0FW-OP-CUST-PO2;
  TI0FW01.TI0FW-TI-CUTK-SEND-CD2 = TI0FM001.TI0FW-TI-CUTK-SEND-CD2;
  TI0FW01.TI-CUTK-STAT-CD[1] = TI0FM001.TI-CUTK-STAT-CD[1];
  TI0FW01.TI-CUTK-STAT-CD[2] = TI0FM001.TI-CUTK-STAT-CD[2];
  TI0FW01.TI-CUTK-STAT-CD[3] = TI0FM001.TI-CUTK-STAT-CD[3];
  TI0FW01.TI-CUTK-STAT-CD[4] = TI0FM001.TI-CUTK-STAT-CD[4];
  TI0FW01.TI-CUTK-STAT-CD[5] = TI0FM001.TI-CUTK-STAT-CD[5];
  TI0FW01.TI-CUTK-STAT-CD[6] = TI0FM001.TI-CUTK-STAT-CD[6];
  TI0FW01.TI0FW-SEND-DATE-RNG-FROM = TI0FM001.TI0FW-SEND-DATE-RNG-FROM;
  TI0FW01.TI0FW-SEND-DATE-RNG-TO = TI0FM001.TI0FW-SEND-DATE-RNG-TO;
  TI0FW01.TI0FW-SENT-DATE-RNG-FROM = TI0FM001.TI0FW-SENT-DATE-RNG-FROM;
  TI0FW01.TI0FW-SENT-DATE-RNG-TO = TI0FM001.TI0FW-SENT-DATE-RNG-TO;
  TI0FW01.TI-CUTK-XMIT-CD = TI0FM001.TI-CUTK-XMIT-CD;
  TI0FW01.TI-CUTK-SPLR-CD = TI0FM001.TI-CUTK-SPLR-CD;
  TI0FW01.TI-CUTK-MSG-CD[1] = TI0FM001.TI-CUTK-MSG-CD[1];
  TI0FW01.TI-CUTK-MSG-CD[2] = TI0FM001.TI-CUTK-MSG-CD[2];
  TI0FW01.TI-CUTK-MSG-CD[3] = TI0FM001.TI-CUTK-MSG-CD[3];
  TI0FW01.TI-CUTK-MSG-CD[4] = TI0FM001.TI-CUTK-MSG-CD[4];
  TI0FW01.TI-CUTK-MSG-CD[5] = TI0FM001.TI-CUTK-MSG-CD[5];

   /* ------------------------------------------------------------*/
   /* No DB2 or CSP tables are accessed in this step.*/
   /* ------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/
end // end TI0F-11000

// Format and converse the map
Function TI0F-12000()
   /* ------------------------------------------------------------*/
   /* If an error was found, save the error message number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    TIWREC.XXX-MSG-NBR = converseVar.validationMsgNum; /* Message number*/
  end

   /* ------------------------------------------------------------*/
   /* If the map must be formatted, format the data in the map.*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-MAP-FMAT-FL == "Y") /* Map must be formatted*/

    TI0F-12100(); /* Format the data in the map*/

  end

   /* ------------------------------------------------------------*/
   /* Format the current date and any FAST PATH information.*/
   /* ------------------------------------------------------------*/

  TI0FM001.XXX-CURR-DT = VGVar.currentShortGregorianDate; /* Current date*/

  if (TI0FWCA1.CATOAP > " ")

    TI0FM001.CATOAP = TI0FWCA1.CATOAP;

  else

    TI0FM001.CATOAP = COMMAREA.CATOAP; /* TO application*/

  end

  if (TI0FWCA1.CAITEM > " ")

    TI0FM001.CAITEM = TI0FWCA1.CAITEM;

  else

    TI0FM001.CAITEM = COMMAREA.CAITEM; /* Application data*/

  end

   /* ------------------------------------------------------------*/
   /* If a message to display, indicate sound audible alarm.*/
   /* ------------------------------------------------------------*/

  if (TIWREC.XXX-MSG-NBR > 0 /* Message to display*/
   || COMMAREA.CAMSG > " ")  /* or message text*/

    if (TIWREC.XXX-MSG-NBR != 0) /* Message to display*/

      if (TIWREC.XXX-MSG-NBR == 9999)
        converseLib.validationFailed();
      else
        converseLib.validationFailed(TIWREC.XXX-MSG-NBR);
      end /* Message number*/

    else

      TI0FM001.VAGen_EZEMSG = COMMAREA.CAMSG; /* Message text*/

    end

    TI0FM001.XXX-MSG-LOC-ID = TIWREC.XXX-MSG-LOC-ID;
    TI0FM001.TI0FM-HYPHEN = "-";
                                   /* Message location*/

    set TI0FM001 alarm; /* Indicate sound alarm*/

  else

    converseLib.validationFailed(0); /* Message number*/

    TI0FM001.VAGen_EZEMSG = " "; /* Message text*/

    TI0FM001.XXX-MSG-LOC-ID = " ";
    TI0FM001.TI0FM-HYPHEN = " ";
  end

  converse TI0FM001 ;

   /* ------------------------------------------------------------*/
   /* Clear the message fields and save FAST PATH information.*/
   /* ------------------------------------------------------------*/

  TIWREC.XXX-MSG-LOC-ID = " "; /* Message location*/
  TIWREC.XXX-MSG-NBR = 0; /* Message number*/
  COMMAREA.CAMSG = " "; /* Message text*/

  COMMAREA.CATOAP = TI0FM001.CATOAP; /* TO application*/
  COMMAREA.CAITEM = TI0FM001.CAITEM; /* Application data*/

   /* ------------------------------------------------------------*/
   /* Reset modifiable field attributes to normal intensity.*/
   /* ------------------------------------------------------------*/

  set TI0FM001.XGP-GPC-CD normal; /* Category code*/
  set TI0FM001.CATOAP normal; /* TO application*/
  set TI0FM001.CAITEM normal; /* Application data*/

end // end TI0F-12000

// Format the data in the map
Function TI0F-12100()
   /* ------------------------------------------------------------*/
   /* Clear the fields in the map storage area to be formatted.*/
   /* ------------------------------------------------------------*/

  set TI0FM001 initial; /* M001 input/output area*/

  TI0FW00.XXX-MAP-FMAT-FL = "N"; /* Format the map flag*/

   /* ------------------------------------------------------------*/
   /* Move sales order data to sceen*/
   /* ------------------------------------------------------------*/

  TI0FM001.XGP-GPC-CD = TI0FW01.XGP-GPC-CD;
  TI0FM001.CU-CO-ID = TI0FW01.CU-CO-ID;
  TI0FM001.TI0FW-CU-STOR-ID = TI0FW01.TI0FW-CU-STOR-ID;
  TI0FM001.TI0FW-XNX-DEPT-ID-XREF = TI0FW01.TI0FW-XNX-DEPT-ID-XREF;
  TI0FM001.TI0FW-OP-CUST-PO1 = TI0FW01.TI0FW-OP-CUST-PO1;
  TI0FM001.TI0FW-SY-STY-CD1 = TI0FW01.TI0FW-SY-STY-CD1;
  TI0FM001.TI0FW-SY-COLR-CD-ID1 = TI0FW01.TI0FW-SY-COLR-CD-ID1;
  TI0FM001.OP-CUST-ORD-ID = TI0FW01.OP-CUST-ORD-ID;
  TI0FM001.OP-NIKE-ORD-ID = TI0FW01.OP-NIKE-ORD-ID;
  TI0FM001.TI0FW-CUST-NEED-DT-FROM = TI0FW01.TI0FW-CUST-NEED-DT-FROM;
  TI0FM001.TI0FW-CUST-NEED-DT-TO = TI0FW01.TI0FW-CUST-NEED-DT-TO;

  TI0FM001.XHD-HNDL-CD = TI0FW01.XHD-HNDL-CD;

  TI0FM001.TI0FW-TI-CUTK-SEND-CD1 = TI0FW01.TI0FW-TI-CUTK-SEND-CD1;

   /* ------------------------------------------------------------*/
   /* Move production order data to sceen*/
   /* ------------------------------------------------------------*/

  TI0FM001.TI0FW-PO-ID-MO-RNG-YY = TI0FW01.TI0FW-PO-ID-MO-RNG-YY;

  TI0FM001.TI0FW-PO-ID-MO-RNG-BLD-MM = TI0FW01.TI0FW-PO-ID-MO-RNG-BLD-MM;

  TI0FM001.TI0FW-PO-ID-MO-RNG-SHP-MM = TI0FW01.TI0FW-PO-ID-MO-RNG-SHP-MM;

  TI0FM001.FY-FCTY-CD = TI0FW01.FY-FCTY-CD;

  TI0FM001.PC-PO-NBR = TI0FW01.PC-PO-NBR;

  TI0FM001.XCT-CTRY-CD = TI0FW01.XCT-CTRY-CD;

  TI0FM001.TI0FW-SY-STY-CD2 = TI0FW01.TI0FW-SY-STY-CD2;

  TI0FM001.TI0FW-SY-COLR-CD-ID2 = TI0FW01.TI0FW-SY-COLR-CD-ID2;

  TI0FM001.PC-PRDCU-ID = TI0FW01.PC-PRDCU-ID;

  TI0FM001.TI0FW-OP-CUST-PO2 = TI0FW01.TI0FW-OP-CUST-PO2;

  TI0FM001.TI0FW-TI-CUTK-SEND-CD2 = TI0FW01.TI0FW-TI-CUTK-SEND-CD2;

   /* ------------------------------------------------------------*/
   /* Move ticket order data to sceen*/
   /* ------------------------------------------------------------*/

  TI0FM001.TI-CUTK-STAT-CD[1] = TI0FW01.TI-CUTK-STAT-CD[1];
  TI0FM001.TI-CUTK-STAT-CD[2] = TI0FW01.TI-CUTK-STAT-CD[2];
  TI0FM001.TI-CUTK-STAT-CD[3] = TI0FW01.TI-CUTK-STAT-CD[3];
  TI0FM001.TI-CUTK-STAT-CD[4] = TI0FW01.TI-CUTK-STAT-CD[4];
  TI0FM001.TI-CUTK-STAT-CD[5] = TI0FW01.TI-CUTK-STAT-CD[5];
  TI0FM001.TI-CUTK-STAT-CD[6] = TI0FW01.TI-CUTK-STAT-CD[6];

  TI0FM001.TI0FW-SEND-DATE-RNG-FROM = TI0FW01.TI0FW-SEND-DATE-RNG-FROM;

  TI0FM001.TI0FW-SEND-DATE-RNG-TO = TI0FW01.TI0FW-SEND-DATE-RNG-TO;

  TI0FM001.TI0FW-SENT-DATE-RNG-FROM = TI0FW01.TI0FW-SENT-DATE-RNG-FROM;

  TI0FM001.TI0FW-SENT-DATE-RNG-TO = TI0FW01.TI0FW-SENT-DATE-RNG-TO;

  TI0FM001.TI-CUTK-XMIT-CD = TI0FW01.TI-CUTK-XMIT-CD;

  TI0FM001.TI-CUTK-SPLR-CD = TI0FW01.TI-CUTK-SPLR-CD;

  TI0FW00.TI0FW-TI-CUTK-MSG-CD-IDX = 1;
  while ((TI0FW-TI-CUTK-MSG-CD-IDX <= 5))

    TI0FM001.TI-CUTK-MSG-CD[TI0FW-TI-CUTK-MSG-CD-IDX] = TI0FW01.TI-CUTK-MSG-CD[TI0FW-TI-CUTK-MSG-CD-IDX];

    TI0FW00.TI0FW-TI-CUTK-MSG-CD-IDX = TI0FW00.TI0FW-TI-CUTK-MSG-CD-IDX + 1;

  end /* (TI0FW-TI-CUTK-MSG-CD-IDX LE 5)*/

  if (TI0FW00.TI0FW-MAX-RECS-RETURNED-FL != "Y")

    set TI0FW01 empty;

    TI0FW01.TI0FW-TI-CUTK-SEND-CD1 = "*";

    TI0FW01.TI0FW-TI-CUTK-SEND-CD2 = "*";

  end

   /* END OF STATEMENT PROCEDURE*/
end // end TI0F-12100

// Check attention identifier
Function TI0F-13000()
  if (converseVar.eventKey is pf3 /* RETURN TO TI0M*/
   || converseVar.eventKey is pf4) /* RETURN TO MN0M*/

    if (converseVar.eventKey is pf3)
      COMMAREA.CATOAP = "TI0M";
    end

    if (converseVar.eventKey is pf4)
      COMMAREA.CATOAP = "MN0M";
    end

    TI0FS-TI0FW01-TP(); /* Purge any temporary storage*/

    XSTIS-EXIT();

    exit stack;

  end

  if (converseVar.eventKey is pa2)

    if (TI0FW00.XXX-RQT-DATA-FL == "Y")
      set TI0FW02 empty;
    end

    TI0FW00.XXX-RQT-DATA-FL = "N";
    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    COMMAREA.CATOAP = " ";
    COMMAREA.CAITEM = " ";

    exit stack;

  end

  if (COMMAREA.CATOAP > " " /* FAST PATH was requested*/
   && converseVar.eventKey not pf1)

    if (converseVar.eventKey is enter) /* ENTER = ACCEPT AND PROCESS INPUT*/

      TI0FS-TI0FW01-TP();

      XSTIS-EXIT();

      set TI0FM001.CATOAP cursor, bold;

      TI0FW00.XXX-MAP-DSP-CD = "1";

    else

      TIWREC.XXX-MSG-LOC-ID = "13000";

      converseLib.validationFailed(5);

    end

    exit stack;

  end

  if (converseVar.eventKey not enter /* ENTER = ACCEPT AND PROCESS INPUT*/
   && converseVar.eventKey not pf1)  /* PF1 = TRANSFER TO HELP*/

    TIWREC.XXX-MSG-LOC-ID = "13000";
    converseLib.validationFailed(4);

    if (converseVar.eventKey is pakey)
      converseLib.clearScreen();
      
    end

    exit stack;

  end
   /* END OF PROCESS STATEMENTS*/
end // end TI0F-13000

// Verify data that was entered
Function TI0F-14000()
  if (converseVar.eventKey is pf1)

    return;

  end

  TI0FW00.TI0FW-TI-CUTK-MSG-EXISTS-FL = "N";

  TI0FW00.TI0FW-TI-CUTK-MSG-CD-IDX = 1;

  while ((TI0FW-TI-CUTK-MSG-CD-IDX <= 5))

    TI0FW00.TI0FW-TI-CUTK-MSG-CD[TI0FW-TI-CUTK-MSG-CD-IDX] = TI0FM001.TI-CUTK-MSG-CD[TI0FW-TI-CUTK-MSG-CD-IDX];

    if ((TI0FM001.TI-CUTK-MSG-CD[TI0FW-TI-CUTK-MSG-CD-IDX]
     != TI0FW01.TI-CUTK-MSG-CD[TI0FW-TI-CUTK-MSG-CD-IDX]
     && TI0FM001.TI-CUTK-MSG-CD[TI0FW-TI-CUTK-MSG-CD-IDX] > " "))

      TI0FW00.TI0FW-TI-CUTK-MSG-EXISTS-FL = "Y";

    end

    TI0FW-TI-CUTK-MSG-CD-IDX = TI0FW-TI-CUTK-MSG-CD-IDX + 1;

  end /* (TI0FW-TI-CUTK-MSG-CD-IDX LE 5);*/

  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-FL = "N";

  if ((TI0FM001.TI-CUTK-XMIT-CD != TI0FW01.TI-CUTK-XMIT-CD
   && TI0FM001.TI-CUTK-XMIT-CD > " "))

    TI0FW00.TI0FW-TI-CUTK-XMIT-CD-FL = "Y";

  end

  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-FL = "N";

  if ((TI0FM001.TI-CUTK-SPLR-CD != TI0FW01.TI-CUTK-SPLR-CD
   && TI0FM001.TI-CUTK-SPLR-CD > " "))

    TI0FW00.TI0FW-TI-CUTK-SPLR-CD-FL = "Y";

  end

  TI0FW00.TI0FW-CUST-NEED-DT-FROM-FL = "N";

  if ((TI0FM001.TI0FW-CUST-NEED-DT-FROM != TI0FW01.TI0FW-CUST-NEED-DT-FROM
   && TI0FM001.TI0FW-CUST-NEED-DT-FROM > 0))

    TI0FW00.TI0FW-CUST-NEED-DT-FROM-FL = "Y";

    if (TI0FM001.TI0FW-CUST-NEED-DT-TO == 0)

      TI0FM001.TI0FW-CUST-NEED-DT-TO = TI0FM001.TI0FW-CUST-NEED-DT-FROM;

    end

  end

  TI0FW00.TI0FW-SEND-DATE-RNG-FROM-FL = "N";
  if ((TI0FM001.TI0FW-SEND-DATE-RNG-FROM
   != TI0FW01.TI0FW-SEND-DATE-RNG-FROM
   && TI0FM001.TI0FW-SEND-DATE-RNG-FROM > 0)
  )
    TI0FW00.TI0FW-SEND-DATE-RNG-FROM-FL = "Y";
    if (TI0FM001.TI0FW-SEND-DATE-RNG-TO == 0)

      TI0FW01.TI0FW-SEND-DATE-RNG-TO = TI0FM001.TI0FW-SEND-DATE-RNG-FROM;

    end

  end

  TI0FW00.TI0FW-SENT-DATE-RNG-FROM-FL = "N";
  if ((TI0FM001.TI0FW-SENT-DATE-RNG-FROM
   != TI0FW01.TI0FW-SENT-DATE-RNG-FROM
   && TI0FM001.TI0FW-SENT-DATE-RNG-FROM > 0)
  )
    TI0FW00.TI0FW-SENT-DATE-RNG-FROM-FL = "Y";
    if (TI0FM001.TI0FW-SENT-DATE-RNG-TO == 0)

      TI0FW01.TI0FW-SENT-DATE-RNG-TO = TI0FM001.TI0FW-SENT-DATE-RNG-FROM;

    end

  end

  TI0FW00.TI0FW-CU-STOR-ID-FL = "N";

  if (TI0FM001.TI0FW-CU-STOR-ID > " ")

    TI0FW00.TI0FW-CU-STOR-ID-FL = "Y";

    TI0FW00.TI0FW-CU-STOR-ID-IN-CHA = TI0FM001.TI0FW-CU-STOR-ID;

    TI0FW00.TI0FW-CU-STOR-ID-IN-NUM = TI0FM001.TI0FW-CU-STOR-ID;

    TI0FW00.TI0FW-WORK-IDX = 1;

    while ((TI0FW-WORK-IDX <= 4))

      if (TI0FW00.TI0FW-CU-STOR-ID-IN-CBYT[TI0FW-WORK-IDX] not numeric)

        TI0FW00.TI0FW-CU-STOR-ID-WK-BYTE[TI0FW-WORK-IDX] = 0;

      else

        TI0FW00.TI0FW-CU-STOR-ID-WK-BYTE[TI0FW-WORK-IDX] = TI0FW00.TI0FW-CU-STOR-ID-IN-NBYT[TI0FW-WORK-IDX];

      end

      TI0FW00.TI0FW-WORK-IDX = TI0FW00.TI0FW-WORK-IDX + 1;

    end /* WHILE (TI0FW-WORK-IDX LE 4)*/

  end

  TI0FW00.TI0FW-XNX-DEPT-ID-XREF-FL = "N";

  if (TI0FM001.TI0FW-XNX-DEPT-ID-XREF > " ")

    TI0FW00.TI0FW-XNX-DEPT-ID-XREF-FL = "Y";

    TI0FW00.TI0FW-XNX-DEPT-ID-IN-CHA = TI0FM001.TI0FW-XNX-DEPT-ID-XREF;

    TI0FW00.TI0FW-XNX-DEPT-ID-IN-NUM = TI0FM001.TI0FW-XNX-DEPT-ID-XREF;

    TI0FW00.TI0FW-WORK-IDX = 1;

    while ((TI0FW-WORK-IDX <= 4))

      if (TI0FW00.TI0FW-XNX-DEPT-ID-IN-CBYT[TI0FW-WORK-IDX] not numeric)

        TI0FW00.TI0FW-XNX-DEPT-ID-WK-BYTE[TI0FW-WORK-IDX] = 0;

      else

        TI0FW00.TI0FW-XNX-DEPT-ID-WK-BYTE[TI0FW-WORK-IDX] = TI0FW00.TI0FW-XNX-DEPT-ID-IN-NBYT[TI0FW-WORK-IDX];

      end

      TI0FW00.TI0FW-WORK-IDX = TI0FW00.TI0FW-WORK-IDX + 1;

    end /* WHILE (TI0FW-WORK-IDX LE 4)*/

  end

   /* ------------------------------------------------------------*/
   /* Verify that the GPC code has been entered.*/
   /* ------------------------------------------------------------*/

  if (TI0FM001.XGP-GPC-CD <= " ")

    TIWREC.XXX-MSG-LOC-ID = "14000"; /* Message location*/
    converseLib.validationFailed(27); /* Field missing or invalid*/

    set TI0FM001.XGP-GPC-CD cursor, bold; /* Highlight*/

    exit stack;

  end

   /* ------------------------------------------------------------*/
   /* Verify that the GPC code entered is valid.*/
   /* ------------------------------------------------------------*/

  if ((TI0FM001.XGP-GPC-CD != TI0FW01.XGP-GPC-CD
   && TI0FM001.XGP-GPC-CD > " "))

    XGPREC.XGPCD = TI0FM001.XGP-GPC-CD; /* GPC code*/

    /* ------------------------------------------------------------*/
    /* Determine if the code is in the table and status is active.*/
    /* ------------------------------------------------------------*/
    if (XGPREC.XGPCD in XGPTBL.XGPCD /* Code in table*/
     && XGPTBL.XXXSTAT[sysVar.arrayIndex] == "A") /* and active status*/

       /* NEXT SENTENCE*/

    else

      /* ------------------------------------------------------------*/
      /* If not found or inactive, indicate missing or invalid.*/
      /* ------------------------------------------------------------*/

      TIWREC.XXX-MSG-LOC-ID = "14000"; /* Message location*/
      converseLib.validationFailed(28); /* Field missing or invalid*/
      set TI0FM001.XGP-GPC-CD cursor, bold; /* Highlight*/

      exit stack;

    end
  end

   /* ------------------------------------------------------------*/
   /* Determine whether any Ticket Order data was entered.*/
   /* ------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* Determine whether any status codes were entered.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX = 1;

  TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL = "N";

  while ((TI0FW-TI-CUTK-STAT-CD-IDX <= 6
   && TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL != "Y"))

    if ((TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX]
     != TI0FW01.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX]
     && TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX] > " ")
    )
      TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL = "Y";

    end

    TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX = TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX + 1;

  end /* (TI0FW-TI-CUTK-stat-CD-IDX LE 6)*/

   /* ------------------------------------------------------------*/
   /* Determine whether any ticket data was entered.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-TICKET-DATA-FL = "N";

  if ((TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")
   || (TI0FM001.TI0FW-SEND-DATE-RNG-FROM
   != TI0FW01.TI0FW-SEND-DATE-RNG-FROM
   && TI0FM001.TI0FW-SEND-DATE-RNG-FROM > 0)
   || (TI0FM001.TI0FW-SEND-DATE-RNG-TO
   != TI0FW01.TI0FW-SEND-DATE-RNG-TO
   && TI0FM001.TI0FW-SEND-DATE-RNG-TO > 0)
   || (TI0FM001.TI0FW-SENT-DATE-RNG-FROM
   != TI0FW01.TI0FW-SENT-DATE-RNG-FROM
   && TI0FM001.TI0FW-SENT-DATE-RNG-FROM > 0)
   || (TI0FM001.TI0FW-SENT-DATE-RNG-TO
   != TI0FW01.TI0FW-SENT-DATE-RNG-TO
   && TI0FM001.TI0FW-SENT-DATE-RNG-TO > 0)
   || (TI0FM001.TI-CUTK-XMIT-CD != TI0FW01.TI-CUTK-XMIT-CD
   && TI0FM001.TI-CUTK-XMIT-CD > " ")
   || (TI0FM001.TI-CUTK-SPLR-CD != TI0FW01.TI-CUTK-SPLR-CD
   && TI0FM001.TI-CUTK-SPLR-CD > " "))

    TI0FW00.TI0FW-TICKET-DATA-FL = "Y";

  end

  TI0FW00.TI0FW-TI-CUTK-MSG-CD-IDX = 1;

  while ((TI0FW-TI-CUTK-MSG-CD-IDX <= 5))

    if ((TI0FM001.TI-CUTK-MSG-CD[TI0FW-TI-CUTK-MSG-CD-IDX]
     != TI0FW01.TI-CUTK-MSG-CD[TI0FW-TI-CUTK-MSG-CD-IDX]
     && TI0FM001.TI-CUTK-MSG-CD[TI0FW-TI-CUTK-MSG-CD-IDX] > " ")
    )
      TI0FW00.TI0FW-TICKET-DATA-FL = "Y";

    end

    TI0FW00.TI0FW-TI-CUTK-MSG-CD-IDX = TI0FW00.TI0FW-TI-CUTK-MSG-CD-IDX + 1;

  end /* (TI0FW-TI-CUTK-MSG-CD-IDX LE 5)*/

   /* ------------------------------------------------------------*/
   /* Determine whether any Production Order data was entered.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-PRODC-DATA-FL = "N";

  if (((TI0FM001.TI0FW-PO-ID-MO-RNG-YY != TI0FW01.TI0FW-PO-ID-MO-RNG-YY
   && TI0FM001.TI0FW-PO-ID-MO-RNG-YY > 0)
   && (TI0FM001.TI0FW-PO-ID-MO-RNG-BLD-MM
   != TI0FW01.TI0FW-PO-ID-MO-RNG-BLD-MM
   && TI0FM001.TI0FW-PO-ID-MO-RNG-BLD-MM > 0)
   && (TI0FM001.TI0FW-PO-ID-MO-RNG-SHP-MM
   != TI0FW01.TI0FW-PO-ID-MO-RNG-SHP-MM
   && TI0FM001.TI0FW-PO-ID-MO-RNG-SHP-MM > 0))
   || (TI0FM001.FY-FCTY-CD != TI0FW01.FY-FCTY-CD
   && TI0FM001.FY-FCTY-CD > " ")
   || (TI0FM001.PC-PO-NBR != TI0FW01.PC-PO-NBR
   && TI0FM001.PC-PO-NBR > " ")
   || (TI0FM001.XCT-CTRY-CD != TI0FW01.XCT-CTRY-CD
   && TI0FM001.XCT-CTRY-CD > " ")
   || ((TI0FM001.TI0FW-SY-STY-CD2 != TI0FW01.TI0FW-SY-STY-CD2
   && TI0FM001.TI0FW-SY-STY-CD2 > " ")
   && (TI0FM001.TI0FW-SY-COLR-CD-ID2 != TI0FW01.TI0FW-SY-COLR-CD-ID2
   && TI0FM001.TI0FW-SY-COLR-CD-ID2 > " "))
   || (TI0FM001.PC-PRDCU-ID != TI0FW01.PC-PRDCU-ID
   && TI0FM001.PC-PRDCU-ID > " ")
   || (TI0FM001.TI0FW-OP-CUST-PO2 != TI0FW01.TI0FW-OP-CUST-PO2
   && TI0FM001.TI0FW-OP-CUST-PO2 > " ")
   || (TI0FM001.TI0FW-TI-CUTK-SEND-CD2
   != TI0FW01.TI0FW-TI-CUTK-SEND-CD2
   && (TI0FM001.TI0FW-TI-CUTK-SEND-CD2 >= " "
   && TI0FM001.TI0FW-TI-CUTK-SEND-CD2 != "*")))

    TI0FW00.TI0FW-PRODC-DATA-FL = "Y";

  end

   /* ------------------------------------------------------------*/
   /* Determine whether any Sales data was entered.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-SALES-DATA-FL = "N";

  if ((TI0FM001.CU-CO-ID != TI0FW01.CU-CO-ID
   && TI0FM001.CU-CO-ID > 0)
   || (TI0FW00.TI0FW-CU-STOR-ID-FL == "Y")
   || (TI0FW00.TI0FW-XNX-DEPT-ID-XREF-FL == "Y")
   || (TI0FM001.TI0FW-OP-CUST-PO1 != TI0FW01.TI0FW-OP-CUST-PO1
   && TI0FM001.TI0FW-OP-CUST-PO1 > " ")
   || (TI0FM001.TI0FW-SY-STY-CD1 != TI0FW01.TI0FW-SY-STY-CD1
   && TI0FM001.TI0FW-SY-STY-CD1 > " ")
   || (TI0FM001.TI0FW-SY-COLR-CD-ID1 != TI0FW01.TI0FW-SY-COLR-CD-ID1
   && TI0FM001.TI0FW-SY-COLR-CD-ID1 > " ")
   || (TI0FM001.OP-CUST-ORD-ID != TI0FW01.OP-CUST-ORD-ID
   && TI0FM001.OP-CUST-ORD-ID > 0)
   || (TI0FM001.TI0FW-CUST-NEED-DT-FROM
   != TI0FW01.TI0FW-CUST-NEED-DT-FROM
   && TI0FM001.TI0FW-CUST-NEED-DT-FROM > 0)
   || (TI0FM001.TI0FW-CUST-NEED-DT-TO != TI0FW01.TI0FW-CUST-NEED-DT-TO
   && TI0FM001.TI0FW-CUST-NEED-DT-TO > 0)
   || (TI0FM001.XHD-HNDL-CD != TI0FW01.XHD-HNDL-CD
   && TI0FM001.XHD-HNDL-CD > " ")
   || (TI0FM001.TI0FW-TI-CUTK-SEND-CD1
   != TI0FW01.TI0FW-TI-CUTK-SEND-CD1
   && (TI0FM001.TI0FW-TI-CUTK-SEND-CD1 >= " "
   && TI0FM001.TI0FW-TI-CUTK-SEND-CD1 != "*")))

    TI0FW00.TI0FW-SALES-DATA-FL = "Y";

  end

   /* ------------------------------------------------------------*/
   /* Determine if neither sales nor production data was entered.*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.TI0FW-PRODC-DATA-FL != "Y"
   && TI0FW00.TI0FW-SALES-DATA-FL != "Y"
   && TI0FW00.TI0FW-MAX-RECS-RETURNED-FL != "Y")

    TIWREC.XXX-MSG-LOC-ID = "14000"; /* Message location*/
    converseLib.validationFailed(21); /* Field missing or invalid*/

    exit stack; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Determine whether production order and sales order data were*/
   /* both entered.*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.TI0FW-PRODC-DATA-FL == "Y"
   && TI0FW00.TI0FW-SALES-DATA-FL == "Y")

    TIWREC.XXX-MSG-LOC-ID = "14000"; /* Message location*/
    converseLib.validationFailed(22); /* Field missing or invalid*/

    exit stack;

  end

  TI0F-14100(); /* VERIFY TICKET ORDERS CRITERIA ENTERED*/

  if (converseVar.validationMsgNum != 0)
    exit stack;
  end

   /* ------------------------------------------------------------*/
   /* If production orders data entered.*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.TI0FW-PRODC-DATA-FL == "Y")

    /* ------------------------------------------------------------*/
    /* Determine whether Production Order PO Id was entered.*/
    /* ------------------------------------------------------------*/

    if ((TI0FM001.TI0FW-PO-ID-MO-RNG-YY != TI0FW01.TI0FW-PO-ID-MO-RNG-YY
     && TI0FM001.TI0FW-PO-ID-MO-RNG-YY > 0)
     && (TI0FM001.TI0FW-PO-ID-MO-RNG-BLD-MM
     != TI0FW01.TI0FW-PO-ID-MO-RNG-BLD-MM
     && TI0FM001.TI0FW-PO-ID-MO-RNG-BLD-MM > 0)
     && (TI0FM001.TI0FW-PO-ID-MO-RNG-SHP-MM
     != TI0FW01.TI0FW-PO-ID-MO-RNG-SHP-MM
     && TI0FM001.TI0FW-PO-ID-MO-RNG-SHP-MM > 0))

      TI0FW00.TI0FW-PO-ID-FL = "Y";

    end

    /* ------------------------------------------------------------*/
    /* Determine whether required prodction orders data was entered.*/
    /* ------------------------------------------------------------*/

    if ((TI0FW00.TI0FW-PO-ID-FL == "Y"
     && ((TI0FM001.FY-FCTY-CD != TI0FW01.FY-FCTY-CD
     && TI0FM001.FY-FCTY-CD > " ")
     || (TI0FM001.XCT-CTRY-CD != TI0FW01.XCT-CTRY-CD
     && TI0FM001.XCT-CTRY-CD > " ")))
     || ((TI0FM001.TI0FW-SY-COLR-CD-ID2 != TI0FW01.TI0FW-SY-COLR-CD-ID2
     && TI0FM001.TI0FW-SY-COLR-CD-ID2 > " ")
     && (TI0FM001.TI0FW-SY-STY-CD2 != TI0FW01.TI0FW-SY-STY-CD2
     && TI0FM001.TI0FW-SY-STY-CD2 > " "))
     || (TI0FM001.PC-PRDCU-ID != TI0FW01.PC-PRDCU-ID
     && TI0FM001.PC-PRDCU-ID > " ")
     || (TI0FM001.PC-PO-NBR != TI0FW01.PC-PO-NBR
     && TI0FM001.PC-PO-NBR > 0)
     || (TI0FM001.TI0FW-TI-CUTK-SEND-CD2
     != TI0FW01.TI0FW-TI-CUTK-SEND-CD2
     && (TI0FM001.TI0FW-TI-CUTK-SEND-CD2 >= " "
     && TI0FM001.TI0FW-TI-CUTK-SEND-CD2 != "*")))

      /* CONTINUE*/

    else

      TIWREC.XXX-MSG-LOC-ID = "14000";
      converseLib.validationFailed(23);

      exit stack;

    end

    TI0F-14200(); /* VERIFY PRODUCTION ORDER CRITERIA ENTERED*/

    if (converseVar.validationMsgNum > 0)
      exit stack;
    end

  end

   /* ------------------------------------------------------------*/
   /* If data was entered in the sales orders area of the screen.*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.TI0FW-SALES-DATA-FL == "Y")

    /* ------------------------------------------------------------*/
    /* Determine whether sales order has been entered.*/
    /* ------------------------------------------------------------*/

    TI0FW00.TI0FW-SALES-ORDER-FL = "N";

    if (TI0FM001.OP-CUST-ORD-ID != TI0FW01.OP-CUST-ORD-ID
     && TI0FM001.OP-CUST-ORD-ID > 0)

      TI0FW00.TI0FW-SALES-ORDER-FL = "Y";

    end

    TI0FW-CU-CO-ID-FL = "N";

    if (TI0FM001.CU-CO-ID > 0)

      TI0FW-CU-CO-ID-FL = "Y";

    end

    /* ------------------------------------------------------------*/
    /* Determine whether any required data has been entered.*/
    /* ------------------------------------------------------------*/

    TI0FW00.TI0FW-STYLE-COLR-FL = "N";

    if ((TI0FM001.TI0FW-SY-STY-CD1 != TI0FW01.TI0FW-SY-STY-CD1
     && TI0FM001.TI0FW-SY-STY-CD1 > " "))

      if ((TI0FM001.TI0FW-SY-COLR-CD-ID1 != TI0FW01.TI0FW-SY-COLR-CD-ID1
       && TI0FM001.TI0FW-SY-COLR-CD-ID1 > " ")
      )
        TI0FW00.TI0FW-STYLE-COLR-FL = "Y";

        TI0FW00.TI0FW-SY-STY-CD = TI0FM001.TI0FW-SY-STY-CD1;

        TI0FW00.TI0FW-SY-COLR-CD-ID = TI0FM001.TI0FW-SY-COLR-CD-ID1;

      else
        TIWREC.XXX-MSG-LOC-ID = "14000"; /* Message location*/
        converseLib.validationFailed(29); /* Field missing or invalid*/

        set TI0FM001.TI0FW-SY-STY-CD1 bold; /* Highlight*/
        set TI0FM001.TI0FW-SY-COLR-CD-ID1 cursor, bold; /* Highlight*/

        exit stack;

      end

    end

    TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL = "N";

    if ((TI0FM001.TI0FW-TI-CUTK-SEND-CD1 != TI0FW01.TI0FW-TI-CUTK-SEND-CD1
     && (TI0FM001.TI0FW-TI-CUTK-SEND-CD1 >= " "
     && TI0FM001.TI0FW-TI-CUTK-SEND-CD1 != "*")))

      TI0FW00.TI-CUTK-SEND-CD = TI0FM001.TI0FW-TI-CUTK-SEND-CD1;

      TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL = "Y";

    end

    /* ------------------------------------------------------------*/
    /* Verify that all the data entered in sales order area of screen*/
    /* is valid.*/
    /* ------------------------------------------------------------*/

    if (TI0FW00.TI0FW-SALES-ORDER-FL != "Y"
     && TI0FW00.TI0FW-STYLE-COLR-FL != "Y"
     && TI0FW00.TI0FW-CU-CO-ID-FL != "Y"
     && TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL != "Y")

      TIWREC.XXX-MSG-LOC-ID = "14000"; /* Message location*/
      converseLib.validationFailed(24); /* Field missing or invalid*/

      set TI0FM001.CU-CO-ID cursor; /* Highlight*/

      exit stack;

    end

    if (TI0FW00.TI0FW-SALES-ORDER-FL != "Y")

      TI0F-14300();

      if (converseVar.validationMsgNum > 0)
        exit stack;
      end

    end

  end

  if (COMMAREA.CAITEM > " ")

    TIWREC.XXX-MSG-LOC-ID = "14000";
    converseLib.validationFailed(7);

    set TI0FM001.CAITEM cursor, bold;

    exit stack;

  end
end // end TI0F-14000

// Verify product category code
Function TI0F-14100()
   /* ------------------------------------------------------------*/
   /* Verify that all the error codes entered are valid.*/
   /* ------------------------------------------------------------*/
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-IDX = 5;

  while ((TI0FW00.TI0FW-TI-CUTK-MSG-CD-IDX > 0 && converseVar.validationMsgNum == 0))

    TI0F-14110();

    TI0FW00.TI0FW-TI-CUTK-MSG-CD-IDX = TI0FW00.TI0FW-TI-CUTK-MSG-CD-IDX - 1;

  end /* WHILE (TI0FW00.TI0FW-TI-CUTK-MSG-CD-IDX GT 0 AND EZEMNO EQ 0);*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* Verify that the supplier code entered is valid.*/
   /* ------------------------------------------------------------*/
  TI0F-14120();

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* Verify that the send method entered is valid.*/
   /* ------------------------------------------------------------*/
  TI0F-14130();

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* Verify that the ticket order status entered is valid.*/
   /* ------------------------------------------------------------*/
  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    TI0F-14150();

  end

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    exit stack; /* Exit to display map*/
  end
end // end TI0F-14100

// Verify general product class
Function TI0F-14110()
  if ((TI0FM001.TI-CUTK-MSG-CD[TI0FW-TI-CUTK-MSG-CD-IDX]
   != TI0FW01.TI-CUTK-MSG-CD[TI0FW-TI-CUTK-MSG-CD-IDX])
   && (TI0FM001.TI-CUTK-MSG-CD[TI0FW-TI-CUTK-MSG-CD-IDX] > " ")
  )
    VTOMSG01.TI-CUTK-MSG-CD = TI0FM001.TI-CUTK-MSG-CD[TI0FW-TI-CUTK-MSG-CD-IDX];

    TI0FS-VTOMSG01-S();

    if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

      TIWREC.XXX-MSG-LOC-ID = "14110"; /* Message location*/
      converseLib.validationFailed(55); /* Field missing or invalid*/

      set TI0FM001.TI-CUTK-MSG-CD[TI0FW-TI-CUTK-MSG-CD-IDX] cursor, bold;

    end

  end
end // end TI0F-14110

// Verify general product class
Function TI0F-14120()
  if ((TI0FM001.TI-CUTK-SPLR-CD != TI0FW01.TI-CUTK-SPLR-CD)
   && (TI0FM001.TI-CUTK-SPLR-CD > " "))

    VTOPCD01.TI-CUTK-SPLR-CD = TI0FM001.TI-CUTK-SPLR-CD;

    TI0FS-VTOPCD01-S();

    if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

      TIWREC.XXX-MSG-LOC-ID = "14120"; /* Message location*/
      converseLib.validationFailed(54); /* Field missing or invalid*/

      set TI0FM001.TI-CUTK-SPLR-CD cursor, bold; /* Highlight*/

      exit stack; /* Return to previous process*/

    end

  end
end // end TI0F-14120

// Verify send method
Function TI0F-14130()
  if ((TI0FM001.TI-CUTK-XMIT-CD != TI0FW01.TI-CUTK-XMIT-CD)
   && (TI0FM001.TI-CUTK-XMIT-CD > " "))

    VTOXCD01.TI-CUTK-XMIT-CD = TI0FM001.TI-CUTK-XMIT-CD;

    TI0FS-VTOXCD01-S();

    if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

      TIWREC.XXX-MSG-LOC-ID = "14130"; /* Message location*/
      converseLib.validationFailed(61); /* Field missing or invalid*/

      set TI0FM001.TI-CUTK-XMIT-CD cursor, bold; /* Highlight*/

      exit stack; /* Return to previous process*/

    end

  end
end // end TI0F-14130

// Verify ticket order status
Function TI0F-14150()
  TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX = 6;

  TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "Y";

  while ((TI0FW-TI-CUTK-STAT-CD-IDX >= 1)
   && (TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL != "N"))

    set VTOSCD01 empty;

    if ((TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX]
     != TI0FW01.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX]
     && TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX] > " "))

      VTOSCD01.TI-CUTK-STAT-CD = TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];

      TI0FS-VTOSCD01-S();

      if (SQLCA.VAGen_SQLCODE == 100)

        TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "N";

      end

    end

    TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX = TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX - 1;

  end /* while(TI0FW-TI-CUTK-STAT-CD-IDX GE 1)*/
     /* AND (TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL NE 'N')*/

  TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX = TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX + 1;

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL == "N")

    TIWREC.XXX-MSG-LOC-ID = "14150";
    converseLib.validationFailed(53);

    set TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX] cursor, bold;

  end
end // end TI0F-14150

// Verify product category code
Function TI0F-14200()
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL = "N";

  if ((TI0FM001.TI0FW-TI-CUTK-SEND-CD2 != TI0FW01.TI0FW-TI-CUTK-SEND-CD2
   && (TI0FM001.TI0FW-TI-CUTK-SEND-CD2 >= " "
   && TI0FM001.TI0FW-TI-CUTK-SEND-CD2 != "*")))

    set VTODCD01 empty; /* Clear row storage area*/

    VTODCD01.TI-CUTK-SEND-CD = TI0FM001.TI0FW-TI-CUTK-SEND-CD2;

    TI0FS-VTODCD01-S();

    if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

      TIWREC.XXX-MSG-LOC-ID = "14200"; /* Message location*/
      converseLib.validationFailed(62); /* Field missing or invalid*/
      set TI0FM001.TI0FW-TI-CUTK-SEND-CD2 cursor, bold;

      exit stack;

    end

    TI0FW00.TI-CUTK-SEND-CD = TI0FM001.TI0FW-TI-CUTK-SEND-CD2;

    TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL = "Y";

  end

   /* ------------------------------------------------------------*/
   /* Verify that the customer purchase order entered is valid.*/
   /* ------------------------------------------------------------*/
  if ((TI0FM001.TI0FW-OP-CUST-PO2 != TI0FW01.TI0FW-OP-CUST-PO2
   && TI0FM001.TI0FW-OP-CUST-PO2 > " "))

    TI0FW00.TI0FW-OP-CUST-PO-FL = "Y";

  end

   /* ------------------------------------------------------------*/
   /* Verify that the style, and color entered in the production orders*/
   /* area of the screen is valid.*/
   /* ------------------------------------------------------------*/
  if (TI0FM001.TI0FW-SY-COLR-CD-ID2 != TI0FW01.TI0FW-SY-COLR-CD-ID2
   && TI0FM001.TI0FW-SY-COLR-CD-ID2 > " ")

    TI0FW00.TI0FW-STYLE-COLR-FL = "Y";

    TI0FW00.TI0FW-SY-STY-CD = TI0FM001.TI0FW-SY-STY-CD2;

    TI0FW00.TI0FW-SY-COLR-CD-ID = TI0FM001.TI0FW-SY-COLR-CD-ID2;

    TI0F-14220();

    if (converseVar.validationMsgNum != 0)
      exit stack;
    end

  end

   /* ------------------------------------------------------------*/
   /* Verify that the county code entered in the production orders*/
   /* area of the screen is valid.*/
   /* ------------------------------------------------------------*/
  if (TI0FM001.XCT-CTRY-CD != TI0FW01.XCT-CTRY-CD
   && TI0FM001.XCT-CTRY-CD > " ")

    TI0F-14230();

    if (converseVar.validationMsgNum != 0) /* Error was found*/
      exit stack; /* Exit to display map*/
    end

  end

   /* ------------------------------------------------------------*/
   /* Verify that the PO Number entered in the production orders*/
   /* area of the screen is valid.*/
   /* ------------------------------------------------------------*/
  if (TI0FM001.PC-PO-NBR != TI0FW01.PC-PO-NBR
   && TI0FM001.PC-PO-NBR > 0)

    TI0F-14240();

    if (converseVar.validationMsgNum != 0) /* Error was found*/
      exit stack; /* Exit to display map*/
    end

  end

   /* ------------------------------------------------------------*/
   /* Verify that the factory code entered is valid.*/
   /* ------------------------------------------------------------*/
  if (TI0FM001.FY-FCTY-CD != TI0FW01.FY-FCTY-CD
   && TI0FM001.FY-FCTY-CD > " ")

    TI0F-14250();

    if (converseVar.validationMsgNum != 0) /* Error was found*/
      exit stack; /* Exit to display map*/
    end

  end

   /* ------------------------------------------------------------*/
   /* Verify that the PO ID entered in the production orders*/
   /* area of the screen is valid.*/
   /* ------------------------------------------------------------*/
  if (TI0FM001.TI0FW-PO-ID-MO-RNG-YY != TI0FW01.TI0FW-PO-ID-MO-RNG-YY
   && TI0FM001.TI0FW-PO-ID-MO-RNG-YY > 0)

    TI0F-14260();

    if (converseVar.validationMsgNum != 0) /* Error was found*/
      exit stack; /* Exit to display map*/
    end

  end

   /* ------------------------------------------------------------*/
   /* Verify that the customer xref entered in the production orders*/
   /* area of the screen is valid.*/
   /* ------------------------------------------------------------*/
  if (TI0FM001.PC-PRDCU-ID != TI0FW01.PC-PRDCU-ID
   && TI0FM001.PC-PRDCU-ID > " ")

    TI0F-14270();

    if (converseVar.validationMsgNum != 0) /* Error was found*/
      exit stack; /* Exit to display map*/
    end

  end
end // end TI0F-14200

// Obtain the data to display
Function TI0F-14220()
  set SYCREC empty;

  SYCREC.XGPCD = TI0FM001.XGP-GPC-CD;

  SYCREC.SY1STNBR = TI0FM001.TI0FW-SY-STY-CD2;

  SYCREC.SY2CLRID = TI0FM001.TI0FW-SY-COLR-CD-ID2;

  SYCREC.XDMCD = " ";

  TI0FS-IO0560-SS();

  if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

    TIWREC.XXX-MSG-LOC-ID = "14220"; /* Message location*/
    converseLib.validationFailed(18); /* No data was found to display*/

    set TI0FM001.TI0FW-SY-STY-CD2 cursor, bold;
    set TI0FM001.TI0FW-SY-COLR-CD-ID2 bold;

  else

    TI0FS-IO0560-SN();

    if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

      TIWREC.XXX-MSG-LOC-ID = "14220"; /* Message location*/
      converseLib.validationFailed(18); /* No data was found to display*/

      set TI0FM001.TI0FW-SY-STY-CD2 cursor, bold;
      set TI0FM001.TI0FW-SY-COLR-CD-ID2 bold;

    end

  end

end // end TI0F-14220

// Verify product category code
Function TI0F-14230()
  set XCTREC empty;

  XCTREC.XCTCD = TI0FM001.XCT-CTRY-CD; /* COLOR CODE*/

   /* ------------------------------------------------------------*/
   /* Determine if the code is in the table and status is active.*/
   /* ------------------------------------------------------------*/

  if (XCTREC.XCTCD in XCTTBL.XCTCD /* Code in table*/
   && XCTTBL.XXXSTAT[sysVar.arrayIndex] == "A") /* and active status*/

     /* NEXT SENTENCE*/

  else

    /* ------------------------------------------------------------*/
    /* If not found or inactive, indicate missing or invalid.*/
    /* ------------------------------------------------------------*/

    TIWREC.XXX-MSG-LOC-ID = "14240"; /* Message location*/
    converseLib.validationFailed(25); /* Field missing or invalid*/

    set TI0FM001.XCT-CTRY-CD cursor, bold; /* Highlight*/

  end
end // end TI0F-14230

// Verify send method
Function TI0F-14240()

  set PC3REC empty;

  PC3REC.XGPCD = TI0FM001.XGP-GPC-CD;
  PC3REC.PC3PONBR = TI0FM001.PC-PO-NBR;

  TI0FS-IO3270-S();

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TIWREC.XXX-MSG-LOC-ID = "14240"; /* Message location*/
    converseLib.validationFailed(18); /* Field missing or invalid*/

    set TI0FM001.PC-PO-NBR cursor, bold; /* Highlight*/

  end
end // end TI0F-14240

// Verify product category code
Function TI0F-14250()
  set FY1REC empty;

  FY1REC.FY1FCTYC = TI0FM001.FY-FCTY-CD; /* FACTORY CODE*/

  FY1REC.XGPCD = TI0FM001.XGP-GPC-CD; /* XGP CODE*/

  TI0FS-IO2810-S();

  if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

    TIWREC.XXX-MSG-LOC-ID = "14250"; /* Message location*/
    converseLib.validationFailed(52); /* No data was found to display*/

    set TI0FM001.FY-FCTY-CD cursor, bold; /* Highlight*/

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end
end // end TI0F-14250

// Verify send method
Function TI0F-14260()
  set PC3REC empty;

  TI0FW00.TI0FW-PO-ID-YY-NUM = TI0FM001.TI0FW-PO-ID-MO-RNG-YY;

  TI0FW00.TI0FW-PO-ID-BLD-MM-NUM = TI0FM001.TI0FW-PO-ID-MO-RNG-BLD-MM;

  TI0FW00.TI0FW-PO-ID-SHP-MM-NUM = TI0FM001.TI0FW-PO-ID-MO-RNG-SHP-MM;

  if (TI0FM001.TI0FW-PO-ID-MO-RNG-YY > 50)
    TI0FW00.TI0FW-PO-ID-CC-NUM = 19;
  else
    TI0FW00.TI0FW-PO-ID-CC-NUM = 20;
  end

  TI0FW00.TI0FW-PO-ID-ZERO-NUM = 0;

  PC3REC.XGPCD = TI0FM001.XGP-GPC-CD;

  TI0FW00.PC-PO-ID-MO-RNG = TI0FW00.TI0FW-PC-PO-ID-MO-RNG;

  PC3REC.PC3POIDT = TI0FW00.PC-PO-ID-MO-RNG;

  TI0FS-IO3270-S5();

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TIWREC.XXX-MSG-LOC-ID = "14260"; /* Message location*/
    converseLib.validationFailed(25); /* Field missing or invalid*/

    set TI0FM001.TI0FW-PO-ID-MO-RNG-YY cursor, bold;
    set TI0FM001.TI0FW-PO-ID-MO-RNG-BLD-MM bold;
    set TI0FM001.TI0FW-PO-ID-MO-RNG-SHP-MM bold;

  else
    TI0FS-IO3270-N5();

    if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

      TIWREC.XXX-MSG-LOC-ID = "14260"; /* Message location*/
      converseLib.validationFailed(25); /* Field missing or invalid*/

      set TI0FM001.TI0FW-PO-ID-MO-RNG-YY cursor, bold;
      set TI0FM001.TI0FW-PO-ID-MO-RNG-BLD-MM bold;
      set TI0FM001.TI0FW-PO-ID-MO-RNG-SHP-MM bold;

    end

  end

  TI0FS-IO3270-C5();
    /*  */
    /* END OF PROCEDURE*/
end // end TI0F-14260

// Obtain the data to display
Function TI0F-14270()
  set PC2REC empty;

  PC2REC.XGPCD = TI0FM001.XGP-GPC-CD;

  PC2REC.PC2CUXID = TI0FM001.PC-PRDCU-ID;

  TI0FS-IO3340-S();

  if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

    TIWREC.XXX-MSG-LOC-ID = "14270"; /* Message location*/
    converseLib.validationFailed(18); /* No data was found to display*/

    set TI0FM001.PC-PRDCU-ID cursor, bold;

  end

end // end TI0F-14270

// Verify product category code
Function TI0F-14300()
   /* ------------------------------------------------------------*/
   /* Verify that the handling code entered is valid.*/
   /* ------------------------------------------------------------*/
  if (TI0FM001.XHD-HNDL-CD != TI0FW01.XHD-HNDL-CD)
    XHDREC.XHD-HNDL-CD = TI0FM001.XHD-HNDL-CD; /* HANDLING CODE*/

    /* ------------------------------------------------------------*/
    /* Determine if the code is in the table and status is active.*/
    /* ------------------------------------------------------------*/

    if (XHDREC.XHD-HNDL-CD in XHDTBL.XHDCD /* Code in table*/
     && XHDTBL.XXXSTAT[sysVar.arrayIndex] == "A") /* and active status*/

       /* NEXT SENTENCE*/

    else

      /* ------------------------------------------------------------*/
      /* If not found or inactive, indicate missing or invalid.*/
      /* ------------------------------------------------------------*/
      TIWREC.XXX-MSG-LOC-ID = "14300"; /* Message location*/
      converseLib.validationFailed(30); /* Field missing or invalid*/
      set TI0FM001.XHD-HNDL-CD cursor, bold; /* Highlight*/

      exit stack;

    end
  end

   /* ------------------------------------------------------------*/
   /* Verify that the company id entered is valid.*/
   /* ------------------------------------------------------------*/
  if (TI0FM001.CU-CO-ID > 0)

    TI0F-14310();

    if (converseVar.validationMsgNum != 0) /* Error was found*/
      exit stack; /* Exit to display map*/
    end
  end

   /* ------------------------------------------------------------*/
   /* Verify beginning need date is valid.*/
   /* ------------------------------------------------------------*/
  if ((TI0FM001.TI0FW-CUST-NEED-DT-FROM != TI0FW01.TI0FW-CUST-NEED-DT-FROM
   && TI0FM001.TI0FW-CUST-NEED-DT-FROM > 0)
   || (TI0FM001.TI0FW-CUST-NEED-DT-TO != TI0FW01.TI0FW-CUST-NEED-DT-TO
   && TI0FM001.TI0FW-CUST-NEED-DT-TO > 0))

    TI0F-14320();

    if (converseVar.validationMsgNum != 0) /* Error was found*/
      exit stack; /* Exit to display map*/
    end
  end

   /* ------------------------------------------------------------*/
   /* Verify send indicator*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0F-14330();

    if (converseVar.validationMsgNum != 0) /* Error was found*/
      exit stack; /* Exit to display map*/
    end
  end
end // end TI0F-14300

// Verify send method
Function TI0F-14310()
  KUNREC.XGPCD = TI0FM001.XGP-GPC-CD;
  KUNREC.KUCCOID = TI0FM001.CU-CO-ID;

  if (TI0FW00.TI0FW-CU-STOR-ID-FL == "Y")

    KUNREC.KUMSTRID = TI0FW00.TI0FW-CU-STOR-ID-WK-NUM;

  else
    KUNREC.KUMSTRID = -1;

  end

  if (TI0FW00.TI0FW-XNX-DEPT-ID-XREF-FL == "Y")

    KUNREC.XNXCD = TI0FW00.TI0FW-XNX-DEPT-ID-WK-NUM;

  else
    KUNREC.XNXCD = -1;

  end

  TI0FS-IO0280-SS();

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TIWREC.XXX-MSG-LOC-ID = "14310"; /* Message location*/
    converseLib.validationFailed(31); /* Field missing or invalid*/

    set TI0FM001.TI0FW-XNX-DEPT-ID-XREF bold; /* Highlight*/
    set TI0FM001.TI0FW-CU-STOR-ID bold; /* Highlight*/
    set TI0FM001.CU-CO-ID cursor, bold; /* Highlight*/

    exit stack; /* Return to previous process*/

  else

    TI0FS-IO0280-SN();

    if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

      TIWREC.XXX-MSG-LOC-ID = "14310"; /* Message location*/
      converseLib.validationFailed(31); /* Field missing or invalid*/

      set TI0FM001.TI0FW-XNX-DEPT-ID-XREF bold; /* Highlight*/
      set TI0FM001.TI0FW-CU-STOR-ID bold; /* Highlight*/
      set TI0FM001.CU-CO-ID cursor, bold; /* Highlight*/

      exit stack; /* Return to previous process*/

    end
  end
end // end TI0F-14310

// Verify send method
Function TI0F-14320()
  if (TI0FM001.TI0FW-CUST-NEED-DT-FROM > 0)
    /* ------------------------------------------------------------*/
     /* call ta2 date convert  routine*/
    /* ------------------------------------------------------------*/

    TA2REC.TA2GRGA = TI0FM001.TI0FW-CUST-NEED-DT-FROM;
    TA2REC.TA2GRTYP = "A";
    TA2REC.TA2DTOPT = "GREGJUL";

    try
      call "TA0040" (TA2REC) {isNoRefresh = yes, isExternal = yes};
    end /* date convert*/

    if (sysVar.errorCode == "00000000") /* Good system return code*/
      if (TA2RTNCD == 222)

        TIWREC.XXX-MSG-LOC-ID = "14320"; /* Message location*/
        converseLib.validationFailed(32); /* Field missing or invalid*/
        set TI0FM001.TI0FW-CUST-NEED-DT-FROM cursor, bold;

        exit stack;

      end
    end

  end

  if (TI0FM001.TI0FW-CUST-NEED-DT-TO > 0)
    /* ------------------------------------------------------------*/
     /* call ta2 date convert  routine*/
    /* ------------------------------------------------------------*/

    TA2REC.TA2GRGA = TI0FM001.TI0FW-CUST-NEED-DT-TO;
    TA2REC.TA2GRTYP = "A";
    TA2REC.TA2DTOPT = "GREGJUL";

    try
      call "TA0040" (TA2REC) {isNoRefresh = yes, isExternal = yes};
    end /* date convert*/

    if (sysVar.errorCode == "00000000") /* Good system return code*/
      if (TA2RTNCD == 222)

        TIWREC.XXX-MSG-LOC-ID = "14320"; /* Message location*/
        converseLib.validationFailed(33); /* Field missing or invalid*/
        set TI0FM001.TI0FW-CUST-NEED-DT-TO cursor, bold;

        exit stack;

      end

    end
  end
end // end TI0F-14320

// Verify send method
Function TI0F-14330()
  set VTODCD01 empty; /* Clear row storage area*/

  VTODCD01.TI-CUTK-SEND-CD = TI0FM001.TI0FW-TI-CUTK-SEND-CD1;

  TI0FS-VTODCD01-S();

  if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

    TIWREC.XXX-MSG-LOC-ID = "14330"; /* Message location*/
    converseLib.validationFailed(62); /* Field missing or invalid*/
    set TI0FM001.TI0FW-TI-CUTK-SEND-CD1 cursor, bold;

    exit stack;

  end
end // end TI0F-14330

// Process valid input request
Function TI0F-15000()
   /* ------------------------------------------------------------*/
   /* Move sales order data to working storage record*/
   /* ------------------------------------------------------------*/
  TI0FW01.XGP-GPC-CD = TI0FM001.XGP-GPC-CD;
  TI0FW01.CU-CO-ID = TI0FM001.CU-CO-ID;
  TI0FW01.TI0FW-CU-STOR-ID = TI0FM001.TI0FW-CU-STOR-ID;
  TI0FW01.TI0FW-XNX-DEPT-ID-XREF = TI0FM001.TI0FW-XNX-DEPT-ID-XREF;
  TI0FW01.TI0FW-OP-CUST-PO1 = TI0FM001.TI0FW-OP-CUST-PO1;
  TI0FW01.TI0FW-SY-STY-CD1 = TI0FM001.TI0FW-SY-STY-CD1;
  TI0FW01.TI0FW-SY-COLR-CD-ID1 = TI0FM001.TI0FW-SY-COLR-CD-ID1;
  TI0FW01.OP-CUST-ORD-ID = TI0FM001.OP-CUST-ORD-ID;
  TI0FW01.OP-NIKE-ORD-ID = TI0FM001.OP-NIKE-ORD-ID;
  TI0FW01.TI0FW-CUST-NEED-DT-FROM = TI0FM001.TI0FW-CUST-NEED-DT-FROM;
  TI0FW01.TI0FW-CUST-NEED-DT-TO = TI0FM001.TI0FW-CUST-NEED-DT-TO;
  TI0FW01.XHD-HNDL-CD = TI0FM001.XHD-HNDL-CD;
  TI0FW01.TI0FW-TI-CUTK-SEND-CD1 = TI0FM001.TI0FW-TI-CUTK-SEND-CD1;

   /* ------------------------------------------------------------*/
   /* Move production order data to working storage record*/
   /* ------------------------------------------------------------*/
  TI0FW01.TI0FW-PO-ID-MO-RNG-YY = TI0FM001.TI0FW-PO-ID-MO-RNG-YY;
  TI0FW01.TI0FW-PO-ID-MO-RNG-BLD-MM = TI0FM001.TI0FW-PO-ID-MO-RNG-BLD-MM;
  TI0FW01.TI0FW-PO-ID-MO-RNG-SHP-MM = TI0FM001.TI0FW-PO-ID-MO-RNG-SHP-MM;
  TI0FW01.FY-FCTY-CD = TI0FM001.FY-FCTY-CD;
  TI0FW01.PC-PO-NBR = TI0FM001.PC-PO-NBR;
  TI0FW01.XCT-CTRY-CD = TI0FM001.XCT-CTRY-CD;
  TI0FW01.TI0FW-SY-STY-CD2 = TI0FM001.TI0FW-SY-STY-CD2;
  TI0FW01.TI0FW-SY-COLR-CD-ID2 = TI0FM001.TI0FW-SY-COLR-CD-ID2;
  TI0FW01.PC-PRDCU-ID = TI0FM001.PC-PRDCU-ID;
  TI0FW01.TI0FW-OP-CUST-PO2 = TI0FM001.TI0FW-OP-CUST-PO2;
  TI0FW01.TI0FW-TI-CUTK-SEND-CD2 = TI0FM001.TI0FW-TI-CUTK-SEND-CD2;

   /* ------------------------------------------------------------*/
   /* Move ticket order data to working storage record*/
   /* ------------------------------------------------------------*/

  TI0FW01.TI-CUTK-STAT-CD[1] = TI0FM001.TI-CUTK-STAT-CD[1];
  TI0FW01.TI-CUTK-STAT-CD[2] = TI0FM001.TI-CUTK-STAT-CD[2];
  TI0FW01.TI-CUTK-STAT-CD[3] = TI0FM001.TI-CUTK-STAT-CD[3];
  TI0FW01.TI-CUTK-STAT-CD[4] = TI0FM001.TI-CUTK-STAT-CD[4];
  TI0FW01.TI-CUTK-STAT-CD[5] = TI0FM001.TI-CUTK-STAT-CD[5];
  TI0FW01.TI-CUTK-STAT-CD[6] = TI0FM001.TI-CUTK-STAT-CD[6];

  TI0FW01.TI0FW-SEND-DATE-RNG-FROM = TI0FM001.TI0FW-SEND-DATE-RNG-FROM;

  TI0FW01.TI0FW-SEND-DATE-RNG-TO = TI0FM001.TI0FW-SEND-DATE-RNG-TO;

  TI0FW01.TI0FW-SENT-DATE-RNG-FROM = TI0FM001.TI0FW-SENT-DATE-RNG-FROM;

  TI0FW01.TI0FW-SENT-DATE-RNG-TO = TI0FM001.TI0FW-SENT-DATE-RNG-TO;

  TI0FW01.TI-CUTK-XMIT-CD = TI0FM001.TI-CUTK-XMIT-CD;

  TI0FW01.TI-CUTK-SPLR-CD = TI0FM001.TI-CUTK-SPLR-CD;

  TI0FW01.TI-CUTK-MSG-CD[1] = TI0FM001.TI-CUTK-MSG-CD[1];
  TI0FW01.TI-CUTK-MSG-CD[2] = TI0FM001.TI-CUTK-MSG-CD[2];
  TI0FW01.TI-CUTK-MSG-CD[3] = TI0FM001.TI-CUTK-MSG-CD[3];
  TI0FW01.TI-CUTK-MSG-CD[4] = TI0FM001.TI-CUTK-MSG-CD[4];
  TI0FW01.TI-CUTK-MSG-CD[5] = TI0FM001.TI-CUTK-MSG-CD[5];
  TI0FWCA1.CATOAP = TI0FM001.CATOAP;
  TI0FWCA1.CAITEM = TI0FM001.CAITEM;

  if (converseVar.eventKey is pf1)

    TIWREC.XXX-MSG-LOC-ID = "10000";

    TIWREC.XXX-MSG-NBR = 0;

    TIWREC.TI-CUTK-XMIT-CD = " ";
    COMMAREA.CAUSERA = TIWREC.CAUSERA;

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    TI0FWCA1.TI0FWCA1-TI0FW00 = TI0FW00.TI0FW00-REC;

    TI0FWCA1.TI0FWCA1-TI0FW02 = TI0FW02.TI0FW02-REC;

    TI0FWCA1.XXX-MSG-LOC-ID = TIWREC.XXX-MSG-LOC-ID;

    TI0FWCA1.XXX-MSG-NBR = TIWREC.XXX-MSG-NBR;

    TI0FWCA1.TI-CUTK-XMIT-CD = TIWREC.TI-CUTK-XMIT-CD;

    COMMAREA.CA-USER-WORKAREA-2K-B = TI0FWCA1.TI0FWCA1-REC;
    TI0FWCA2.TI0FWCA2-TI0FW01 = TI0FW01.TI0FW01-REC;

    TI0FWCA2.TI0FWCA2-TI0FW03 = TI0FW03.TI0FW03-REC;

    TI0FWCA2.TI0FWCA2-TI0FW04 = TI0FW04.TI0FW04-REC;

    TI0FWCA2.TI0FWCA2-TI0FW05 = TI0FW05.TI0FW05-REC;

    COMMAREA.CA-USER-WORKAREA-2K-C = TI0FWCA2.TI0FWCA2-REC;
    COMMAREA.CAFROMAP = "TI0F";

    COMMAREA.CACURRAP = "TI0F";

    COMMAREA.CATOAP = "GD01";

    COMMAREA.CAITEM = "TI0FM001";

    XSTIS-EXIT();

    set TI0FM001.CATOAP cursor, bold;

    TI0FW00.XXX-MAP-DSP-CD = "1";

    TIWREC.XXX-MSG-LOC-ID = "15000";
    converseLib.validationFailed(78);

    exit stack;

  end

   /* ------------------------------------------------------------*/
   /* If valid sales order criteria entered request summary screen 2*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.TI0FW-SALES-DATA-FL == "Y")

    TI0FW00.TI0FW-SALES-DATA-FL = "N";

    TI0FW00.XXX-RQT-DATA-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "2";

    TI0FW00.TI0FW-PREVIOUS-SCREEN-IND = 2;

    exit stack; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If valid production order criteria entered request summary screen 3*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.TI0FW-PRODC-DATA-FL == "Y")

    TI0FW00.TI0FW-PRODC-DATA-FL = "N";

    TI0FW00.XXX-RQT-DATA-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "3";

    TI0FW00.TI0FW-PREVIOUS-SCREEN-IND = 3;

    exit stack; /* Return to previous process*/

  end

  if (TI0FW00.TI0FW-MAX-RECS-RETURNED-FL == "Y")

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    if (TI0FW00.TI0FW-TICKET-DATA-FL == "Y")

      TI0FW00.TI0FW-TICKET-DATA-FL = "N";

      TI0FW00.XXX-RQT-DATA-FL = "Y";

    else

      TI0FW00.XXX-RQT-DATA-FL = "N";

    end

    if (TI0FW00.TI0FW-PREVIOUS-SCREEN-IND == 2)

      TI0FW00.XXX-MAP-DSP-CD = "2";

    end

    if (TI0FW00.TI0FW-PREVIOUS-SCREEN-IND == 3)

      TI0FW00.XXX-MAP-DSP-CD = "3";

    end

    exit stack; /* Return to previous process*/

  end
end // end TI0F-15000

// Main process to display a map
Function TI0F-20000()
   /* ------------------------------------------------------------*/
   /* This is the main process used to display a map.  Processing*/
   /* always returns to the top of this process and falls through*/
   /* subordinate processes until an error is found or a valid*/
   /* request is processed.  Processing sequence is as follows:*/

   /* 1) Obtain the data to display.*/
   /* 2) Format the map output area and display the map.*/
   /* 3) Check the attention identifier used to respond.*/
   /* 4) Verify the data that was entered.*/
   /* 5) Process a valid input request.*/

   /* In all subordinate processes, "EZEFLO" is used to exit to*/
   /* redisplay the map when an error is found.  This is done to*/
   /* minimize the coding effort required to skip subsequent*/
   /* processing under error conditions.*/
   /* ------------------------------------------------------------*/

  TI0F-21000(); /* Obtain the data to display*/

  TI0F-22000(); /* Format and display the map*/

  TI0F-23000(); /* Check attention identifier*/

  TI0F-24000(); /* Verify the entered data*/

  TI0F-25000(); /* Process valid input request*/

end // end TI0F-20000

// Obtain the data to display
Function TI0F-21000()
   /* ------------------------------------------------------------*/
   /* If data was not requested or an error was found, return to*/
   /* the previous process.*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-RQT-DATA-FL != "Y"
   || converseVar.validationMsgNum != 0)

    return;

  end

   /* ------------------------------------------------------------*/
   /* If no message (EZERTN above), reset the page number to display.*/
   /* ------------------------------------------------------------*/

  if (TIWREC.XXX-MSG-NBR == 0)

    TI0FW00.TI0FW-M002-CURR-PAGE-NBR = 1; /* Page number to display*/

  end

  TI0FW00.TI0FW-M002-HI-PAGE-NBR = 0; /* Page number to display*/

   /* ------------------------------------------------------------*/
   /* Purge any pages from temporary storage and save key fields.*/
   /* ------------------------------------------------------------*/

  TI0FS-TI0FW02-TP(); /* Purge any temporary storage*/

   /* ------------------------------------------------------------*/
   /* Initialize screen M002 storage record.*/
   /* ------------------------------------------------------------*/

  set TI0FW02 empty; /* M002 display storage*/

  TI0FW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

   /* ------------------------------------------------------------*/
   /* Initialize ticket order header record.*/
   /* ------------------------------------------------------------*/

  set VTOHDR01 empty; /* Clear row storage area*/

   /* ------------------------------------------------------------*/
   /* If the sales order is entered.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-TBL = " ";

  TI0FW00.XXX-INX-FLD-NBR = 1;

  if (TI0FM001.OP-CUST-ORD-ID > 0)

    if (TI0FM001.OP-NIKE-ORD-ID > 0)

      TI0F-21600();

      if (converseVar.validationMsgNum != 0) /* Normal return code*/
        exit stack; /* Exit to display map*/
      end

    else

      TI0F-21900(); /* Select unique*/

      if (converseVar.validationMsgNum != 0) /* Normal return code*/
        exit stack; /* Exit to display map*/
      end

    end

    TI0FW00.XXX-RQT-DATA-FL = "N";

    if (TI0FW00.TI0FW-M002-HI-PAGE-NBR == 0)

      TIWREC.XXX-MSG-LOC-ID = "21000";
      converseLib.validationFailed(18);

      TI0FW00.XXX-MAP-DSP-CD = "1";

      exit stack;

    end

    return;

  end

  if (TI0FM001.CU-CO-ID > 0)

    if ((TI0FW00.TI0FW-CU-STOR-ID-FL == "Y"
     && TI0FW00.TI0FW-XNX-DEPT-ID-XREF-FL == "Y"))

      if (TI0FM001.TI0FW-OP-CUST-PO1 > " ")

        TI0F-21500();

        if (converseVar.validationMsgNum != 0) /* Normal return code*/
          exit stack; /* Exit to display map*/
        end

      else

        TI0F-21100();

        if (converseVar.validationMsgNum != 0) /* Normal return code*/
          exit stack; /* Exit to display map*/
        end

      end

      TI0FW00.TI0FW-CU-STOR-ID-FL = "N";

      TI0FW00.TI0FW-XNX-DEPT-ID-XREF-FL = "N";

      if ((TI0FW00.XXX-INX-FLD-NBR > 1))

        TI0FS-TI0FW02-TA();

      end

      TI0FW00.XXX-RQT-DATA-FL = "N";

      if (TI0FW00.TI0FW-M002-HI-PAGE-NBR == 0)

        TIWREC.XXX-MSG-LOC-ID = "21000";
        converseLib.validationFailed(18);

        TI0FW00.XXX-MAP-DSP-CD = "1";

        exit stack;

      end

      return;

    end

    if ((TI0FW00.TI0FW-CU-STOR-ID-FL != "Y"
     && TI0FW00.TI0FW-XNX-DEPT-ID-XREF-FL != "Y"))

      if (TI0FM001.TI0FW-OP-CUST-PO1 > " ")

        TI0F-21300();

        if (converseVar.validationMsgNum != 0) /* Normal return code*/
          exit stack; /* Exit to display map*/
        end

      else

        TI0F-21200();

        if (converseVar.validationMsgNum != 0) /* Normal return code*/
          exit stack; /* Exit to display map*/
        end

      end

      if ((TI0FW00.XXX-INX-FLD-NBR > 1))

        TI0FS-TI0FW02-TA();

      end

      TI0FW00.XXX-RQT-DATA-FL = "N";

      if (TI0FW00.TI0FW-M002-HI-PAGE-NBR == 0)

        TIWREC.XXX-MSG-LOC-ID = "21000";
        converseLib.validationFailed(18);

        TI0FW00.XXX-MAP-DSP-CD = "1";

        exit stack;

      end

      return;

    end

    if (TI0FM001.TI0FW-OP-CUST-PO1 > " ")

      TI0F-21500();

      if (converseVar.validationMsgNum != 0) /* Normal return code*/
        exit stack; /* Exit to display map*/
      end

      TI0FW00.TI0FW-CU-STOR-ID-FL = "N";

      TI0FW00.TI0FW-XNX-DEPT-ID-XREF-FL = "N";

    else

      TI0F-21400();

      if (converseVar.validationMsgNum != 0) /* Normal return code*/
        exit stack; /* Exit to display map*/
      end

      TI0FW00.TI0FW-CU-STOR-ID-FL = "N";

      TI0FW00.TI0FW-XNX-DEPT-ID-XREF-FL = "N";

      if ((TI0FW00.XXX-INX-FLD-NBR > 1))

        TI0FS-TI0FW02-TA();

      end

      TI0FW00.XXX-RQT-DATA-FL = "N";

      if (TI0FW00.TI0FW-M002-HI-PAGE-NBR == 0)

        TIWREC.XXX-MSG-LOC-ID = "21000";
        converseLib.validationFailed(18);

        TI0FW00.XXX-MAP-DSP-CD = "1";

        exit stack;

      end

      return;

    end

  end

  if (TI0FM001.TI0FW-OP-CUST-PO1 > " ")

    if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y"
    )
      TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX = 1;
      TI0FW00.TI0FW-WORK-IDX = 1;

      while ((TI0FW-TI-CUTK-STAT-CD-IDX <= 1))

        if (TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX] > " ")

          TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX = 1;
          TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL = "N";

          while ((TI0FW-TI-CUTK-STAT-CD-SAVE-IDX <= 6
           && TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL != "Y"))

            if (TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX]
             == TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE[TI0FW-TI-CUTK-STAT-CD-SAVE-IDX]
            )
              TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL = "Y";

            end

            TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX = TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX + 1;

          end /* WHILE (TI0FW-TI-CUTK-STAT-CD-SAVE-IDX LE 6*/
                  /* AND TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL NE 'Y')*/

          if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL != "Y"
          )
            TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE[TI0FW-WORK-IDX] = TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];

            TI0FW00.TI0FW-WORK-IDX = TI0FW00.TI0FW-WORK-IDX + 1;

            TI0F-21700();

            if (converseVar.validationMsgNum != 0) /* Normal return code*/
              exit stack; /* Exit to display map*/
            end

          end

        end

        TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX = TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX + 1;

      end /* WHILE (TI0FW-TI-CUTK-STAT-CD-IDX GE 1)*/

    else

      TI0F-21700();

      if (converseVar.validationMsgNum != 0) /* Normal return code*/
        exit stack; /* Exit to display map*/
      end

    end

    TI0FW00.XXX-RQT-DATA-FL = "N";

    return;

  else

    if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

      TI0F-21A00(); /* SCAN-H*/

      if (converseVar.validationMsgNum != 0) /* Normal return code*/
        exit stack; /* Exit to display map*/
      end

      if ((TI0FW00.XXX-INX-FLD-NBR > 1))

        TI0FS-TI0FW02-TA();

      end

      if (TI0FW00.TI0FW-M002-HI-PAGE-NBR == 0)

        TIWREC.XXX-MSG-LOC-ID = "21000";
        converseLib.validationFailed(18);

        TI0FW00.XXX-MAP-DSP-CD = "1";

        exit stack;

      end

      TI0FW00.XXX-RQT-DATA-FL = "N";

      return;

    else

      TI0F-21800(); /* SCAN-F*/

      if (converseVar.validationMsgNum != 0) /* Normal return code*/
        exit stack; /* Exit to display map*/
      end

      if ((TI0FW00.XXX-INX-FLD-NBR > 1))

        TI0FS-TI0FW02-TA();

      end

      TI0FW00.XXX-RQT-DATA-FL = "N";

      if (TI0FW00.TI0FW-M002-HI-PAGE-NBR == 0)

        TIWREC.XXX-MSG-LOC-ID = "21000";
        converseLib.validationFailed(18);

        TI0FW00.XXX-MAP-DSP-CD = "1";

        exit stack;

      end

      return;

    end

  end
end // end TI0F-21000

// Obtain the data to display
Function TI0F-21100()
   /* ------------------------------------------------------------*/
   /* Setup and call the I/O routine to access ticket order header.*/
   /* ------------------------------------------------------------*/

  VTOHDR01.XGP-GPC-CD = TI0FW01.XGP-GPC-CD;

  VTOHDR01.CU-CO-ID = TI0FW01.CU-CO-ID;

  VTOHDR01.CU-STOR-ID = TI0FW00.TI0FW-CU-STOR-ID-WK-NUM;

  VTOHDR01.XNX-DEPT-ID-XREF = TI0FW00.TI0FW-XNX-DEPT-ID-WK-NUM;

  VTOHDR01.TI-CUTK-STAT-CD = "*";

  TI0FW00.TI0FW-HDR-FND-FL = "Y"; /* VTOHDR01 record found*/

  TI0FW00.TI0FW-TOHDR-EOF-FL = "N"; /* No VTOHDR01 record found*/

  TI0FS-VTOHDR01-S1(); /* Declare and open cursor*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

    TI0FW00.TI0FW-HDR-FND-FL = "N"; /* VTOHDR01 record found*/

    TIWREC.XXX-MSG-LOC-ID = "21100"; /* Message location*/
    converseLib.validationFailed(18); /* No data was found to display*/

    set TI0FM001.CU-CO-ID cursor, bold; /* Highlight*/

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

  TI0FW-RQT-FIRST-REC-FL = "N";

  TI0FW00.TI0FW-TOHDR-EOF-FL = "N"; /* No VTOHDR01 record found*/

  TI0FS-VTOHDR01-N1(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TOHDR-EOF-FL = "Y"; /* No VTOHDR01 record found*/

  else

    TI0FW-RQT-FIRST-REC-FL = "Y";

  end

  TI0FW00.TI0FW-TI0FW02-TA-COUNT = 1; /* Display line index*/

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  while ((TI0FW00.TI0FW-TOHDR-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW02-TA-COUNT <= 300)) /* No pages formatted*/

      /* ------------------------------------------------------------*/
      /* Build key for Sales Order Header, select DORDER.VITEM001 row*/
      /* ------------------------------------------------------------*/

    TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM = VTOHDR01.OP-CUST-ORD-ID;

    TI0FW00.TI0FW-OP-CUST-ORD-ID-LCHA = TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM;

    set OP1REC empty;

    OP1REC.OP1PARTN = TI0FW00.TI0FW-OP-ORD-PART-CHA;

    OP1REC.OP1CUOID = VTOHDR01.OP-CUST-ORD-ID;

    OP1REC.OP1NORID = VTOHDR01.OP-NIKE-ORD-ID;

    TI0FS-IO0430-S(); /* Select sales order header*/

    if (converseVar.validationMsgNum != 0)
      exit stack;
    end

      /* ------------------------------------------------------------*/
      /* Complete populating storage fields for screen M002*/
      /* ------------------------------------------------------------*/

    TI0FW00.TI0FW-DATE-NUM = OP1REC.OP1CUNDT;

    TI0FW00.TI0FW-DATE-WORK = TI0FW00.TI0FW-DATE-NUM;

    TI0FW00.TI0FW-DATE-DISP-MM = TI0FW00.TI0FW-DATE-WRK6-MM;

    TI0FW00.TI0FW-DATE-DISP-SLASH1 = "/";

    TI0FW00.TI0FW-DATE-DISP-DD = TI0FW00.TI0FW-DATE-WRK6-DD;

    TI0FW00.TI0FW-DATE-DISP-SLASH2 = "/";

    TI0FW00.TI0FW-DATE-DISP-YY = TI0FW00.TI0FW-DATE-WRK6-YY;

    /* ------------------------------------------------------------*/
    /* Select and open the cursor for the ticket request table.*/
    /* ------------------------------------------------------------*/

    set VTORQT01 empty; /* Clear row storage area*/

    VTORQT01.OP-CUST-ORD-ID = VTOHDR01.OP-CUST-ORD-ID;

    VTORQT01.OP-NIKE-ORD-ID = VTOHDR01.OP-NIKE-ORD-ID;

    TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

    TI0FS-VTORQT01-S1(); /* Declare and Open cursor*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

      TI0FW00.TI0FW-HDR-FND-FL = "N"; /* VTOHDR01 record found*/

      TIWREC.XXX-MSG-LOC-ID = "21100"; /* Message location*/
      converseLib.validationFailed(18); /* No data was found to display*/

      set TI0FM001.CU-CO-ID cursor, bold; /* Highlight*/

      exit stack; /* Exit to display map*/

    end

    /* ------------------------------------------------------------*/
    /* Set "not eof" condition, read next VTORQT01 row*/
    /* ------------------------------------------------------------*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

    TI0FS-VTORQT01-N1(); /* Select the table row*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

      TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

    else

      TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT + 1;

    end

    /* ------------------------------------------------------------*/
    /* For each VTORQT01 row*/
    /* ------------------------------------------------------------*/

    while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"))

      TI0F-21110();

    end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE 'Y');*/

    /* ------------------------------------------------------------*/
    /* Close the cursor for the selected set.*/
    /* ------------------------------------------------------------*/

    TI0FS-VTORQT01-C1(); /* Close selected set cursor*/

    TI0FS-VTOHDR01-N1(); /* Select the table row*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

      TI0FW00.TI0FW-TOHDR-EOF-FL = "Y"; /* No VTOHDR01 record found*/

    else

      TI0FW-RQT-FIRST-REC-FL = "Y";

    end
  end

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTOHDR01-C1(); /* Close selected set cursor*/

   /* ------------------------------------------------------------*/
   /* If no pages were formatted, indicate no data to display.*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.TI0FW-TI0FW02-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "21100"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

end // end TI0F-21100

// Obtain the data to display
Function TI0F-21110()
  TI0FW00.TI0FW-STYLE-COLR-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-NEED-DT-OK-FL = "Y";
  TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if ((TI0FM001.XHD-HNDL-CD != TI0FW01.XHD-HNDL-CD
   && TI0FM001.XHD-HNDL-CD > " "))

    TI0FS-HNDLCODE-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-FL == "Y")

    TI0FS-STYLCOLR-ED();

  end

  if (TI0FW00.TI0FW-CUST-NEED-DT-FROM-FL == "Y")

    TI0FS-NEEDDATE-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "N";

    TI0FS-STATCODE-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-NEED-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL == "Y")

    TI0FS-TORQTW02-MV();

    OP2REC.OP1CUOID = VTORQT01.OP-CUST-ORD-ID;

    OP2REC.OP1NORID = VTORQT01.OP-NIKE-ORD-ID;

    OP2REC.OP2LNINB = VTORQT01.OP-LINE-ITEM-NBR;

    TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM = VTORQT01.OP-CUST-ORD-ID;

    TI0FW00.TI0FW-OP-CUST-ORD-ID-LCHA = TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM;

    OP2REC.OP1PARTN = TI0FW00.TI0FW-OP-ORD-PART-CHA;
    TI0FS-IO0440-S();

    if (SQLCA.VAGen_SQLCODE == 0)

      if (OP2REC.OP2LNIST == "OP"
       || OP2REC.OP2LNIST == "PA"
       || OP2REC.OP2LNIST == "PR")

        TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = OP2REC.OP2TONOQ;

      end

      if (OP2REC.OP2LNIST == "AL")

        TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = OP2REC.OP2TALCQ;

      end

      if (OP2REC.OP2LNIST == "SH")

        TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = OP2REC.OP2TSHPQ;

      end

      if (OP2REC.OP2LNIST == "XL")

        TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = OP2REC.OP2TCNLQ;

      end

      if (OP2REC.OP2LNIST == "PS")

        TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = OP2REC.OP2TONOQ + OP2REC.OP2TALCQ;

      end

    end

  else
    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end

   /* ------------------------------------------------------------*/
   /* Select next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-N1(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* Bump map line index up by 1*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
   /* ------------------------------------------------------------*/
   /* If page is full, add page to the storage queue, set map line*/
   /* index to 1*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW02-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end
end // end TI0F-21110

// Obtain the data to display
Function TI0F-21200()
   /* ------------------------------------------------------------*/
   /* Setup and call the I/O routine to access ticket order header.*/
   /* ------------------------------------------------------------*/

  VTOHDR01.XGP-GPC-CD = TI0FW01.XGP-GPC-CD;
  VTOHDR01.CU-CO-ID = TI0FW01.CU-CO-ID;

  VTOHDR01.TI-CUTK-STAT-CD = "*";

  TI0FW00.TI0FW-HDR-FND-FL = "Y"; /* VTOHDR01 record found*/

  TI0FW00.TI0FW-TOHDR-EOF-FL = "N"; /* No VTOHDR01 record found*/

  TI0FS-VTOHDR01-S2(); /* Declare and open cursor*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

    TI0FW00.TI0FW-HDR-FND-FL = "N"; /* VTOHDR01 record found*/

    TIWREC.XXX-MSG-LOC-ID = "21200"; /* Message location*/
    converseLib.validationFailed(18); /* No data was found to display*/

    set TI0FM001.CU-CO-ID cursor, bold; /* Highlight*/

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

  TI0FW00.TI0FW-RQT-FIRST-REC-FL = "N";
  TI0FW00.TI0FW-TOHDR-EOF-FL = "N"; /* No VTOHDR01 record found*/

  TI0FS-VTOHDR01-N2(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TOHDR-EOF-FL = "Y"; /* No VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-RQT-FIRST-REC-FL = "N";
  end

  TI0FW00.TI0FW-TI0FW02-TA-COUNT = 0;

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  while ((TI0FW00.TI0FW-TOHDR-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW02-TA-COUNT <= 300))

    TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM = VTOHDR01.OP-CUST-ORD-ID;

    TI0FW00.TI0FW-OP-CUST-ORD-ID-LCHA = TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM;

    set OP1REC empty;

    OP1REC.OP1PARTN = TI0FW00.TI0FW-OP-ORD-PART-CHA;

    OP1REC.OP1CUOID = VTOHDR01.OP-CUST-ORD-ID;

    OP1REC.OP1NORID = VTOHDR01.OP-NIKE-ORD-ID;

    TI0FS-IO0430-S();

    if (converseVar.validationMsgNum != 0) /* Normal return code*/
      exit stack; /* Exit to display map*/
    end

    TI0FW00.TI0FW-DATE-NUM = OP1REC.OP1CUNDT;

    TI0FW00.TI0FW-DATE-WORK = TI0FW00.TI0FW-DATE-NUM;

    TI0FW00.TI0FW-DATE-DISP-MM = TI0FW00.TI0FW-DATE-WRK6-MM;

    TI0FW00.TI0FW-DATE-DISP-SLASH1 = "/";

    TI0FW00.TI0FW-DATE-DISP-DD = TI0FW00.TI0FW-DATE-WRK6-DD;

    TI0FW00.TI0FW-DATE-DISP-SLASH2 = "/";

    TI0FW00.TI0FW-DATE-DISP-YY = TI0FW00.TI0FW-DATE-WRK6-YY;

    /* ------------------------------------------------------------*/
    /* Select and open the cursor for the ticket request table.*/
    /* ------------------------------------------------------------*/

    set VTORQT01 empty; /* Clear row storage area*/

    VTORQT01.OP-CUST-ORD-ID = VTOHDR01.OP-CUST-ORD-ID;

    VTORQT01.OP-NIKE-ORD-ID = VTOHDR01.OP-NIKE-ORD-ID;

    TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

    TI0FS-VTORQT01-S1(); /* Declare and Open cursor*/

    if (converseVar.validationMsgNum != 0) /* Normal return code*/
      exit stack; /* Exit to display map*/
    end

    /* ------------------------------------------------------------*/
    /* Set "not eof" condition, read next VTORQT01 row*/
    /* ------------------------------------------------------------*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

    TI0FS-VTORQT01-N1(); /* Select the table row*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

      TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

    else

      TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT + 1;

      TI0FW00.TI0FW-RQT-FIRST-REC-FL = "Y";

    end

    /* ------------------------------------------------------------*/
    /* For each VTORQT01 row*/
    /* ------------------------------------------------------------*/

    while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"))

      TI0F-21210();

    end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE 'Y');*/


    /* ------------------------------------------------------------*/
    /* Close the cursor for the selected set.*/
    /* ------------------------------------------------------------*/

    TI0FS-VTORQT01-C1(); /* Close selected set cursor*/

    TI0FS-VTOHDR01-N2(); /* Select the table row*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

      TI0FW00.TI0FW-TOHDR-EOF-FL = "Y"; /* No VTOHDR01 record found*/

    else

      TI0FW00.TI0FW-RQT-FIRST-REC-FL = "Y";

    end
  end

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTOHDR01-C2(); /* Close selected set cursor*/

  if (TI0FW00.TI0FW-TI0FW02-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "21200"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-21200

// Obtain the data to display
Function TI0F-21210()
   /* ------------------------------------------------------------*/
   /* Populate the storage fields for screen M002*/
   /* ------------------------------------------------------------*/
  TI0FW00.TI0FW-STYLE-COLR-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-NEED-DT-OK-FL = "Y";
  TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if ((TI0FM001.XHD-HNDL-CD != TI0FW01.XHD-HNDL-CD
   && TI0FM001.XHD-HNDL-CD > " "))

    TI0FS-HNDLCODE-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-FL == "Y")

    TI0FS-STYLCOLR-ED();

  end

  if (TI0FW00.TI0FW-CUST-NEED-DT-FROM-FL == "Y")

    TI0FS-NEEDDATE-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "N";

    TI0FS-STATCODE-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-NEED-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL == "Y")

    TI0FS-TORQTW02-MV();

    set TIXREC empty;

    set SQLCA empty;

    set VTOITM01 empty;

    TI0FW00.TI0FW-TI9910-CALL-ACTION = "SS";

    TIXREC.TIX-GROUP = TI0FW00.TI0FW-TI9910-CALL-GROUP;

    VTOITM01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

    VTOITM01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

    VTOITM01.TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;

    TI0FS-TI9910-SS();

    TI0FW00.TI0FW-TI9910-CALL-GROUP = TIXREC.TIX-GROUP;

    if (SQLCA.VAGen_SQLCODE == -305)

      TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = 0;

    else

      TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = VTOITM01.TI-ON-ORD-QTY;

    end

  else
    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end

   /* ------------------------------------------------------------*/
   /* Select next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-N1(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* Bump map line index up by 1*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
   /* ------------------------------------------------------------*/
   /* If page is full, add page to the storage queue, set map line*/
   /* index to 1*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW02-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end

   /* END OF STATEMENT GROUP*/
end // end TI0F-21210

// Obtain the data to display
Function TI0F-21300()
   /* ------------------------------------------------------------*/
   /* Setup and call the I/O routine to access ticket order header.*/
   /* ------------------------------------------------------------*/

  VTOHDR01.XGP-GPC-CD = TI0FW01.XGP-GPC-CD;
  VTOHDR01.CU-CO-ID = TI0FW01.CU-CO-ID;
  VTOHDR01.OP-CUST-PO = TI0FW01.TI0FW-OP-CUST-PO1;

  VTOHDR01.TI-CUTK-STAT-CD = "*";

  TI0FW00.TI0FW-HDR-FND-FL = "Y"; /* VTOHDR01 record found*/

  TI0FW00.TI0FW-TOHDR-EOF-FL = "N"; /* No VTOHDR01 record found*/

  TI0FS-VTOHDR01-S3(); /* Declare and open cursor*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

    TI0FW00.TI0FW-HDR-FND-FL = "N"; /* VTOHDR01 record found*/

    TIWREC.XXX-MSG-LOC-ID = "21300"; /* Message location*/
    converseLib.validationFailed(18); /* No data was found to display*/

    TI0FW00.XXX-MAP-DSP-CD = "1";

    set TI0FM001.CU-CO-ID cursor, bold; /* Highlight*/

    exit stack; /* Exit to display map*/

  end

  TI0FS-VTOHDR01-N3(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TOHDR-EOF-FL = "Y"; /* No VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-RQT-FIRST-REC-FL = "N";

  end

  TI0FW00.TI0FW-TI0FW02-TA-COUNT = 0;

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  while ((TI0FW00.TI0FW-TOHDR-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW02-TA-COUNT <= 300))

    /* ------------------------------------------------------------*/
    /* Build key for Sales Order Header, select DORDER.VITEM001 row*/
    /* ------------------------------------------------------------*/

    TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM = VTOHDR01.OP-CUST-ORD-ID;

    TI0FW00.TI0FW-OP-CUST-ORD-ID-LCHA = TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM;

    set OP1REC empty;

    OP1REC.OP1PARTN = TI0FW00.TI0FW-OP-ORD-PART-CHA;

    OP1REC.OP1CUOID = VTOHDR01.OP-CUST-ORD-ID;

    OP1REC.OP1NORID = VTOHDR01.OP-NIKE-ORD-ID;

    TI0FS-IO0430-S();

    if (converseVar.validationMsgNum != 0) /* Normal return code*/
      exit stack; /* Exit to display map*/
    end

     /* ------------------------------------------------------------*/
     /* Complete populating storage fields for screen M002*/
     /* ------------------------------------------------------------*/

    TI0FW00.TI0FW-DATE-NUM = OP1REC.OP1CUNDT;

    TI0FW00.TI0FW-DATE-WORK = TI0FW00.TI0FW-DATE-NUM;

    TI0FW00.TI0FW-DATE-DISP-MM = TI0FW00.TI0FW-DATE-WRK6-MM;

    TI0FW00.TI0FW-DATE-DISP-SLASH1 = "/";

    TI0FW00.TI0FW-DATE-DISP-DD = TI0FW00.TI0FW-DATE-WRK6-DD;

    TI0FW00.TI0FW-DATE-DISP-SLASH2 = "/";

    TI0FW00.TI0FW-DATE-DISP-YY = TI0FW00.TI0FW-DATE-WRK6-YY;

    /* ------------------------------------------------------------*/
    /* Select and open the cursor for the ticket request table.*/
    /* ------------------------------------------------------------*/

    set VTORQT01 empty; /* Clear row storage area*/

    VTORQT01.OP-CUST-ORD-ID = VTOHDR01.OP-CUST-ORD-ID;

    VTORQT01.OP-NIKE-ORD-ID = VTOHDR01.OP-NIKE-ORD-ID;

    TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

    TI0FS-VTORQT01-S1(); /* Declare and Open cursor*/

    if (converseVar.validationMsgNum != 0) /* Normal return code*/
      exit stack; /* Exit to display map*/
    end

    /* ------------------------------------------------------------*/
    /* Set "not eof" condition, read next VTORQT01 row*/
    /* ------------------------------------------------------------*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

    TI0FS-VTORQT01-N1(); /* Select the table row*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

      TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

    else

      TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT + 1;

      TI0FW00.TI0FW-RQT-FIRST-REC-FL = "Y";

    end

    TI0FW00.TI0FW-RQT-FIRST-REC-FL = "Y";
    /* ------------------------------------------------------------*/
    /* For each VTORQT01 row*/
    /* ------------------------------------------------------------*/

    while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"))

      TI0F-21310();

    end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE 'Y');*/

    /* ------------------------------------------------------------*/
    /* Close the cursor for the selected set.*/
    /* ------------------------------------------------------------*/

    TI0FS-VTORQT01-C1(); /* Close selected set cursor*/

    TI0FS-VTOHDR01-N3(); /* Select the table row*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

      TI0FW00.TI0FW-TOHDR-EOF-FL = "Y"; /* No VTOHDR01 record found*/

    else

      TI0FW00.TI0FW-RQT-FIRST-REC-FL = "Y";

    end
  end

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTOHDR01-C3(); /* Close selected set cursor*/

  if (TI0FW00.TI0FW-TI0FW02-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "21300"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-21300

// Obtain the data to display
Function TI0F-21310()
  TI0FW00.TI0FW-STYLE-COLR-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-NEED-DT-OK-FL = "Y";
  TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if ((TI0FM001.XHD-HNDL-CD != TI0FW01.XHD-HNDL-CD
   && TI0FM001.XHD-HNDL-CD > " "))

    TI0FS-HNDLCODE-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-FL == "Y")

    TI0FS-STYLCOLR-ED();

  end

  if (TI0FW00.TI0FW-CUST-NEED-DT-FROM-FL == "Y")

    TI0FS-NEEDDATE-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "N";

    TI0FS-STATCODE-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-NEED-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL == "Y")

    TI0FS-TORQTW02-MV();

    set TIXREC empty;

    set SQLCA empty;

    set VTOITM01 empty;

    TI0FW00.TI0FW-TI9910-CALL-ACTION = "SS";

    TIXREC.TIX-GROUP = TI0FW00.TI0FW-TI9910-CALL-GROUP;

    VTOITM01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

    VTOITM01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

    VTOITM01.TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;

    TI0FS-TI9910-SS();

    TI0FW00.TI0FW-TI9910-CALL-GROUP = TIXREC.TIX-GROUP;

    if (SQLCA.VAGen_SQLCODE == -305)

      TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = 0;

    else

      TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = VTOITM01.TI-ON-ORD-QTY;

    end

  else
    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end

      /* ------------------------------------------------------------*/
      /* Select next VTORQT01 row*/
      /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-N1(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT + 1;

  end

      /* ------------------------------------------------------------*/
      /* Bump map line index up by 1*/
      /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
      /* ------------------------------------------------------------*/
      /* If page is full, add page to the storage queue, set map line*/
      /* index to 1*/
      /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW02-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end
end // end TI0F-21310

// Obtain the data to display
Function TI0F-21400()
   /* ------------------------------------------------------------*/
   /* Setup and call the I/O routine to access ticket order header.*/
   /* ------------------------------------------------------------*/

  VTOHDR01.XGP-GPC-CD = TI0FW01.XGP-GPC-CD;
  VTOHDR01.CU-CO-ID = TI0FW01.CU-CO-ID;

  if (TI0FW00.TI0FW-CU-STOR-ID-FL == "Y")

    VTOHDR01.CU-STOR-ID = TI0FW00.TI0FW-CU-STOR-ID-WK-NUM;

  else

    VTOHDR01.CU-STOR-ID = -1;

  end

  if (TI0FW00.TI0FW-XNX-DEPT-ID-XREF-FL == "Y")

    VTOHDR01.XNX-DEPT-ID-XREF = TI0FW00.TI0FW-XNX-DEPT-ID-WK-NUM;

  else

    VTOHDR01.XNX-DEPT-ID-XREF = -1;

  end

  VTOHDR01.TI-CUTK-STAT-CD = "*";

  TI0FW00.TI0FW-HDR-FND-FL = "Y"; /* VTOHDR01 record found*/

  TI0FW00.TI0FW-TOHDR-EOF-FL = "N"; /* No VTOHDR01 record found*/

  TI0FS-VTOHDR01-S4(); /* Declare and open cursor*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

    TI0FW00.TI0FW-HDR-FND-FL = "N"; /* VTOHDR01 record found*/

    TIWREC.XXX-MSG-LOC-ID = "21400"; /* Message location*/
    converseLib.validationFailed(18); /* No data was found to display*/
    set TI0FM001.CU-CO-ID cursor, bold; /* Highlight*/

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

  TI0FS-VTOHDR01-N4(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TOHDR-EOF-FL = "Y"; /* No VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-RQT-FIRST-REC-FL = "Y";

  end

  TI0FW00.TI0FW-TI0FW02-TA-COUNT = 0;

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  while ((TI0FW00.TI0FW-TOHDR-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW02-TA-COUNT <= 300))

      /* ------------------------------------------------------------*/
      /* Build key for Sales Order Header, select DORDER.VITEM001 row*/
      /* ------------------------------------------------------------*/

    TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM = VTOHDR01.OP-CUST-ORD-ID;

    TI0FW00.TI0FW-OP-CUST-ORD-ID-LCHA = TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM;

    set OP1REC empty;

    OP1REC.OP1PARTN = TI0FW00.TI0FW-OP-ORD-PART-CHA;

    OP1REC.OP1CUOID = VTOHDR01.OP-CUST-ORD-ID;

    OP1REC.OP1NORID = VTOHDR01.OP-NIKE-ORD-ID;

    TI0FS-IO0430-S(); /* Select sales order header*/

    if (converseVar.validationMsgNum != 0) /* Normal return code*/
      exit stack; /* Exit to display map*/
    end

      /* ------------------------------------------------------------*/
      /* Complete populating storage fields for screen M002*/
      /* ------------------------------------------------------------*/

    TI0FW00.TI0FW-DATE-NUM = OP1REC.OP1CUNDT;

    TI0FW00.TI0FW-DATE-WORK = TI0FW00.TI0FW-DATE-NUM;

    TI0FW00.TI0FW-DATE-DISP-MM = TI0FW00.TI0FW-DATE-WRK6-MM;

    TI0FW00.TI0FW-DATE-DISP-SLASH1 = "/";

    TI0FW00.TI0FW-DATE-DISP-DD = TI0FW00.TI0FW-DATE-WRK6-DD;

    TI0FW00.TI0FW-DATE-DISP-SLASH2 = "/";

    TI0FW00.TI0FW-DATE-DISP-YY = TI0FW00.TI0FW-DATE-WRK6-YY;

    /* ------------------------------------------------------------*/
    /* Select and open the cursor for the ticket request table.*/
    /* ------------------------------------------------------------*/

    set VTORQT01 empty; /* Clear row storage area*/

    VTORQT01.OP-CUST-ORD-ID = VTOHDR01.OP-CUST-ORD-ID;

    VTORQT01.OP-NIKE-ORD-ID = VTOHDR01.OP-NIKE-ORD-ID;

    TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

    TI0FS-VTORQT01-S1(); /* Declare and Open cursor*/

    if (converseVar.validationMsgNum != 0) /* Normal return code*/
      exit stack; /* Exit to display map*/
    end

    TI0FW00.TI0FW-RQT-FIRST-REC-FL = "Y";

    /* ------------------------------------------------------------*/
    /* Set "not eof" condition, read next VTORQT01 row*/
    /* ------------------------------------------------------------*/

    TI0FS-VTORQT01-N1(); /* Select the table row*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

      TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

    else

      TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT + 1;

    end


    /* ------------------------------------------------------------*/
    /* For each VTORQT01 row*/
    /* ------------------------------------------------------------*/

    while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"))

      TI0F-21410();

    end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE 'Y');*/

    /* ------------------------------------------------------------*/
    /* Close the cursor for the selected set.*/
    /* ------------------------------------------------------------*/

    TI0FS-VTORQT01-C1(); /* Close selected set cursor*/

    TI0FS-VTOHDR01-N4(); /* Select the table row*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

      TI0FW00.TI0FW-TOHDR-EOF-FL = "Y"; /* No VTOHDR01 record found*/

    else

      TI0FW00.TI0FW-RQT-FIRST-REC-FL = "N";

    end
  end

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTOHDR01-C4(); /* Close selected set cursor*/

  if (TI0FW00.TI0FW-TI0FW02-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "21400"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-21400

// Obtain the data to display
Function TI0F-21410()
  TI0FW00.TI0FW-STYLE-COLR-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-NEED-DT-OK-FL = "Y";
  TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if ((TI0FM001.XHD-HNDL-CD != TI0FW01.XHD-HNDL-CD
   && TI0FM001.XHD-HNDL-CD > " "))

    TI0FS-HNDLCODE-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-FL == "Y")

    TI0FS-STYLCOLR-ED();

  end

  if (TI0FW00.TI0FW-CUST-NEED-DT-FROM-FL == "Y")

    TI0FS-NEEDDATE-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "N";

    TI0FS-STATCODE-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-NEED-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL == "Y")

    TI0FS-TORQTW02-MV();

    set TIXREC empty;

    set SQLCA empty;

    set VTOITM01 empty;

    TI0FW00.TI0FW-TI9910-CALL-ACTION = "SS";

    TIXREC.TIX-GROUP = TI0FW00.TI0FW-TI9910-CALL-GROUP;

    VTOITM01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

    VTOITM01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

    VTOITM01.TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;

    TI0FS-TI9910-SS();

    TI0FW00.TI0FW-TI9910-CALL-GROUP = TIXREC.TIX-GROUP;

    if (SQLCA.VAGen_SQLCODE == -305)

      TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = 0;

    else

      TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = VTOITM01.TI-ON-ORD-QTY;

    end

  else
    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end

  TI0FS-VTORQT01-N1(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-RQT-FIRST-REC-FL = "Y";

    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT + 1;

  end

  TI0FW00.TI0FW-RQT-FIRST-REC-FL = "N";

   /* ------------------------------------------------------------*/
   /* Bump map line index up by 1*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
   /* ------------------------------------------------------------*/
   /* If page is full, add page to the storage queue, set map line*/
   /* index to 1*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW02-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end
end // end TI0F-21410

// Obtain the data to display
Function TI0F-21500()
   /* ------------------------------------------------------------*/
   /* Setup and call the I/O routine to access ticket order header.*/
   /* ------------------------------------------------------------*/

  VTOHDR01.CU-CO-ID = TI0FW01.CU-CO-ID;

  VTOHDR01.XGP-GPC-CD = TI0FW01.XGP-GPC-CD;

  VTOHDR01.OP-CUST-PO = TI0FW01.TI0FW-OP-CUST-PO1;

  if (TI0FW00.TI0FW-CU-STOR-ID-FL == "Y")

    VTOHDR01.CU-STOR-ID = TI0FW00.TI0FW-CU-STOR-ID-WK-NUM;

  else

    VTOHDR01.CU-STOR-ID = -1;

  end

  if (TI0FW00.TI0FW-XNX-DEPT-ID-XREF-FL == "Y")

    VTOHDR01.XNX-DEPT-ID-XREF = TI0FW00.TI0FW-XNX-DEPT-ID-WK-NUM;

  else

    VTOHDR01.XNX-DEPT-ID-XREF = -1;

  end

  VTOHDR01.TI-CUTK-STAT-CD = "*";

  TI0FW00.TI0FW-TOHDR-EOF-FL = "N"; /* No VTOHDR01 record found*/

  TI0FS-VTOHDR01-S5(); /* Declare and open cursor*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

    TIWREC.XXX-MSG-LOC-ID = "21500"; /* Message location*/
    converseLib.validationFailed(18); /* No data was found to display*/
    set TI0FM001.CU-CO-ID cursor, bold; /* Highlight*/

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

  TI0FW00.TI0FW-TOHDR-EOF-FL = "N";

  TI0FS-VTOHDR01-N5(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TOHDR-EOF-FL = "Y"; /* No VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-RQT-FIRST-REC-FL = "N";

  end

  TI0FW00.TI0FW-TI0FW02-TA-COUNT = 0;

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  while ((TI0FW00.TI0FW-TOHDR-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW02-TA-COUNT <= 300))

    /* ------------------------------------------------------------*/
    /* Build key for Sales Order Header, select DORDER.VITEM001 row*/
    /* ------------------------------------------------------------*/

    TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM = VTOHDR01.OP-CUST-ORD-ID;

    TI0FW00.TI0FW-OP-CUST-ORD-ID-LCHA = TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM;

    set OP1REC empty;

    OP1REC.OP1PARTN = TI0FW00.TI0FW-OP-ORD-PART-CHA;

    OP1REC.OP1CUOID = VTOHDR01.OP-CUST-ORD-ID;

    OP1REC.OP1NORID = VTOHDR01.OP-NIKE-ORD-ID;

    TI0FS-IO0430-S(); /* Select sales order header*/

    if (converseVar.validationMsgNum != 0) /* Normal return code*/
      exit stack; /* Exit to display map*/
    end

    /* ------------------------------------------------------------*/
    /* Complete populating storage fields for screen M002*/
    /* ------------------------------------------------------------*/

    TI0FW00.TI0FW-DATE-NUM = OP1REC.OP1CUNDT;

    TI0FW00.TI0FW-DATE-WORK = TI0FW00.TI0FW-DATE-NUM;

    TI0FW00.TI0FW-DATE-DISP-MM = TI0FW00.TI0FW-DATE-WRK6-MM;

    TI0FW00.TI0FW-DATE-DISP-SLASH1 = "/";

    TI0FW00.TI0FW-DATE-DISP-DD = TI0FW00.TI0FW-DATE-WRK6-DD;

    TI0FW00.TI0FW-DATE-DISP-SLASH2 = "/";

    TI0FW00.TI0FW-DATE-DISP-YY = TI0FW00.TI0FW-DATE-WRK6-YY;

    /* ------------------------------------------------------------*/
    /* Select and open the cursor for the ticket request table.*/
    /* ------------------------------------------------------------*/

    set VTORQT01 empty; /* Clear row storage area*/

    VTORQT01.OP-CUST-ORD-ID = VTOHDR01.OP-CUST-ORD-ID;

    VTORQT01.OP-NIKE-ORD-ID = VTOHDR01.OP-NIKE-ORD-ID;

    TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

    TI0FS-VTORQT01-S1(); /* Declare and Open cursor*/

    if (converseVar.validationMsgNum != 0) /* Normal return code*/
      exit stack; /* Exit to display map*/
    end

    /* ------------------------------------------------------------*/
    /* Set "not eof" condition, read next VTORQT01 row*/
    /* ------------------------------------------------------------*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

    TI0FS-VTORQT01-N1(); /* Select the table row*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

      TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

    else

      TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT + 1;

    end

    TI0FW00.TI0FW-RQT-FIRST-REC-FL = "Y";

    /* ------------------------------------------------------------*/
    /* For each VTORQT01 row*/
    /* ------------------------------------------------------------*/

    while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"))

      TI0F-21510();

    end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE 'Y');*/

    /* ------------------------------------------------------------*/
    /* Close the cursor for the selected set.*/
    /* ------------------------------------------------------------*/

    TI0FS-VTORQT01-C1(); /* Close selected set cursor*/

    TI0FS-VTOHDR01-N5(); /* Select the table row*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

      TI0FW00.TI0FW-TOHDR-EOF-FL = "Y"; /* No VTOHDR01 record found*/

    else

      TI0FW00.TI0FW-RQT-FIRST-REC-FL = "Y";

    end
  end

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTOHDR01-C5(); /* Close selected set cursor*/

  if (TI0FW00.TI0FW-TI0FW02-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "21500"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-21500

// Obtain the data to display
Function TI0F-21510()
  TI0FW00.TI0FW-STYLE-COLR-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-NEED-DT-OK-FL = "Y";
  TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if ((TI0FM001.XHD-HNDL-CD != TI0FW01.XHD-HNDL-CD
   && TI0FM001.XHD-HNDL-CD > " "))

    TI0FS-HNDLCODE-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-FL == "Y")

    TI0FS-STYLCOLR-ED();

  end

  if (TI0FW00.TI0FW-CUST-NEED-DT-FROM-FL == "Y")

    TI0FS-NEEDDATE-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "N";

    TI0FS-STATCODE-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-NEED-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL == "Y")

    TI0FS-TORQTW02-MV();

    set TIXREC empty;

    set SQLCA empty;

    set VTOITM01 empty;

    TI0FW00.TI0FW-TI9910-CALL-ACTION = "SS";

    TIXREC.TIX-GROUP = TI0FW00.TI0FW-TI9910-CALL-GROUP;

    VTOITM01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

    VTOITM01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

    VTOITM01.TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;

    TI0FS-TI9910-SS();

    TI0FW00.TI0FW-TI9910-CALL-GROUP = TIXREC.TIX-GROUP;

    if (SQLCA.VAGen_SQLCODE == -305)

      TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = 0;

    else

      TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = VTOITM01.TI-ON-ORD-QTY;

    end

  else
    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end
   /* ------------------------------------------------------------*/
   /* Select next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-N1(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* Bump map line index up by 1*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
   /* ------------------------------------------------------------*/
   /* If page is full, add page to the storage queue, set map line*/
   /* index to 1*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW02-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end
end // end TI0F-21510

// Obtain the data to display
Function TI0F-21600()
  set VTOHDR01 empty;
  VTOHDR01.XGP-GPC-CD = TI0FW01.XGP-GPC-CD;
  VTOHDR01.OP-CUST-ORD-ID = TI0FW01.OP-CUST-ORD-ID;
  VTOHDR01.OP-NIKE-ORD-ID = TI0FW01.OP-NIKE-ORD-ID;

  TI0FS-VTOHDR01-S(); /* Declare and open cursor*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

    TIWREC.XXX-MSG-LOC-ID = "21600"; /* Message location*/
    converseLib.validationFailed(18); /* No data was found to display*/

    set TI0FM001.OP-NIKE-ORD-ID bold; /* Highlight*/
    set TI0FM001.OP-CUST-ORD-ID cursor, bold; /* Highlight*/

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Build key for Sales Order Header, select DORDER.VITEM001 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM = VTOHDR01.OP-CUST-ORD-ID;

  TI0FW00.TI0FW-OP-CUST-ORD-ID-LCHA = TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM;

  set OP1REC empty;

  OP1REC.OP1PARTN = TI0FW00.TI0FW-OP-ORD-PART-CHA;

  OP1REC.OP1CUOID = VTOHDR01.OP-CUST-ORD-ID;

  OP1REC.OP1NORID = VTOHDR01.OP-NIKE-ORD-ID;

  TI0FS-IO0430-S(); /* Select sales order header*/

  if (converseVar.validationMsgNum != 0) /* Normal return code*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* Complete populating storage fields for screen M002*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-DATE-NUM = OP1REC.OP1CUNDT;

  TI0FW00.TI0FW-DATE-WORK = TI0FW00.TI0FW-DATE-NUM;

  TI0FW00.TI0FW-DATE-DISP-MM = TI0FW00.TI0FW-DATE-WRK6-MM;

  TI0FW00.TI0FW-DATE-DISP-SLASH1 = "/";

  TI0FW00.TI0FW-DATE-DISP-DD = TI0FW00.TI0FW-DATE-WRK6-DD;

  TI0FW00.TI0FW-DATE-DISP-SLASH2 = "/";

  TI0FW00.TI0FW-DATE-DISP-YY = TI0FW00.TI0FW-DATE-WRK6-YY;

  TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

   /* ------------------------------------------------------------*/
   /* Select and open the cursor for the ticket request table.*/
   /* ------------------------------------------------------------*/

  set VTORQT01 empty; /* Clear row storage area*/

  VTORQT01.OP-CUST-ORD-ID = VTOHDR01.OP-CUST-ORD-ID;

  VTORQT01.OP-NIKE-ORD-ID = VTOHDR01.OP-NIKE-ORD-ID;

  TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

  TI0FS-VTORQT01-S1(); /* Declare and Open cursor*/

  if (converseVar.validationMsgNum != 0) /* Normal return code*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* Set "not eof" condition, read next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-TI0FW02-TA-COUNT = 0;

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  TI0FS-VTORQT01-N1(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT + 1;

  end


   /* ------------------------------------------------------------*/
   /* For each VTORQT01 row*/
   /* ------------------------------------------------------------*/

  while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW02-TA-COUNT <= 300))

    TI0F-21610();

  end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE 'Y');*/

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-C1(); /* Close selected set cursor*/

   /* ------------------------------------------------------------*/
   /* Add any partially formatted last page to the queue.*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > 1) /* Page was formatted*/
    TI0FS-TI0FW02-TA(); /* Add page to temporary storage*/
  end

  if (TI0FW00.TI0FW-TI0FW02-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "21600"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-21600

// Obtain the data to display
Function TI0F-21610()
  TI0FW00.TI0FW-STYLE-COLR-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-NEED-DT-OK-FL = "Y";
  TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if ((TI0FM001.XHD-HNDL-CD != TI0FW01.XHD-HNDL-CD
   && TI0FM001.XHD-HNDL-CD > " "))

    TI0FS-HNDLCODE-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-FL == "Y")

    TI0FS-STYLCOLR-ED();

  end

  if (TI0FW00.TI0FW-CUST-NEED-DT-FROM-FL == "Y")

    TI0FS-NEEDDATE-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "N";

    TI0FS-STATCODE-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-NEED-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL == "Y")

    TI0FS-TORQTW02-MV();

    set TIXREC empty;

    set SQLCA empty;

    set VTOITM01 empty;

    TI0FW00.TI0FW-TI9910-CALL-ACTION = "SS";

    TIXREC.TIX-GROUP = TI0FW00.TI0FW-TI9910-CALL-GROUP;

    VTOITM01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

    VTOITM01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

    VTOITM01.TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;

    TI0FS-TI9910-SS();

    TI0FW00.TI0FW-TI9910-CALL-GROUP = TIXREC.TIX-GROUP;

    if (SQLCA.VAGen_SQLCODE == -305)

      TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = 0;

    else

      TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = VTOITM01.TI-ON-ORD-QTY;

    end

  else
    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end

   /* ------------------------------------------------------------*/
   /* Select next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-N1(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* Bump map line index up by 1*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
   /* ------------------------------------------------------------*/
   /* If page is full, add page to the storage queue, set map line*/
   /* index to 1*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW02-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end
end // end TI0F-21610

// Obtain the data to display
Function TI0F-21700()
   /* ------------------------------------------------------------*/
   /* Select and open the cursor for the ticket request table.*/
   /* ------------------------------------------------------------*/

  set VTORQT01 empty; /* Clear row storage area*/

  VTORQT01.XGP-GPC-CD = TI0FM001.XGP-GPC-CD;

  VTORQT01.SY-STY-NBR = TI0FM001.TI0FW-SY-STY-CD1;

  VTORQT01.SY-COLR-CD-ID = TI0FM001.TI0FW-SY-COLR-CD-ID1;

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    VTORQT01.TI-CUTK-STAT-CD = TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];

  else

    VTORQT01.TI-CUTK-STAT-CD = "*";

  end

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    VTORQT01.TI-CUTK-SEND-CD = TI0FW00.TI-CUTK-SEND-CD;

  else

    VTORQT01.TI-CUTK-SEND-CD = "*";

  end

  if (TI0FM001.TI-CUTK-SPLR-CD > " ")

    VTORQT01.TI-CUTK-SPLR-CD = TI0FM001.TI-CUTK-SPLR-CD;

  else

    VTORQT01.TI-CUTK-SPLR-CD = "*";

  end

  if (TI0FM001.TI-CUTK-XMIT-CD > " ")

    VTORQT01.TI-CUTK-XMIT-CD = TI0FM001.TI-CUTK-XMIT-CD;

  else

    VTORQT01.TI-CUTK-XMIT-CD = "*";

  end

  VTORQT01.PC-PO-ID-MO-RNG = -1;

  VTORQT01.PC-PO-NBR = -1;

  VTORQT01.FY-FCTY-CD = "*";

  VTORQT01.XCT-CTRY-CD = "*";

  VTORQT01.PC-PRDCU-ID = "*";

  TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTORQT01 record found*/

  TI0FS-VTORQT01-SG(); /* Declare and Open cursor*/

  if (converseVar.validationMsgNum != 0) /* Normal return code*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* Set "not eof" condition, read next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-TI0FW02-TA-COUNT = 0;

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  TI0FS-VTORQT01-NG(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* For each VTORQT01 row*/
   /* ------------------------------------------------------------*/

  while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW02-TA-COUNT <= 300))

    /* ------------------------------------------------------------*/
    /* Setup and call the I/O routine to access ticket order header.*/
    /* ------------------------------------------------------------*/


    TI0FW00.TI0FW-RQT-FIRST-REC-FL = "Y";
    VTOHDR01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

    VTOHDR01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

    TI0FS-VTOHDR01-S(); /* Declare and open cursor*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

      TI0FW00.TI0FW-HDR-FND-FL = "N"; /* VTOHDR01 record found*/

    else

      TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM = VTOHDR01.OP-CUST-ORD-ID;

      TI0FW00.TI0FW-OP-CUST-ORD-ID-LCHA = TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM;

      set OP1REC empty;

      OP1REC.OP1PARTN = TI0FW00.TI0FW-OP-ORD-PART-CHA;

      OP1REC.OP1CUOID = VTOHDR01.OP-CUST-ORD-ID;

      OP1REC.OP1NORID = VTOHDR01.OP-NIKE-ORD-ID;

      TI0FS-IO0430-S();

      if (converseVar.validationMsgNum != 0)
        exit stack;
      end

      TI0FW00.TI0FW-DATE-NUM = OP1REC.OP1CUNDT;

      TI0FW00.TI0FW-DATE-WORK = TI0FW00.TI0FW-DATE-NUM;

      TI0FW00.TI0FW-DATE-DISP-MM = TI0FW00.TI0FW-DATE-WRK6-MM;

      TI0FW00.TI0FW-DATE-DISP-SLASH1 = "/";

      TI0FW00.TI0FW-DATE-DISP-DD = TI0FW00.TI0FW-DATE-WRK6-DD;

      TI0FW00.TI0FW-DATE-DISP-SLASH2 = "/";

      TI0FW00.TI0FW-DATE-DISP-YY = TI0FW00.TI0FW-DATE-WRK6-YY;

    end

    TI0F-21710();

  end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE 'Y');*/

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-CG(); /* Close selected set cursor*/

  if (TI0FW00.TI0FW-TI0FW02-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "21700"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-21700

// Obtain the data to display
Function TI0F-21710()
  TI0FW00.TI0FW-STYLE-COLR-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-NEED-DT-OK-FL = "Y";
  TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "Y";

  if ((TI0FM001.XHD-HNDL-CD != TI0FW01.XHD-HNDL-CD
   && TI0FM001.XHD-HNDL-CD > " "))

    TI0FS-HNDLCODE-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-FL == "Y")

    TI0FS-STYLCOLR-ED();

  end

  if (TI0FW00.TI0FW-CUST-NEED-DT-FROM-FL == "Y")

    TI0FS-NEEDDATE-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-NEED-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y")

    TI0FS-TORQTW02-MV();

    set TIXREC empty;

    set SQLCA empty;

    set VTOITM01 empty;

    TI0FW00.TI0FW-TI9910-CALL-ACTION = "SS";

    TIXREC.TIX-GROUP = TI0FW00.TI0FW-TI9910-CALL-GROUP;

    VTOITM01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

    VTOITM01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

    VTOITM01.TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;

    TI0FS-TI9910-SS();

    TI0FW00.TI0FW-TI9910-CALL-GROUP = TIXREC.TIX-GROUP;

    if (SQLCA.VAGen_SQLCODE == -305)

      TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = 0;

    else

      TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = VTOITM01.TI-ON-ORD-QTY;

    end

  else
    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end

   /* ------------------------------------------------------------*/
   /* Select next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-NG(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* Bump map line index up by 1*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
   /* ------------------------------------------------------------*/
   /* If page is full, add page to the storage queue, set map line*/
   /* index to 1*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW02-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end

   /* END OF STATEMENT GROUP*/
end // end TI0F-21710

// Obtain the data to display
Function TI0F-21800()
   /* ------------------------------------------------------------*/
   /* Select and open the cursor for the ticket request table.*/
   /* ------------------------------------------------------------*/

  set VTORQT01 empty; /* Clear row storage area*/

  VTORQT01.XGP-GPC-CD = TI0FM001.XGP-GPC-CD;

  VTORQT01.SY-STY-NBR = TI0FM001.TI0FW-SY-STY-CD1;

  VTORQT01.SY-COLR-CD-ID = TI0FM001.TI0FW-SY-COLR-CD-ID1;

  TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

  TI0FS-VTORQT01-SF(); /* Declare and Open cursor*/

  if (converseVar.validationMsgNum != 0) /* Normal return code*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* Set "not eof" condition, read next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-TI0FW02-TA-COUNT = 0;

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  TI0FS-VTORQT01-NF(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* For each VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW02-TA-COUNT <= 300))

    /* ------------------------------------------------------------*/
    /* Setup and call the I/O routine to access ticket order header.*/
    /* ------------------------------------------------------------*/


    TI0FW00.TI0FW-RQT-FIRST-REC-FL = "Y";
    VTOHDR01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

    VTOHDR01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

    TI0FS-VTOHDR01-S(); /* Declare and open cursor*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

      TI0FW00.TI0FW-HDR-FND-FL = "N"; /* VTOHDR01 record found*/

    else

      TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM = VTOHDR01.OP-CUST-ORD-ID;

      TI0FW00.TI0FW-OP-CUST-ORD-ID-LCHA = TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM;

      set OP1REC empty;

      OP1REC.OP1PARTN = TI0FW00.TI0FW-OP-ORD-PART-CHA;

      OP1REC.OP1CUOID = VTOHDR01.OP-CUST-ORD-ID;

      OP1REC.OP1NORID = VTOHDR01.OP-NIKE-ORD-ID;

      TI0FS-IO0430-S();

      if (converseVar.validationMsgNum != 0)
        exit stack;
      end

      TI0FW00.TI0FW-DATE-NUM = OP1REC.OP1CUNDT;

      TI0FW00.TI0FW-DATE-WORK = TI0FW00.TI0FW-DATE-NUM;

      TI0FW00.TI0FW-DATE-DISP-MM = TI0FW00.TI0FW-DATE-WRK6-MM;

      TI0FW00.TI0FW-DATE-DISP-SLASH1 = "/";

      TI0FW00.TI0FW-DATE-DISP-DD = TI0FW00.TI0FW-DATE-WRK6-DD;

      TI0FW00.TI0FW-DATE-DISP-SLASH2 = "/";

      TI0FW00.TI0FW-DATE-DISP-YY = TI0FW00.TI0FW-DATE-WRK6-YY;

    end

    TI0F-21810();

  end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE 'Y');*/

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-CF(); /* Close selected set cursor*/

  if (TI0FW00.TI0FW-TI0FW02-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "21800"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-21800

// Obtain the data to display
Function TI0F-21810()
  TI0FW00.TI0FW-STYLE-COLR-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-NEED-DT-OK-FL = "Y";
  TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-FL == "Y")

    TI0FS-STYLCOLR-ED();

  end

  if (TI0FW00.TI0FW-CUST-NEED-DT-FROM-FL == "Y")

    TI0FS-NEEDDATE-ED();

  end

  if (TI0FM001.XHD-HNDL-CD != TI0FW01.XHD-HNDL-CD
   || TI0FM001.XHD-HNDL-CD > " ")

    TI0FS-HNDLCODE-ED();

  end

  if (TI0FW00.TI0FW-OP-CUST-PO-FL == "Y")

    TI0FS-CUSTPO-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "N";

    TI0FS-STATCODE-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-NEED-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL == "Y")

    TI0FS-TORQTW02-MV();

    set TIXREC empty;

    set SQLCA empty;

    set VTOITM01 empty;

    TI0FW00.TI0FW-TI9910-CALL-ACTION = "SS";

    TIXREC.TIX-GROUP = TI0FW00.TI0FW-TI9910-CALL-GROUP;

    VTOITM01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

    VTOITM01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

    VTOITM01.TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;

    TI0FS-TI9910-SS();

    TI0FW00.TI0FW-TI9910-CALL-GROUP = TIXREC.TIX-GROUP;

    if (SQLCA.VAGen_SQLCODE == -305)

      TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = 0;

    else

      TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = VTOITM01.TI-ON-ORD-QTY;

    end

  else
    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end

   /* ------------------------------------------------------------*/
   /* Select next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-NF(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* Bump map line index up by 1*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
   /* ------------------------------------------------------------*/
   /* If page is full, add page to the storage queue, set map line*/
   /* index to 1*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW02-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end

   /* END OF STATEMENT GROUP*/
end // end TI0F-21810

// Obtain the data to display
Function TI0F-21900()
   /* ------------------------------------------------------------*/
   /* Setup and call the I/O routine to access ticket order header.*/
   /* ------------------------------------------------------------*/

  set VTOHDR01 empty;

  VTOHDR01.XGP-GPC-CD = TI0FW01.XGP-GPC-CD;

  VTOHDR01.OP-CUST-ORD-ID = TI0FW01.OP-CUST-ORD-ID;

  TI0FW00.TI0FW-HDR-FND-FL = "Y"; /* VTOHDR01 record found*/

  TI0FW00.TI0FW-TOHDR-EOF-FL = "N"; /* No VTOHDR01 record found*/

  TI0FS-VTOHDR01-S6(); /* Declare and open cursor*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

    TI0FW00.TI0FW-HDR-FND-FL = "N"; /* VTOHDR01 record found*/

    TIWREC.XXX-MSG-LOC-ID = "21900"; /* Message location*/
    converseLib.validationFailed(18); /* No data was found to display*/

    set TI0FM001.OP-CUST-ORD-ID cursor, bold; /* Highlight*/

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

  TI0FW00.TI0FW-RQT-FIRST-REC-FL = "N";
  TI0FW00.TI0FW-TOHDR-EOF-FL = "N"; /* No VTOHDR01 record found*/

  TI0FS-VTOHDR01-N6(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TOHDR-EOF-FL = "Y"; /* No VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-RQT-FIRST-REC-FL = "N";
  end

  TI0FW00.TI0FW-TI0FW02-TA-COUNT = 0;

  TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  while ((TI0FW00.TI0FW-TOHDR-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW02-TA-COUNT <= 300))

    TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM = VTOHDR01.OP-CUST-ORD-ID;

    TI0FW00.TI0FW-OP-CUST-ORD-ID-LCHA = TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM;

    set OP1REC empty;

    OP1REC.OP1PARTN = TI0FW00.TI0FW-OP-ORD-PART-CHA;

    OP1REC.OP1CUOID = VTOHDR01.OP-CUST-ORD-ID;

    OP1REC.OP1NORID = VTOHDR01.OP-NIKE-ORD-ID;

    TI0FS-IO0430-S();

    if (converseVar.validationMsgNum != 0) /* Normal return code*/
      exit stack; /* Exit to display map*/
    end

    TI0FW00.TI0FW-DATE-NUM = OP1REC.OP1CUNDT;

    TI0FW00.TI0FW-DATE-WORK = TI0FW00.TI0FW-DATE-NUM;

    TI0FW00.TI0FW-DATE-DISP-MM = TI0FW00.TI0FW-DATE-WRK6-MM;

    TI0FW00.TI0FW-DATE-DISP-SLASH1 = "/";

    TI0FW00.TI0FW-DATE-DISP-DD = TI0FW00.TI0FW-DATE-WRK6-DD;

    TI0FW00.TI0FW-DATE-DISP-SLASH2 = "/";

    TI0FW00.TI0FW-DATE-DISP-YY = TI0FW00.TI0FW-DATE-WRK6-YY;

    /* ------------------------------------------------------------*/
    /* Select and open the cursor for the ticket request table.*/
    /* ------------------------------------------------------------*/

    set VTORQT01 empty; /* Clear row storage area*/

    VTORQT01.OP-CUST-ORD-ID = VTOHDR01.OP-CUST-ORD-ID;

    VTORQT01.OP-NIKE-ORD-ID = VTOHDR01.OP-NIKE-ORD-ID;

    TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

    TI0FS-VTORQT01-S1(); /* Declare and Open cursor*/

    if (converseVar.validationMsgNum != 0) /* Normal return code*/
      exit stack; /* Exit to display map*/
    end

    /* ------------------------------------------------------------*/
    /* Set "not eof" condition, read next VTORQT01 row*/
    /* ------------------------------------------------------------*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

    TI0FS-VTORQT01-N1(); /* Select the table row*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

      TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

    else

      TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT + 1;

      TI0FW00.TI0FW-RQT-FIRST-REC-FL = "Y";

    end

    /* ------------------------------------------------------------*/
    /* For each VTORQT01 row*/
    /* ------------------------------------------------------------*/

    while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"))

      TI0F-21910();

    end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE 'Y');*/

    /* ------------------------------------------------------------*/
    /* Close the cursor for the selected set.*/
    /* ------------------------------------------------------------*/

    TI0FS-VTORQT01-C1(); /* Close selected set cursor*/

    TI0FS-VTOHDR01-N6(); /* Select the table row*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

      TI0FW00.TI0FW-TOHDR-EOF-FL = "Y"; /* No VTOHDR01 record found*/

    else

      TI0FW00.TI0FW-RQT-FIRST-REC-FL = "Y";

    end
  end


   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTOHDR01-C6(); /* Close selected set cursor*/
   /* ------------------------------------------------------------*/
   /* Add any partially formatted last page to the queue.*/
   /* ------------------------------------------------------------*/

  if ((TI0FW00.XXX-INX-FLD-NBR > 1))

    TI0FS-TI0FW02-TA(); /* Add page to temporary storage*/

  end

  if (TI0FW00.TI0FW-TI0FW02-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "21900"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-21900

// Obtain the data to display
Function TI0F-21910()
  TI0FW00.TI0FW-STYLE-COLR-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-NEED-DT-OK-FL = "Y";
  TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if ((TI0FM001.XHD-HNDL-CD != TI0FW01.XHD-HNDL-CD
   && TI0FM001.XHD-HNDL-CD > " "))

    TI0FS-HNDLCODE-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-FL == "Y")

    TI0FS-STYLCOLR-ED();

  end

  if (TI0FW00.TI0FW-CUST-NEED-DT-FROM-FL == "Y")

    TI0FS-NEEDDATE-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "N";

    TI0FS-STATCODE-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-NEED-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL == "Y")

    TI0FS-TORQTW02-MV();

    set TIXREC empty;

    set SQLCA empty;

    set VTOITM01 empty;

    TI0FW00.TI0FW-TI9910-CALL-ACTION = "SS";

    TIXREC.TIX-GROUP = TI0FW00.TI0FW-TI9910-CALL-GROUP;

    VTOITM01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

    VTOITM01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

    VTOITM01.TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;

    TI0FS-TI9910-SS();

    TI0FW00.TI0FW-TI9910-CALL-GROUP = TIXREC.TIX-GROUP;

    if (SQLCA.VAGen_SQLCODE == -305)

      TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = 0;

    else

      TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = VTOITM01.TI-ON-ORD-QTY;

    end

  else
    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end

   /* ------------------------------------------------------------*/
   /* Select next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-N1(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* Bump map line index up by 1*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
   /* ------------------------------------------------------------*/
   /* If page is full, add page to the storage queue, set map line*/
   /* index to 1*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW02-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end

   /* END OF STATEMENT GROUP*/
end // end TI0F-21910

// Obtain the data to display
Function TI0F-21A00()
  set VTORQT01 empty; /* Clear row storage area*/

  VTORQT01.XGP-GPC-CD = TI0FM001.XGP-GPC-CD;

  VTORQT01.TI-CUTK-SEND-CD = TI0FM001.TI0FW-TI-CUTK-SEND-CD1;

  TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

  TI0FS-VTORQT01-SH(); /* Declare and Open cursor*/

  if (converseVar.validationMsgNum != 0) /* Normal return code*/
    exit stack; /* Exit to display map*/
  end

  TI0FW00.TI0FW-TI0FW02-TA-COUNT = 0;

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  TI0FS-VTORQT01-NH(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* For each VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW02-TA-COUNT <= 300))

    /* ------------------------------------------------------------*/
    /* Setup and call the I/O routine to access ticket order header.*/
    /* ------------------------------------------------------------*/


    TI0FW00.TI0FW-RQT-FIRST-REC-FL = "Y";
    VTOHDR01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

    VTOHDR01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

    TI0FS-VTOHDR01-S(); /* Declare and open cursor*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

      TI0FW00.TI0FW-HDR-FND-FL = "N"; /* VTOHDR01 record found*/

    else

      TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM = VTOHDR01.OP-CUST-ORD-ID;

      TI0FW00.TI0FW-OP-CUST-ORD-ID-LCHA = TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM;

      set OP1REC empty;

      OP1REC.OP1PARTN = TI0FW00.TI0FW-OP-ORD-PART-CHA;

      OP1REC.OP1CUOID = VTOHDR01.OP-CUST-ORD-ID;

      OP1REC.OP1NORID = VTOHDR01.OP-NIKE-ORD-ID;

      TI0FS-IO0430-S();

      if (converseVar.validationMsgNum != 0)
        exit stack;
      end

      TI0FW00.TI0FW-DATE-NUM = OP1REC.OP1CUNDT;

      TI0FW00.TI0FW-DATE-WORK = TI0FW00.TI0FW-DATE-NUM;

      TI0FW00.TI0FW-DATE-DISP-MM = TI0FW00.TI0FW-DATE-WRK6-MM;

      TI0FW00.TI0FW-DATE-DISP-SLASH1 = "/";

      TI0FW00.TI0FW-DATE-DISP-DD = TI0FW00.TI0FW-DATE-WRK6-DD;

      TI0FW00.TI0FW-DATE-DISP-SLASH2 = "/";

      TI0FW00.TI0FW-DATE-DISP-YY = TI0FW00.TI0FW-DATE-WRK6-YY;

    end

    TI0F-21A10();

  end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE 'Y');*/

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-CH(); /* Close selected set cursor*/

  if (TI0FW00.TI0FW-TI0FW02-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "21A00"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-21A00

// Obtain the data to display
Function TI0F-21A10()
  TI0FW00.TI0FW-STYLE-COLR-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-NEED-DT-OK-FL = "Y";
  TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-FL == "Y")

    TI0FS-STYLCOLR-ED();

  end

  if (TI0FW00.TI0FW-CUST-NEED-DT-FROM-FL == "Y")

    TI0FS-NEEDDATE-ED();

  end

  if (TI0FM001.XHD-HNDL-CD != TI0FW01.XHD-HNDL-CD
   || TI0FM001.XHD-HNDL-CD > " ")

    TI0FS-HNDLCODE-ED();

  end

  if (TI0FW00.TI0FW-OP-CUST-PO-FL == "Y")

    TI0FS-CUSTPO-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "N";

    TI0FS-STATCODE-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-NEED-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL == "Y")

    TI0FS-TORQTW02-MV();

    set TIXREC empty;

    set SQLCA empty;

    set VTOITM01 empty;

    TI0FW00.TI0FW-TI9910-CALL-ACTION = "SS";

    TIXREC.TIX-GROUP = TI0FW00.TI0FW-TI9910-CALL-GROUP;

    VTOITM01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

    VTOITM01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

    VTOITM01.TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;

    TI0FS-TI9910-SS();

    TI0FW00.TI0FW-TI9910-CALL-GROUP = TIXREC.TIX-GROUP;

    if (SQLCA.VAGen_SQLCODE == -305)

      TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = 0;

    else

      TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = VTOITM01.TI-ON-ORD-QTY;

    end

  else
    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end

   /* ------------------------------------------------------------*/
   /* Select next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-NH(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW02-TA-COUNT = TI0FW00.TI0FW-TI0FW02-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* Bump map line index up by 1*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
   /* ------------------------------------------------------------*/
   /* If page is full, add page to the storage queue, set map line*/
   /* index to 1*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW02-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end

   /* END OF STATEMENT GROUP*/
end // end TI0F-21A10

// Format and converse the map
Function TI0F-22000()
   /* ------------------------------------------------------------*/
   /* If an error was found, save the error message number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    TIWREC.XXX-MSG-NBR = converseVar.validationMsgNum; /* Message number*/
  end

   /* ------------------------------------------------------------*/
   /* If the map must be formatted, format the data in the map.*/
   /* ------------------------------------------------------------*/

  if ((TI0FW00.XXX-MAP-FMAT-FL == "Y" /* Map must be formatted*/
   || TI0FW00.XXX-PAGE-UPD-FL == "Y")) /* Map must be formatted*/

    TI0F-22100(); /* Format the data in the map*/

  end
   /* ------------------------------------------------------------*/
   /* Format the current date and any FAST PATH information.*/
   /* ------------------------------------------------------------*/

  TI0FM002.XXX-CURR-DT = VGVar.currentShortGregorianDate; /* Current date*/

  if (TI0FWCA1.CATOAP > " ")

    TI0FM002.CATOAP = TIWREC.CATOAP;
    TI0FWCA1.CATOAP = " ";

  else

    TI0FM002.CATOAP = COMMAREA.CATOAP; /* TO application*/

  end

  if (TI0FWCA1.CAITEM > " ")

    TI0FM002.CAITEM = TI0FWCA1.CAITEM;
    TI0FWCA1.CAITEM = " ";

  else

    TI0FM002.CAITEM = COMMAREA.CAITEM; /* Application data*/

  end

   /* ------------------------------------------------------------*/
   /* If a message to display, indicate sound audible alarm.*/
   /* ------------------------------------------------------------*/

  if (TIWREC.XXX-MSG-NBR != 0 /* Message to display*/
   || COMMAREA.CAMSG != " ")  /* or message text*/

    if (TIWREC.XXX-MSG-NBR != 0) /* Message to display*/

      if (TIWREC.XXX-MSG-NBR == 9999)
        converseLib.validationFailed();
      else
        converseLib.validationFailed(TIWREC.XXX-MSG-NBR);
      end /* Message number*/

    else

      TI0FM002.VAGen_EZEMSG = COMMAREA.CAMSG; /* Message text*/

    end

    TI0FM002.XXX-MSG-LOC-ID = TIWREC.XXX-MSG-LOC-ID;
    TI0FM002.TI0FM-HYPHEN = "-";
                                  /* Message location*/
    set TI0FM002 alarm; /* Indicate sound alarm*/

  end

  converse TI0FM002 ;

   /* ------------------------------------------------------------*/
   /* Clear the message fields and save FAST PATH information.*/
   /* ------------------------------------------------------------*/

  TIWREC.XXX-MSG-LOC-ID = " "; /* Message location*/
  TIWREC.XXX-MSG-NBR = 0; /* Message number*/
  COMMAREA.CAMSG = " "; /* Message text*/

  COMMAREA.CATOAP = TI0FM002.CATOAP; /* TO application*/
  COMMAREA.CAITEM = TI0FM002.CAITEM; /* Application data*/

   /* ------------------------------------------------------------*/
   /* Reset modifiable field attributes to normal intensity.*/
   /* ------------------------------------------------------------*/

  set TI0FM002.CATOAP normal; /* TO application*/
  set TI0FM002.CAITEM normal; /* Application data*/
end // end TI0F-22000

// Format the data in the map
Function TI0F-22100()
   /* ------------------------------------------------------------*/
   /* Clear the fields in the map storage area to be formatted.*/
   /* ------------------------------------------------------------*/

  set TI0FM002 initial; /* M002 input/output area*/

  TI0FM002.XXX-CURR-PAGE-NBR = TI0FW00.TI0FW-M002-CURR-PAGE-NBR;

  TI0FW00.XXX-MAP-FMAT-FL = "N"; /* Format the map flag*/

   /* ------------------------------------------------------------*/
   /* If the page in storage is not the page to be displayed,*/
   /* obtain the desired page from temporary storage.*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.TI0FW-M002-HI-PAGE-NBR > 0) /* Pages were formatted*/

    if (TI0FW00.XXX-PAGE-UPD-FL == "Y") /* Current page was changed*/

      TA5REC.TA5TSQIX = TI0FW00.XXX-CURR-PAGE-NBR;

      TI0FS-TI0FW02-TU(); /* Update temporary storage page*/

      TI0FW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

    end

    if (TI0FM002.XXX-CURR-PAGE-NBR != TA5REC.TA5TSQIX
    )
      if (TI0FM002.XXX-CURR-PAGE-NBR > TI0FW00.TI0FW-M002-HI-PAGE-NBR
      )
        TI0FM002.XXX-CURR-PAGE-NBR = TI0FW00.TI0FW-M002-HI-PAGE-NBR;

      end

      if (TI0FM002.XXX-CURR-PAGE-NBR < 1
      )
        TI0FM002.XXX-CURR-PAGE-NBR = 1;

      end

      TA5REC.TA5TSQIX = TI0FM002.XXX-CURR-PAGE-NBR;

      TI0FS-TI0FW02-TR(); /* Read temporary storage page*/

    end

    /* ------------------------------------------------------------*/
    /* Display the page information on the screen.*/
    /* ------------------------------------------------------------*/

    set TI0FM002.XXX-CURR-PAGE-DESC skip; /* "PAGE" literal*/

    TI0FW00.XXX-CURR-PAGE-NBR = TI0FM002.XXX-CURR-PAGE-NBR;

    set TI0FM002.XXX-HI-PAGE-DESC skip; /* "OF" literal*/

    TI0FM002.XXX-HI-PAGE-NBR = TI0FW00.TI0FW-M002-HI-PAGE-NBR;

  end

  TI0FM002.XGP-GPC-CD = TI0FW02.XGP-GPC-CD;

  TI0FW00.TI0FW-SEND-CD-SET-DEFINED-FL = "N";

  TI0FW00.TI0FW-SELECT-SET-DEFINED-FL = "N";

  TI0FW00.XXX-INX-FLD-NBR = 1; /* Initialize line index*/

  while (TI0FW00.XXX-INX-FLD-NBR <= TI0FW00.XXX-INX-LMT-NBR)

    TI0FM002.TI0FW-SALES-ORD-ID[XXX-INX-FLD-NBR] = TI0FW02.TI0FW-SALES-ORD-ID[XXX-INX-FLD-NBR];

    TI0FM002.CU-CO-ID[XXX-INX-FLD-NBR] = TI0FW02.CU-CO-ID[XXX-INX-FLD-NBR];

    TI0FM002.OP-CUST-PO[XXX-INX-FLD-NBR] = TI0FW02.OP-CUST-PO[XXX-INX-FLD-NBR];

    TI0FM002.TI0FW-STYLE-COLR[XXX-INX-FLD-NBR] = TI0FW02.TI0FW-STYLE-COLR[XXX-INX-FLD-NBR];

    TI0FM002.TI0FW-OP-CUST-NEED-DT[XXX-INX-FLD-NBR] = TI0FW02.TI0FW-OP-CUST-NEED-DT[XXX-INX-FLD-NBR];

    TI0FM002.TI-CUTK-STAT-CD[XXX-INX-FLD-NBR] = TI0FW02.TI-CUTK-STAT-CD[XXX-INX-FLD-NBR];

    TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] = TI0FW02.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR];

    if (TI0FW00.TI0FW-M002-CHG-FL == "Y")

      if (COMMAREA.CACLVL[4] == "Y"
       && (TI0FM002.TI-CUTK-STAT-CD[XXX-INX-FLD-NBR] != "HS"
       && (TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] != "  "
       && TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] != "A "))
       || (TI0FM002.TI-CUTK-STAT-CD[XXX-INX-FLD-NBR] == "HS"
       && (TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] == "  "
       || TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] == "X ")))

        if (TI0FW00.TI0FW-SEND-CD-SET-DEFINED-FL == "N")

          set TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] cursor, initialAttributes;
          TI0FW00.TI0FW-SEND-CD-SET-DEFINED-FL = "Y";

        else

          set TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] initialAttributes;

        end

      else

        set TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] blue, noHighLight, protect;
      end

    else

      set TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] blue, noHighLight, protect;
    end

    TI0FM002.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR] = TI0FW02.TI0FW-TOT-ON-ORD-QTY[XXX-INX-FLD-NBR];

    TI0FM002.TI0FW-SELECT[XXX-INX-FLD-NBR] = TI0FW02.TI0FW-SELECT[XXX-INX-FLD-NBR];

    if (TI0FW00.TI0FW-M002-CHG-FL == "Y")

      set TI0FM002.TI0FW-SELECT[XXX-INX-FLD-NBR] noHighLight, protect;

    else


      if (TI0FW00.TI0FW-SELECT-SET-DEFINED-FL == "N")

        set TI0FM002.TI0FW-SELECT[XXX-INX-FLD-NBR] cursor, initialAttributes;
        TI0FW00.TI0FW-SELECT-SET-DEFINED-FL = "Y";

      else

        set TI0FM002.TI0FW-SELECT[XXX-INX-FLD-NBR] initialAttributes;

      end

    end

    if (TI0FW02.OP-CUST-ORD-ID[XXX-INX-FLD-NBR] == 0)

      set TI0FM002.TI0FW-SELECT[XXX-INX-FLD-NBR] noHighLight, protect;

    end

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;

  end

  if (TI0FW00.TI0FW-M002-CHG-FL == "Y")

    TI0FM002.TI0FW-PFKEYS = "1= HELP, 3=CANCEL CHANGE, ENTER=ACCEPT CHANGES";

    TI0FM002.TI0FW-SELECT-PFKEYS = " ";

  else

    TI0FM002.TI0FW-PFKEYS = "1=HELP, 3=END, 4=MAIN, 6=CHG, 7=UP, 8=DOWN";

    TI0FM002.TI0FW-SELECT-PFKEYS = "S+PFKEY:  PF11=RESEND, ENTER=DETAIL";

  end
end // end TI0F-22100

// Check attention identifier
Function TI0F-23000()
  if (converseVar.eventKey is pf4 /* mnom menu requested*/
  )                              
    COMMAREA.CATOAP = "MN0M"; /* System Menu*/

    TI0FW00.XXX-MAP-DSP-CD = "1";

    TI0FS-TI0FW02-TP(); /* Purge any temporary storage*/

    XSTIS-EXIT(); /* Exit to another application*/

    exit stack; /* Exit to display map*/

  end

  if (converseVar.eventKey is pa2) /* PA2 was pressed*/

    if (TI0FW00.XXX-RQT-DATA-FL == "Y") /* Request for data pending*/

      set TI0FW01 empty; /* M001 display storage*/

    end

    TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/
    TI0FW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    COMMAREA.CATOAP = " "; /* TO application*/
    COMMAREA.CAITEM = " "; /* Application data*/

    exit stack; /* Exit to display map*/

  end

  if (TI0FM002.CATOAP > " " /* FAST PATH was requested*/
   && converseVar.eventKey not pf1
   && converseVar.eventKey not pf3)

    if (converseVar.eventKey is enter) /* ENTER was pressed*/

      XSTIS-EXIT(); /* Exit to another application*/

      set TI0FM002.CATOAP cursor, bold; /* Highlight*/

    else

      TIWREC.XXX-MSG-LOC-ID = "23000"; /* Message location*/

      converseLib.validationFailed(5); /* PA/PF key may not be used*/

    end

    exit stack; /* Exit to display map*/

  end

  if (TI0FW00.TI0FW-M002-CHG-FL == "Y"
  )
    if (converseVar.eventKey not enter /* COMMIT CHANGES*/
     && converseVar.eventKey not pf1   /* HELP*/
     && converseVar.eventKey not pf3)  /* RETURN TO TI0FM001, canel changes*/

      TIWREC.XXX-MSG-LOC-ID = "23000";
      converseLib.validationFailed(74);

      exit stack;

    end

  end

  if (converseVar.eventKey is pf6)

    if (TI0FW00.TI0FW-M002-CHG-FL == "Y")

      TIWREC.XXX-MSG-LOC-ID = "23000";

      converseLib.validationFailed(66);

      exit stack;

    end

    if (COMMAREA.CACHGFL == "Y")

      TI0FS-CACHGLVL-ED();

      if (converseVar.validationMsgNum != 0)

        TIWREC.XXX-MSG-LOC-ID = "23000";

        exit stack;

      end

    else

      TIWREC.XXX-MSG-LOC-ID = "23000";

      converseLib.validationFailed(63);

      exit stack;

    end

    TI0FW00.TI0FW-M002-CHG-FL = "Y";

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    exit stack;

  end

  if (converseVar.eventKey is pf11)

    if (COMMAREA.CACHGFL == "Y")

      TI0FS-CACHGLVL-11();

      if (converseVar.validationMsgNum != 0)

        TIWREC.XXX-MSG-LOC-ID = "23000";

        exit stack;

      end

    else

      TIWREC.XXX-MSG-LOC-ID = "23000";

      converseLib.validationFailed(111);

      exit stack;

    end

  end

  if (converseVar.eventKey not enter /* VIEW SELECTION*/
   && converseVar.eventKey not pf1   /* HELP*/
   && converseVar.eventKey not pf3   /* END*/
   && converseVar.eventKey not pf6   /* CHANGE*/
   && converseVar.eventKey not pf7   /* SCROLL UP*/
   && converseVar.eventKey not pf8   /* SCROLL DOWN*/
   && converseVar.eventKey not pf11) /* RESEND*/

    TIWREC.XXX-MSG-LOC-ID = "23000"; /* Message location*/
    converseLib.validationFailed(4); /* PA/PF key pressed is not valid*/

    if (converseVar.eventKey is pakey) /* PA key was pressed*/
      converseLib.clearScreen();
       /* Clear screen before display*/
    end

    exit stack; /* Exit to display map*/

  end
end // end TI0F-23000

// Verify data that was entered
Function TI0F-24000()
  if (converseVar.eventKey is pf1)

    return;

  end

  if (TI0FM001.CAITEM > " ") /* Application data was entered*/

    TIWREC.XXX-MSG-LOC-ID = "24000"; /* Message location*/
    converseLib.validationFailed(7); /* Enter only with FAST PATH*/

    set TI0FM001.CAITEM cursor, bold; /* Highlight*/

    exit stack;

  end

  if (converseVar.eventKey is enter) /* Scroll up requested*/

    if (TI0FW00.TI0FW-M002-CHG-FL == "Y")

      TI0FW00.XXX-INX-FLD-NBR = 1; /* Initialize line index*/

      TI0FW00.TI0FW-DATA-CHANGED-FL = "N";

      while ((TI0FW00.XXX-INX-FLD-NBR <= TI0FW00.XXX-INX-LMT-NBR))

        if (TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR]
         != TI0FW02.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR]
         && (TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] > "  "
         && TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] != "* "))

          if ((TI0FM002.TI-CUTK-STAT-CD[XXX-INX-FLD-NBR] != "HS"
           && (TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] != "Y "
           && TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] != "X "
           && TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] != "R "
           && TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] != "N "))
           || (TI0FM002.TI-CUTK-STAT-CD[XXX-INX-FLD-NBR] == "HS"
           && (TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] != "  "
           && TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] != "X ")))

            TIWREC.XXX-MSG-LOC-ID = "24000";

            set TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] cursor, bold;

            converseLib.validationFailed(62);

            exit stack;

          else

            TI0FW00.TI0FW-DATA-CHANGED-FL = "Y";

          end

        end

        TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;

      end /* WHILE (TI0FW00.XXX-INX-FLD-NBR LE TI0FW00.XXX-INX-LMT-NBR)*/

      if (TI0FW00.TI0FW-DATA-CHANGED-FL == "N"
      )
        TIWREC.XXX-MSG-LOC-ID = "24000"; /* Message location*/

        converseLib.validationFailed(74); /* Enter only with FAST PATH*/

        exit stack;

      end

      TI0FW00.TI0FW-VTORQT01-CHG-FL = "Y";

      TI0FW00.TI0FW-M002-CHG-FL = "N";

      return;

    end

  end

  if (converseVar.eventKey is pf7 /* Scroll up requested*/
   || converseVar.eventKey is pf8) /* Scroll down requested*/

    TI0F-24200(); /* Verify scroll is possible*/

    if (converseVar.validationMsgNum != 0)
      exit stack;
    end

  end

  if (converseVar.eventKey is enter /* Detail request*/
   || converseVar.eventKey is pf7   /* Scroll up requested*/
   || converseVar.eventKey is pf8   /* Scroll down requested*/
   || converseVar.eventKey is pf11) /* Resend  requested*/

    TI0F-24300(); /* Check for selection*/

    if (converseVar.validationMsgNum != 0)
      exit stack;
    end

  end
end // end TI0F-24000

// Verify scroll request
Function TI0F-24200()
   /* ------------------------------------------------------------*/
   /* If scroll back was requested, ensure that pages exist.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf7 /* Scroll back request*/
   && TI0FW00.TI0FW-M002-CURR-PAGE-NBR < 2) /* and no previous pages*/

    TIWREC.XXX-MSG-LOC-ID = "24200"; /* Message location*/
    converseLib.validationFailed(2); /* No previous page to display*/

  end

   /* ------------------------------------------------------------*/
   /* If scroll forward was requested, ensure that pages exist.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf8 /* Scroll forward request*/
   && TI0FW00.TI0FW-M002-CURR-PAGE-NBR
   >= TI0FW00.TI0FW-M002-HI-PAGE-NBR)
                                   /* and no more pages*/

    TIWREC.XXX-MSG-LOC-ID = "24200"; /* Message location*/
    converseLib.validationFailed(3); /* No more pages to display*/

  end
end // end TI0F-24200

// Highlight other changed fields
Function TI0F-24300()
  TI0FW00.TI0FW-DATA-CHANGED-FL = "N";

  TI0FW00.XXX-INX-FLD-NBR = 1;

  while ((TI0FW00.XXX-INX-FLD-NBR <= TI0FW00.XXX-INX-LMT-NBR))

    if (TI0FM002.TI0FW-SELECT[XXX-INX-FLD-NBR]
     != TI0FW02.TI0FW-SELECT[XXX-INX-FLD-NBR]
     && TI0FM002.TI0FW-SELECT[XXX-INX-FLD-NBR] >= " ")

      TI0FW02.TI0FW-SELECT[XXX-INX-FLD-NBR] = TI0FM002.TI0FW-SELECT[XXX-INX-FLD-NBR];

      TI0FW00.TI0FW-DATA-CHANGED-FL = "Y";

      if (TI0FM002.TI0FW-SELECT[XXX-INX-FLD-NBR] != "S")

        TIWREC.XXX-MSG-LOC-ID = "24300";

        converseLib.validationFailed(14);

        set TI0FM002.TI0FW-SELECT[XXX-INX-FLD-NBR] cursor;

        exit stack;

      end

    end

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;

  end

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  if (TI0FW00.TI0FW-DATA-CHANGED-FL == "Y")

    TI0FW00.TI0FW-A-ROW-WAS-SELECTED-FL = "Y";

  end

  if (converseVar.eventKey is enter)

    if (TI0FM002.XXX-CURR-PAGE-NBR == TI0FW00.XXX-CURR-PAGE-NBR)

      if (TI0FW00.TI0FW-A-ROW-WAS-SELECTED-FL == "N")

        TIWREC.XXX-MSG-LOC-ID = "24300";

        converseLib.validationFailed(36);

        set TI0FM002.TI0FW-SELECT[1] cursor;

      end

    end

  end

  if (converseVar.eventKey is pf6)

    if (TI0FW00.TI0FW-A-ROW-WAS-SELECTED-FL == "N")

      TIWREC.XXX-MSG-LOC-ID = "24300";

      converseLib.validationFailed(73);

      set TI0FM002.TI0FW-SELECT[1] cursor;

    end

  end
end // end TI0F-24300

// Process valid input request
Function TI0F-25000()
  if (converseVar.eventKey is pf1)

    TIWREC.XXX-MSG-LOC-ID = "25000";

    TIWREC.XXX-MSG-NBR = 0;

    TIWREC.TI-CUTK-XMIT-CD = " ";
    COMMAREA.CAUSERA = TIWREC.CAUSERA;

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    TI0FWCA1.TI0FWCA1-TI0FW00 = TI0FW00.TI0FW00-REC;

    TI0FWCA1.TI0FWCA1-TI0FW02 = TI0FW02.TI0FW02-REC;

    TI0FWCA1.XXX-MSG-LOC-ID = TIWREC.XXX-MSG-LOC-ID;

    TI0FWCA1.XXX-MSG-NBR = TIWREC.XXX-MSG-NBR;

    TI0FWCA1.TI-CUTK-XMIT-CD = TIWREC.TI-CUTK-XMIT-CD;

    TI0FWCA1.CATOAP = TI0FM002.CATOAP;

    TI0FWCA1.CAITEM = TI0FM002.CAITEM;

    COMMAREA.CA-USER-WORKAREA-2K-B = TI0FWCA1.TI0FWCA1-REC;
    TI0FWCA2.TI0FWCA2-TI0FW01 = TI0FW01.TI0FW01-REC;

    TI0FWCA2.TI0FWCA2-TI0FW03 = TI0FW03.TI0FW03-REC;

    TI0FWCA2.TI0FWCA2-TI0FW04 = TI0FW04.TI0FW04-REC;

    TI0FWCA2.TI0FWCA2-TI0FW05 = TI0FW05.TI0FW05-REC;

    COMMAREA.CA-USER-WORKAREA-2K-C = TI0FWCA2.TI0FWCA2-REC;
    COMMAREA.CAFROMAP = "TI0F";

    COMMAREA.CACURRAP = "TI0F";

    COMMAREA.CATOAP = "GD01";

    COMMAREA.CAITEM = "TI0FM002";

    XSTIS-EXIT();

    set TI0FM001.CATOAP cursor, bold;

    TI0FW00.XXX-MAP-DSP-CD = "2";

    TIWREC.XXX-MSG-LOC-ID = "25000";
    converseLib.validationFailed(78);

    exit stack;

  end

  if (converseVar.eventKey is pf3) /* Scroll back*/

    if (TI0FW00.TI0FW-M002-CHG-FL == "Y")

      converseLib.validationFailed(76);

      TI0FW00.XXX-MAP-DSP-CD = "2";

      TI0FW00.XXX-PAGE-UPD-FL = "Y";

    else

      TI0FW00.XXX-MAP-DSP-CD = "1";

      TI0FW00.XXX-MAP-FMAT-FL = "Y";

    end

    TI0FW00.TI0FW-VTORQT01-CHG-FL = "N";

    TI0FW00.TI0FW-M002-CHG-FL = "N";

    exit stack;

  end

  if (converseVar.eventKey is pf6) /* Scroll back requested*/

    TI0FW00.TI0FW-M002-CHG-FL = "Y";

    exit stack; /* Return to previous process*/

  end

  if (converseVar.eventKey is pf7) /* Scroll back requested*/

    TI0FW00.TI0FW-VTORQT01-CHG-FL = "N";

    TI0FW00.TI0FW-M002-CHG-FL = "N";

    TI0FM002.XXX-CURR-PAGE-NBR = TI0FM002.XXX-CURR-PAGE-NBR - 1;

    TI0FW00.TI0FW-M002-CURR-PAGE-NBR = TI0FM002.XXX-CURR-PAGE-NBR;

    if (TI0FW00.TI0FW-DATA-CHANGED-FL == "Y")

      TI0FW00.XXX-PAGE-UPD-FL = "Y"; /* Page update flag*/

    end
                                  /* Decrement page number*/
    TI0FW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    exit stack; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If scroll forward was requested, increment the page number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf8) /* Scroll forward requested*/

    TI0FW00.TI0FW-VTORQT01-CHG-FL = "N";

    TI0FW00.TI0FW-M002-CHG-FL = "N";

    TI0FM002.XXX-CURR-PAGE-NBR = TI0FM002.XXX-CURR-PAGE-NBR + 1;

    TI0FW00.TI0FW-M002-CURR-PAGE-NBR = TI0FM002.XXX-CURR-PAGE-NBR;

    if (TI0FW00.TI0FW-DATA-CHANGED-FL == "Y")

      TI0FW00.XXX-PAGE-UPD-FL = "Y"; /* Page update flag*/

    end
                                  /* Increment page number*/
    TI0FW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    exit stack; /* Return to previous process*/

  end

  if (converseVar.eventKey is enter)

    if (TI0FW00.TI0FW-VTORQT01-CHG-FL == "Y")

      TI0FW00.TI0FW-VTORQT01-CHG-FL = "N";

      TI0FW00.XXX-INX-FLD-NBR = 1; /* Initialize line index*/

      while (TI0FW00.XXX-INX-FLD-NBR <= TI0FW00.XXX-INX-LMT-NBR)

        if ((TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR]
         != TI0FW02.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR]
         && (TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] > "  "
         && TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] != "* ")))

          set VTORQT01 empty;
          VTORQT01.OP-CUST-ORD-ID = TI0FW02.OP-CUST-ORD-ID[XXX-INX-FLD-NBR];

          VTORQT01.OP-NIKE-ORD-ID = TI0FW02.OP-NIKE-ORD-ID[XXX-INX-FLD-NBR];

          VTORQT01.TI-CUTK-RQT-NBR = TI0FW02.TI-CUTK-RQT-NBR[XXX-INX-FLD-NBR];

          TI0FS-VTORQT01-S();

          VTORQT01.TI-CUTK-SEND-CD = TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR];

          set TA2REC empty;

          TA2REC.TA2DTOPT = "GETDATE ";

          try
            call "TA0040" (TA2REC) {isNoRefresh = yes, isExternal = yes};
          end

          if (sysVar.errorCode == "00000000")

            if (TA2RTNCD != 222)

              VTORQT01.TI-CUTK-RQT-RVW-DT = TA2REC.TA2GRGGN;

              VTORQT01.ZZ-CHNG-DT = TA2REC.TA2GRGGN;

              TI0FW00.TI0FW-WDATE-TIME-NUM = TA2REC.TA2TIMEN;

              VTORQT01.ZZ-CHNG-HHMM = TI0FW00.TI0FW-WDATE-HHMM-NUM;

            end

          end

          TI0FS-VTORQT01-U();

          if (SQLCA.VAGen_SQLCODE == 100)

            TIWREC.XXX-MSG-LOC-ID = "25000";

            converseLib.validationFailed(12);

          else
            TIWREC.XXX-MSG-LOC-ID = "25000";

            converseLib.validationFailed(1);

            TI0FW00.XXX-MAP-FMAT-FL = "Y";

            TI0FW02.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] = TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR];

            TI0FS-TI0FW02-TU();

          end

        end

        TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;

      end

    else

      if (TI0FM002.XXX-CURR-PAGE-NBR != TI0FW00.XXX-CURR-PAGE-NBR)

        TI0FW00.TI0FW-M002-CURR-PAGE-NBR = TI0FM002.XXX-CURR-PAGE-NBR;

        TI0FW00.XXX-MAP-FMAT-FL = "Y";

        exit stack;

      end

      if (TI0FW00.TI0FW-A-ROW-WAS-SELECTED-FL == "Y")

        if (TI0FW00.TI0FW-DATA-CHANGED-FL == "Y"
        )
          TA5REC.TA5TSQIX = TI0FM002.XXX-CURR-PAGE-NBR;

          TI0FS-TI0FW02-TU(); /* Update temporary storage page*/

          TI0FW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

        end

        TI0FW00.TI0FW-M002-CURR-PAGE-NBR = TI0FM002.XXX-CURR-PAGE-NBR;

        TI0FW00.XXX-MAP-FMAT-FL = "Y";

        XXX-RQT-DATA-FL = "Y";

        TI0FW00.TI0FW-DATA-CHANGED-FL = "N";

        TI0FW-PREVIOUS-SCREEN-IND = 2;

        TI0FW00.XXX-MAP-DSP-CD = "4"; /* Map to be displayed*/

        TI0FW00.TI0FW-TI0FW02-PAGE-TO-READ = 0;

        exit stack;

      end

    end

  end

  if (converseVar.eventKey is pf11)

    if (TI0FM002.XXX-CURR-PAGE-NBR != TI0FW00.XXX-CURR-PAGE-NBR)

      TI0FW00.TI0FW-M002-CURR-PAGE-NBR = TI0FM002.XXX-CURR-PAGE-NBR;

      TI0FW00.XXX-MAP-FMAT-FL = "Y";

      exit stack;

    end

    if (TI0FW00.TI0FW-A-ROW-WAS-SELECTED-FL == "Y")

      if (TI0FW00.TI0FW-DATA-CHANGED-FL == "Y"
      )
        TA5REC.TA5TSQIX = TI0FM002.XXX-CURR-PAGE-NBR;

        TI0FS-TI0FW02-TU(); /* Update temporary storage page*/

        TI0FW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

      end

      TI0FW00.TI0FW-M002-CURR-PAGE-NBR = TI0FM002.XXX-CURR-PAGE-NBR;

      TI0FW00.XXX-MAP-FMAT-FL = "Y";

      XXX-RQT-DATA-FL = "Y";

      TI0FW00.TI0FW-DATA-CHANGED-FL = "N";

      TI0FW-PREVIOUS-SCREEN-IND = 2;

      TI0FW00.XXX-MAP-DSP-CD = "4"; /* Map to be displayed*/

      TI0FW00.TI0FW-TI0FW02-PAGE-TO-READ = 0;

      exit stack;

    end

  end
end // end TI0F-25000

// Main process to display a map
Function TI0F-30000()
   /* ------------------------------------------------------------*/
   /* This is the main process used to display a map.  Processing*/
   /* always returns to the top of this process and falls through*/
   /* subordinate processes until an error is found or a valid*/
   /* request is processed.  Processing sequence is as follows:*/

   /* 1) Obtain the data to display.*/
   /* 2) Format the map output area and display the map.*/
   /* 3) Check the attention identifier used to respond.*/
   /* 4) Verify the data that was entered.*/
   /* 5) Process a valid input request.*/

   /* In all subordinate processes, "EZEFLO" is used to exit to*/
   /* redisplay the map when an error is found.  This is done to*/
   /* minimize the coding effort required to skip subsequent*/
   /* processing under error conditions.*/
   /* ------------------------------------------------------------*/

  TI0F-31000(); /* Obtain the data to display*/

  TI0F-32000(); /* Format and display the map*/

  TI0F-33000(); /* Check attention identifier*/

  TI0F-34000(); /* Verify the entered data*/

  TI0F-35000(); /* Process valid input request*/
end // end TI0F-30000

// Obtain the data to display
Function TI0F-31000()
   /* ------------------------------------------------------------*/
   /* If data was not requested or an error was found, return to*/
   /* the previous process.*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-RQT-DATA-FL != "Y" /* Data was not requested*/
   || converseVar.validationMsgNum != 0) /* or an error was found*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If no message (EZERTN above), reset the page number to display.*/
   /* ------------------------------------------------------------*/

  if (TIWREC.XXX-MSG-NBR == 0)

    TI0FW00.TI0FW-M003-CURR-PAGE-NBR = 1; /* Page number to display*/

  end

  TI0FW00.TI0FW-M003-HI-PAGE-NBR = 0; /* Page number to display*/

   /* ------------------------------------------------------------*/
   /* Purge any pages from temporary storage and save key fields.*/
   /* ------------------------------------------------------------*/

  TI0FS-TI0FW03-TP(); /* Purge any temporary storage*/

   /* ------------------------------------------------------------*/
   /* Initialize screen M003 storage record.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-TBL = " ";
  set TI0FW03 empty; /* M003 display storage*/

  TI0FW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

   /* ------------------------------------------------------------*/
   /* If the sales order is entered.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX = 1;

  while ((TI0FW-TI-CUTK-STAT-CD-SAVE-IDX <= 6))

    TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE[TI0FW-TI-CUTK-STAT-CD-SAVE-IDX] = " ";

    TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX = TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX + 1;

  end

  TI0FW00.XXX-INX-FLD-NBR = 1;

  if (((TI0FM001.TI0FW-PO-ID-MO-RNG-YY > 0
   || TI0FM001.TI0FW-PO-ID-MO-RNG-BLD-MM > 0
   || TI0FM001.TI0FW-PO-ID-MO-RNG-SHP-MM > 0)
   && (TI0FM001.FY-FCTY-CD > " ")))

    if ((TI0FM001.XCT-CTRY-CD > " "
     || TI0FM001.PC-PO-NBR > 0
     || TI0FM001.TI0FW-SY-STY-CD2 > " "
     || TI0FM001.PC-PRDCU-ID > " "
     || TI0FM001.TI0FW-OP-CUST-PO2 > " "))

      if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

        TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX = 1;
        TI0FW00.TI0FW-WORK-IDX = 1;

        while ((TI0FW-TI-CUTK-STAT-CD-IDX <= 6))

          if (TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX] > " ")

            TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX = 1;
            TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL = "N";

            while ((TI0FW-TI-CUTK-STAT-CD-SAVE-IDX <= 6
             && TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL != "Y"))

              if (TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX]
               == 
              TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE[TI0FW-TI-CUTK-STAT-CD-SAVE-IDX]
              )
                TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL = "Y";

              end

              TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX = TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX + 1;

            end /* WHILE (TI0FW-TI-CUTK-STAT-CD-SAVE-IDX*/
                                   /* LE 6*/
                  /* AND TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL NE 'Y')*/

            if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL != "Y"
            )
              TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE[TI0FW-WORK-IDX] = TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];

              TI0FW00.TI0FW-WORK-IDX = TI0FW00.TI0FW-WORK-IDX + 1;

              TI0F-31200();

              if (converseVar.validationMsgNum != 0) /* Normal return code*/
                exit stack; /* Exit to display map*/
              end

            end

          end

          TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX = TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX + 1;

        end /* WHILE (TI0FW-TI-CUTK-STAT-CD-IDX GE 1)*/

      else

        TI0F-31200();

        if (converseVar.validationMsgNum != 0) /* Normal return code*/
          exit stack; /* Exit to display map*/
        end

      end

    else

      TI0F-31100();

      if (converseVar.validationMsgNum != 0)
        exit stack;
      end

    end

    if ((TI0FW00.XXX-INX-FLD-NBR > 1))

      TI0FS-TI0FW03-TA();

    end

    if (TI0FW00.TI0FW-M003-HI-PAGE-NBR == 0)

      TIWREC.XXX-MSG-LOC-ID = "31000";
      converseLib.validationFailed(18);

      TI0FW00.XXX-MAP-DSP-CD = "1";

      exit stack;

    end

    TI0FW00.XXX-RQT-DATA-FL = "N";

    return;

  end

  if (((TI0FM001.TI0FW-PO-ID-MO-RNG-YY > 0
   || TI0FM001.TI0FW-PO-ID-MO-RNG-BLD-MM > 0
   || TI0FM001.TI0FW-PO-ID-MO-RNG-SHP-MM > 0)
   && (TI0FM001.XCT-CTRY-CD > " ")))

    if ((TI0FM001.FY-FCTY-CD > " "
     || TI0FM001.PC-PO-NBR > 0
     || TI0FM001.TI0FW-SY-STY-CD2 > " "
     || TI0FM001.PC-PRDCU-ID > " "
     || TI0FM001.TI0FW-OP-CUST-PO2 > " "))

      if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

        TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX = 1;
        TI0FW00.TI0FW-WORK-IDX = 1;

        while ((TI0FW-TI-CUTK-STAT-CD-IDX <= 6))

          if (TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX] > " ")

            TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX = 1;
            TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL = "N";

            while ((TI0FW-TI-CUTK-STAT-CD-SAVE-IDX <= 6
             && TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL != "Y"))

              if (TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX]
               == 
              TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE[TI0FW-TI-CUTK-STAT-CD-SAVE-IDX]
              )
                TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL = "Y";

              end

              TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX = TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX + 1;

            end /* WHILE (TI0FW-TI-CUTK-STAT-CD-SAVE-IDX*/
                                   /* LE 6*/
                  /* AND TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL NE 'Y')*/

            if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL != "Y"
            )
              TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE[TI0FW-WORK-IDX] = TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];

              TI0FW00.TI0FW-WORK-IDX = TI0FW00.TI0FW-WORK-IDX + 1;

              TI0F-31400();

              if (converseVar.validationMsgNum != 0) /* Normal return code*/
                exit stack; /* Exit to display map*/
              end

            end

          end

          TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX = TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX + 1;

        end /* WHILE (TI0FW-TI-CUTK-STAT-CD-IDX GE 1)*/

      else

        TI0F-31400();

        if (converseVar.validationMsgNum != 0) /* Normal return code*/
          exit stack; /* Exit to display map*/
        end

      end

    else

      TI0F-31300();

      if (converseVar.validationMsgNum != 0)
        exit stack;
      end

    end

    if ((TI0FW00.XXX-INX-FLD-NBR > 1))

      TI0FS-TI0FW03-TA();

    end

    if (TI0FW00.TI0FW-M003-HI-PAGE-NBR == 0)

      TIWREC.XXX-MSG-LOC-ID = "31000";
      converseLib.validationFailed(18);

      TI0FW00.XXX-MAP-DSP-CD = "1";

      exit stack;

    end

    TI0FW00.XXX-RQT-DATA-FL = "N";

    return;

  end

  if (TI0FM001.PC-PRDCU-ID > " ")

    if (((TI0FM001.TI0FW-PO-ID-MO-RNG-YY > 0
     && TI0FM001.TI0FW-PO-ID-MO-RNG-BLD-MM > 0
     && TI0FM001.TI0FW-PO-ID-MO-RNG-SHP-MM > 0)
     || (TI0FM001.FY-FCTY-CD > " "
     || TI0FM001.PC-PO-NBR > 0
     || TI0FM001.XCT-CTRY-CD > " "
     || TI0FM001.TI0FW-SY-STY-CD2 > " "
     || TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y"
     || TI0FM001.TI0FW-OP-CUST-PO2 > " ")))

      if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

        TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX = 1;
        TI0FW00.TI0FW-WORK-IDX = 1;

        while ((TI0FW-TI-CUTK-STAT-CD-IDX <= 6))

          if (TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX] > " ")

            TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX = 1;
            TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL = "N";

            while ((TI0FW-TI-CUTK-STAT-CD-SAVE-IDX <= 6
             && TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL != "Y"))

              if (TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX]
               == 
              TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE[TI0FW-TI-CUTK-STAT-CD-SAVE-IDX]
              )
                TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL = "Y";

              end

              TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX = TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX + 1;

            end /* WHILE (TI0FW-TI-CUTK-STAT-CD-SAVE-IDX*/
                                   /* LE 6*/
                  /* AND TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL NE 'Y')*/

            if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL != "Y"
            )
              TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE[TI0FW-WORK-IDX] = TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];

              TI0FW00.TI0FW-WORK-IDX = TI0FW00.TI0FW-WORK-IDX + 1;

              TI0F-31600();

              if (converseVar.validationMsgNum != 0) /* Normal return code*/
                exit stack; /* Exit to display map*/
              end

            end

          end

          TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX = TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX + 1;

        end /* WHILE (TI0FW-TI-CUTK-STAT-CD-IDX GE 1)*/

      else

        TI0F-31600();

        if (converseVar.validationMsgNum != 0) /* Normal return code*/
          exit stack; /* Exit to display map*/
        end

      end

    else

      TI0F-31500();

      if (converseVar.validationMsgNum != 0)
        exit stack;
      end

    end

    if ((TI0FW00.XXX-INX-FLD-NBR > 1))

      TI0FS-TI0FW03-TA();

    end

    if (TI0FW00.TI0FW-M003-HI-PAGE-NBR == 0)

      TIWREC.XXX-MSG-LOC-ID = "31000";
      converseLib.validationFailed(18);

      TI0FW00.XXX-MAP-DSP-CD = "1";

      exit stack;

    end

    TI0FW00.XXX-RQT-DATA-FL = "N";

    return;

  end

  if (TI0FM001.PC-PO-NBR > 0)

    if (((TI0FM001.TI0FW-PO-ID-MO-RNG-YY > 0
     || TI0FM001.TI0FW-PO-ID-MO-RNG-BLD-MM > 0
     || TI0FM001.TI0FW-PO-ID-MO-RNG-SHP-MM > 0)
     || TI0FM001.FY-FCTY-CD > " "
     || TI0FM001.XCT-CTRY-CD > " "
     || TI0FM001.TI0FW-SY-STY-CD2 > " "
     || TI0FM001.PC-PRDCU-ID > " "
     || TI0FM001.TI0FW-OP-CUST-PO2 > " "))

      TI0F-31700();

      if (converseVar.validationMsgNum != 0)
        exit stack;
      end

    else

      if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

        TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX = 1;
        TI0FW00.TI0FW-WORK-IDX = 1;

        while ((TI0FW-TI-CUTK-STAT-CD-IDX <= 6))

          if (TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX] > " ")

            TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX = 1;
            TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL = "N";

            while ((TI0FW-TI-CUTK-STAT-CD-SAVE-IDX <= 6
             && TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL != "Y"))

              if (TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX]
               == 
              TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE[TI0FW-TI-CUTK-STAT-CD-SAVE-IDX]
              )
                TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL = "Y";

              end

              TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX = TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX + 1;

            end /* WHILE (TI0FW-TI-CUTK-STAT-CD-SAVE-IDX*/
                                   /* LE 6*/
                  /* AND TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL NE 'Y')*/

            if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL != "Y"
            )
              TI0F-31800();

              if (converseVar.validationMsgNum != 0) /* Normal return code*/
                exit stack; /* Exit to display map*/
              end

            end

          end

          TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX = TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX + 1;

        end /* WHILE (TI0FW-TI-CUTK-STAT-CD-IDX GE 1)*/

      else

        TI0F-31800();

        if (converseVar.validationMsgNum != 0) /* Normal return code*/
          exit stack; /* Exit to display map*/
        end

      end

    end

    if ((TI0FW00.XXX-INX-FLD-NBR > 1))

      TI0FS-TI0FW03-TA();

    end

    if (TI0FW00.TI0FW-M003-HI-PAGE-NBR == 0)

      TIWREC.XXX-MSG-LOC-ID = "31000";
      converseLib.validationFailed(18);

      TI0FW00.XXX-MAP-DSP-CD = "1";

      exit stack;

    end

    TI0FW00.XXX-RQT-DATA-FL = "N";

    return;

  end

  if (TI0FW00.TI0FW-STYLE-COLR-FL == "Y")

    if (((TI0FM001.TI0FW-PO-ID-MO-RNG-YY > 0
     && TI0FM001.TI0FW-PO-ID-MO-RNG-BLD-MM > 0
     && TI0FM001.TI0FW-PO-ID-MO-RNG-SHP-MM > 0)
     || TI0FM001.FY-FCTY-CD > " "
     || TI0FM001.XCT-CTRY-CD > " "
     || TI0FM001.PC-PO-NBR > 0
     || TI0FM001.PC-PRDCU-ID > " "
     || TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y"
     || TI0FM001.TI0FW-OP-CUST-PO2 > " "))

      if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

        TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX = 1;
        TI0FW00.TI0FW-WORK-IDX = 1;

        while ((TI0FW-TI-CUTK-STAT-CD-IDX <= 6))

          if (TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX] > " ")

            TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX = 1;
            TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL = "N";

            while ((TI0FW-TI-CUTK-STAT-CD-SAVE-IDX <= 6
             && TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL != "Y"))

              if (TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX]
               == 
              TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE[TI0FW-TI-CUTK-STAT-CD-SAVE-IDX]
              )
                TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL = "Y";

              end

              TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX = TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-IDX + 1;

            end /* WHILE (TI0FW-TI-CUTK-STAT-CD-SAVE-IDX*/
                                   /* LE 6*/
                  /* AND TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL NE 'Y')*/

            if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE-FL != "Y"
            )
              TI0FW00.TI0FW-TI-CUTK-STAT-CD-SAVE[TI0FW-WORK-IDX] = TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];

              TI0FW00.TI0FW-WORK-IDX = TI0FW00.TI0FW-WORK-IDX;

              TI0F-31A00();

              if (converseVar.validationMsgNum != 0) /* Normal return code*/
                exit stack; /* Exit to display map*/
              end

            end

          end

          TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX = TI0FW00.TI0FW-TI-CUTK-STAT-CD-IDX + 1;

        end /* WHILE (TI0FW-TI-CUTK-STAT-CD-IDX GE 1)*/

      else

        TI0F-31A00();

        if (converseVar.validationMsgNum != 0) /* Normal return code*/
          exit stack; /* Exit to display map*/
        end

      end

    else

      TI0F-31900();

      if (converseVar.validationMsgNum != 0) /* Normal return code*/
        exit stack; /* Exit to display map*/
      end

    end

    if ((TI0FW00.XXX-INX-FLD-NBR > 1))

      TI0FS-TI0FW03-TA();

    end

    if (TI0FW00.TI0FW-M003-HI-PAGE-NBR == 0)

      TIWREC.XXX-MSG-LOC-ID = "31000";
      converseLib.validationFailed(18);

      TI0FW00.XXX-MAP-DSP-CD = "1";

      exit stack;

    end

    TI0FW00.XXX-RQT-DATA-FL = "N";

    return;

  end

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0F-31B00();

    if (converseVar.validationMsgNum != 0) /* Normal return code*/
      exit stack; /* Exit to display map*/
    end


    if ((TI0FW00.XXX-INX-FLD-NBR > 1))

      TI0FS-TI0FW03-TA();

    end

    if (TI0FW00.TI0FW-M003-HI-PAGE-NBR == 0)

      TIWREC.XXX-MSG-LOC-ID = "31000";
      converseLib.validationFailed(18);

      TI0FW00.XXX-MAP-DSP-CD = "1";

      exit stack;

    end

    TI0FW00.XXX-RQT-DATA-FL = "N";

    return;

  end
end // end TI0F-31000

// Obtain the data to display
Function TI0F-31100()
   /* ------------------------------------------------------------*/
   /* Select and open the cursor for the ticket request table.*/
   /* ------------------------------------------------------------*/

  set VTORQT01 empty; /* Clear row storage area*/

  VTORQT01.XGP-GPC-CD = TI0FM001.XGP-GPC-CD;

  VTORQT01.PC-PO-ID-MO-RNG = TI0FW00.TI0FW-PC-PO-ID-MO-RNG;

  VTORQT01.FY-FCTY-CD = TI0FM001.FY-FCTY-CD;

  TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

  TI0FS-VTORQT01-S8(); /* Declare and Open cursor*/

  if (converseVar.validationMsgNum != 0) /* Normal return code*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* Set "not eof" condition, read next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-TI0FW03-TA-COUNT = 0;

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  TI0FS-VTORQT01-N8(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* For each VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW03-TA-COUNT <= 300))

    TI0F-31110();

  end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE 'Y');*/

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-C8(); /* Close selected set cursor*/

   /* ------------------------------------------------------------*/
   /* Add any partially formatted last page to the queue.*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.TI0FW-TI0FW03-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "31100"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-31100

// Obtain the data to display
Function TI0F-31110()
  TI0FW00.TI0FW-OP-CUST-PO-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-FL == "Y")

    TI0FS-STYLCOLR-ED();

  end

  if (TI0FW00.TI0FW-OP-CUST-PO-FL == "Y")

    TI0FS-CUSTPO-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "N";

    TI0FS-STATCODE-ED();

  end

  if (TI0FW00.TI0FW-OP-CUST-PO-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y")

    TI0FS-TORQTW03-MV();

  else
    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end

   /* ------------------------------------------------------------*/
   /* Select next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-N8(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* Bump map line index up by 1*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
   /* ------------------------------------------------------------*/
   /* If page is full, add page to the storage queue, set map line*/
   /* index to 1*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW03-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end

   /* END OF STATEMENT GROUP*/
end // end TI0F-31110

// Obtain the data to display
Function TI0F-31200()
   /* ------------------------------------------------------------*/
   /* Select and open the cursor for the ticket request table.*/
   /* ------------------------------------------------------------*/

  set VTORQT01 empty; /* Clear row storage area*/

  VTORQT01.XGP-GPC-CD = TI0FM001.XGP-GPC-CD;

  VTORQT01.PC-PO-ID-MO-RNG = TI0FW00.TI0FW-PC-PO-ID-MO-RNG;

  VTORQT01.FY-FCTY-CD = TI0FM001.FY-FCTY-CD;

  if (TI0FM001.PC-PO-NBR > 0)

    VTORQT01.PC-PO-NBR = TI0FM001.PC-PO-NBR;

  else

    VTORQT01.PC-PO-NBR = -1;

  end

  if (TI0FM001.PC-PRDCU-ID > " ")

    VTORQT01.PC-PRDCU-ID = TI0FM001.PC-PRDCU-ID;

  else

    VTORQT01.PC-PRDCU-ID = "*";

  end

  if (TI0FM001.TI0FW-SY-STY-CD2 > " ")

    VTORQT01.SY-STY-NBR = TI0FM001.TI0FW-SY-STY-CD2;
    VTORQT01.SY-COLR-CD-ID = TI0FM001.TI0FW-SY-COLR-CD-ID2;

  else

    VTORQT01.SY-STY-NBR = "*";
    VTORQT01.SY-COLR-CD-ID = "*";

  end

  if (TI0FM001.XCT-CTRY-CD > " ")

    VTORQT01.XCT-CTRY-CD = TI0FM001.XCT-CTRY-CD;

  else

    VTORQT01.XCT-CTRY-CD = "*";

  end

  if (TI0FM001.TI-CUTK-SPLR-CD > " ")

    VTORQT01.TI-CUTK-SPLR-CD = TI0FM001.TI-CUTK-SPLR-CD;

  else

    VTORQT01.TI-CUTK-SPLR-CD = "*";

  end

  if (TI0FM001.TI-CUTK-XMIT-CD > " ")

    VTORQT01.TI-CUTK-XMIT-CD = TI0FM001.TI-CUTK-XMIT-CD;

  else

    VTORQT01.TI-CUTK-XMIT-CD = "*";

  end

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    VTORQT01.TI-CUTK-STAT-CD = TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];

  else

    VTORQT01.TI-CUTK-STAT-CD = "*";

  end

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    VTORQT01.TI-CUTK-SEND-CD = TI0FW00.TI-CUTK-SEND-CD;

  else

    VTORQT01.TI-CUTK-SEND-CD = "*";

  end

  TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

  TI0FS-VTORQT01-SC(); /* Declare and Open cursor*/

  if (converseVar.validationMsgNum != 0) /* Normal return code*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* Set "not eof" condition, read next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-TI0FW03-TA-COUNT = 0;

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  TI0FS-VTORQT01-NC(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* For each VTORQT01 row*/
   /* ------------------------------------------------------------*/

  while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW03-TA-COUNT <= 300))

    TI0F-31210();

  end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE*/
                                   /* 'Y');*/

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-CC(); /* Close selected set cursor*/

  if (TI0FW00.TI0FW-TI0FW03-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "31200"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-31200

// Obtain the data to display
Function TI0F-31210()
  TI0FW00.TI0FW-OP-CUST-PO-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if (TI0FW00.TI0FW-OP-CUST-PO-FL == "Y")

    TI0FS-CUSTPO-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-OP-CUST-PO-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y")

    TI0FS-TORQTW03-MV();

  else
    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end

   /* ------------------------------------------------------------*/
   /* Select next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-NC(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* Bump map line index up by 1*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
   /* ------------------------------------------------------------*/
   /* If page is full, add page to the storage queue, set map line*/
   /* index to 1*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW03-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end

   /* END OF STATEMENT GROUP*/
end // end TI0F-31210

// Obtain the data to display
Function TI0F-31300()
   /* ------------------------------------------------------------*/
   /* Select and open the cursor for the ticket request table.*/
   /* ------------------------------------------------------------*/

  set VTORQT01 empty; /* Clear row storage area*/

  VTORQT01.XGP-GPC-CD = TI0FM001.XGP-GPC-CD;

  VTORQT01.PC-PO-ID-MO-RNG = TI0FW00.TI0FW-PC-PO-ID-MO-RNG;

  VTORQT01.XCT-CTRY-CD = TI0FM001.XCT-CTRY-CD;

  TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

  TI0FS-VTORQT01-S9(); /* Declare and Open cursor*/

  if (converseVar.validationMsgNum != 0) /* Normal return code*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* Set "not eof" condition, read next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-TI0FW03-TA-COUNT = 0;

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  TI0FS-VTORQT01-N9(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* For each VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW03-TA-COUNT <= 300))

    TI0F-31310();

  end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE 'Y');*/

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-C9(); /* Close selected set cursor*/

  if (TI0FW00.TI0FW-TI0FW03-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "31300"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-31300

// Obtain the data to display
Function TI0F-31310()
  TI0FW00.TI0FW-OP-CUST-PO-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-FL == "Y")

    TI0FS-STYLCOLR-ED();

  end

  if (TI0FW00.TI0FW-OP-CUST-PO-FL == "Y")

    TI0FS-CUSTPO-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "N";

    TI0FS-STATCODE-ED();

  end

  if (TI0FW00.TI0FW-OP-CUST-PO-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y")

    TI0FS-TORQTW03-MV();

  else
    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end

   /* ------------------------------------------------------------*/
   /* Select next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-N9(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* Bump map line index up by 1*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
   /* ------------------------------------------------------------*/
   /* If page is full, add page to the storage queue, set map line*/
   /* index to 1*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW03-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end

   /* END OF STATEMENT GROUP*/
end // end TI0F-31310

// Obtain the data to display
Function TI0F-31400()
   /* ------------------------------------------------------------*/
   /* Select and open the cursor for the ticket request table.*/
   /* ------------------------------------------------------------*/

  set VTORQT01 empty; /* Clear row storage area*/

  VTORQT01.XGP-GPC-CD = TI0FM001.XGP-GPC-CD;

  VTORQT01.PC-PO-ID-MO-RNG = TI0FW00.TI0FW-PC-PO-ID-MO-RNG;

  VTORQT01.XCT-CTRY-CD = TI0FM001.XCT-CTRY-CD;

  if (TI0FM001.PC-PO-NBR > 0)

    VTORQT01.PC-PO-NBR = TI0FM001.PC-PO-NBR;

  else

    VTORQT01.PC-PO-NBR = -1;

  end

  if (TI0FM001.PC-PRDCU-ID > " ")

    VTORQT01.PC-PRDCU-ID = TI0FM001.PC-PRDCU-ID;

  else

    VTORQT01.PC-PRDCU-ID = "*";

  end

  if (TI0FM001.TI0FW-SY-STY-CD2 > " ")

    VTORQT01.SY-STY-NBR = TI0FM001.TI0FW-SY-STY-CD2;
    VTORQT01.SY-COLR-CD-ID = TI0FM001.TI0FW-SY-COLR-CD-ID2;

  else

    VTORQT01.SY-STY-NBR = "*";
    VTORQT01.SY-COLR-CD-ID = "*";

  end

  if (TI0FM001.FY-FCTY-CD > " ")

    VTORQT01.FY-FCTY-CD = TI0FM001.FY-FCTY-CD;

  else

    VTORQT01.FY-FCTY-CD = "*";

  end

  if (TI0FM001.TI-CUTK-SPLR-CD > " ")

    VTORQT01.TI-CUTK-SPLR-CD = TI0FM001.TI-CUTK-SPLR-CD;

  else

    VTORQT01.TI-CUTK-SPLR-CD = "*";

  end

  if (TI0FM001.TI-CUTK-XMIT-CD > " ")

    VTORQT01.TI-CUTK-XMIT-CD = TI0FM001.TI-CUTK-XMIT-CD;

  else

    VTORQT01.TI-CUTK-XMIT-CD = "*";

  end

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    VTORQT01.TI-CUTK-STAT-CD = TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];

  else

    VTORQT01.TI-CUTK-STAT-CD = "*";

  end

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    VTORQT01.TI-CUTK-SEND-CD = TI0FW00.TI-CUTK-SEND-CD;

  else

    VTORQT01.TI-CUTK-SEND-CD = "*";

  end

  TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

  TI0FS-VTORQT01-SD(); /* Declare and Open cursor*/

  if (converseVar.validationMsgNum != 0) /* Normal return code*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* Set "not eof" condition, read next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-TI0FW03-TA-COUNT = 0;

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  TI0FS-VTORQT01-ND(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* For each VTORQT01 row*/
   /* ------------------------------------------------------------*/

  while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW03-TA-COUNT <= 300))

    TI0F-31410();

  end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE 'Y');*/

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-CD(); /* Close selected set cursor*/

  if (TI0FW00.TI0FW-TI0FW03-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "31400"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-31400

// Obtain the data to display
Function TI0F-31410()
  TI0FW00.TI0FW-OP-CUST-PO-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if (TI0FW00.TI0FW-OP-CUST-PO-FL == "Y")

    TI0FS-CUSTPO-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-OP-CUST-PO-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y")

    TI0FS-TORQTW03-MV();

  else
    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end

   /* ------------------------------------------------------------*/
   /* Select next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-ND(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* Bump map line index up by 1*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
   /* ------------------------------------------------------------*/
   /* If page is full, add page to the storage queue, set map line*/
   /* index to 1*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW03-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end

   /* END OF STATEMENT GROUP*/
end // end TI0F-31410

// Obtain the data to display
Function TI0F-31500()
   /* ------------------------------------------------------------*/
   /* Select and open the cursor for the ticket request table.*/
   /* ------------------------------------------------------------*/

  set VTORQT01 empty; /* Clear row storage area*/

  VTORQT01.XGP-GPC-CD = TI0FM001.XGP-GPC-CD;

  VTORQT01.PC-PRDCU-ID = TI0FM001.PC-PRDCU-ID;

  TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

  TI0FS-VTORQT01-SA(); /* Declare and Open cursor*/

  if (converseVar.validationMsgNum != 0) /* Normal return code*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* Set "not eof" condition, read next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-TI0FW03-TA-COUNT = 0;

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  TI0FS-VTORQT01-NA(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* For each VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW03-TA-COUNT <= 300))

    TI0F-31510();

  end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE 'Y');*/

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-CA(); /* Close selected set cursor*/

  if (TI0FW00.TI0FW-TI0FW03-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "31500"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-31500

// Obtain the data to display
Function TI0F-31510()
  TI0FW00.TI0FW-OP-CUST-PO-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-FL == "Y")

    TI0FS-STYLCOLR-ED();

  end

  if (TI0FW00.TI0FW-OP-CUST-PO-FL == "Y")

    TI0FS-CUSTPO-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "N";

    TI0FS-STATCODE-ED();

  end

  if (TI0FW00.TI0FW-OP-CUST-PO-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y")

    TI0FS-TORQTW03-MV();

  else
    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end

   /* ------------------------------------------------------------*/
   /* Select next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-NA(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* Bump map line index up by 1*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
   /* ------------------------------------------------------------*/
   /* If page is full, add page to the storage queue, set map line*/
   /* index to 1*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW03-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end

   /* END OF STATEMENT GROUP*/
end // end TI0F-31510

// Obtain the data to display
Function TI0F-31600()
   /* ------------------------------------------------------------*/
   /* Select and open the cursor for the ticket request table.*/
   /* ------------------------------------------------------------*/

  set VTORQT01 empty; /* Clear row storage area*/

  VTORQT01.XGP-GPC-CD = TI0FM001.XGP-GPC-CD;

  VTORQT01.PC-PRDCU-ID = TI0FM001.PC-PRDCU-ID;

  if (TI0FM001.PC-PO-NBR > 0)

    VTORQT01.PC-PO-NBR = TI0FM001.PC-PO-NBR;

  else

    VTORQT01.PC-PO-NBR = -1;

  end

  TI0FW00.TI0FW-PC-PO-ID-MO-RNG-NUM = 0;

  TI0FW00.TI0FW-PO-ID-ZERO-NUM = 0;

  TI0FW00.TI0FW-PO-ID-SHP-MM-NUM = TI0FM001.TI0FW-PO-ID-MO-RNG-SHP-MM;

  TI0FW00.TI0FW-PO-ID-BLD-MM-NUM = TI0FM001.TI0FW-PO-ID-MO-RNG-BLD-MM;

  TI0FW00.TI0FW-PO-ID-YY-NUM = TI0FM001.TI0FW-PO-ID-MO-RNG-YY;

  if (TI0FW00.TI0FW-PC-PO-ID-MO-RNG-NUM > 0)
    if (TI0FW00.TI0FW-PO-ID-YY-NUM < 50)
      TI0FW00.TI0FW-PO-ID-CC-NUM = 20;
    else
      TI0FW00.TI0FW-PO-ID-CC-NUM = 19;
    end
  else
    TI0FW00.TI0FW-PO-ID-CC-NUM = 0;
  end

  TI0FW00.TI0FW-PC-PO-ID-MO-RNG-NUM = TI0FW00.TI0FW-PC-PO-ID-MO-RNG;

  if (TI0FW00.TI0FW-PC-PO-ID-MO-RNG-NUM > 0)

    VTORQT01.PC-PO-ID-MO-RNG = TI0FW00.TI0FW-PC-PO-ID-MO-RNG-NUM;

  else

    VTORQT01.PC-PO-ID-MO-RNG = -1;

  end

  if (TI0FM001.TI0FW-SY-STY-CD2 > " ")

    VTORQT01.SY-STY-NBR = TI0FM001.TI0FW-SY-STY-CD2;
    VTORQT01.SY-COLR-CD-ID = TI0FM001.TI0FW-SY-COLR-CD-ID2;

  else

    VTORQT01.SY-STY-NBR = "*";
    VTORQT01.SY-COLR-CD-ID = "*";

  end

  if (TI0FM001.FY-FCTY-CD > " ")

    VTORQT01.FY-FCTY-CD = TI0FM001.FY-FCTY-CD;

  else

    VTORQT01.FY-FCTY-CD = "*";

  end

  if (TI0FM001.XCT-CTRY-CD > " ")

    VTORQT01.XCT-CTRY-CD = TI0FM001.XCT-CTRY-CD;

  else

    VTORQT01.XCT-CTRY-CD = "*";

  end

  if (TI0FM001.TI-CUTK-SPLR-CD > " ")

    VTORQT01.TI-CUTK-SPLR-CD = TI0FM001.TI-CUTK-SPLR-CD;

  else

    VTORQT01.TI-CUTK-SPLR-CD = "*";

  end

  if (TI0FM001.TI-CUTK-XMIT-CD > " ")

    VTORQT01.TI-CUTK-XMIT-CD = TI0FM001.TI-CUTK-XMIT-CD;

  else

    VTORQT01.TI-CUTK-XMIT-CD = "*";

  end

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    VTORQT01.TI-CUTK-STAT-CD = TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];

  else

    VTORQT01.TI-CUTK-STAT-CD = "*";

  end

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    VTORQT01.TI-CUTK-SEND-CD = TI0FW00.TI-CUTK-SEND-CD;

  else

    VTORQT01.TI-CUTK-SEND-CD = "*";

  end

  TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

  TI0FS-VTORQT01-SE(); /* Declare and Open cursor*/

  if (converseVar.validationMsgNum != 0) /* Normal return code*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* Set "not eof" condition, read next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-TI0FW03-TA-COUNT = 0;

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  TI0FS-VTORQT01-NE(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* For each VTORQT01 row*/
   /* ------------------------------------------------------------*/

  while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW03-TA-COUNT <= 300))

    TI0F-31610();

  end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE 'Y');*/

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-CE(); /* Close selected set cursor*/

  if (TI0FW00.TI0FW-TI0FW03-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "31600"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-31600

// Obtain the data to display
Function TI0F-31610()
  TI0FW00.TI0FW-OP-CUST-PO-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if (TI0FW00.TI0FW-OP-CUST-PO-FL == "Y")

    TI0FS-CUSTPO-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-OP-CUST-PO-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y")

    TI0FS-TORQTW03-MV();

  else
    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end

   /* ------------------------------------------------------------*/
   /* Select next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-NE(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* Bump map line index up by 1*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
   /* ------------------------------------------------------------*/
   /* If page is full, add page to the storage queue, set map line*/
   /* index to 1*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW03-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end

   /* END OF STATEMENT GROUP*/
end // end TI0F-31610

// Obtain the data to display
Function TI0F-31700()
   /* ------------------------------------------------------------*/
   /* Select and open the cursor for the ticket request table.*/
   /* ------------------------------------------------------------*/

  set VTORQT01 empty; /* Clear row storage area*/

  VTORQT01.XGP-GPC-CD = TI0FM001.XGP-GPC-CD;

  VTORQT01.PC-PO-NBR = TI0FM001.PC-PO-NBR;

  TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

  TI0FS-VTORQT01-S7(); /* Declare and Open cursor*/

  if (converseVar.validationMsgNum != 0) /* Normal return code*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* Set "not eof" condition, read next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-TI0FW03-TA-COUNT = 0;

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  TI0FS-VTORQT01-N7(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* For each VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW03-TA-COUNT <= 300))

    TI0F-31710();

  end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE 'Y');*/

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-C7(); /* Close selected set cursor*/

  if (TI0FW00.TI0FW-TI0FW03-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "31700"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-31700

// Obtain the data to display
Function TI0F-31710()
  TI0FW00.TI0FW-OP-CUST-PO-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if (TI0FW00.TI0FW-STYLE-COLR-FL == "Y")

    TI0FS-STYLCOLR-ED();

  end

  if (TI0FW00.TI0FW-OP-CUST-PO-FL == "Y")

    TI0FS-CUSTPO-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "N";

    TI0FS-STATCODE-ED();

  end

  if (TI0FW00.TI0FW-OP-CUST-PO-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y")

    TI0FS-TORQTW03-MV();

  else
    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end

   /* ------------------------------------------------------------*/
   /* Select next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-N7(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* Bump map line index up by 1*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
   /* ------------------------------------------------------------*/
   /* If page is full, add page to the storage queue, set map line*/
   /* index to 1*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW03-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end

   /* END OF STATEMENT GROUP*/
end // end TI0F-31710

// Obtain the data to display
Function TI0F-31800()
   /* ------------------------------------------------------------*/
   /* Select and open the cursor for the ticket request table.*/
   /* ------------------------------------------------------------*/

  set VTORQT01 empty; /* Clear row storage area*/

  VTORQT01.XGP-GPC-CD = TI0FM001.XGP-GPC-CD;

  VTORQT01.PC-PO-NBR = TI0FM001.PC-PO-NBR;

  if ((TI0FM001.TI0FW-PO-ID-MO-RNG-YY > 0
   && TI0FM001.TI0FW-PO-ID-MO-RNG-BLD-MM > 0
   && TI0FM001.TI0FW-PO-ID-MO-RNG-SHP-MM > 0))

    VTORQT01.PC-PO-ID-MO-RNG = TI0FW00.TI0FW-PC-PO-ID-MO-RNG;

  else

    VTORQT01.PC-PO-ID-MO-RNG = -1;

  end

  if (TI0FM001.PC-PRDCU-ID > " ")

    VTORQT01.PC-PRDCU-ID = TI0FM001.PC-PRDCU-ID;

  else

    VTORQT01.PC-PRDCU-ID = "*";

  end

  if (TI0FM001.TI0FW-SY-STY-CD2 > " ")

    VTORQT01.SY-STY-NBR = TI0FM001.TI0FW-SY-STY-CD2;
    VTORQT01.SY-COLR-CD-ID = TI0FM001.TI0FW-SY-COLR-CD-ID2;

  else

    VTORQT01.SY-STY-NBR = "*";
    VTORQT01.SY-COLR-CD-ID = "*";

  end

  if (TI0FM001.FY-FCTY-CD > " ")

    VTORQT01.FY-FCTY-CD = TI0FM001.FY-FCTY-CD;

  else

    VTORQT01.FY-FCTY-CD = "*";

  end

  if (TI0FM001.XCT-CTRY-CD > " ")

    VTORQT01.XCT-CTRY-CD = TI0FM001.XCT-CTRY-CD;

  else

    VTORQT01.XCT-CTRY-CD = "*";

  end

  if (TI0FM001.TI-CUTK-SPLR-CD > " ")

    VTORQT01.TI-CUTK-SPLR-CD = TI0FM001.TI-CUTK-SPLR-CD;

  else

    VTORQT01.TI-CUTK-SPLR-CD = "*";

  end

  if (TI0FM001.TI-CUTK-XMIT-CD > " ")

    VTORQT01.TI-CUTK-XMIT-CD = TI0FM001.TI-CUTK-XMIT-CD;

  else

    VTORQT01.TI-CUTK-XMIT-CD = "*";

  end

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    VTORQT01.TI-CUTK-STAT-CD = TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];

  else

    VTORQT01.TI-CUTK-STAT-CD = "*";

  end

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    VTORQT01.TI-CUTK-SEND-CD = TI0FW00.TI-CUTK-SEND-CD;

  else

    VTORQT01.TI-CUTK-SEND-CD = "*";

  end

  TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

  TI0FS-VTORQT01-SB(); /* Declare and Open cursor*/

  if (converseVar.validationMsgNum != 0) /* Normal return code*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* Set "not eof" condition, read next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-TI0FW03-TA-COUNT = 0;

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  TI0FS-VTORQT01-NB(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* For each VTORQT01 row*/
   /* ------------------------------------------------------------*/

  while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW03-TA-COUNT <= 300))

    TI0F-31810();

  end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE 'Y');*/

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-CB(); /* Close selected set cursor*/

  if (TI0FW00.TI0FW-TI0FW03-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "31800"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-31800

// Obtain the data to display
Function TI0F-31810()
  TI0FW00.TI0FW-OP-CUST-PO-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if (TI0FW00.TI0FW-OP-CUST-PO-FL == "Y")

    TI0FS-CUSTPO-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-OP-CUST-PO-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y")

    TI0FS-TORQTW03-MV();

  else
    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end

   /* ------------------------------------------------------------*/
   /* Select next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-NB(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* Bump map line index up by 1*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
   /* ------------------------------------------------------------*/
   /* If page is full, add page to the storage queue, set map line*/
   /* index to 1*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW03-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end

   /* END OF STATEMENT GROUP*/
end // end TI0F-31810

// Obtain the data to display
Function TI0F-31900()
   /* ------------------------------------------------------------*/
   /* Select and open the cursor for the ticket request table.*/
   /* ------------------------------------------------------------*/

  set VTORQT01 empty; /* Clear row storage area*/

  VTORQT01.XGP-GPC-CD = TI0FM001.XGP-GPC-CD;

  VTORQT01.SY-STY-NBR = TI0FM001.TI0FW-SY-STY-CD2;

  VTORQT01.SY-COLR-CD-ID = TI0FM001.TI0FW-SY-COLR-CD-ID2;

  TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

  TI0FS-VTORQT01-SF(); /* Declare and Open cursor*/

  if (converseVar.validationMsgNum != 0) /* Normal return code*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* Set "not eof" condition, read next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-TI0FW03-TA-COUNT = 0;

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  TI0FS-VTORQT01-NF(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* For each VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW03-TA-COUNT <= 300))

    TI0F-31910();

  end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE 'Y');*/

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-CF(); /* Close selected set cursor*/

  if (TI0FW00.TI0FW-TI0FW03-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "31900"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-31900

// Obtain the data to display
Function TI0F-31910()
  TI0FW00.TI0FW-OP-CUST-PO-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if (TI0FW00.TI0FW-OP-CUST-PO-FL == "Y")

    TI0FS-CUSTPO-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "N";

    TI0FS-STATCODE-ED();

  end

  if (TI0FW00.TI0FW-OP-CUST-PO-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y")

    TI0FS-TORQTW03-MV();

  else
    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end

   /* ------------------------------------------------------------*/
   /* Select next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-NF(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* Bump map line index up by 1*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
   /* ------------------------------------------------------------*/
   /* If page is full, add page to the storage queue, set map line*/
   /* index to 1*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW03-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end

   /* END OF STATEMENT GROUP*/
end // end TI0F-31910

// Obtain the data to display
Function TI0F-31A00()
   /* ------------------------------------------------------------*/
   /* Select and open the cursor for the ticket request table.*/
   /* ------------------------------------------------------------*/

  set VTORQT01 empty; /* Clear row storage area*/

  VTORQT01.XGP-GPC-CD = TI0FM001.XGP-GPC-CD;

  VTORQT01.SY-STY-NBR = TI0FM001.TI0FW-SY-STY-CD2;

  VTORQT01.SY-COLR-CD-ID = TI0FM001.TI0FW-SY-COLR-CD-ID2;

  if (TI0FM001.PC-PO-NBR > 0)

    VTORQT01.PC-PO-NBR = TI0FM001.PC-PO-NBR;

  else
    VTORQT01.PC-PO-NBR = -1;

  end

  if ((TI0FM001.TI0FW-PO-ID-MO-RNG-YY > 0
   && TI0FM001.TI0FW-PO-ID-MO-RNG-BLD-MM > 0
   && TI0FM001.TI0FW-PO-ID-MO-RNG-SHP-MM > 0))

    VTORQT01.PC-PO-ID-MO-RNG = TI0FW00.TI0FW-PC-PO-ID-MO-RNG;

  else

    VTORQT01.PC-PO-ID-MO-RNG = -1;

  end

  if (TI0FM001.PC-PRDCU-ID > " ")

    VTORQT01.PC-PRDCU-ID = TI0FM001.PC-PRDCU-ID;

  else

    VTORQT01.PC-PRDCU-ID = "*";

  end

  if (TI0FM001.FY-FCTY-CD > " ")

    VTORQT01.FY-FCTY-CD = TI0FM001.FY-FCTY-CD;

  else

    VTORQT01.FY-FCTY-CD = "*";

  end

  if (TI0FM001.XCT-CTRY-CD > " ")

    VTORQT01.XCT-CTRY-CD = TI0FM001.XCT-CTRY-CD;

  else

    VTORQT01.XCT-CTRY-CD = "*";

  end

  if (TI0FM001.TI-CUTK-SPLR-CD > " ")

    VTORQT01.TI-CUTK-SPLR-CD = TI0FM001.TI-CUTK-SPLR-CD;

  else

    VTORQT01.TI-CUTK-SPLR-CD = "*";

  end

  if (TI0FM001.TI-CUTK-XMIT-CD > " ")

    VTORQT01.TI-CUTK-XMIT-CD = TI0FM001.TI-CUTK-XMIT-CD;

  else

    VTORQT01.TI-CUTK-XMIT-CD = "*";

  end

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    VTORQT01.TI-CUTK-STAT-CD = TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];

  else

    VTORQT01.TI-CUTK-STAT-CD = "*";

  end

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    VTORQT01.TI-CUTK-SEND-CD = TI0FW00.TI-CUTK-SEND-CD;

  else

    VTORQT01.TI-CUTK-SEND-CD = "*";

  end

  TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

  TI0FS-VTORQT01-SG(); /* Declare and Open cursor*/

  if (converseVar.validationMsgNum != 0) /* Normal return code*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* Set "not eof" condition, read next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-TI0FW03-TA-COUNT = 0;

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  TI0FS-VTORQT01-NG(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* For each VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = 1;

  while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW03-TA-COUNT <= 300))

    TI0F-31A10();

  end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE 'Y');*/

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-CG(); /* Close selected set cursor*/

  if (TI0FW00.TI0FW-TI0FW03-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "31A00"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-31A00

// Obtain the data to display
Function TI0F-31A10()
  TI0FW00.TI0FW-OP-CUST-PO-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if (TI0FW00.TI0FW-OP-CUST-PO-FL == "Y")

    TI0FS-CUSTPO-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-OP-CUST-PO-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL == "Y")

    TI0FS-TORQTW03-MV();

  else
    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end

   /* ------------------------------------------------------------*/
   /* Select next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-NG(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* Bump map line index up by 1*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
   /* ------------------------------------------------------------*/
   /* If page is full, add page to the storage queue, set map line*/
   /* index to 1*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW03-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end

   /* END OF STATEMENT GROUP*/
end // end TI0F-31A10

// Obtain the data to display
Function TI0F-31B00()
   /* ------------------------------------------------------------*/
   /* Select and open the cursor for the ticket request table.*/
   /* ------------------------------------------------------------*/

  set VTORQT01 empty; /* Clear row storage area*/

  VTORQT01.XGP-GPC-CD = TI0FM001.XGP-GPC-CD;

  VTORQT01.TI-CUTK-SEND-CD = TI0FW00.TI-CUTK-SEND-CD;

  TI0FW00.TI0FW-TORQT-EOF-FL = "N"; /* VTOHDR01 record found*/

  TI0FS-VTORQT01-SH(); /* Declare and Open cursor*/

  if (converseVar.validationMsgNum != 0) /* Normal return code*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* Set "not eof" condition, read next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-TI0FW03-TA-COUNT = 0;

  TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "N";

  TI0FS-VTORQT01-NH(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* For each VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  while ((TI0FW00.TI0FW-TORQT-EOF-FL != "Y"
   && TI0FW00.TI0FW-TI0FW03-TA-COUNT <= 300))

    TI0F-31B10();

  end /* WHILE (TI0FW00.TI0FW-RQT-EOF-FL NE 'Y');*/

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-CH(); /* Close selected set cursor*/

  if (TI0FW00.TI0FW-TI0FW03-TA-COUNT > 300) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "31B00"; /* Message location*/
    converseLib.validationFailed(34); /* No data was found to display*/

    TI0FW00.TI0FW-MAX-RECS-RETURNED-FL = "Y";

    TI0FW00.XXX-MAP-DSP-CD = "1";

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-31B00

// Obtain the data to display
Function TI0F-31B10()
  TI0FW00.TI0FW-OP-CUST-PO-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";
  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  if (TI0FW00.TI0FW-TI-CUTK-SEND-CD-FL == "Y")

    TI0FS-SENDIND-ED();

  end

  if (TI0FW00.TI0FW-OP-CUST-PO-FL == "Y")

    TI0FS-CUSTPO-ED();

  end

  TI0FS-TKORDER-ED();

  if (TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL == "Y")

    TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "N";

    TI0FS-STATCODE-ED();

  end

  if (TI0FW00.TI0FW-OP-CUST-PO-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL == "Y"
   && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL == "Y")

    TI0FS-TORQTW03-MV();

  else
    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT - 1;

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  end

   /* ------------------------------------------------------------*/
   /* Select next VTORQT01 row*/
   /* ------------------------------------------------------------*/

  TI0FS-VTORQT01-NH(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

    TI0FW00.TI0FW-TORQT-EOF-FL = "Y"; /* VTOHDR01 record found*/

  else

    TI0FW00.TI0FW-TI0FW03-TA-COUNT = TI0FW00.TI0FW-TI0FW03-TA-COUNT + 1;

  end

   /* ------------------------------------------------------------*/
   /* Bump map line index up by 1*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;
   /* ------------------------------------------------------------*/
   /* If page is full, add page to the storage queue, set map line*/
   /* index to 1*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-INX-FLD-NBR > TI0FW00.XXX-INX-LMT-NBR) /* Page is full*/

    TI0FS-TI0FW03-TA(); /* Add page to temporary storage*/

    TI0FW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  end

   /* END OF STATEMENT GROUP*/
end // end TI0F-31B10

// Format and converse the map
Function TI0F-32000()
   /* ------------------------------------------------------------*/
   /* If an error was found, save the error message number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    TIWREC.XXX-MSG-NBR = converseVar.validationMsgNum; /* Message number*/
  end

   /* ------------------------------------------------------------*/
   /* If the map must be formatted, format the data in the map.*/
   /* ------------------------------------------------------------*/

  if ((TI0FW00.XXX-MAP-FMAT-FL == "Y" /* Map must be formatted*/
   || TI0FW00.XXX-PAGE-UPD-FL == "Y")) /* Map must be formatted*/

    TI0F-32100(); /* Format the data in the map*/

  end
   /* ------------------------------------------------------------*/
   /* Format the current date and any FAST PATH information.*/
   /* ------------------------------------------------------------*/

  TI0FM003.XXX-CURR-DT = VGVar.currentShortGregorianDate; /* Current date*/

  if (TI0FWCA1.CATOAP > " ")

    TI0FM003.CATOAP = TIWREC.CATOAP;
    TI0FWCA1.CATOAP = " ";

  else

    TI0FM003.CATOAP = COMMAREA.CATOAP; /* TO application*/

  end

  if (TI0FWCA1.CAITEM > " ")

    TI0FM003.CAITEM = TI0FWCA1.CAITEM;
    TI0FWCA1.CAITEM = " ";

  else

    TI0FM003.CAITEM = COMMAREA.CAITEM; /* Application data*/

  end

   /* ------------------------------------------------------------*/
   /* If a message to display, indicate sound audible alarm.*/
   /* ------------------------------------------------------------*/

  if (TIWREC.XXX-MSG-NBR != 0 /* Message to display*/
   || COMMAREA.CAMSG != " ")  /* or message text*/

    if (TIWREC.XXX-MSG-NBR != 0) /* Message to display*/

      if (TIWREC.XXX-MSG-NBR == 9999)
        converseLib.validationFailed();
      else
        converseLib.validationFailed(TIWREC.XXX-MSG-NBR);
      end /* Message number*/

    else

      TI0FM003.VAGen_EZEMSG = COMMAREA.CAMSG; /* Message text*/

    end

    TI0FM003.XXX-MSG-LOC-ID = TIWREC.XXX-MSG-LOC-ID;
    TI0FM003.TI0FM-HYPHEN = "-";
                                  /* Message location*/
    set TI0FM003 alarm; /* Indicate sound alarm*/

  end

  converse TI0FM003 ;

   /* ------------------------------------------------------------*/
   /* Clear the message fields and save FAST PATH information.*/
   /* ------------------------------------------------------------*/

  TIWREC.XXX-MSG-LOC-ID = " "; /* Message location*/
  TIWREC.XXX-MSG-NBR = 0; /* Message number*/
  COMMAREA.CAMSG = " "; /* Message text*/

  COMMAREA.CATOAP = TI0FM003.CATOAP; /* TO application*/
  COMMAREA.CAITEM = TI0FM003.CAITEM; /* Application data*/

   /* ------------------------------------------------------------*/
   /* Reset modifiable field attributes to normal intensity.*/
   /* ------------------------------------------------------------*/

  set TI0FM003.CATOAP normal; /* TO application*/
  set TI0FM003.CAITEM normal; /* Application data*/
end // end TI0F-32000

// Format the data in the map
Function TI0F-32100()
  set TI0FM003 initial;

  TI0FM003.XXX-CURR-PAGE-NBR = TI0FW00.TI0FW-M003-CURR-PAGE-NBR;

  TI0FW00.XXX-MAP-FMAT-FL = "N";

  if (TI0FW00.TI0FW-M003-HI-PAGE-NBR > 0)

    if (TI0FW00.XXX-PAGE-UPD-FL == "Y")

      TA5REC.TA5TSQIX = TI0FW00.XXX-CURR-PAGE-NBR;

      TI0FS-TI0FW03-TU();

      TI0FW00.XXX-PAGE-UPD-FL = "N";

    end

    if (TI0FM003.XXX-CURR-PAGE-NBR != TA5REC.TA5TSQIX)

      if (TI0FM003.XXX-CURR-PAGE-NBR > TI0FW00.TI0FW-M003-HI-PAGE-NBR)

        TI0FM003.XXX-CURR-PAGE-NBR = TI0FW00.TI0FW-M003-HI-PAGE-NBR;

      end

      if (TI0FM003.XXX-CURR-PAGE-NBR < 1)

        TI0FM003.XXX-CURR-PAGE-NBR = 1;

      end

      TA5REC.TA5TSQIX = TI0FM003.XXX-CURR-PAGE-NBR;

      TI0FS-TI0FW03-TR();

    end

    /* ------------------------------------------------------------*/
    /* Display the page information on the screen.*/
    /* ------------------------------------------------------------*/

    set TI0FM003.XXX-CURR-PAGE-DESC skip; /* "PAGE" literal*/

    TI0FW00.XXX-CURR-PAGE-NBR = TI0FM003.XXX-CURR-PAGE-NBR;

    set TI0FM003.XXX-HI-PAGE-DESC skip; /* "OF" literal*/

    TI0FM003.XXX-HI-PAGE-NBR = TI0FW00.TI0FW-M003-HI-PAGE-NBR;

  end

  TI0FW00.TI0FW-SELECT-SET-DEFINED-FL = "N";

  TI0FW00.TI0FW-SEND-CD-SET-DEFINED-FL = "N";

  TI0FW00.XXX-INX-FLD-NBR = 1; /* Initialize line index*/

  TI0FM003.XGP-GPC-CD = TI0FW03.XGP-GPC-CD;

  while (TI0FW00.XXX-INX-FLD-NBR <= TI0FW00.XXX-INX-LMT-NBR)

    TI0FM003.PC-PO-NBR[XXX-INX-FLD-NBR] = TI0FW03.PC-PO-NBR[XXX-INX-FLD-NBR];

    TI0FM003.TI0FW-PC-PO-ID[XXX-INX-FLD-NBR] = TI0FW03.TI0FW-PC-PO-ID[XXX-INX-FLD-NBR];

    TI0FM003.FY-FCTY-CD[XXX-INX-FLD-NBR] = TI0FW03.FY-FCTY-CD[XXX-INX-FLD-NBR];

    TI0FM003.PC-PRDCU-ID[XXX-INX-FLD-NBR] = TI0FW03.PC-PRDCU-ID[XXX-INX-FLD-NBR];

    TI0FM003.TI0FW-STYLE-COLR[XXX-INX-FLD-NBR] = TI0FW03.TI0FW-STYLE-COLR[XXX-INX-FLD-NBR];

    TI0FM003.TI-CUTK-STAT-CD[XXX-INX-FLD-NBR] = TI0FW03.TI-CUTK-STAT-CD[XXX-INX-FLD-NBR];

    TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] = TI0FW03.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR];

    TI0FM003.TI0FW-SALES-ORD-ID[XXX-INX-FLD-NBR] = TI0FW03.TI0FW-SALES-ORD-ID[XXX-INX-FLD-NBR];

    TI0FM003.TI0FW-SELECT[XXX-INX-FLD-NBR] = TI0FW03.TI0FW-SELECT[XXX-INX-FLD-NBR];

    if (TI0FW03.OP-CUST-ORD-ID[XXX-INX-FLD-NBR] == 0)

      set TI0FM003.TI0FW-SELECT[XXX-INX-FLD-NBR] blue, noHighLight, skip;

      set TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] blue, noHighLight, skip;

    else

      if (TI0FW00.TI0FW-M003-CHG-FL == "Y")

        set TI0FM003.TI0FW-SELECT[XXX-INX-FLD-NBR] blue, noHighLight, protect;

        if (COMMAREA.CACLVL[4] == "Y"
         && (TI0FM003.TI-CUTK-STAT-CD[XXX-INX-FLD-NBR] != "HS"
         && (TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] != "  "
         && TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] != "A "))
         || (TI0FM003.TI-CUTK-STAT-CD[XXX-INX-FLD-NBR] == "HS"
         && (TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] == "  "
         || TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] == "X ")))

          if (TI0FW00.TI0FW-SEND-CD-SET-DEFINED-FL == "N")

            set TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] cursor, initialAttributes;

            TI0FW00.TI0FW-SEND-CD-SET-DEFINED-FL = "Y";

          else

            set TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] initialAttributes;

          end

        else

          set TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] blue, noHighLight, protect;

        end

      else

        set TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] blue, noHighLight, protect;

        if (TI0FW00.TI0FW-SELECT-SET-DEFINED-FL == "N")

          set TI0FM003.TI0FW-SELECT[XXX-INX-FLD-NBR] cursor, initialAttributes;

          TI0FW00.TI0FW-SELECT-SET-DEFINED-FL = "Y";

        else

          set TI0FM003.TI0FW-SELECT[XXX-INX-FLD-NBR] initialAttributes;

        end

      end

    end

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;

  end

  if (TI0FW00.TI0FW-M003-CHG-FL == "Y")

    TI0FM003.TI0FW-PFKEYS = "1= HELP, 3=CANCEL CHANGE, ENTER=ACCEPT CHANGES";

    TI0FM003.TI0FW-SELECT-PFKEYS = " ";

  else

    TI0FM003.TI0FW-PFKEYS = "1=HELP, 3=END, 4=MAIN, 6=CHG, 7=UP, 8=DOWN";

    TI0FM003.TI0FW-SELECT-PFKEYS = "S+PFKEY:  PF11=RESEND, ENTER=DETAIL";

  end
end // end TI0F-32100

// Check attention identifier
Function TI0F-33000()
  if (converseVar.eventKey is pf4) /* REQUERST HELP FACILITY*/

    COMMAREA.CATOAP = "MN0M"; /* System Menu*/

    TI0FW00.XXX-MAP-DSP-CD = "3";

    TI0FS-TI0FW03-TP(); /* Purge any temporary storage*/

    XSTIS-EXIT(); /* Exit to another application*/

    exit stack; /* Exit to display map*/

  end

  if (converseVar.eventKey is pa2) /* PA2 was pressed*/

    if (TI0FW00.XXX-RQT-DATA-FL == "Y") /* Request for data pending*/

      set TI0FW01 empty; /* M001 display storage*/

    end

    TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/
    TI0FW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    COMMAREA.CATOAP = " "; /* TO application*/
    COMMAREA.CAITEM = " "; /* Application data*/

    exit stack; /* Exit to display map*/

  end

  if (TI0FM003.CATOAP > " " /* FAST PATH REQUESTED*/
   && converseVar.eventKey not pf1
   && converseVar.eventKey not pf3)

    if (converseVar.eventKey is enter)

      TI0FS-TI0FW03-TP(); /* Purge any temporary storage*/

      XSTIS-EXIT(); /* Exit to another application*/

      set TI0FM003.CATOAP cursor, bold;

    else

      TIWREC.XXX-MSG-LOC-ID = "33000";

      converseLib.validationFailed(5);

    end

    exit stack;

  end

  if (TI0FW00.TI0FW-M003-CHG-FL == "Y" /* CHANGE ALREADY REQUESTED*/
  )                                   
    if (converseVar.eventKey not enter /* COMMIT CHANGES*/
     && converseVar.eventKey not pf1   /* HELP*/
     && converseVar.eventKey not pf3)  /* CANCEL CHANGES*/

      TIWREC.XXX-MSG-LOC-ID = "33000";
      converseLib.validationFailed(74);

      exit stack;

    end

  end

  if (converseVar.eventKey is pf6) /* REQUEST CHANGE AUTHORITY*/

    if (TI0FW00.TI0FW-M003-CHG-FL == "Y") /* CHANGE ALREADY REQUESTED*/

      TIWREC.XXX-MSG-LOC-ID = "33000";

      converseLib.validationFailed(66);

      exit stack;

    end

    if (COMMAREA.CACHGFL == "Y") /* PRIMARY CHANGE FLAG*/

      TI0FS-CACHGLVL-ED(); /* LOOK AT SECONDARY CHANGE FLAG*/

      if (converseVar.validationMsgNum != 0)

        TIWREC.XXX-MSG-LOC-ID = "33000";

        exit stack;

      end

    else

      TIWREC.XXX-MSG-LOC-ID = "33000";

      converseLib.validationFailed(63);

      exit stack;

    end

    TI0FW00.TI0FW-M003-CHG-FL = "Y";

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    exit stack;

  end

  if (converseVar.eventKey is pf11) /* REQUEST RESEND AUTHORITY*/

    if (COMMAREA.CACHGFL == "Y") /* PRIMARY CHANGE FLAG*/

      TI0FS-CACHGLVL-11(); /* LOOK AT SECONDARY CHANGE FLAG*/

      if (converseVar.validationMsgNum != 0)

        TIWREC.XXX-MSG-LOC-ID = "33000";

        exit stack;

      end

    else

      TIWREC.XXX-MSG-LOC-ID = "33000";

      converseLib.validationFailed(111);

      exit stack;

    end

  end

  if (converseVar.eventKey not enter /* PROCESS SELECTION*/
   && converseVar.eventKey not pf1   /* HELP*/
   && converseVar.eventKey not pf3   /* RETURN*/
   && converseVar.eventKey not pf6   /* REQUEST CHANGES AUTHORITY*/
   && converseVar.eventKey not pf7   /* SCROLL UP*/
   && converseVar.eventKey not pf8   /* SCROLL DOWN*/
   && converseVar.eventKey not pf9   /* ERROR POPUP*/
   && converseVar.eventKey not pf11) /* RESEND REQUEST*/

    TIWREC.XXX-MSG-LOC-ID = "33000"; /* Message location*/
    converseLib.validationFailed(4); /* PA/PF key pressed is not valid*/

    if (converseVar.eventKey is pakey) /* PA key was pressed*/
      converseLib.clearScreen();
       /* Clear screen before display*/
    end

    exit stack; /* Exit to display map*/

  end
end // end TI0F-33000

// Verify data that was entered
Function TI0F-34000()
  if (converseVar.eventKey is pf1) /* HELP*/

    return;

  end

  if (TI0FM003.CAITEM > " ") /* Application data was entered*/

    TIWREC.XXX-MSG-LOC-ID = "34000"; /* Message location*/
    converseLib.validationFailed(7); /* Enter only with FAST PATH*/

    set TI0FM003.CAITEM cursor, bold; /* Highlight*/

    exit stack;

  end

  if (converseVar.eventKey is enter) /* Scroll up requested*/

    if (TI0FW00.TI0FW-M003-CHG-FL == "Y")

      TI0FW00.XXX-INX-FLD-NBR = 1; /* Initialize line index*/

      TI0FW00.TI0FW-DATA-CHANGED-FL = "N";

      while ((TI0FW00.XXX-INX-FLD-NBR <= TI0FW00.XXX-INX-LMT-NBR))

        if (TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR]
         != TI0FW03.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR]
         && (TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] >= "  "
         && TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] != "* "))

          if ((TI0FM003.TI-CUTK-STAT-CD[XXX-INX-FLD-NBR] != "HS"
           && (TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] != "Y "
           && TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] != "X "
           && TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] != "R "
           && TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] != "N "))
           || (TI0FM003.TI-CUTK-STAT-CD[XXX-INX-FLD-NBR] == "HS"
           && (TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] != "  "
           && TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] != "X ")))

            TIWREC.XXX-MSG-LOC-ID = "34000";

            set TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] cursor, bold;

            converseLib.validationFailed(62);

            exit stack;

          else

            TI0FW00.TI0FW-DATA-CHANGED-FL = "Y";

          end

        end

        TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;

      end /* WHILE (TI0FW00.XXX-INX-FLD-NBR LE TI0FW00.XXX-INX-LMT-NBR)*/

      if (TI0FW00.TI0FW-DATA-CHANGED-FL == "N"
      )
        TIWREC.XXX-MSG-LOC-ID = "34000"; /* Message location*/

        converseLib.validationFailed(74); /* Enter only with FAST PATH*/

        exit stack;

      end

      TI0FW00.TI0FW-VTORQT01-CHG-FL = "Y";

      TI0FW00.TI0FW-M003-CHG-FL = "N";

      return;

    end

  end

  if (converseVar.eventKey is pf7 /* Scroll up*/
   || converseVar.eventKey is pf8) /* Scroll down*/

    TI0F-34200(); /* Verify scroll is possible*/

    if (converseVar.validationMsgNum != 0)
      exit stack;
    end

  end

  if (converseVar.eventKey is enter /* Detail request*/
   || converseVar.eventKey is pf7   /* Scroll up requested*/
   || converseVar.eventKey is pf8   /* Scroll down requested*/
   || converseVar.eventKey is pf11) /* Resend requested*/

    TI0F-34300(); /* Check for selection*/

    if (converseVar.validationMsgNum != 0)
      exit stack;
    end

  end
end // end TI0F-34000

// Verify scroll request
Function TI0F-34200()
   /* ------------------------------------------------------------*/
   /* If scroll back was requested, ensure that pages exist.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf7 /* Scroll back request*/
   && TI0FW00.TI0FW-M003-CURR-PAGE-NBR < 2) /* and no previous pages*/

    TIWREC.XXX-MSG-LOC-ID = "34200"; /* Message location*/
    converseLib.validationFailed(2); /* No previous page to display*/

  end

   /* ------------------------------------------------------------*/
   /* If scroll forward was requested, ensure that pages exist.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf8 /* Scroll forward request*/
   && TI0FW00.TI0FW-M003-CURR-PAGE-NBR
   >= TI0FW00.TI0FW-M003-HI-PAGE-NBR)
                                   /* and no more pages*/

    TIWREC.XXX-MSG-LOC-ID = "34200"; /* Message location*/
    converseLib.validationFailed(3); /* No more pages to display*/

  end
end // end TI0F-34200

// Highlight other changed fields
Function TI0F-34300()

  TI0FW00.TI0FW-DATA-CHANGED-FL = "N";

  TI0FW00.XXX-INX-FLD-NBR = 1;

  while ((TI0FW00.XXX-INX-FLD-NBR <= TI0FW00.XXX-INX-LMT-NBR))

    if (TI0FM003.TI0FW-SELECT[XXX-INX-FLD-NBR]
     != TI0FW03.TI0FW-SELECT[XXX-INX-FLD-NBR]
     && TI0FM003.TI0FW-SELECT[XXX-INX-FLD-NBR] >= " ")

      TI0FW03.TI0FW-SELECT[XXX-INX-FLD-NBR] = TI0FM003.TI0FW-SELECT[XXX-INX-FLD-NBR];

      TI0FW00.TI0FW-DATA-CHANGED-FL = "Y";

      if (TI0FM003.TI0FW-SELECT[XXX-INX-FLD-NBR] != "S")

        TIWREC.XXX-MSG-LOC-ID = "34300";

        converseLib.validationFailed(14);

        set TI0FM003.TI0FW-SELECT[XXX-INX-FLD-NBR] cursor;

        exit stack;

      end

    end

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;

  end

  TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

  if (TI0FW00.TI0FW-DATA-CHANGED-FL == "Y")

    TI0FW00.TI0FW-A-ROW-WAS-SELECTED-FL = "Y";

  end

  if (converseVar.eventKey is enter)

    if (TI0FM003.XXX-CURR-PAGE-NBR == TI0FW00.XXX-CURR-PAGE-NBR)

      if (TI0FW00.TI0FW-A-ROW-WAS-SELECTED-FL == "N")

        TIWREC.XXX-MSG-LOC-ID = "34300";

        converseLib.validationFailed(36);

        set TI0FM003.TI0FW-SELECT[1] cursor;

      end

    end

  end
end // end TI0F-34300

// Process valid input request
Function TI0F-35000()
  if (converseVar.eventKey is pf1)

    TIWREC.XXX-MSG-LOC-ID = "35000";

    TIWREC.XXX-MSG-NBR = 0;

    TIWREC.TI-CUTK-XMIT-CD = " ";
    COMMAREA.CAUSERA = TIWREC.CAUSERA;

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    TI0FWCA1.TI0FWCA1-TI0FW00 = TI0FW00.TI0FW00-REC;

    TI0FWCA1.TI0FWCA1-TI0FW02 = TI0FW02.TI0FW02-REC;

    TI0FWCA1.XXX-MSG-LOC-ID = TIWREC.XXX-MSG-LOC-ID;

    TI0FWCA1.XXX-MSG-NBR = TIWREC.XXX-MSG-NBR;

    TI0FWCA1.TI-CUTK-XMIT-CD = TIWREC.TI-CUTK-XMIT-CD;

    TI0FWCA1.CATOAP = TI0FM003.CATOAP;

    TI0FWCA1.CAITEM = TI0FM003.CAITEM;

    COMMAREA.CA-USER-WORKAREA-2K-B = TI0FWCA1.TI0FWCA1-REC;
    TI0FWCA2.TI0FWCA2-TI0FW01 = TI0FW01.TI0FW01-REC;

    TI0FWCA2.TI0FWCA2-TI0FW03 = TI0FW03.TI0FW03-REC;

    TI0FWCA2.TI0FWCA2-TI0FW04 = TI0FW04.TI0FW04-REC;

    TI0FWCA2.TI0FWCA2-TI0FW05 = TI0FW05.TI0FW05-REC;

    COMMAREA.CA-USER-WORKAREA-2K-C = TI0FWCA2.TI0FWCA2-REC;
    COMMAREA.CAFROMAP = "TI0F";

    COMMAREA.CACURRAP = "TI0F";

    COMMAREA.CATOAP = "GD01";

    COMMAREA.CAITEM = "TI0FM003";

    XSTIS-EXIT();

    set TI0FM001.CATOAP cursor, bold;

    TI0FW00.XXX-MAP-DSP-CD = "3";

    TIWREC.XXX-MSG-LOC-ID = "35000";
    converseLib.validationFailed(78);

    exit stack;

  end

  if (converseVar.eventKey is pf3) /* Scroll back*/

    if (TI0FW00.TI0FW-M003-CHG-FL == "Y")

      converseLib.validationFailed(76);

      TI0FW00.XXX-MAP-DSP-CD = "3";

      TI0FW00.XXX-PAGE-UPD-FL = "Y";

    else

      TI0FW00.XXX-MAP-DSP-CD = "1";

      TI0FW00.XXX-MAP-FMAT-FL = "Y";

    end

    TI0FW00.TI0FW-VTORQT01-CHG-FL = "N";

    TI0FW00.TI0FW-M003-CHG-FL = "N";

    exit stack;

  end

  if (converseVar.eventKey is pf6) /* Scroll back requested*/

    TI0FW00.TI0FW-M003-CHG-FL = "Y";

    exit stack; /* Return to previous process*/

  end

  if (converseVar.eventKey is pf7) /* Scroll back requested*/

    TI0FW00.TI0FW-VTORQT01-CHG-FL = "N";

    TI0FW00.TI0FW-M003-CHG-FL = "N";

    TI0FM003.XXX-CURR-PAGE-NBR = TI0FM003.XXX-CURR-PAGE-NBR - 1;

    TI0FW00.TI0FW-M003-CURR-PAGE-NBR = TI0FM003.XXX-CURR-PAGE-NBR;

    if (TI0FW00.TI0FW-DATA-CHANGED-FL == "Y")

      TI0FW00.XXX-PAGE-UPD-FL = "Y"; /* Page update flag*/

    end
                                  /* Decrement page number*/
    TI0FW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    exit stack; /* Return to previous process*/

  end

  if (converseVar.eventKey is pf8) /* Scroll forward requested*/

    TI0FW00.TI0FW-VTORQT01-CHG-FL = "N";

    TI0FW00.TI0FW-M003-CHG-FL = "N";

    TI0FM003.XXX-CURR-PAGE-NBR = TI0FM003.XXX-CURR-PAGE-NBR + 1;

    TI0FW00.TI0FW-M003-CURR-PAGE-NBR = TI0FM003.XXX-CURR-PAGE-NBR;

    if (TI0FW00.TI0FW-DATA-CHANGED-FL == "Y")

      TI0FW00.XXX-PAGE-UPD-FL = "Y"; /* Page update flag*/

    end
                                  /* Increment page number*/
    TI0FW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    exit stack; /* Return to previous process*/

  end

  if (converseVar.eventKey is enter)

    if (TI0FW00.TI0FW-VTORQT01-CHG-FL == "Y")

      TI0FW00.TI0FW-VTORQT01-CHG-FL = "N";

      TI0FW00.XXX-INX-FLD-NBR = 1; /* Initialize line index*/

      while (TI0FW00.XXX-INX-FLD-NBR <= TI0FW00.XXX-INX-LMT-NBR)

        if ((TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR]
         != TI0FW03.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR]
         && (TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] >= "  ")
         && TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] != "* "))

          set VTORQT01 empty;
          VTORQT01.OP-CUST-ORD-ID = TI0FW03.OP-CUST-ORD-ID[XXX-INX-FLD-NBR];

          VTORQT01.OP-NIKE-ORD-ID = TI0FW03.OP-NIKE-ORD-ID[XXX-INX-FLD-NBR];

          VTORQT01.TI-CUTK-RQT-NBR = TI0FW03.TI-CUTK-RQT-NBR[XXX-INX-FLD-NBR];

          TI0FS-VTORQT01-S();

          VTORQT01.TI-CUTK-SEND-CD = TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR];

          set TA2REC empty;

          TA2REC.TA2DTOPT = "GETDATE ";

          try
            call "TA0040" (TA2REC) {isNoRefresh = yes, isExternal = yes};
          end

          if (sysVar.errorCode == "00000000")

            if (TA2RTNCD != 222)

              VTORQT01.TI-CUTK-RQT-RVW-DT = TA2REC.TA2GRGGN;

              VTORQT01.ZZ-CHNG-DT = TA2REC.TA2GRGGN;

              TI0FW00.TI0FW-WDATE-TIME-NUM = TA2REC.TA2TIMEN;

              VTORQT01.ZZ-CHNG-HHMM = TI0FW00.TI0FW-WDATE-HHMM-NUM;

            end

          end

          TI0FS-VTORQT01-U();

          if (SQLCA.VAGen_SQLCODE == 100)

            TIWREC.XXX-MSG-LOC-ID = "35000";

            converseLib.validationFailed(12);

          else
            TIWREC.XXX-MSG-LOC-ID = "35000";

            converseLib.validationFailed(1);

            TI0FW00.XXX-MAP-FMAT-FL = "Y";

            TI0FW03.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] = TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR];

            TI0FS-TI0FW03-TU();

          end

        end

        TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;

      end

    else

      if (TI0FM003.XXX-CURR-PAGE-NBR != TI0FW00.XXX-CURR-PAGE-NBR)

        TI0FW00.TI0FW-M003-CURR-PAGE-NBR = TI0FM003.XXX-CURR-PAGE-NBR;

        TI0FW00.XXX-MAP-FMAT-FL = "Y";

        exit stack;

      end

      if (TI0FW00.TI0FW-A-ROW-WAS-SELECTED-FL == "Y")

        if (TI0FW00.TI0FW-DATA-CHANGED-FL == "Y"
        )
          TA5REC.TA5TSQIX = TI0FM003.XXX-CURR-PAGE-NBR;

          TI0FS-TI0FW03-TU(); /* Update temporary storage page*/

          TI0FW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

        end

        TI0FW00.TI0FW-M003-CURR-PAGE-NBR = TI0FM003.XXX-CURR-PAGE-NBR;

        TI0FW00.XXX-MAP-FMAT-FL = "Y";

        XXX-RQT-DATA-FL = "Y";

        TI0FW00.TI0FW-DATA-CHANGED-FL = "N";

        TI0FW-PREVIOUS-SCREEN-IND = 3;

        TI0FW00.XXX-MAP-DSP-CD = "4"; /* Map to be displayed*/

        TI0FW00.TI0FW-TI0FW03-PAGE-TO-READ = 0;

        exit stack;

      end

    end

  end

  if (converseVar.eventKey is pf11)

    if (TI0FM003.XXX-CURR-PAGE-NBR != TI0FW00.XXX-CURR-PAGE-NBR)

      TI0FW00.TI0FW-M003-CURR-PAGE-NBR = TI0FM003.XXX-CURR-PAGE-NBR;

      TI0FW00.XXX-MAP-FMAT-FL = "Y";

      exit stack;

    end

    if (TI0FW00.TI0FW-A-ROW-WAS-SELECTED-FL == "Y")

      if (TI0FW00.TI0FW-DATA-CHANGED-FL == "Y"
      )
        TA5REC.TA5TSQIX = TI0FM003.XXX-CURR-PAGE-NBR;

        TI0FS-TI0FW03-TU(); /* Update temporary storage page*/

        TI0FW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

      end

      TI0FW00.TI0FW-M003-CURR-PAGE-NBR = TI0FM003.XXX-CURR-PAGE-NBR;

      TI0FW00.XXX-MAP-FMAT-FL = "Y";

      XXX-RQT-DATA-FL = "Y";

      TI0FW00.TI0FW-DATA-CHANGED-FL = "N";

      TI0FW-PREVIOUS-SCREEN-IND = 3;

      TI0FW00.XXX-MAP-DSP-CD = "4"; /* Map to be displayed*/

      TI0FW00.TI0FW-TI0FW03-PAGE-TO-READ = 0;

      exit stack;

    end

  end
end // end TI0F-35000

// Main process to display a map
Function TI0F-40000()
   /* ------------------------------------------------------------*/
   /* This is the main process used to display a map.  Processing*/
   /* always returns to the top of this process and falls through*/
   /* subordinate processes until an error is found or a valid*/
   /* request is processed.  Processing sequence is as follows:*/

   /* 1) Obtain the data to display.*/
   /* 2) Format the map output area and display the map.*/
   /* 3) Check the attention identifier used to respond.*/
   /* 4) Verify the data that was entered.*/
   /* 5) Process a valid input request.*/

   /* In all subordinate processes, "EZEFLO" is used to exit to*/
   /* redisplay the map when an error is found.  This is done to*/
   /* minimize the coding effort required to skip subsequent*/
   /* processing under error conditions.*/
   /* ------------------------------------------------------------*/

  TI0F-41000(); /* Obtain the data to display*/

  TI0F-42000(); /* Format and display the map*/

  TI0F-43000(); /* Check attention identifier*/

  TI0F-44000(); /* Verify the entered data*/

  TI0F-45000(); /* Process valid input request*/

end // end TI0F-40000

// Obtain the data to display
Function TI0F-41000()
   /* ------------------------------------------------------------*/
   /* If data was not requested or an error was found, return to*/
   /* the previous process.*/
   /* ------------------------------------------------------------*/
  if (TI0FW00.XXX-RQT-DATA-FL != "Y" /* Data was not requested*/
   || converseVar.validationMsgNum != 0) /* or an error was found*/

    return; /* Return to previous process*/

  end

  if (TI0FW-PREVIOUS-SCREEN-IND == 2)

    if (TI0FW00.TI0FW-M002-HI-PAGE-NBR <= 0) /* Pages were formatted*/

      return;

    end

    TI0F-41100();

  end

  if (TI0FW-PREVIOUS-SCREEN-IND == 3)

    if (TI0FW00.TI0FW-M003-HI-PAGE-NBR <= 0) /* Pages were formatted*/

      return;

    end

    TI0F-41200();

  end

  TI0FW04.TI-CUTK-STAT-CD = VTORQT01.TI-CUTK-STAT-CD;
  TI0FW04.TI-CUTK-SNT-DT = VTORQT01.TI-CUTK-SNT-DT;
  TI0FW04.TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;

   /* ------------------------------------------------------------*/
   /* GET STATUS DESCRIPTION*/
   /* ------------------------------------------------------------*/
  set VTOSCD01 empty; /* Clear row storage area*/

  if (VTORQT01.TI-CUTK-STAT-CD > " ")

    VTOSCD01.TI-CUTK-STAT-CD = VTORQT01.TI-CUTK-STAT-CD;

    TI0FS-VTOSCD01-S();

    if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

      /* CONTINUE*/

    else

      TI0FW04.TI-CUTK-STAT-DESC = VTOSCD01.TI-CUTK-STAT-DESC;

    end
  end

   /* ------------------------------------------------------------*/
   /* Get supplier abbreviation*/
   /* ------------------------------------------------------------*/
  if (VTORQT01.TI-CUTK-SPLR-CD > " ")

    TI0FW04.TI-CUTK-SPLR-CD = VTORQT01.TI-CUTK-SPLR-CD;

    set VTOPCD01 empty;

    VTOPCD01.TI-CUTK-SPLR-CD = VTORQT01.TI-CUTK-SPLR-CD;

    TI0FS-VTOPCD01-S();

    if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

      /* CONTINUE*/

    else

      TI0FM004.TI0FW-TI-CUTK-SPLR-CD-HYPHEN = "-";

      TI0FW04.TI-CUTK-SPLR-NM = VTOPCD01.TI-CUTK-SPLR-NM;

    end

  end

   /* ------------------------------------------------------------*/
   /* Get transmit method abbreviation*/
   /* ------------------------------------------------------------*/
  if (VTORQT01.TI-CUTK-XMIT-CD > " ")

    TI0FW04.TI-CUTK-XMIT-CD = VTORQT01.TI-CUTK-XMIT-CD;

    VTOXCD01.TI-CUTK-XMIT-CD = VTORQT01.TI-CUTK-XMIT-CD;

    TI0FS-VTOXCD01-S();

    if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

      /* CONTINUE*/

    else

      TI0FM004.TI0FW-TI-CUTK-XMIT-CD-HYPHEN = "-";

      TI0FW04.TI-CUTK-XMIT-ABRV = VTOXCD01.TI-CUTK-XMIT-ABRV;

    end
  end

   /* FORMAT SNT-DT*/

  if (VTORQT01.TI-CUTK-SNT-DT == 0)

    TI0FW04.TI0FW-CUTK-SNT-DT = "N/A";

  else

    TI0FW00.TI0FW-DATE-NUM = VTORQT01.TI-CUTK-SNT-DT;

    TI0FW00.TI0FW-DATE-WORK = TI0FW00.TI0FW-DATE-NUM;

    TI0FW00.TI0FW-DATE-DISP-MM = TI0FW00.TI0FW-DATE-WRK6-MM;

    TI0FW00.TI0FW-DATE-DISP-SLASH1 = "/";

    TI0FW00.TI0FW-DATE-DISP-DD = TI0FW00.TI0FW-DATE-WRK6-DD;

    TI0FW00.TI0FW-DATE-DISP-SLASH2 = "/";

    TI0FW00.TI0FW-DATE-DISP-YY = TI0FW00.TI0FW-DATE-WRK6-YY;

    TI0FW04.TI0FW-CUTK-SNT-DT = TI0FW00.TI0FW-DATE-DISPLAY;

  end

   /* FORMAT EST-SND-DT*/

  if (VTORQT01.TI-CUTK-EST-SND-DT == 0)

    TI0FW04.TI0FW-CUTK-EST-SND-DT = "N/A";

  else

    TI0FW00.TI0FW-DATE-NUM = VTORQT01.TI-CUTK-EST-SND-DT;

    TI0FW00.TI0FW-DATE-WORK = TI0FW00.TI0FW-DATE-NUM;

    TI0FW00.TI0FW-DATE-DISP-MM = TI0FW00.TI0FW-DATE-WRK6-MM;

    TI0FW00.TI0FW-DATE-DISP-SLASH1 = "/";

    TI0FW00.TI0FW-DATE-DISP-DD = TI0FW00.TI0FW-DATE-WRK6-DD;

    TI0FW00.TI0FW-DATE-DISP-SLASH2 = "/";

    TI0FW00.TI0FW-DATE-DISP-YY = TI0FW00.TI0FW-DATE-WRK6-YY;

    TI0FW04.TI0FW-CUTK-EST-SND-DT = TI0FW00.TI0FW-DATE-DISPLAY;

  end

  TI0FW04.TI-CUTK-SEND-CD = VTORQT01.TI-CUTK-SEND-CD;

  if (VTORQT01.TI-CUTK-SEND-CD > " ")

    set VTODCD01 empty;

    VTODCD01.TI-CUTK-SEND-CD = VTORQT01.TI-CUTK-SEND-CD;

    TI0FS-VTODCD01-S();
    if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

      TI0FW04.TI-CUTK-SEND-DESC = "SEND CODE NOT IN VTODCD01";

    else

      TI0FM004.TI0FW-TI-CUTK-SEND-CD-HYPHEN = "-";

      TI0FW04.TI-CUTK-SEND-DESC = VTODCD01.TI-CUTK-SEND-DESC;

    end

  else

    TI0FW04.TI-CUTK-SEND-DESC = " ";

  end

   /* FORMAT RQT-RVW-DT*/

  if (VTORQT01.TI-CUTK-RQT-RVW-DT == 0)

    TI0FW04.TI0FW-CUTK-RQT-RVW-DT = "N/A";

  else

    TI0FW00.TI0FW-DATE-NUM = VTORQT01.TI-CUTK-RQT-RVW-DT;

    TI0FW00.TI0FW-DATE-WORK = TI0FW00.TI0FW-DATE-NUM;

    TI0FW00.TI0FW-DATE-DISP-MM = TI0FW00.TI0FW-DATE-WRK6-MM;

    TI0FW00.TI0FW-DATE-DISP-SLASH1 = "/";

    TI0FW00.TI0FW-DATE-DISP-DD = TI0FW00.TI0FW-DATE-WRK6-DD;

    TI0FW00.TI0FW-DATE-DISP-SLASH2 = "/";

    TI0FW00.TI0FW-DATE-DISP-YY = TI0FW00.TI0FW-DATE-WRK6-YY;

    TI0FW04.TI0FW-CUTK-RQT-RVW-DT = TI0FW00.TI0FW-DATE-DISPLAY;

  end

  set VTOITM01 empty;

  VTOITM01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

  VTOITM01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

  VTOITM01.TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;

  TI0FS-VTOITM01-S1();

  TI0FS-VTOITM01-N1();

  if (SQLCA.VAGen_SQLCODE == 0
  )
    TI0FW04.CU-BUY-SESN-ID = VTOITM01.CU-BUY-SESN-ID;

  end

  TI0FS-VTOITM01-C1();

   /* FORMAT CUSTOMER-ID*/

  set VTOHDR01 empty; /* Clear row storage area*/

  VTOHDR01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

  VTOHDR01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

  TI0FS-VTOHDR01-S();

  if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

    TIWREC.XXX-MSG-LOC-ID = "41000"; /* Message location*/
    converseLib.validationFailed(56); /* No data was found to display*/

    exit stack; /* Exit to display map*/

  end

  TI0FW00.TI0FW-CU-CO-ID-NUM = VTOHDR01.CU-CO-ID;

  TI0FW00.TI0FW-CU-CO-ID-LCHA = TI0FW00.TI0FW-CU-CO-ID-NUM;

  TI0FW00.TI0FW-CU-CO-ID-CHA = TI0FW00.TI0FW-CU-CO-ID-SCHA;

  TI0FW00.TI0F-CUSTOMER-PERIOD1 = ".";

  TI0FW00.TI0FW-CU-STOR-ID-NUM = VTOHDR01.CU-STOR-ID;

  TI0FW00.TI0FW-CU-STOR-ID-LCHA = TI0FW00.TI0FW-CU-STOR-ID-NUM;

  TI0FW00.TI0FW-CU-STOR-ID-CHA = TI0FW00.TI0FW-CU-STOR-ID-SCHA;

  TI0FW00.TI0F-CUSTOMER-PERIOD2 = ".";

  TI0FW00.TI0FW-XNX-DEPT-ID-XREF-NUM = VTOHDR01.XNX-DEPT-ID-XREF;

  TI0FW00.TI0FW-XNX-DEPT-ID-XREF-LCHA = TI0FW00.TI0FW-XNX-DEPT-ID-XREF-NUM;

  TI0FW00.TI0FW-XNX-DEPT-ID-XREF-CHA = TI0FW00.TI0FW-XNX-DEPT-ID-XREF-SCHA;

  TI0FW04.TI0FW-CUSTOMER-ID = TI0FW00.TI0FW-CUSTOMER-ID;

   /* CU-CO-SHORT-NM*/

  set KUCREC empty; /* Clear row storage area*/

  KUCREC.KUCCOID = VTOHDR01.CU-CO-ID;

  TI0FS-IO0240-S();

  if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

    TIWREC.XXX-MSG-LOC-ID = "41000"; /* Message location*/
    converseLib.validationFailed(57); /* No data was found to display*/

    exit stack; /* Exit to display map*/

  end

  TI0FW04.CU-CO-SHORT-NM = KUCREC.CU-CO-SHORT-NM;

   /* PC-PO-ID-MO-RNG*/

  TI0FW00.TI0FW-PC-PO-ID-MO-RNG-NUM = VTORQT01.PC-PO-ID-MO-RNG;

  TI0FW00.TI0FW-PO-ID-YY = TI0FW00.TI0FW-PO-ID-YY-CHA;

  TI0F-PC-PO-ID-SPACE1 = " ";

  TI0FW00.TI0FW-PO-ID-BLD-MM = TI0FW00.TI0FW-PO-ID-BLD-MM-CHA;

  TI0F-PC-PO-ID-SPACE2 = " ";

  TI0FW00.TI0FW-PO-ID-SHP-MM = TI0FW00.TI0FW-PO-ID-SHP-MM-CHA;

  TI0FW04.TI0FW-PC-PO-ID = TI0FW00.TI0FW-PC-PO-ID;

  TI0FW05.TI0FW-PC-PO-ID = TI0FW00.TI0FW-PC-PO-ID;

   /* FY-FCTY-CD*/

  TI0FW04.FY-FCTY-CD = VTORQT01.FY-FCTY-CD;

  TI0FW05.FY-FCTY-CD = VTORQT01.FY-FCTY-CD;

   /* FORMAT SALES-ORD-ID*/

  TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM = VTORQT01.OP-CUST-ORD-ID;

  TI0FW00.TI0FW-OP-CUST-ORD-ID-LCHA = TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM;

  TI0FW00.TI0FW-OP-CUST-ORD-ID-CHA = TI0FW00.TI0FW-OP-CUST-ORD-ID-SCHA;

  TI0FW00.TI0FW-SALES-ORD-PERIOD = ".";

  TI0FW00.TI0FW-OP-NIKE-ORD-ID-NUM = VTORQT01.OP-NIKE-ORD-ID;

  TI0FW00.TI0FW-OP-NIKE-ORD-ID-LCHA = TI0FW00.TI0FW-OP-NIKE-ORD-ID-NUM;

  TI0FW00.TI0FW-OP-NIKE-ORD-ID-CHA = TI0FW00.TI0FW-OP-NIKE-ORD-ID-SCHA;

  TI0FW04.TI0FW-SALES-ORD-ID = TI0FW00.TI0FW-SALES-ORD-ID;

  TI0FW05.TI0FW-SALES-ORD-ID = TI0FW00.TI0FW-SALES-ORD-ID;

   /* PC-PO-NBR*/

  TI0FW04.PC-PO-NBR = VTORQT01.PC-PO-NBR;

  TI0FW05.PC-PO-NBR = VTORQT01.PC-PO-NBR;

   /* XCT-CTRY-CD*/

  if (VTORQT01.XCT-CTRY-CD in XCTTBL.XCTCD /* Code in table*/
   && XCTTBL.XXXSTAT[sysVar.arrayIndex] == "A") /* and active status*/

    TI0FW04.XCT-CTRY-ABRV = XCTTBL.XCTABRV[sysVar.arrayIndex];

  end

   /* CUSTOMER XREF ID*/

  TI0FW04.PC-PRDCU-ID = VTORQT01.PC-PRDCU-ID;

   /* FORMAT STYLE-COLR*/

  TI0FW00.SY-STY-CD = VTORQT01.SY-STY-NBR;

  TI0FW00.TI0FW-STY-COLR-HYPHEN = "-";

  TI0FW00.SY-COLR-CD-ID = VTORQT01.SY-COLR-CD-ID;

  TI0FW04.TI0FW-STYLE-COLR = TI0FW00.TI0FW-STYLE-COLR;

  TI0FW05.TI0FW-STYLE-COLR = TI0FW00.TI0FW-STYLE-COLR;

   /* CUSTOMER PRODUCT ID*/

   /* ------------------------------------------------------------*/
   /* Get customer need date from order header DORDER.VOPHDR01*/
   /* ------------------------------------------------------------*/

  OP1REC.OP1PARTN = TI0FW00.TI0FW-OP-ORD-PART-CHA;

  OP1REC.OP1CUOID = VTORQT01.OP-CUST-ORD-ID;

  OP1REC.OP1NORID = VTORQT01.OP-NIKE-ORD-ID;

  TI0FS-IO0430-S();

  if (converseVar.validationMsgNum != 0) /* Normal return code*/
    exit stack; /* Exit to display map*/
  end

  TI0FW00.TI0FW-DATE-NUM = OP1REC.OP1CUNDT;

  TI0FW00.TI0FW-DATE-WORK = TI0FW00.TI0FW-DATE-NUM;

  TI0FW00.TI0FW-DATE-DISP-MM = TI0FW00.TI0FW-DATE-WRK6-MM;

  TI0FW00.TI0FW-DATE-DISP-SLASH1 = "/";

  TI0FW00.TI0FW-DATE-DISP-DD = TI0FW00.TI0FW-DATE-WRK6-DD;

  TI0FW00.TI0FW-DATE-DISP-SLASH2 = "/";

  TI0FW00.TI0FW-DATE-DISP-YY = TI0FW00.TI0FW-DATE-WRK6-YY;

  TI0FW04.TI0FW-OP-CUST-NEED-DT = TI0FW00.TI0FW-DATE-DISPLAY;

  TI0FW04.XOS-ORD-STAT-CD = OP1REC.XOSCD;

   /* ------------------------------------------------------------*/
   /* Get style name*/
   /* ------------------------------------------------------------*/

  set SYCREC empty; /* Clear row storage area*/

  SYCREC.XGPCD = VTORQT01.XGP-GPC-CD;

  SYCREC.SY1STNBR = VTORQT01.SY-STY-NBR;

  SYCREC.SY2CLRID = VTORQT01.SY-COLR-CD-ID;

  SYCREC.XDMCD = VTORQT01.XDM-DIM-CD;

  TI0FS-IO0560-S();

  if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

    TIWREC.XXX-MSG-LOC-ID = "41000"; /* Message location*/
    converseLib.validationFailed(58); /* No data was found to display*/

    exit stack; /* Exit to display map*/

  end

  TI0FW04.SY-STY-NM = SYCREC.SY1STYNM;

  TI0FW05.SY-STY-NM = SYCREC.SY1STYNM;

  set SY1REC empty; /* Clear row storage area*/

  SY1REC.XGPCD = VTORQT01.XGP-GPC-CD;

  SY1REC.SY1STNBR = VTORQT01.SY-STY-NBR;

  TI0FS-IO0120-S();

  if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

    TIWREC.XXX-MSG-LOC-ID = "41000"; /* Message location*/
    converseLib.validationFailed(59); /* No data was found to display*/

    exit stack; /* Exit to display map*/

  end

  set SY4REC empty; /* Clear row storage area*/

  SY4REC.SY4SZSCL = SY1REC.SY4SZSCL;
  TI0FS-IO0040-S();

  if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

    TIWREC.XXX-MSG-LOC-ID = "41000"; /* Message location*/
    converseLib.validationFailed(60); /* No data was found to display*/

    exit stack; /* Exit to display map*/

  end

  set TIXREC empty;

  set SQLCA empty;

  set VTOITM01 empty;

  TI0FW00.TI0FW-TI9910-CALL-ACTION = "SS";

  TIXREC.TIX-GROUP = TI0FW00.TI0FW-TI9910-CALL-GROUP;

  VTOITM01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

  VTOITM01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

  VTOITM01.TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;

  TI0FS-TI9910-SS();

  TI0FW00.TI0FW-TI9910-CALL-GROUP = TIXREC.TIX-GROUP;

  if (SQLCA.VAGen_SQLCODE == -305)

    TI0FW04.TI0FW-TOT-ON-ORD-QTY = 0;

  else

    TI0FW04.TI0FW-TOT-ON-ORD-QTY = VTOITM01.TI-ON-ORD-QTY;

  end

  set TIXREC empty;

  set SQLCA empty;

  set VTRMSG01 empty;

  TI0FW00.TI0FW-TI9920-CALL-ACTION = "SC";

  TI0FW00.TI0FW-VTRMSG01-COUNT = 0;

  TIXREC.TIX-GROUP = TI0FW00.TI0FW-TI9920-CALL-GROUP;

  VTRMSG01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

  VTRMSG01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

  VTRMSG01.TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;

  TI0FS-TI9920-SC();

  TI0FW00.TI0FW-TI9920-CALL-GROUP = TIXREC.TIX-GROUP;

  if (SQLCA.VAGen_SQLCODE == -305)

    TI0FW04.TI0FW-TI-CUTK-MSG-CD-TXT = "NO ";

    set TI0FM004.TI0FW-TI-CUTK-MSG-CD-TXT noHighLight, blue;

  else
    if (TI0FW-VTRMSG01-COUNT == 0)

      TI0FW04.TI0FW-TI-CUTK-MSG-CD-TXT = "NO ";

      set TI0FM004.TI0FW-TI-CUTK-MSG-CD-TXT noHighLight, blue;

    else

      TI0FW04.TI0FW-TI-CUTK-MSG-CD-TXT = "YES";

      set TI0FM004.TI0FW-TI-CUTK-MSG-CD-TXT initialAttributes;

    end

  end


  if (converseVar.validationMsgNum == 0)
    if (converseVar.eventKey is pf11)
      if (TI0FW04.TI-CUTK-STAT-CD == "ST"
       || TI0FW04.TI-CUTK-STAT-CD == "SS")
        if (TI0FW04.TI-CUTK-SNT-DT > 0)
          if (TI0FW04.TI0FW-PF11-CONFIRM-FL != "Y")
            TI0FW04.TI0FW-PF11-CONFIRM-FL = "Y";
            converseLib.validationFailed(108); /* press pf11 to confirm resend*/
          end
        else
          TI0FW04.TI0FW-PF11-CONFIRM-FL = "N";
          converseLib.validationFailed(114); /* invalid sent dt for resend*/
        end
      else
        TI0FW04.TI0FW-PF11-CONFIRM-FL = "N";
        converseLib.validationFailed(110); /* invalid status for resend*/
      end
    end
  end


  TI0FW04.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

  TI0FW04.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

  TI0FW04.TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;

  TI0FW04.OP-LINE-ITEM-NBR = VTORQT01.OP-LINE-ITEM-NBR;

  return;
end // end TI0F-41000

// Obtain the data to display
Function TI0F-41100()
  TI0FW00.TI0FW-TI0FW02-PAGE-TO-READ = TI0FW00.TI0FW-TI0FW02-PAGE-TO-READ + 1;

  if (TI0FW00.TI0FW-TI0FW02-PAGE-TO-READ > TI0FW00.TI0FW-M002-HI-PAGE-NBR)

    TIWREC.XXX-MSG-LOC-ID = "41100"; /* Message location*/

    converseLib.validationFailed(18); /* No data was found to display*/

    exit stack; /* Exit to display map*/

  end

  TI0FW00.TI0FW-SELECTED-ROW-FOUND-FL = "N";

  while ((TI0FW00.TI0FW-TI0FW02-PAGE-TO-READ
   <= TI0FW00.TI0FW-M002-HI-PAGE-NBR
   && TI0FW00.TI0FW-SELECTED-ROW-FOUND-FL != "Y"))

    TA5REC.TA5TSQIX = TI0FW00.TI0FW-TI0FW02-PAGE-TO-READ;

    TI0FS-TI0FW02-TR();

    TI0FW00.XXX-INX-FLD-NBR = 1;

    while ((TI0FW00.XXX-INX-FLD-NBR <= TI0FW00.XXX-INX-LMT-NBR
     && TI0FW00.TI0FW-SELECTED-ROW-FOUND-FL != "Y"))

      if (TI0FW02.TI0FW-SELECT[XXX-INX-FLD-NBR] == "S")

        TI0FW00.TI0FW-SELECTED-ROW-FOUND-FL = "Y";

      end

      TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;

    end /* WHILE (TI0FW00.XXX-INX-FLD-NBR LE TI0FW00.XXX-INX-LMT-NBR*/
       /* AND TI0FW00.TI0FW-SELECTED-ROW-FOUND-FL NE 'Y')*/

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

    if (TI0FW00.TI0FW-SELECTED-ROW-FOUND-FL != "Y")

      TI0FW00.TI0FW-TI0FW02-PAGE-TO-READ = TI0FW00.TI0FW-TI0FW02-PAGE-TO-READ + 1;

    end

  end /* while (TI0FW00.TI0FW-TI0FW02-PAGE-TO-READ*/
     /* le TI0FW00.TI0FW-M002-HI-PAGE-NBR*/
     /* OR TI0FW00.TI0FW-SELECTED-ROW-FOUND-FL NE 'Y')*/

  if (TI0FW00.TI0FW-SELECTED-ROW-FOUND-FL == "Y")

    TI0FW02.TI0FW-SELECT[XXX-INX-FLD-NBR] = "V";
    TI0FM002.TI0FW-SELECT[XXX-INX-FLD-NBR] = "V";

    TA5REC.TA5TSQIX = TI0FW00.TI0FW-TI0FW02-PAGE-TO-READ;

    TI0FS-TI0FW02-TU();

  else

    TI0FW00.TI0FW-TI0FW02-PAGE-TO-READ = 0;

    if (TI0FW-PREVIOUS-SCREEN-IND == 2)

      TI0FW00.XXX-MAP-DSP-CD = "2";

    end

    if (TI0FW-PREVIOUS-SCREEN-IND == 3)

      TI0FW00.XXX-MAP-DSP-CD = "3";

    end

    TI0FW00.XXX-RQT-DATA-FL = "N";

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    TI0FW00.TI0FW-A-ROW-WAS-SELECTED-FL = "N";

    exit stack;
  end

  TI0FW00.TI0FW-TI0FW02-PAGE-TO-READ = TI0FW00.TI0FW-TI0FW02-PAGE-TO-READ - 1;

   /* ------------------------------------------------------------*/
   /* If no message (EZERTN above), reset the page number to display.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

   /* ------------------------------------------------------------*/
   /* Initialize screen M002 storage record.*/
   /* ------------------------------------------------------------*/

  set TI0FW04 empty; /* M002 display storage*/

   /* ------------------------------------------------------------*/
   /* Get ticket order request DCUTKT.VTORQT01*/
   /* ------------------------------------------------------------*/

  set VTORQT01 empty; /* Clear row storage area*/

  VTORQT01.OP-CUST-ORD-ID = TI0FW02.OP-CUST-ORD-ID[XXX-INX-FLD-NBR];

  VTORQT01.OP-NIKE-ORD-ID = TI0FW02.OP-NIKE-ORD-ID[XXX-INX-FLD-NBR];

  VTORQT01.TI-CUTK-RQT-NBR = TI0FW02.TI-CUTK-RQT-NBR[XXX-INX-FLD-NBR];

  TI0FS-VTORQT01-S();

  if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

    TIWREC.XXX-MSG-LOC-ID = "41100"; /* Message location*/
    converseLib.validationFailed(18); /* No data was found to display*/

    set TI0FM002.TI0FW-SALES-ORD-ID[XXX-INX-FLD-NBR] cursor, bold;

    exit stack; /* Exit to display map*/

  end
end // end TI0F-41100

// Obtain the data to display
Function TI0F-41200()
  TI0FW00.TI0FW-TI0FW03-PAGE-TO-READ = TI0FW00.TI0FW-TI0FW03-PAGE-TO-READ + 1;

  if (TI0FW00.TI0FW-TI0FW03-PAGE-TO-READ > TI0FW00.TI0FW-M003-HI-PAGE-NBR)

    TIWREC.XXX-MSG-LOC-ID = "41200"; /* Message location*/
    converseLib.validationFailed(18); /* No data was found to display*/

     /* PAGES TO READ SHOULD NEVER BE GREATER THAT HIGH PAGES*/

    exit stack; /* Exit to display map*/

  end

  TI0FW00.TI0FW-SELECTED-ROW-FOUND-FL = "N";

  while ((TI0FW00.TI0FW-TI0FW03-PAGE-TO-READ
   <= TI0FW00.TI0FW-M003-HI-PAGE-NBR
   && TI0FW00.TI0FW-SELECTED-ROW-FOUND-FL != "Y"))

    TA5REC.TA5TSQIX = TI0FW00.TI0FW-TI0FW03-PAGE-TO-READ;

    TI0FS-TI0FW03-TR();

    TI0FW00.XXX-INX-FLD-NBR = 1;

    while ((TI0FW00.XXX-INX-FLD-NBR <= TI0FW00.XXX-INX-LMT-NBR
     && TI0FW00.TI0FW-SELECTED-ROW-FOUND-FL != "Y"))

      if (TI0FW03.TI0FW-SELECT[XXX-INX-FLD-NBR] == "S")

        TI0FW00.TI0FW-SELECTED-ROW-FOUND-FL = "Y";

      end

      TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR + 1;

    end /* WHILE (TI0FW00.XXX-INX-FLD-NBR LE TI0FW00.XXX-INX-LMT-NBR*/
       /* AND TI0FW00.TI0FW-SELECTED-ROW-FOUND-FL NE 'Y')*/

    TI0FW00.XXX-INX-FLD-NBR = TI0FW00.XXX-INX-FLD-NBR - 1;

    if (TI0FW00.TI0FW-SELECTED-ROW-FOUND-FL != "Y")

      TI0FW00.TI0FW-TI0FW03-PAGE-TO-READ = TI0FW00.TI0FW-TI0FW03-PAGE-TO-READ + 1;

    end

  end /* while (TI0FW00.TI0FW-TI0FW03-PAGE-TO-READ*/
     /* le TI0FW00.TI0FW-m003-HI-PAGE-NBR*/
     /* OR TI0FW00.TI0FW-SELECTED-ROW-FOUND-FL NE 'Y')*/

  if (TI0FW00.TI0FW-SELECTED-ROW-FOUND-FL == "Y")

    TI0FW03.TI0FW-SELECT[XXX-INX-FLD-NBR] = "V";
    TI0FM003.TI0FW-SELECT[XXX-INX-FLD-NBR] = "V";

    TA5REC.TA5TSQIX = TI0FW00.TI0FW-TI0FW03-PAGE-TO-READ;

    TI0FS-TI0FW03-TU();

  else

    TI0FW00.TI0FW-TI0FW03-PAGE-TO-READ = 0;

    TI0FW00.XXX-MAP-DSP-CD = "3";

    TI0FW00.XXX-RQT-DATA-FL = "N";

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    TI0FW00.TI0FW-A-ROW-WAS-SELECTED-FL = "N";

    exit stack;
  end

  TI0FW00.TI0FW-TI0FW03-PAGE-TO-READ = TI0FW00.TI0FW-TI0FW03-PAGE-TO-READ - 1;

   /* ------------------------------------------------------------*/
   /* If no message (EZERTN above), reset the page number to display.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

   /* ------------------------------------------------------------*/
   /* Initialize screen m003 storage record.*/
   /* ------------------------------------------------------------*/

  set TI0FW04 empty; /* m003 display storage*/

   /* ------------------------------------------------------------*/
   /* Get ticket order request DCUTKT.VTORQT01*/
   /* ------------------------------------------------------------*/

  set VTORQT01 empty; /* Clear row storage area*/

  VTORQT01.OP-CUST-ORD-ID = TI0FW03.OP-CUST-ORD-ID[XXX-INX-FLD-NBR];

  VTORQT01.OP-NIKE-ORD-ID = TI0FW03.OP-NIKE-ORD-ID[XXX-INX-FLD-NBR];

  VTORQT01.TI-CUTK-RQT-NBR = TI0FW03.TI-CUTK-RQT-NBR[XXX-INX-FLD-NBR];

  TI0FS-VTORQT01-S();

  if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

    TIWREC.XXX-MSG-LOC-ID = "41200"; /* Message location*/
    converseLib.validationFailed(18); /* No data was found to display*/

    set TI0FM003.TI0FW-SALES-ORD-ID[XXX-INX-FLD-NBR] cursor, bold;

    exit stack; /* Exit to display map*/

  end
end // end TI0F-41200

// Format and converse the map
Function TI0F-42000()
   /* ------------------------------------------------------------*/
   /* If an error was found, save the error message number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    TIWREC.XXX-MSG-NBR = converseVar.validationMsgNum; /* Message number*/
  end

  TI0FW00.XXX-RQT-DATA-FL = "N";

   /* ------------------------------------------------------------*/
   /* If the map must be formatted, format the data in the map.*/
   /* ------------------------------------------------------------*/

  if (TI0FW00.XXX-MAP-FMAT-FL == "Y") /* Map must be formatted*/
    TI0F-42100(); /* Format the data in the map*/
  end

   /* ------------------------------------------------------------*/
   /* Format the current date and any FAST PATH information.*/
   /* ------------------------------------------------------------*/

  TI0FM004.XXX-CURR-DT = VGVar.currentShortGregorianDate; /* Current date*/

  if (TI0FWCA1.CATOAP > " ")

    TI0FM004.CATOAP = TIWREC.CATOAP;
    TI0FWCA1.CATOAP = " ";

  else

    TI0FM004.CATOAP = COMMAREA.CATOAP; /* TO application*/

  end

  if (TI0FWCA1.CAITEM > " ")

    TI0FM004.CAITEM = TI0FWCA1.CAITEM;
    TI0FWCA1.CAITEM = " ";

  else

    TI0FM004.CAITEM = COMMAREA.CAITEM; /* Application data*/

  end

   /* ------------------------------------------------------------*/
   /* If a message to display, indicate sound audible alarm.*/
   /* ------------------------------------------------------------*/

  if (TIWREC.XXX-MSG-NBR != 0 /* Message to display*/
   || COMMAREA.CAMSG != " ")  /* or message text*/

    if (TIWREC.XXX-MSG-NBR != 0) /* Message to display*/

      if (TIWREC.XXX-MSG-NBR == 9999)
        converseLib.validationFailed();
      else
        converseLib.validationFailed(TIWREC.XXX-MSG-NBR);
      end /* Message number*/

    else

      TI0FM004.VAGen_EZEMSG = COMMAREA.CAMSG; /* Message text*/

    end

    TI0FM004.XXX-MSG-LOC-ID = TIWREC.XXX-MSG-LOC-ID;
    TI0FM004.TI0FM-HYPHEN = "-";
                                  /* Message location*/
    set TI0FM004 alarm; /* Indicate sound alarm*/

  end

  converse TI0FM004 ;

   /* ------------------------------------------------------------*/
   /* Clear the message fields and save FAST PATH information.*/
   /* ------------------------------------------------------------*/

  TIWREC.XXX-MSG-LOC-ID = " "; /* Message location*/
  TIWREC.XXX-MSG-NBR = 0; /* Message number*/
  COMMAREA.CAMSG = " "; /* Message text*/

  COMMAREA.CATOAP = TI0FM004.CATOAP; /* TO application*/
  COMMAREA.CAITEM = TI0FM004.CAITEM; /* Application data*/

  set TI0FM004.CATOAP normal; /* TO application*/
  set TI0FM004.CAITEM normal; /* Application data*/

  if (TI0FW-PREVIOUS-SCREEN-IND == 2)

    TI0FW02.TI0FW-SELECT[XXX-INX-FLD-NBR] = "V";
    TI0FM002.TI0FW-SELECT[XXX-INX-FLD-NBR] = "V";

  end
   /*  */
   /* IF TI0FW-PREVIOUS-SCREEN-IND = 3*/
   /*  */
   /* MOVE 'V' TO TI0FW03.TI0FW-SELECT(XXX-INX-FLD-NBR)*/
   /* MOVE 'V' TO TI0FM003.TI0FW-SELECT(XXX-INX-FLD-NBR)*/
   /*  */
   /* END*/
end // end TI0F-42000

// Format the data in the map
Function TI0F-42100()
  set TI0FM004 initial; /* M004 input/output area*/

  TI0FW00.XXX-MAP-FMAT-FL = "N"; /* Format the map flag*/

  TI0FM004.TI-CUTK-STAT-CD = TI0FW04.TI-CUTK-STAT-CD;

  TI0FM004.TI-CUTK-STAT-DESC = TI0FW04.TI-CUTK-STAT-DESC;

  TI0FM004.CU-BUY-SESN-ID = TI0FW04.CU-BUY-SESN-ID;

  TI0FM004.TI0FW-TI-CUTK-MSG-CD-TXT = TI0FW04.TI0FW-TI-CUTK-MSG-CD-TXT;

  TI0FM004.TI-CUTK-SPLR-CD = TI0FW04.TI-CUTK-SPLR-CD;

  if (TI0FW04.TI-CUTK-SPLR-CD > " ")

    TI0FM004.TI0FW-TI-CUTK-SPLR-CD-HYPHEN = "-";

    set TI0FM004.TI0FW-TI-CUTK-SPLR-CD-HYPHEN initialAttributes;

    TI0FM004.TI-CUTK-SPLR-NM = TI0FW04.TI-CUTK-SPLR-NM;

  else

    TI0FM004.TI0FW-TI-CUTK-SPLR-CD-HYPHEN = " ";

    set TI0FM004.TI0FW-TI-CUTK-SPLR-CD-HYPHEN skip, invisible;

    TI0FM004.TI-CUTK-SPLR-NM = " ";

  end

  TI0FM004.TI-CUTK-XMIT-CD = TI0FW04.TI-CUTK-XMIT-CD;

  if (TI0FM004.TI-CUTK-XMIT-CD > " ")

    TI0FM004.TI0FW-TI-CUTK-XMIT-CD-HYPHEN = "-";

    set TI0FM004.TI0FW-TI-CUTK-XMIT-CD-HYPHEN initialAttributes;

    TI0FM004.TI-CUTK-XMIT-ABRV = TI0FW04.TI-CUTK-XMIT-ABRV;

  else

    TI0FM004.TI0FW-TI-CUTK-XMIT-CD-HYPHEN = " ";

    set TI0FM004.TI0FW-TI-CUTK-XMIT-CD-HYPHEN skip, invisible;

    TI0FM004.TI-CUTK-XMIT-ABRV = " ";

  end

  TI0FM004.TI0FW-CUTK-EST-SND-DT = TI0FW04.TI0FW-CUTK-EST-SND-DT;

  TI0FM004.TI0FW-CUTK-EST-SND-DT-FORMAT = " ";

  set TI0FM004.TI0FW-CUTK-EST-SND-DT-FORMAT skip, invisible;

  TI0FM004.TI0FW-CUTK-SNT-DT = TI0FW04.TI0FW-CUTK-SNT-DT;

  TI0FM004.TI-CUTK-SEND-CD = TI0FW04.TI-CUTK-SEND-CD;

  TI0FM004.TI0FW-CUTK-RQT-RVW-DT = TI0FW04.TI0FW-CUTK-RQT-RVW-DT;

  if (TI0FM004.TI-CUTK-SEND-CD > "  ")

    TI0FM004.TI0FW-TI-CUTK-SEND-CD-HYPHEN = "-";

    set TI0FM004.TI0FW-TI-CUTK-SEND-CD-HYPHEN initialAttributes;

    TI0FM004.TI-CUTK-SEND-DESC = TI0FW04.TI-CUTK-SEND-DESC;

  else

    TI0FM004.TI0FW-TI-CUTK-SEND-CD-HYPHEN = " ";

    set TI0FM004.TI0FW-TI-CUTK-SEND-CD-HYPHEN skip, invisible;

    TI0FM004.TI-CUTK-SEND-DESC = " ";

  end

  if (TI0FW00.TI0FW-M004-CHG-FL == "Y")

    if (COMMAREA.CACLVL[4] == "Y"
     && TI0FM004.TI-CUTK-SEND-CD != "  "
     && TI0FM004.TI-CUTK-SEND-CD != "A ")

      set TI0FM004.TI-CUTK-SEND-CD cursor, initialAttributes;

    else

      set TI0FM004.TI-CUTK-SEND-CD blue, noHighLight, skip;

    end

    if (COMMAREA.CACLVL[7] == "Y"
    )
      set TI0FM004.TI0FW-CUTK-EST-SND-DT cursor, initialAttributes;

      TI0FM004.TI0FW-CUTK-EST-SND-DT-FORMAT = "(MM/DD/YY)";

      set TI0FM004.TI0FW-CUTK-EST-SND-DT-FORMAT initialAttributes;

    else

      set TI0FM004.TI0FW-CUTK-EST-SND-DT blue, noHighLight, skip;

      TI0FM004.TI0FW-CUTK-EST-SND-DT-FORMAT = "          ";

      set TI0FM004.TI0FW-CUTK-EST-SND-DT-FORMAT skip, invisible;

    end

    if (COMMAREA.CACLVL[6] == "Y"
    )
      set TI0FM004.TI-CUTK-XMIT-CD cursor, initialAttributes;

    else

      set TI0FM004.TI-CUTK-XMIT-CD blue, noHighLight, skip;

    end

    if (COMMAREA.CACLVL[5] == "Y"
    )
      set TI0FM004.TI-CUTK-SPLR-CD cursor, initialAttributes;

    else

      set TI0FM004.TI-CUTK-SPLR-CD blue, noHighLight, skip;

    end

  else

    set TI0FM004.TI-CUTK-SPLR-CD blue, noHighLight, skip;

    set TI0FM004.TI-CUTK-XMIT-CD blue, noHighLight, skip;

    set TI0FM004.TI-CUTK-SEND-CD blue, noHighLight, skip;

    set TI0FM004.TI0FW-CUTK-EST-SND-DT blue, noHighLight, skip;

    set TI0FM004.CATOAP cursor;

  end

  TI0FM004.TI0FW-CUSTOMER-ID = TI0FW04.TI0FW-CUSTOMER-ID;

  TI0FM004.CU-CO-SHORT-NM = TI0FW04.CU-CO-SHORT-NM;

  TI0FM004.TI0FW-PC-PO-ID = TI0FW04.TI0FW-PC-PO-ID;

  TI0FM004.FY-FCTY-CD = TI0FW04.FY-FCTY-CD;

  TI0FM004.TI0FW-SALES-ORD-ID = TI0FW04.TI0FW-SALES-ORD-ID;

  TI0FM004.TI-CUTK-RQT-NBR = TI0FW04.TI-CUTK-RQT-NBR;

  TI0FM004.PC-PO-NBR = TI0FW04.PC-PO-NBR;

  TI0FM004.XCT-CTRY-ABRV = TI0FW04.XCT-CTRY-ABRV;

  TI0FM004.TI0FW-OP-CUST-NEED-DT = TI0FW04.TI0FW-OP-CUST-NEED-DT;

  TI0FM004.XOS-ORD-STAT-CD = TI0FW04.XOS-ORD-STAT-CD;

  TI0FM004.PC-PRDCU-ID = TI0FW04.PC-PRDCU-ID;

  TI0FM004.TI0FW-STYLE-COLR = TI0FW04.TI0FW-STYLE-COLR;

  TI0FM004.SY-STY-NM = TI0FW04.SY-STY-NM;

  TI0FM004.TI0FW-TOT-ON-ORD-QTY = TI0FW04.TI0FW-TOT-ON-ORD-QTY;

   /* MOVE 1 TO TI0FW00.XXX-INX-FLD-NBR*/
end // end TI0F-42100

// Check attention identifier
Function TI0F-43000()
  if (converseVar.eventKey is pf4) /* PF1 was pressed*/

    COMMAREA.CATOAP = "MN0M"; /* System Menu*/

    XSTIS-EXIT(); /* Exit to another application*/

    exit stack; /* Exit to display map*/

  end

  if (converseVar.eventKey is pf3) /* PF1 was pressed*/

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    return; /* Exit to display map*/

  end

  if (converseVar.eventKey is pa2) /* PA2 was pressed*/

    if (TI0FW00.XXX-RQT-DATA-FL == "Y") /* Request for data pending*/
      set TI0FW01 empty; /* M001 display storage*/
    end

    TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

    TI0FW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    COMMAREA.CATOAP = " "; /* TO application*/
    COMMAREA.CAITEM = " "; /* Application data*/

    exit stack; /* Exit to display map*/

  end

  if (TI0FM004.CATOAP > " " /* FAST PATH was requested*/
   && converseVar.eventKey not pf1)

    if (converseVar.eventKey is enter) /* ENTER was pressed*/

      XSTIS-EXIT(); /* Exit to another application*/

      set TI0FM004.CATOAP cursor, bold; /* Highlight*/

    else

      TIWREC.XXX-MSG-LOC-ID = "43000"; /* Message location*/

      converseLib.validationFailed(5); /* PA/PF key may not be used*/

    end

    exit stack; /* Exit to display map*/

  end

  if (converseVar.eventKey is pf6)

    if (TI0FW-M004-CHG-FL == "Y")

      TIWREC.XXX-MSG-LOC-ID = "43000";

      converseLib.validationFailed(66);

      exit stack;

    end

    if (COMMAREA.CACHGFL == "Y")

      TI0FS-CACHGLVL-ED();

      if (converseVar.validationMsgNum != 0)

        TIWREC.XXX-MSG-LOC-ID = "43000";

        exit stack;

      end

    else

      TIWREC.XXX-MSG-LOC-ID = "43000";

      converseLib.validationFailed(63);

      exit stack;

    end

    TI0FW00.TI0FW-M004-CHG-FL = "Y";

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    exit stack;

  end

  if (converseVar.eventKey is pf11)
    if (COMMAREA.CACHGFL == "Y")

      TI0FS-CACHGLVL-11();

      if (converseVar.validationMsgNum != 0)

        TIWREC.XXX-MSG-LOC-ID = "43000";

        exit stack;

      end

    else

      TIWREC.XXX-MSG-LOC-ID = "43000";

      converseLib.validationFailed(111); /* not authorized for resends*/

      exit stack;

    end

    if (TI0FW04.TI-CUTK-STAT-CD != "ST"
     && TI0FW04.TI-CUTK-STAT-CD != "SS"
    )
      TIWREC.XXX-MSG-LOC-ID = "43000";

      converseLib.validationFailed(110); /* invalid status for resends*/

      exit stack;

    end

  end

  if (converseVar.eventKey not enter /* RETURN*/
   && converseVar.eventKey not pf1   /* HELP*/
   && converseVar.eventKey not pf9   /* ERROR POPUP*/
   && converseVar.eventKey not pf10  /* DETAIL SIZES*/
   && converseVar.eventKey not pf11) /* RESEND TICKETS*/

    TIWREC.XXX-MSG-LOC-ID = "43000";

    converseLib.validationFailed(4);

    if (converseVar.eventKey is pakey)

      converseLib.clearScreen();

    end

    exit stack;

  end
end // end TI0F-43000

// Verify data that was entered
Function TI0F-44000()
  if (converseVar.eventKey is pf1) /* HELP*/

    return;

  end
   /* ------------------------------------------------------------*/
   /* Highlight any application data that was entered.*/
   /* ------------------------------------------------------------*/

  if (TI0FM001.CAITEM > " ") /* Application data was entered*/

    TIWREC.XXX-MSG-LOC-ID = "44000"; /* Message location*/
    converseLib.validationFailed(7); /* Enter only with FAST PATH*/

    set TI0FM004.CAITEM cursor, bold; /* Highlight*/

    exit stack;

  end

  if (converseVar.eventKey is enter)

    if (TI0FW00.TI0FW-M004-CHG-FL == "Y")

      if (TI0FM004.TI-CUTK-SEND-CD != TI0FW04.TI-CUTK-SEND-CD)

        if (TI0FM004.TI-CUTK-SEND-CD != "Y "
         && TI0FM004.TI-CUTK-SEND-CD != "X "
         && TI0FM004.TI-CUTK-SEND-CD != "R "
         && TI0FM004.TI-CUTK-SEND-CD != "N ")

          TIWREC.XXX-MSG-LOC-ID = "44000";

          set TI0FM004.TI-CUTK-SEND-CD cursor, bold; /* Highlight*/

          converseLib.validationFailed(62);

          exit stack;

        end

      end

      if (TI0FM004.TI0FW-CUTK-EST-SND-DT != TI0FW04.TI0FW-CUTK-EST-SND-DT)

        TA2REC.TA2GRGB = TI0FM004.TI0FW-CUTK-EST-SND-DT;
        TA2REC.TA2GRTYP = "B";
        TA2REC.TA2DTOPT = "GREGGREG";

        try
          call "TA0040" (TA2REC) {isNoRefresh = yes, isExternal = yes};
        end /* date convert*/

        if (sysVar.errorCode == "00000000") /* Good system return code*/

          if (TA2RTNCD == 222)

            TIWREC.XXX-MSG-LOC-ID = "44000"; /* Message location*/

            converseLib.validationFailed(70); /* Field missing or invalid*/

            set TI0FM004.TI0FW-CUTK-EST-SND-DT cursor, bold;

            exit stack;

          end

        end

      end

      if (TI0FM004.TI-CUTK-XMIT-CD != TI0FW04.TI-CUTK-XMIT-CD)

        set VTOXCD01 empty;

        VTOXCD01.TI-CUTK-XMIT-CD = TI0FM004.TI-CUTK-XMIT-CD;

        TI0FS-VTOXCD01-S();

        if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

          TIWREC.XXX-MSG-LOC-ID = "44000";

          set TI0FM004.TI-CUTK-XMIT-CD cursor, bold; /* Highlight*/

          converseLib.validationFailed(61);

          exit stack;

        end

      end

      if (TI0FM004.TI-CUTK-SPLR-CD != TI0FW04.TI-CUTK-SPLR-CD)

        set VTOPCD01 empty;

        VTOPCD01.TI-CUTK-SPLR-CD = TI0FM004.TI-CUTK-SPLR-CD;

        TI0FS-VTOPCD01-S();

        if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

          TIWREC.XXX-MSG-LOC-ID = "44000";

          set TI0FM004.TI-CUTK-SPLR-CD cursor, bold; /* Highlight*/

          converseLib.validationFailed(54);

          exit stack;

        end

      end

      if (TI0FM004.TI-CUTK-XMIT-CD != TI0FW04.TI-CUTK-XMIT-CD
       || TI0FM004.TI-CUTK-SPLR-CD != TI0FW04.TI-CUTK-SPLR-CD)

        set VTSPXM01 empty;

        VTSPXM01.TI-CUTK-SPLR-CD = TI0FM004.TI-CUTK-SPLR-CD;

        VTSPXM01.TI-CUTK-XMIT-CD = TI0FM004.TI-CUTK-XMIT-CD;

        TI0FS-VTSPXM01-S();

        if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

          TIWREC.XXX-MSG-LOC-ID = "44000";

          set TI0FM004.TI-CUTK-SPLR-CD cursor, bold; /* Highlight*/

          set TI0FM004.TI-CUTK-XMIT-CD bold; /* Highlight*/

          converseLib.validationFailed(69);

          exit stack;

        end

      end

      TI0FW00.TI0FW-VTORQT01-CHG-FL = "Y";

      TI0FW00.TI0FW-M004-CHG-FL = "N";

    end

  end

  if (converseVar.eventKey is pf9)

    if (TI0FM004.TI0FW-TI-CUTK-MSG-CD-TXT == "NO ")

      TIWREC.XXX-MSG-LOC-ID = "44000";
      converseLib.validationFailed(77);

      exit stack;

    end

  end
end // end TI0F-44000

// Process valid input request
Function TI0F-45000()
  if (converseVar.eventKey is pf1)

    TIWREC.XXX-MSG-LOC-ID = "45000";
    TIWREC.XXX-MSG-NBR = 0;

    TIWREC.TI-CUTK-XMIT-CD = " ";
    COMMAREA.CAUSERA = TIWREC.CAUSERA;

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    TI0FWCA1.TI0FWCA1-TI0FW00 = TI0FW00.TI0FW00-REC;

    TI0FWCA1.TI0FWCA1-TI0FW02 = TI0FW02.TI0FW02-REC;

    TI0FWCA1.XXX-MSG-LOC-ID = TIWREC.XXX-MSG-LOC-ID;

    TI0FWCA1.XXX-MSG-NBR = TIWREC.XXX-MSG-NBR;

    TI0FWCA1.TI-CUTK-XMIT-CD = TIWREC.TI-CUTK-XMIT-CD;

    TI0FWCA1.CATOAP = TI0FM004.CATOAP;

    TI0FWCA1.CAITEM = TI0FM004.CAITEM;

    COMMAREA.CA-USER-WORKAREA-2K-B = TI0FWCA1.TI0FWCA1-REC;
    TI0FWCA2.TI0FWCA2-TI0FW01 = TI0FW01.TI0FW01-REC;

    TI0FWCA2.TI0FWCA2-TI0FW03 = TI0FW03.TI0FW03-REC;

    TI0FWCA2.TI0FWCA2-TI0FW04 = TI0FW04.TI0FW04-REC;

    TI0FWCA2.TI0FWCA2-TI0FW05 = TI0FW05.TI0FW05-REC;

    COMMAREA.CA-USER-WORKAREA-2K-C = TI0FWCA2.TI0FWCA2-REC;
    COMMAREA.CAFROMAP = "TI0F";

    COMMAREA.CACURRAP = "TI0F";

    COMMAREA.CATOAP = "GD01";

    COMMAREA.CAITEM = "TI0FM004";

    XSTIS-EXIT();

    set TI0FM001.CATOAP cursor, bold;

    TI0FW00.XXX-MAP-DSP-CD = "4";

    TIWREC.XXX-MSG-LOC-ID = "45000";
    converseLib.validationFailed(78);

    exit stack;

  end
   /* ------------------------------------------------------------*/
   /* If scroll backward was requested, decrement the page number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf3) /* Scroll back requested*/

    TI0FW00.TI0FW-VTORQT01-CHG-FL = "N";

    TI0FW00.TI0FW-M004-CHG-FL = "N";

    if (TI0FW-PREVIOUS-SCREEN-IND == 2)

      TI0FW00.XXX-MAP-DSP-CD = "2";

    end

    if (TI0FW-PREVIOUS-SCREEN-IND == 3)

      TI0FW00.XXX-MAP-DSP-CD = "3";

    end

    exit stack;

  end

  if (converseVar.eventKey is pf6) /* Scroll back requested*/

    /* MOVE 'Y' TO TI0FW00.TI0FW-VTORQT01-CHG-FL;*/
    TI0FW00.TI0FW-M004-CHG-FL = "Y";

    exit stack; /* Return to previous process*/

  end

  if (converseVar.eventKey is pf9)

    TI0FW00.XXX-MAP-DSP-CD = "7";

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    TI0FW00.XXX-RQT-DATA-FL = "Y";

    exit stack;
  end

  if (converseVar.eventKey is pf10)

    TI0FW00.XXX-MAP-DSP-CD = "5";

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    TI0FW00.XXX-RQT-DATA-FL = "Y";

    exit stack;
  end

  if (converseVar.eventKey is enter) /* Scroll forward requested*/

    if (TI0FW00.TI0FW-VTORQT01-CHG-FL == "Y")

      TI0FW00.TI0FW-VTORQT01-CHG-FL = "N";

      TI0FW00.TI0FW-M004-CHG-FL = "N";

      set VTORQT01 empty;
      VTORQT01.OP-CUST-ORD-ID = TI0FW04.OP-CUST-ORD-ID;

      VTORQT01.OP-NIKE-ORD-ID = TI0FW04.OP-NIKE-ORD-ID;

      VTORQT01.TI-CUTK-RQT-NBR = TI0FW04.TI-CUTK-RQT-NBR;

      TI0FS-VTORQT01-S();

      if (TI0FM004.TI-CUTK-SEND-CD != TI0FW04.TI-CUTK-SEND-CD
       && TI0FM004.TI-CUTK-SEND-CD >= " ")

        VTORQT01.TI-CUTK-SEND-CD = TI0FM004.TI-CUTK-SEND-CD;

        set TA2REC empty;

        TA2REC.TA2DTOPT = "GETDATE ";

        try
          call "TA0040" (TA2REC) {isNoRefresh = yes, isExternal = yes};
        end

        if (sysVar.errorCode == "00000000")

          if (TA2RTNCD != 222)

            VTORQT01.TI-CUTK-RQT-RVW-DT = TA2REC.TA2GRGGN;

          end

        end

      end

      if (TI0FM004.TI-CUTK-SPLR-CD != TI0FW04.TI-CUTK-SPLR-CD
       && TI0FM004.TI-CUTK-SPLR-CD > " ")

        VTORQT01.TI-CUTK-SPLR-CD = TI0FM004.TI-CUTK-SPLR-CD;

      end

      if (TI0FM004.TI-CUTK-XMIT-CD != TI0FW04.TI-CUTK-XMIT-CD
       && TI0FM004.TI-CUTK-XMIT-CD > " ")

        VTORQT01.TI-CUTK-XMIT-CD = TI0FM004.TI-CUTK-XMIT-CD;

      end

      if (TI0FM004.TI0FW-CUTK-EST-SND-DT != TI0FW04.TI0FW-CUTK-EST-SND-DT
       && TI0FM004.TI0FW-CUTK-EST-SND-DT > " ")

        TA2REC.TA2GRGB = TI0FM004.TI0FW-CUTK-EST-SND-DT;

        TA2REC.TA2GRTYP = "B";

        TA2REC.TA2DTOPT = "GREGGREG";

        try
          call "TA0040" (TA2REC) {isNoRefresh = yes, isExternal = yes};
        end /* date convert*/

        if (sysVar.errorCode == "00000000") /* Good system return code*/

          if (TA2RTNCD == 222)

            TIWREC.XXX-MSG-LOC-ID = "45000"; /* Message location*/
            converseLib.validationFailed(70); /* Field missing or invalid*/

            set TI0FM004.TI0FW-CUTK-EST-SND-DT cursor, bold;

            exit stack;

          end

          VTORQT01.TI-CUTK-EST-SND-DT = TA2REC.TA2GRGGN;
        end

      end

      set TA2REC empty;

      TA2REC.TA2DTOPT = "GETDATE ";

      try
        call "TA0040" (TA2REC) {isNoRefresh = yes, isExternal = yes};
      end

      if (sysVar.errorCode == "00000000")

        if (TA2RTNCD != 222)

          VTORQT01.TI-CUTK-RQT-RVW-DT = TA2REC.TA2GRGGN;

          VTORQT01.ZZ-CHNG-DT = TA2REC.TA2GRGGN;

          TI0FW00.TI0FW-WDATE-TIME-NUM = TA2REC.TA2TIMEN;

          VTORQT01.ZZ-CHNG-HHMM = TI0FW00.TI0FW-WDATE-HHMM-NUM;

        end

      end

      TI0FS-VTORQT01-U();

      if (SQLCA.VAGen_SQLCODE == 100)

        TIWREC.XXX-MSG-LOC-ID = "45000";

        converseLib.validationFailed(12);

      else
        TIWREC.XXX-MSG-LOC-ID = "45000";

        converseLib.validationFailed(1);

        TI0FW00.XXX-MAP-FMAT-FL = "Y";

        if (TI0FM004.TI-CUTK-SPLR-CD != TI0FW04.TI-CUTK-SPLR-CD)

          TI0FW04.TI-CUTK-SPLR-CD = TI0FM004.TI-CUTK-SPLR-CD;

          set VTOPCD01 empty;

          VTOPCD01.TI-CUTK-SPLR-CD = TI0FM004.TI-CUTK-SPLR-CD;

          TI0FS-VTOPCD01-S();

          if (SQLCA.VAGen_SQLCODE != 100) /* Abnormal return code*/

            TI0FM004.TI0FW-TI-CUTK-SPLR-CD-HYPHEN = "-";

            set TI0FM004.TI0FW-TI-CUTK-SPLR-CD-HYPHEN initialAttributes;

            TI0FM004.TI-CUTK-SPLR-NM = VTOPCD01.TI-CUTK-SPLR-NM;

          end

          TI0FW04.TI-CUTK-SPLR-CD = TI0FM004.TI-CUTK-SPLR-CD;

          TI0FW04.TI-CUTK-SPLR-NM = TI0FM004.TI-CUTK-SPLR-NM;

        end

        if (TI0FM004.TI-CUTK-XMIT-CD > " ")

          set VTOXCD01 empty;

          VTOXCD01.TI-CUTK-XMIT-CD = TI0FM004.TI-CUTK-XMIT-CD;

          TI0FS-VTOXCD01-S();

          if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

            /* CONTINUE*/

          else

            TI0FM004.TI0FW-TI-CUTK-XMIT-CD-HYPHEN = "-";

            set TI0FM004.TI0FW-TI-CUTK-XMIT-CD-HYPHEN initialAttributes;

            TI0FW04.TI-CUTK-XMIT-ABRV = VTOXCD01.TI-CUTK-XMIT-ABRV;

          end

          TI0FW04.TI-CUTK-XMIT-CD = TI0FM004.TI-CUTK-XMIT-CD;

          TI0FW04.TI-CUTK-XMIT-ABRV = TI0FM004.TI-CUTK-XMIT-ABRV;

        end

        if (TI0FM004.TI-CUTK-SEND-CD != TI0FW04.TI-CUTK-SEND-CD)

          set VTODCD01 empty;

          VTODCD01.TI-CUTK-SEND-CD = VTORQT01.TI-CUTK-SEND-CD;

          TI0FS-VTODCD01-S();
          if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

            TI0FW04.TI-CUTK-SEND-DESC = "SEND CODE NOT IN VTODCD01";

          else

            TI0FM004.TI-CUTK-SEND-DESC = VTODCD01.TI-CUTK-SEND-DESC;

          end

          TI0FW04.TI-CUTK-SEND-CD = TI0FM004.TI-CUTK-SEND-CD;

          TI0FW04.TI-CUTK-SEND-DESC = TI0FM004.TI-CUTK-SEND-DESC;

          TI0FW00.TI0FW-DATE-NUM = VTORQT01.TI-CUTK-RQT-RVW-DT;

          TI0FW00.TI0FW-DATE-WORK = TI0FW00.TI0FW-DATE-NUM;

          TI0FW00.TI0FW-DATE-DISP-MM = TI0FW00.TI0FW-DATE-WRK6-MM;

          TI0FW00.TI0FW-DATE-DISP-SLASH1 = "/";

          TI0FW00.TI0FW-DATE-DISP-DD = TI0FW00.TI0FW-DATE-WRK6-DD;

          TI0FW00.TI0FW-DATE-DISP-SLASH2 = "/";

          TI0FW00.TI0FW-DATE-DISP-YY = TI0FW00.TI0FW-DATE-WRK6-YY;

          TI0FW04.TI0FW-CUTK-RQT-RVW-DT = TI0FW00.TI0FW-DATE-DISPLAY;

          TI0FM004.TI0FW-CUTK-RQT-RVW-DT = TI0FW04.TI0FW-CUTK-RQT-RVW-DT;

        end

        if (TI0FW-PREVIOUS-SCREEN-IND == 2)

          TI0FM002.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] = TI0FM004.TI-CUTK-SEND-CD;

          TI0FW02.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] = TI0FM004.TI-CUTK-SEND-CD;

          TI0FS-TI0FW02-TU();

        end

        if (TI0FW-PREVIOUS-SCREEN-IND == 3)

          TI0FM003.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] = TI0FM004.TI-CUTK-SEND-CD;

          TI0FW03.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] = TI0FM004.TI-CUTK-SEND-CD;

          TI0FS-TI0FW03-TU();

        end

      end

    else

      TI0FW00.XXX-RQT-DATA-FL = "Y";

    end

    exit stack;
  end

  if (converseVar.eventKey is pf11) /* resend function requested*/

    if (TI0FW04.TI0FW-PF11-CONFIRM-FL != "Y")
      TI0FW04.TI0FW-PF11-CONFIRM-FL = "Y";
      converseLib.validationFailed(108); /* /confirm resend*/
      exit stack;
    else

      TI0FW04.TI0FW-PF11-CONFIRM-FL = "N";
      TI0FW00.TI0FW-PF11-IDX = 1;
      set VTORQT01 empty;
      VTORQT01.OP-CUST-ORD-ID = TI0FW04.OP-CUST-ORD-ID;
      VTORQT01.OP-NIKE-ORD-ID = TI0FW04.OP-NIKE-ORD-ID;
      TI0FS-VTORQT01-SX(); /* Select Request Number Maximum*/
      TI0FW04.TI0FW-TI-CUTK-RQT-MAX = VTORQT01.TI-CUTK-RQT-NBR + 1;

      set VTORQT01 empty;
      VTORQT01.OP-CUST-ORD-ID = TI0FW04.OP-CUST-ORD-ID;
      VTORQT01.OP-NIKE-ORD-ID = TI0FW04.OP-NIKE-ORD-ID;
      VTORQT01.OP-LINE-ITEM-NBR = TI0FW04.OP-LINE-ITEM-NBR;
      TI0FS-VTORQT01-SU(); /* Select last VTORQT01 for line item*/

      if (VTORQT01.TI-CUTK-STAT-CD != "ST"
       && VTORQT01.TI-CUTK-STAT-CD != "SS")
        if (VTORQT01.TI-CUTK-RQT-NBR == TI0FW04.TI-CUTK-RQT-NBR)
          converseLib.validationFailed(109); /* invalid status for resend*/
          exit stack;
        else
          converseLib.validationFailed(115); /* invalid status for resend*/
          exit stack;
        end
      else
        if (VTORQT01.TI-CUTK-SNT-DT == 0)
          converseLib.validationFailed(114); /* invalid status for resend*/
          exit stack;
        end
      end

      VTORQT01.TI-CUTK-STAT-CD = "RE"; /* Ready to send status*/
   /* MOVE 'SS' TO VTORQT01.TI-CUTK-STAT-CD;*/
      VTORQT01.TI-CUTK-SEND-CD = " ";
      VTORQT01.TI-CUTK-RQT-RVW-DT = 0;
      VTORQT01.TI-CUTK-SNT-DT = 0;
      VTORQT01.ZZ-CHNG-CNT = 0;
      VTORQT01.TI-CUTK-RQT-NBR = TI0FW04.TI0FW-TI-CUTK-RQT-MAX;

      set TA2REC empty;
      TA2REC.TA2DTOPT = "GETDATE ";
      try
        call "TA0040" (TA2REC) {isNoRefresh = yes, isExternal = yes};
      end

      if (sysVar.errorCode == "00000000")
        if (TA2RTNCD != 222)
          VTORQT01.TI-CUTK-STAT-DT = TA2REC.TA2GRGGN;
          VTORQT01.ZZ-SDT = TA2REC.TA2GRGGN;
          VTORQT01.ZZ-CHNG-DT = TA2REC.TA2GRGGN;
          TI0FW00.TI0FW-WDATE-TIME-NUM = TA2REC.TA2TIMEN;
          VTORQT01.ZZ-CHNG-HHMM = TI0FW00.TI0FW-WDATE-HHMM-NUM;
        end

      end

      TI0FS-VTORQT01-A(); /* Insert VTORQT01 resend*/

      if (SQLCA.VAGen_SQLCODE == 0)

        set VTOITM01 empty;
        TI0FW00.TI0FW-TI9910-CALL-ACTION = "S1";
        TIXREC.TIX-GROUP = TI0FW00.TI0FW-TI9910-CALL-GROUP;
        VTOITM01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;
        VTOITM01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;
        VTOITM01.TI-CUTK-RQT-NBR = TI0FW04.TI-CUTK-RQT-NBR;
        TI0FS-VTOITM01-S1(); /* Open cursor VTOITM01*/

        if (SQLCA.VAGen_SQLCODE == 0)
          TI0FS-VTOITM01-N1(); /* Fetch next VTOITM01*/
          if (SQLCA.VAGen_SQLCODE == 0)

            TI0FW00.TI0FW-TOITM-EOF-FL = "N";
            while (TI0FW00.TI0FW-TOITM-EOF-FL == "N")
              TI0FW00.TI0FW-TI9910-CALL-ACTION = "A ";
              VTOITM01.TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;
              VTOITM01.ZZ-SDT = VTORQT01.ZZ-SDT;
              VTOITM01.ZZ-CHNG-DT = VTORQT01.ZZ-CHNG-DT;
              VTOITM01.ZZ-CHNG-HHMM = VTORQT01.ZZ-CHNG-HHMM;
              TI0FS-VTOITM01-A(); /* Insert VTOITM01*/

              VTOITM01.TI-CUTK-RQT-NBR = TI0FW04.TI-CUTK-RQT-NBR;
              TI0FS-VTOITM01-N1(); /* Fetch next VTOITM01*/
              if (SQLCA.VAGen_SQLCODE == 100)
                TI0FW00.TI0FW-TOITM-EOF-FL = "Y";
              end
            end /* END WHILE*/
            TI0FS-VTOITM01-C1(); /* Close cursor VTOITM01*/
          end
        end

        TI0FW00.TI0FW-PREVIOUS-PF11 = "Y";
        TI0FW00.TI0FW-PF11-OP-CUST-ORD-ID[TI0FW-PF11-IDX] = VTORQT01.OP-CUST-ORD-ID;
        TI0FW00.TI0FW-PF11-OP-NIKE-ORD-ID[TI0FW-PF11-IDX] = VTORQT01.OP-NIKE-ORD-ID;
        TI0FW00.TI0FW-PF11-TI-CUTK-RQT-NBR[TI0FW-PF11-IDX] = VTORQT01.TI-CUTK-RQT-NBR;
        if (TI0FW00.TI0FW-PF11-IDX < 12)
          TI0FW00.TI0FW-PF11-IDX = TI0FW00.TI0FW-PF11-IDX + 1;
        end
      else
        TIWREC.XXX-MSG-LOC-ID = "45000";
        converseLib.validationFailed(12); /* data changed by another application*/
      end

      /* MOVE 'R' TO TI0FW02.TI0FW-SELECT(XXX-INX-FLD-NBR);*/
      /* MOVE 'R' TO TI0FM002.TI0FW-SELECT(XXX-INX-FLD-NBR);*/
      /* TI0FS-TI0FW02-TU;*/

      TI0FW00.XXX-RQT-DATA-FL = "Y"; /* Request for data flag*/
      TI0FW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/
      if (TI0FW-PREVIOUS-SCREEN-IND == 2)
        TI0FW00.XXX-MAP-DSP-CD = "2"; /* Map to be displayed*/
      end
      if (TI0FW-PREVIOUS-SCREEN-IND == 3)
        TI0FW00.XXX-MAP-DSP-CD = "3"; /* Map to be displayed*/
      end
      exit stack;
    end
  end
end // end TI0F-45000

// Main process to display a map
Function TI0F-50000()
   /* ------------------------------------------------------------*/
   /* This is the main process used to display a map.  Processing*/
   /* always returns to the top of this process and falls through*/
   /* subordinate processes until an error is found or a valid*/
   /* request is processed.  Processing sequence is as follows:*/

   /* 1) Obtain the data to display.*/
   /* 2) Format the map output area and display the map.*/
   /* 3) Check the attention identifier used to respond.*/
   /* 4) Verify the data that was entered.*/
   /* 5) Process a valid input request.*/

   /* In all subordinate processes, "EZEFLO" is used to exit to*/
   /* redisplay the map when an error is found.  This is done to*/
   /* minimize the coding effort required to skip subsequent*/
   /* processing under error conditions.*/
   /* ------------------------------------------------------------*/

  TI0F-51000(); /* Obtain the data to display*/

  TI0F-52000(); /* Format and display the map*/

  TI0F-53000(); /* Check attention identifier*/

  TI0F-54000(); /* Verify the entered data*/

  TI0F-55000(); /* Process valid input request*/
end // end TI0F-50000

// Obtain the data to display
Function TI0F-51000()
  if (TI0FW00.XXX-RQT-DATA-FL != "Y"
   || converseVar.validationMsgNum != 0)

    return;

  end

  if (TIWREC.XXX-MSG-NBR == 0)

    TI0FW00.TI0FW-M005-CURR-PAGE-NBR = 1;

  end

  TI0FW00.TI0FW-M005-HI-PAGE-NBR = 0;

  TI0FS-TI0FW05-TP();

  set TI0FW05 empty;

  TI0FW00.XXX-MAP-FMAT-FL = "Y";

  TI0F-51100();

  TI0FW00.XXX-RQT-DATA-FL = "N";

  return;

end // end TI0F-51000

// Obtain the data to display
Function TI0F-51100()
  set VTOITM01 empty;

  VTOITM01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

  VTOITM01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

  VTOITM01.TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;

  TI0FS-VTOITM01-S1(); /* Declare and Open cursor*/

  if (SQLCA.VAGen_SQLCODE == 100)

    TIWREC.XXX-MSG-LOC-ID = "51100";
    converseLib.validationFailed(18);
    TI0FW00.XXX-MAP-DSP-CD = "4";

    exit stack;

  end

  TI0FW00.TI0FW-TOITM-EOF-FL = "N";

  TI0FS-VTOITM01-N1();

  if (SQLCA.VAGen_SQLCODE == 100)

    TI0FW00.TI0FW-TOITM-EOF-FL = "Y";

  else

    TI0FW00.TI0FW-TOT-ON-ORD-QTY = 0;

  end

  TI0FW00.TI0FW-VTOITM01-NBR = 1;

  TI0FW00.XXX-INX-LMT-NBR = 10;

  while ((TI0FW00.TI0FW-TOITM-EOF-FL != "Y"))

    TI0FW00.TI0FW-VTOITM01-SZ-ID = VTOITM01.SY-SZ-ID;

    if (VTOITM01.SY-SZ-ID > 0)

      TI0FW05.SY-SZ-ID-DESC[TI0FW-VTOITM01-NBR] = SY4REC.SY4IDDSC[TI0FW-VTOITM01-SZ-ID];

    else

      TI0FW05.SY-SZ-ID-DESC[TI0FW-VTOITM01-NBR] = " ";

    end

    TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM = VTORQT01.OP-CUST-ORD-ID;

    TI0FW00.TI0FW-OP-CUST-ORD-ID-LCHA = TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM;

    TI0FW00.TI0FW-OP-CUST-ORD-ID-CHA = TI0FW00.TI0FW-OP-CUST-ORD-ID-SCHA;

    TI0FW00.TI0FW-SALES-ORD-PERIOD = ".";

    TI0FW00.TI0FW-OP-NIKE-ORD-ID-NUM = VTORQT01.OP-NIKE-ORD-ID;

    TI0FW00.TI0FW-OP-NIKE-ORD-ID-LCHA = TI0FW00.TI0FW-OP-NIKE-ORD-ID-NUM;

    TI0FW00.TI0FW-OP-NIKE-ORD-ID-CHA = TI0FW00.TI0FW-OP-NIKE-ORD-ID-SCHA;

    TI0FW05.TI0FW-SALES-ORD-ID = TI0FW00.TI0FW-SALES-ORD-ID;

    TI0FW00.SY-STY-CD = VTORQT01.SY-STY-NBR;

    TI0FW00.TI0FW-STY-COLR-HYPHEN = "-";

    TI0FW00.SY-COLR-CD-ID = VTORQT01.SY-COLR-CD-ID;

    TI0FW05.TI0FW-STYLE-COLR = TI0FW00.TI0FW-STYLE-COLR;

    set SYCREC empty; /* Clear row storage area*/

    SYCREC.XGPCD = VTORQT01.XGP-GPC-CD;

    SYCREC.SY1STNBR = VTORQT01.SY-STY-NBR;

    SYCREC.SY2CLRID = VTORQT01.SY-COLR-CD-ID;

    SYCREC.XDMCD = VTORQT01.XDM-DIM-CD;

    TI0FS-IO0560-S();

    if (SQLCA.VAGen_SQLCODE == 100)

      TIWREC.XXX-MSG-LOC-ID = "51100"; /* Message location*/
      converseLib.validationFailed(58); /* No data was found to display*/

      exit stack; /* Exit to display map*/

    end

    TI0FW05.SY-STY-NM = SYCREC.SY1STYNM;

    set SY1REC empty; /* Clear row storage area*/

    SY1REC.XGPCD = VTORQT01.XGP-GPC-CD;

    SY1REC.SY1STNBR = VTORQT01.SY-STY-NBR;

    TI0FS-IO0120-S();

    if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

      TIWREC.XXX-MSG-LOC-ID = "51100"; /* Message location*/
      converseLib.validationFailed(59); /* No data was found to display*/

      exit stack; /* Exit to display map*/

    end

    set SY4REC empty; /* Clear row storage area*/

    SY4REC.SY4SZSCL = SY1REC.SY4SZSCL;
    TI0FS-IO0040-S();

    if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

      TIWREC.XXX-MSG-LOC-ID = "51100"; /* Message location*/
      converseLib.validationFailed(60); /* No data was found to display*/

      exit stack; /* Exit to display map*/

    end

    TI0FW00.TI0FW-PC-PO-ID-MO-RNG = VTORQT01.PC-PO-ID-MO-RNG;

    TI0FW00.TI0FW-PO-ID-YY = TI0FW00.TI0FW-PO-ID-YY-NUM;

    TI0FW00.TI0FW-PO-ID-BLD-MM = TI0FW00.TI0FW-PO-ID-BLD-MM-NUM;

    TI0FW00.TI0FW-PO-ID-SHP-MM = TI0FW00.TI0FW-PO-ID-SHP-MM-NUM;

    TI0FW05.TI0FW-PC-PO-ID = TI0FW00.TI0FW-PC-PO-ID;

    TI0FW05.FY-FCTY-CD = VTORQT01.FY-FCTY-CD;

    TI0FW05.PC-PO-NBR = VTORQT01.PC-PO-NBR;

    TI0FW05.TI-CUTK-LINE-NBR[TI0FW-VTOITM01-NBR] = VTOITM01.TI-CUTK-LINE-NBR;

    TI0FW05.TI-ON-ORD-QTY[TI0FW-VTOITM01-NBR] = VTOITM01.TI-ON-ORD-QTY;

    TI0FW05.CU-CUST-RTL-PRC[TI0FW-VTOITM01-NBR] = VTOITM01.CU-CUST-RTL-PRC;

    TI0FW05.CU-CUST-PROD-ID[TI0FW-VTOITM01-NBR] = VTOITM01.CU-CUST-PROD-ID;

    TI0FW05.CU-PROD-NM[TI0FW-VTOITM01-NBR] = VTOITM01.CU-PROD-NM;

    TI0FW00.TI0FW-TOT-ON-ORD-QTY = TI0FW00.TI0FW-TOT-ON-ORD-QTY + VTOITM01.TI-ON-ORD-QTY;

    set VTIMSG01 empty; /* Clear row storage area*/

    VTIMSG01.OP-CUST-ORD-ID = VTOITM01.OP-CUST-ORD-ID;

    VTIMSG01.OP-NIKE-ORD-ID = VTOITM01.OP-NIKE-ORD-ID;

    VTIMSG01.TI-CUTK-RQT-NBR = VTOITM01.TI-CUTK-RQT-NBR;

    VTIMSG01.TI-CUTK-LINE-NBR = VTOITM01.TI-CUTK-LINE-NBR;

    TI0FW00.TI0FW-TIMSG-EOF-FL = "N"; /* VTRMSG01 record found*/

    TI0FW00.TI0FW-TI9900-CALL-ACTION = "SC";

    TI0FW00.TI0FW-VTIMSG01-COUNT = -999999998;

    TIXREC.TIX-GROUP = TI0FW00.TI0FW-TI9900-CALL-GROUP;

    TI0FS-TI9900-SC(); /* Declare and Open cursor*/

    TI0FW00.TI0FW-TI9900-CALL-GROUP = TIXREC.TIX-GROUP;

    if (TI0FW00.TI0FW-VTIMSG01-COUNT > 0)

      TI0FW05.TI0FW-TI-CUTK-MSG-CD-FL[TI0FW-VTOITM01-NBR] = "*";

    else

      TI0FW05.TI0FW-TI-CUTK-MSG-CD-FL[TI0FW-VTOITM01-NBR] = " ";

    end

    /* --------------------------------------------------------*/
    /* Select next VTOITM01 row*/
    /* --------------------------------------------------------*/

    TI0FS-VTOITM01-N1(); /* Select the table row*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

      TI0FW00.TI0FW-TOITM-EOF-FL = "Y";

    end

    TI0FW00.TI0FW-VTOITM01-NBR = TI0FW00.TI0FW-VTOITM01-NBR + 1;

    if (TI0FW00.TI0FW-VTOITM01-NBR > TI0FW00.XXX-INX-LMT-NBR)

      TI0FW05.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

      TI0FW05.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

      TI0FW05.TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;

      TI0FS-TI0FW05-TA();

      TI0FW00.TI0FW-VTOITM01-NBR = 1;

    end

  end /* WHILE (TI0FW00.TI0FW-TOITM-EOF-FL NE 'Y');*/

  TI0FW00.XXX-INX-LMT-NBR = 12; /* Display line index*/

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  TI0FS-VTOITM01-C1(); /* Close selected set cursor*/

  TI0FW05.TI0FW-TOT-ON-ORD-QTY = TI0FW00.TI0FW-TOT-ON-ORD-QTY;

  if (TI0FW00.TI0FW-VTOITM01-NBR > 1) /* Page was formatted*/

    TI0FW05.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

    TI0FW05.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

    TI0FW05.TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;

    TI0FS-TI0FW05-TA(); /* Add page to temporary storage*/

  end

  if (TI0FW00.TI0FW-M005-HI-PAGE-NBR == 0) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "51100"; /* Message location*/
    converseLib.validationFailed(18); /* No data was found to display*/
    TI0FW00.XXX-MAP-DSP-CD = "4";

    exit stack; /* Exit to display map*/

  end

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

   /* END OF STATEMENT GROUP*/
end // end TI0F-51100

// Format and converse the map
Function TI0F-52000()
  if (converseVar.validationMsgNum != 0) /* Error was found*/
    TIWREC.XXX-MSG-NBR = converseVar.validationMsgNum; /* Message number*/
  end

  if ((TI0FW00.XXX-MAP-FMAT-FL == "Y"
   || TI0FW00.XXX-PAGE-UPD-FL == "Y"))

    TI0F-52100();

  end
   /* ------------------------------------------------------------*/
   /* Format the current date and any FAST PATH information.*/
   /* ------------------------------------------------------------*/

  TI0FM005.XXX-CURR-DT = VGVar.currentShortGregorianDate; /* Current date*/

  TI0FM005.CATOAP = COMMAREA.CATOAP; /* TO application*/
  TI0FM005.CAITEM = COMMAREA.CAITEM; /* Application data*/

   /* ------------------------------------------------------------*/
   /* If a message to display, indicate sound audible alarm.*/
   /* ------------------------------------------------------------*/

  if (TIWREC.XXX-MSG-NBR != 0 /* Message to display*/
   || COMMAREA.CAMSG != " ")  /* or message text*/

    if (TIWREC.XXX-MSG-NBR != 0) /* Message to display*/

      if (TIWREC.XXX-MSG-NBR == 9999)
        converseLib.validationFailed();
      else
        converseLib.validationFailed(TIWREC.XXX-MSG-NBR);
      end /* Message number*/

    else

      TI0FM005.VAGen_EZEMSG = COMMAREA.CAMSG; /* Message text*/

    end

    TI0FM005.XXX-MSG-LOC-ID = TIWREC.XXX-MSG-LOC-ID;
    TI0FM005.TI0FM-HYPHEN = "-";
                                  /* Message location*/
    set TI0FM005 alarm; /* Indicate sound alarm*/

  end

  converse TI0FM005 ;

   /* ------------------------------------------------------------*/
   /* Clear the message fields and save FAST PATH information.*/
   /* ------------------------------------------------------------*/

  TIWREC.XXX-MSG-LOC-ID = " "; /* Message location*/
  TIWREC.XXX-MSG-NBR = 0; /* Message number*/
  COMMAREA.CAMSG = " "; /* Message text*/

  COMMAREA.CATOAP = TI0FM005.CATOAP; /* TO application*/
  COMMAREA.CAITEM = TI0FM005.CAITEM; /* Application data*/

   /* ------------------------------------------------------------*/
   /* Reset modifiable field attributes to normal intensity.*/
   /* ------------------------------------------------------------*/

  set TI0FM005.CATOAP normal; /* TO application*/
  set TI0FM005.CAITEM normal; /* Application data*/
end // end TI0F-52000

// Format the data in the map
Function TI0F-52100()
  set TI0FM005 initial;

  TI0FM005.XXX-CURR-PAGE-NBR = TI0FW00.TI0FW-M005-CURR-PAGE-NBR;

  TI0FW00.XXX-MAP-FMAT-FL = "N";

  if (TI0FW00.TI0FW-M005-HI-PAGE-NBR > 0) /* Pages were formatted*/

    if (TI0FW00.XXX-PAGE-UPD-FL == "Y") /* Current page was changed*/

      TA5REC.TA5TSQIX = TI0FW00.XXX-CURR-PAGE-NBR;

      TI0FS-TI0FW05-TU();

      TI0FW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

    end

    if (TI0FM005.XXX-CURR-PAGE-NBR != TA5REC.TA5TSQIX)

      if (TI0FM005.XXX-CURR-PAGE-NBR > TI0FW00.TI0FW-M005-HI-PAGE-NBR)

        TI0FM005.XXX-CURR-PAGE-NBR = TI0FW00.TI0FW-M005-HI-PAGE-NBR;

      end

      if (TI0FM005.XXX-CURR-PAGE-NBR < 1)

        TI0FM005.XXX-CURR-PAGE-NBR = 1;

      end

      TA5REC.TA5TSQIX = TI0FM005.XXX-CURR-PAGE-NBR;

      TI0FS-TI0FW05-TR(); /* Read temporary storage page*/

    end

    /* ------------------------------------------------------------*/
    /* Display the page information on the screen.*/
    /* ------------------------------------------------------------*/

    set TI0FM005.XXX-CURR-PAGE-DESC skip; /* "PAGE" literal*/

    TI0FW00.XXX-CURR-PAGE-NBR = TI0FM005.XXX-CURR-PAGE-NBR;

    set TI0FM005.XXX-HI-PAGE-DESC skip; /* "OF" literal*/

    TI0FM005.XXX-HI-PAGE-NBR = TI0FW00.TI0FW-M005-HI-PAGE-NBR;

    TI0FM005.TI0FW-SALES-ORD-ID = TI0FW05.TI0FW-SALES-ORD-ID;

    TI0FM005.TI0FW-STYLE-COLR = TI0FW05.TI0FW-STYLE-COLR;

    TI0FM005.SY-STY-NM = TI0FW05.SY-STY-NM;

    TI0FM005.TI0FW-PC-PO-ID = TI0FW05.TI0FW-PC-PO-ID;

    TI0FM005.FY-FCTY-CD = TI0FW05.FY-FCTY-CD;

    TI0FM005.PC-PO-NBR = TI0FW05.PC-PO-NBR;

    TI0FM005.TI0FW-TOT-ON-ORD-QTY = TI0FW00.TI0FW-TOT-ON-ORD-QTY;

  end

  TI0FW00.TI0FW-VTOITM01-NBR = 1; /* Initialize line index*/

  TI0FW00.XXX-INX-LMT-NBR = 10;

  while ((TI0FW00.TI0FW-VTOITM01-NBR <= TI0FW00.XXX-INX-LMT-NBR))

    TI0FM005.SY-SZ-ID-DESC[TI0FW-VTOITM01-NBR] = TI0FW05.SY-SZ-ID-DESC[TI0FW-VTOITM01-NBR];

    TI0FM005.TI-ON-ORD-QTY[TI0FW-VTOITM01-NBR] = TI0FW05.TI-ON-ORD-QTY[TI0FW-VTOITM01-NBR];

    TI0FM005.CU-CUST-RTL-PRC[TI0FW-VTOITM01-NBR] = TI0FW05.CU-CUST-RTL-PRC[TI0FW-VTOITM01-NBR];

    TI0FM005.CU-CUST-PROD-ID[TI0FW-VTOITM01-NBR] = TI0FW05.CU-CUST-PROD-ID[TI0FW-VTOITM01-NBR];

    TI0FM005.CU-PROD-NM[TI0FW-VTOITM01-NBR] = TI0FW05.CU-PROD-NM[TI0FW-VTOITM01-NBR];

    TI0FM005.TI0FW-TI-CUTK-MSG-CD-FL[TI0FW-VTOITM01-NBR] = TI0FW05.TI0FW-TI-CUTK-MSG-CD-FL[TI0FW-VTOITM01-NBR];

    if (TI0FM005.TI0FW-TI-CUTK-MSG-CD-FL[TI0FW-VTOITM01-NBR] > " ")

      set TI0FM005.TI0FW-TI-CUTK-MSG-CD-FL[TI0FW-VTOITM01-NBR] initialAttributes;

    else

      set TI0FM005.TI0FW-TI-CUTK-MSG-CD-FL[TI0FW-VTOITM01-NBR] noHighLight, protect, blue;

    end

    TI0FW00.TI0FW-VTOITM01-NBR = TI0FW00.TI0FW-VTOITM01-NBR + 1;
                                  /* Increment line index*/
  end

  TI0FW00.XXX-INX-LMT-NBR = 12;
end // end TI0F-52100

// Check attention identifier
Function TI0F-53000()
  if (converseVar.eventKey is pf4 /* MAIN MENU*/
  )                              
    COMMAREA.CATOAP = "MN0M"; /* System Menu*/

    TI0FW00.XXX-MAP-DSP-CD = "1";

    TI0FS-TI0FW05-TP(); /* Purge any temporary storage*/

    XSTIS-EXIT(); /* Exit to another application*/

    exit stack; /* Exit to display map*/

  end

  if (converseVar.eventKey is pa2) /* PA2 was pressed*/

    if (TI0FW00.XXX-RQT-DATA-FL == "Y") /* Request for data pending*/

      set TI0FW01 empty; /* M001 display storage*/

    end

    TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/
    TI0FW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    COMMAREA.CATOAP = " "; /* TO application*/
    COMMAREA.CAITEM = " "; /* Application data*/

    exit stack; /* Exit to display map*/

  end

  if (TI0FM005.CATOAP > " " /* FAST PATH was requested*/
   && converseVar.eventKey not pf1
   && converseVar.eventKey not pf3)

    if (converseVar.eventKey is enter) /* ENTER was pressed*/

      TI0FS-TI0FW05-TP(); /* Purge any temporary storage*/

      XSTIS-EXIT(); /* Exit to another application*/

      set TI0FM005.CATOAP cursor, bold; /* Highlight*/

    else

      TIWREC.XXX-MSG-LOC-ID = "53000"; /* Message location*/

      converseLib.validationFailed(5); /* PA/PF key may not be used*/

    end

    exit stack; /* Exit to display map*/

  end

  if (converseVar.eventKey not enter
   && converseVar.eventKey not pf1
   && converseVar.eventKey not pf3
   && converseVar.eventKey not pf6
   && converseVar.eventKey not pf7
   && converseVar.eventKey not pf8
   && converseVar.eventKey not pf9)

    TIWREC.XXX-MSG-LOC-ID = "53000";
    converseLib.validationFailed(4);

    if (converseVar.eventKey is pakey) /* PA key was pressed*/
      converseLib.clearScreen();
       /* Clear screen before display*/
    end

    exit stack; /* Exit to display map*/

  end
end // end TI0F-53000

// Verify data that was entered
Function TI0F-54000()
  if (converseVar.eventKey is pf1)

    return;

  end

  if (TI0FM003.CAITEM > " ")

    TIWREC.XXX-MSG-LOC-ID = "54000";
    converseLib.validationFailed(7);

    set TI0FM005.CAITEM cursor, bold;

    exit stack;

  end

  if (converseVar.eventKey is pf7
   || converseVar.eventKey is pf8
  )
    TI0F-54100();

    if (converseVar.validationMsgNum != 0)
      exit stack;
    end

  end

  if (converseVar.eventKey is pf9)

    TI0F-54200();

    if (converseVar.validationMsgNum != 0)
      exit stack;
    end

  end
end // end TI0F-54000

// Verify scroll request
Function TI0F-54100()
   /* ------------------------------------------------------------*/
   /* If scroll back was requested, ensure that pages exist.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf7 /* Scroll back request*/
   && TI0FW00.TI0FW-M005-CURR-PAGE-NBR < 2) /* and no previous pages*/

    TIWREC.XXX-MSG-LOC-ID = "54100"; /* Message location*/
    converseLib.validationFailed(2); /* No previous page to display*/

  end

   /* ------------------------------------------------------------*/
   /* If scroll forward was requested, ensure that pages exist.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf8 /* Scroll forward request*/
   && TI0FW00.TI0FW-M005-CURR-PAGE-NBR
   >= TI0FW00.TI0FW-M005-HI-PAGE-NBR)
                                   /* and no more pages*/

    TIWREC.XXX-MSG-LOC-ID = "54100"; /* Message location*/
    converseLib.validationFailed(3); /* No more pages to display*/

  end
end // end TI0F-54100

// Verify scroll request
Function TI0F-54200()
  TI0FW00.TI0FW-CSR-ON-ERR-FL = "N";

  TI0FW00.TI0FW-VTOITM01-NBR = 1;

  TI0FW00.XXX-INX-LMT-NBR = 10;

  while ((TI0FW-VTOITM01-NBR <= XXX-INX-LMT-NBR
   && TI0FW00.TI0FW-CSR-ON-ERR-FL == "N"))

    if (TI0FM005.TI0FW-TI-CUTK-MSG-CD-FL[TI0FW-VTOITM01-NBR] is cursor)
      TI0FS-CSRONERR-FL();
    end

    TI0FW00.TI0FW-VTOITM01-NBR = TI0FW00.TI0FW-VTOITM01-NBR + 1;

  end /* WHILE (TI0FW-VTOITM01-NBR LE XXX-INX-LMT-NBR*/
       /* OR TI0FW00.TI0FW-CSR-ON-ERR-FL NE 'N');*/

  TI0FW00.TI0FW-VTOITM01-NBR = TI0FW00.TI0FW-VTOITM01-NBR - 1;

  TI0FW00.XXX-INX-LMT-NBR = 12;

  if (TI0FW00.TI0FW-CSR-ON-ERR-FL == "N")

    TIWREC.XXX-MSG-LOC-ID = "54200";
    converseLib.validationFailed(72);

    exit stack;

  end
end // end TI0F-54200

// Process valid input request
Function TI0F-55000()
  if (converseVar.eventKey is pf1)

    TIWREC.XXX-MSG-LOC-ID = "55000";

    TIWREC.XXX-MSG-NBR = 0;

    TIWREC.TI-CUTK-XMIT-CD = " ";
    COMMAREA.CAUSERA = TIWREC.CAUSERA;

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    TI0FWCA1.TI0FWCA1-TI0FW00 = TI0FW00.TI0FW00-REC;

    TI0FWCA1.TI0FWCA1-TI0FW02 = TI0FW02.TI0FW02-REC;

    TI0FWCA1.XXX-MSG-LOC-ID = TIWREC.XXX-MSG-LOC-ID;

    TI0FWCA1.XXX-MSG-NBR = TIWREC.XXX-MSG-NBR;

    TI0FWCA1.TI-CUTK-XMIT-CD = TIWREC.TI-CUTK-XMIT-CD;

    COMMAREA.CA-USER-WORKAREA-2K-B = TI0FWCA1.TI0FWCA1-REC;
    TI0FWCA2.TI0FWCA2-TI0FW01 = TI0FW01.TI0FW01-REC;

    TI0FWCA2.TI0FWCA2-TI0FW03 = TI0FW03.TI0FW03-REC;

    TI0FWCA2.TI0FWCA2-TI0FW04 = TI0FW04.TI0FW04-REC;

    TI0FWCA2.TI0FWCA2-TI0FW05 = TI0FW05.TI0FW05-REC;

    COMMAREA.CA-USER-WORKAREA-2K-C = TI0FWCA2.TI0FWCA2-REC;
    COMMAREA.CAFROMAP = "TI0F";

    COMMAREA.CACURRAP = "TI0F";

    COMMAREA.CATOAP = "GD01";

    COMMAREA.CAITEM = "TI0FM005";

    XSTIS-EXIT();

    set TI0FM001.CATOAP cursor, bold;

    TI0FW00.XXX-MAP-DSP-CD = "1";

    TIWREC.XXX-MSG-LOC-ID = "55000";
    converseLib.validationFailed(78);

    exit stack;

  end

  if (converseVar.eventKey is pf3)

    TI0FW00.XXX-MAP-DSP-CD = "4";

    exit stack;

  end

  if (converseVar.eventKey is pf7) /* Scroll back requested*/

    TI0FM005.XXX-CURR-PAGE-NBR = TI0FM005.XXX-CURR-PAGE-NBR - 1;

    TI0FW00.TI0FW-M005-CURR-PAGE-NBR = TI0FM005.XXX-CURR-PAGE-NBR;
                                  /* Decrement page number*/
    TI0FW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    exit stack; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If scroll forward was requested, increment the page number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf8) /* Scroll forward requested*/

    TI0FM005.XXX-CURR-PAGE-NBR = TI0FM005.XXX-CURR-PAGE-NBR + 1;

    TI0FW00.TI0FW-M005-CURR-PAGE-NBR = TI0FM005.XXX-CURR-PAGE-NBR;
                                  /* Increment page number*/
    TI0FW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    exit stack; /* Return to previous process*/

  end

  if (converseVar.eventKey is pf9)

    TI0FW00.XXX-MAP-DSP-CD = "6";

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    TI0FW00.XXX-RQT-DATA-FL = "Y";

    exit stack;
  end

  if (converseVar.eventKey is enter)

    if (TI0FM005.XXX-CURR-PAGE-NBR != TI0FW00.XXX-CURR-PAGE-NBR)

      TI0FW00.TI0FW-M005-CURR-PAGE-NBR = TI0FM005.XXX-CURR-PAGE-NBR;

    else

      TI0FW00.XXX-MAP-DSP-CD = "4";

    end

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    exit stack;

  end
end // end TI0F-55000

// Main process to display a map
Function TI0F-60000()
   /* ------------------------------------------------------------*/
   /* This is the main process used to display a map.  Processing*/
   /* always returns to the top of this process and falls through*/
   /* subordinate processes until an error is found or a valid*/
   /* request is processed.  Processing sequence is as follows:*/

   /* 1) Obtain the data to display.*/
   /* 2) Format the map output area and display the map.*/
   /* 3) Check the attention identifier used to respond.*/
   /* 4) Verify the data that was entered.*/
   /* 5) Process a valid input request.*/

   /* In all subordinate processes, "EZEFLO" is used to exit to*/
   /* redisplay the map when an error is found.  This is done to*/
   /* minimize the coding effort required to skip subsequent*/
   /* processing under error conditions.*/
   /* ------------------------------------------------------------*/

  TI0F-61000(); /* Obtain the data to display*/

  TI0F-62000(); /* Format and display the map*/

  TI0F-63000(); /* Check attention identifier*/

  TI0F-64000(); /* Verify the entered data*/

  TI0F-65000(); /* Process valid input request*/
end // end TI0F-60000

// Obtain the data to display
Function TI0F-61000()
  if (TI0FW00.XXX-RQT-DATA-FL != "Y"
   || converseVar.validationMsgNum != 0)

    return;

  end

  if (TIWREC.XXX-MSG-NBR == 0)

    TI0FW00.TI0FW-M006-CURR-PAGE-NBR = 1;

  end

  TI0FW00.TI0FW-M006-HI-PAGE-NBR = 0;

  TI0FS-TI0FW06-TP();

  set TI0FW06 empty;

  TI0FW00.XXX-MAP-FMAT-FL = "Y";

  TI0FW06.XXX-CURR-DT = TI0FM005.XXX-CURR-DT;
  TI0FW06.TI0FW-TI0FM005-CURR-PAGE-DESC = TI0FM005.XXX-CURR-PAGE-DESC;

  TI0FW06.TI0FW-TI0FM005-CURR-PAGE-NBR = TI0FM005.XXX-CURR-PAGE-NBR;

  TI0FW06.TI0FW-TI0FM005-HI-PAGE-DESC = TI0FM005.XXX-HI-PAGE-DESC;

  TI0FW06.TI0FW-TI0FM005-HI-PAGE-NBR = TI0FM005.XXX-HI-PAGE-NBR;

  TI0FW06.TI0FW-SALES-ORD-ID = TI0FW05.TI0FW-SALES-ORD-ID;

  TI0FW06.TI0FW-STYLE-COLR = TI0FW05.TI0FW-STYLE-COLR;

  TI0FW06.SY-STY-NM = TI0FW05.SY-STY-NM;

  TI0FW06.TI0FW-PC-PO-ID = TI0FW05.TI0FW-PC-PO-ID;

  TI0FW06.FY-FCTY-CD = TI0FW05.FY-FCTY-CD;

  TI0FW06.PC-PO-NBR = TI0FW05.PC-PO-NBR;

  TI0FW06.TI0FW-TOT-ON-ORD-QTY = TI0FW05.TI0FW-TOT-ON-ORD-QTY;

  TI0FW06.SY-SZ-ID-DESC = TI0FW05.SY-SZ-ID-DESC[TI0FW-VTOITM01-NBR];

  TI0FW06.TI-ON-ORD-QTY = TI0FW05.TI-ON-ORD-QTY[TI0FW-VTOITM01-NBR];

  TI0FW06.CU-CUST-RTL-PRC = TI0FW05.CU-CUST-RTL-PRC[TI0FW-VTOITM01-NBR];

  TI0FW06.CU-CUST-PROD-ID = TI0FW05.CU-CUST-PROD-ID[TI0FW-VTOITM01-NBR];

  TI0FW06.CU-PROD-NM = TI0FW05.CU-PROD-NM[TI0FW-VTOITM01-NBR];

  TI0FW06.TI0FW-TI-CUTK-MSG-CD-FL = TI0FW05.TI0FW-TI-CUTK-MSG-CD-FL[TI0FW-VTOITM01-NBR];

  set VTIMSG01 empty;

  VTIMSG01.OP-CUST-ORD-ID = TI0FW05.OP-CUST-ORD-ID;

  VTIMSG01.OP-NIKE-ORD-ID = TI0FW05.OP-NIKE-ORD-ID;

  VTIMSG01.TI-CUTK-RQT-NBR = TI0FW05.TI-CUTK-RQT-NBR;

  VTIMSG01.TI-CUTK-LINE-NBR = TI0FW05.TI-CUTK-LINE-NBR[TI0FW-VTOITM01-NBR];

  TI0FS-VTIMSG01-S1();

  if (SQLCA.VAGen_SQLCODE == 100)

    TIWREC.XXX-MSG-LOC-ID = "61000";
    converseLib.validationFailed(18);
    TI0FW00.XXX-MAP-DSP-CD = "4";

    exit stack;

  end

  TI0FW00.TI0FW-TIMSG-EOF-FL = "N";

  TI0FS-VTIMSG01-N1();

  if (SQLCA.VAGen_SQLCODE == 100)

    TI0FW00.TI0FW-TIMSG-EOF-FL = "Y";

  end

  TI0FW00.TI0FW-VTIMSG01-NBR = 1;

  TI0FW00.XXX-INX-LMT-NBR = 6;

  while ((TI0FW00.TI0FW-TIMSG-EOF-FL != "Y"))

    TI0FW06.TI-CUTK-MSG-CD[TI0FW-VTIMSG01-NBR] = VTIMSG01.TI-CUTK-MSG-CD;

    set VTOMSG01 empty;

    VTOMSG01.TI-CUTK-MSG-CD = VTIMSG01.TI-CUTK-MSG-CD;

    TI0FS-VTOMSG01-S();

    if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

      TI0FW06.TI-CUTK-MSG-DESC[TI0FW-VTIMSG01-NBR] = " ";

    else

      TI0FW06.TI-CUTK-MSG-DESC[TI0FW-VTIMSG01-NBR] = VTOMSG01.TI-CUTK-MSG-DESC;

    end

    TI0FS-VTIMSG01-N1(); /* Select the table row*/

    if (SQLCA.VAGen_SQLCODE == 100)

      TI0FW00.TI0FW-TIMSG-EOF-FL = "Y";

    end

    TI0FW00.TI0FW-VTIMSG01-NBR = TI0FW00.TI0FW-VTIMSG01-NBR + 1;

    if (TI0FW00.TI0FW-VTIMSG01-NBR > TI0FW00.XXX-INX-LMT-NBR)

      TI0FS-TI0FW06-TA();

      TI0FW00.TI0FW-VTIMSG01-NBR = 1;

    end

  end /* WHILE (TI0FW00.TI0FW-TIMSG-EOF-FL NE 'Y');*/

  TI0FW00.XXX-INX-LMT-NBR = 12;

  TI0FS-VTIMSG01-C1();

  if (TI0FW00.TI0FW-VTIMSG01-NBR > 1)

    TI0FS-TI0FW06-TA(); /* Add page to temporary storage*/

  end

  if (TI0FW00.TI0FW-M006-HI-PAGE-NBR == 0) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "61000"; /* Message location*/
    converseLib.validationFailed(18); /* No data was found to display*/
    TI0FW00.XXX-MAP-DSP-CD = "4";

    exit stack; /* Exit to display map*/

  end

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

  return;

   /* END OF STATEMENT GROUP*/
end // end TI0F-61000

// Format and converse the map
Function TI0F-62000()
  if (converseVar.validationMsgNum != 0) /* Error was found*/
    TIWREC.XXX-MSG-NBR = converseVar.validationMsgNum; /* Message number*/
  end

  if ((TI0FW00.XXX-MAP-FMAT-FL == "Y"
   || TI0FW00.XXX-PAGE-UPD-FL == "Y"))

    converseLib.clearScreen();

    TI0FM006.XXX-CURR-PAGE-NBR = TI0FW00.TI0FW-M006-CURR-PAGE-NBR;

    TI0FW00.XXX-MAP-FMAT-FL = "N";

    if (TI0FW00.TI0FW-M006-HI-PAGE-NBR > 0) /* Pages were formatted*/

      if (TI0FW00.XXX-PAGE-UPD-FL == "Y") /* Current page was changed*/

        TA5REC.TA5TSQIX = TI0FW00.XXX-CURR-PAGE-NBR;

        TI0FS-TI0FW06-TU();

        TI0FW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

      end

      if (TI0FM006.XXX-CURR-PAGE-NBR != TA5REC.TA5TSQIX)

        if (TI0FM006.XXX-CURR-PAGE-NBR > TI0FW00.TI0FW-M006-HI-PAGE-NBR)

          TI0FM006.XXX-CURR-PAGE-NBR = TI0FW00.TI0FW-M006-HI-PAGE-NBR;

        end

        if (TI0FM006.XXX-CURR-PAGE-NBR < 1)

          TI0FM006.XXX-CURR-PAGE-NBR = 1;

        end

        TA5REC.TA5TSQIX = TI0FM006.XXX-CURR-PAGE-NBR;

        TI0FS-TI0FW06-TR(); /* Read temporary storage page*/

      end

      set TI0FM006.XXX-CURR-PAGE-DESC skip; /* "PAGE" literal*/

      TI0FW00.XXX-CURR-PAGE-NBR = TI0FM006.XXX-CURR-PAGE-NBR;

      set TI0FM006.XXX-HI-PAGE-DESC skip; /* "OF" literal*/

      TI0FM006.XXX-HI-PAGE-NBR = TI0FW00.TI0FW-M006-HI-PAGE-NBR;

    end

    TI0FM006.XXX-CURR-DT = TI0FW06.XXX-CURR-DT;

    TI0FM006.TI0FW-TI0FM005-CURR-PAGE-DESC = TI0FW06.TI0FW-TI0FM005-CURR-PAGE-DESC;

    TI0FM006.TI0FW-TI0FM005-CURR-PAGE-NBR = TI0FW06.TI0FW-TI0FM005-CURR-PAGE-NBR;

    TI0FM006.TI0FW-TI0FM005-HI-PAGE-DESC = TI0FW06.TI0FW-TI0FM005-HI-PAGE-DESC;

    TI0FM006.TI0FW-TI0FM005-HI-PAGE-NBR = TI0FW06.TI0FW-TI0FM005-HI-PAGE-NBR;

    TI0FM006.TI0FW-SALES-ORD-ID = TI0FW06.TI0FW-SALES-ORD-ID;

    TI0FM006.TI0FW-STYLE-COLR = TI0FW06.TI0FW-STYLE-COLR;

    TI0FM006.SY-STY-NM = TI0FW06.SY-STY-NM;

    TI0FM006.TI0FW-PC-PO-ID = TI0FW06.TI0FW-PC-PO-ID;

    TI0FM006.FY-FCTY-CD = TI0FW06.FY-FCTY-CD;

    TI0FM006.PC-PO-NBR = TI0FW06.PC-PO-NBR;

    TI0FM006.TI0FW-TOT-ON-ORD-QTY = TI0FW06.TI0FW-TOT-ON-ORD-QTY;

    TI0FM006.SY-SZ-ID-DESC = TI0FW06.SY-SZ-ID-DESC;

    TI0FM006.TI-ON-ORD-QTY = TI0FW06.TI-ON-ORD-QTY;

    TI0FM006.CU-CUST-RTL-PRC = TI0FW06.CU-CUST-RTL-PRC;

    TI0FM006.CU-CUST-PROD-ID = TI0FW06.CU-CUST-PROD-ID;

    TI0FM006.CU-PROD-NM = TI0FW06.CU-PROD-NM;

    TI0FM006.TI0FW-TI-CUTK-MSG-CD-FL = TI0FW06.TI0FW-TI-CUTK-MSG-CD-FL;

    TI0FW00.TI0FW-VTIMSG01-NBR = 1; /* Initialize line index*/

    TI0FW00.XXX-INX-LMT-NBR = 6;

    while ((TI0FW00.TI0FW-VTIMSG01-NBR <= TI0FW00.XXX-INX-LMT-NBR))

      TI0FM006.TI-CUTK-MSG-CD[TI0FW-VTIMSG01-NBR] = TI0FW06.TI-CUTK-MSG-CD[TI0FW-VTIMSG01-NBR];

      TI0FM006.TI-CUTK-MSG-DESC[TI0FW-VTIMSG01-NBR] = TI0FW06.TI-CUTK-MSG-DESC[TI0FW-VTIMSG01-NBR];

      TI0FW00.TI0FW-VTIMSG01-NBR = TI0FW00.TI0FW-VTIMSG01-NBR + 1;
    end

    TI0FW00.XXX-INX-LMT-NBR = 12;

  end

   /* ------------------------------------------------------------*/
   /* If a message to display, indicate sound audible alarm.*/
   /* ------------------------------------------------------------*/
  if (TIWREC.XXX-MSG-NBR != 0 /* Message to display*/
   || COMMAREA.CAMSG != " ")  /* or message text*/

    if (TIWREC.XXX-MSG-NBR != 0)

      if (TIWREC.XXX-MSG-NBR == 9999)
        converseLib.validationFailed();
      else
        converseLib.validationFailed(TIWREC.XXX-MSG-NBR);
      end

    end

    set TI0FM006 alarm; /* Indicate sound alarm*/

  end

  converse TI0FM006 ;

   /* ------------------------------------------------------------*/
   /* Clear the message fields.*/
   /* ------------------------------------------------------------*/

  TIWREC.XXX-MSG-LOC-ID = " "; /* Message location*/
  TIWREC.XXX-MSG-NBR = 0; /* Message number*/
  COMMAREA.CAMSG = " "; /* Message text*/
end // end TI0F-62000

// Check attention identifier
Function TI0F-63000()
  if (converseVar.eventKey is pf4) /* PF4 was pressed*/

    COMMAREA.CATOAP = "MN0M"; /* System Menu*/
    TI0FW00.XXX-MAP-DSP-CD = "1";

    TI0FS-TI0FW06-TP(); /* Purge any temporary storage*/

    XSTIS-EXIT(); /* Exit to another application*/

    exit stack; /* Exit to display map*/

  end
                                       /*  */
  if (converseVar.eventKey not enter /* RETURN*/
   && converseVar.eventKey not pf1   /* HELP*/
   && converseVar.eventKey not pf3   /* RETURN*/
   && converseVar.eventKey not pf7   /* SCROLL UP*/
   && converseVar.eventKey not pf8)  /* SCROLL DOWN*/

    TIWREC.XXX-MSG-LOC-ID = "63000";
    converseLib.validationFailed(4);

    if (converseVar.eventKey is pakey) /* PA key was pressed*/
      converseLib.clearScreen();
       /* Clear screen before display*/
    end

    exit stack; /* Exit to display map*/

  end
end // end TI0F-63000

// Verify data that was entered
Function TI0F-64000()
  if (converseVar.eventKey is pf1)

    return;

  end

  if (converseVar.eventKey is pf7
   || converseVar.eventKey is pf8)

    TI0F-64100();

    if (converseVar.validationMsgNum != 0)
      exit stack;
    end

  end
end // end TI0F-64000

// Verify scroll request
Function TI0F-64100()
  if (converseVar.eventKey is pf7
   && TI0FW00.TI0FW-M006-CURR-PAGE-NBR < 2)

    TIWREC.XXX-MSG-LOC-ID = "64100";
    converseLib.validationFailed(2);

  end

  if (converseVar.eventKey is pf8
   && TI0FW00.TI0FW-M006-CURR-PAGE-NBR
   >= TI0FW00.TI0FW-M006-HI-PAGE-NBR)

    TIWREC.XXX-MSG-LOC-ID = "64100";
    converseLib.validationFailed(3);

  end
end // end TI0F-64100

// Process valid input request
Function TI0F-65000()
  if (converseVar.eventKey is pf1)

    TIWREC.XXX-MSG-LOC-ID = "65000";

    TIWREC.XXX-MSG-NBR = 0;

    TIWREC.TI-CUTK-XMIT-CD = " ";
    COMMAREA.CAUSERA = TIWREC.CAUSERA;

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    TI0FWCA1.TI0FWCA1-TI0FW00 = TI0FW00.TI0FW00-REC;

    TI0FWCA1.TI0FWCA1-TI0FW02 = TI0FW02.TI0FW02-REC;

    TI0FWCA1.XXX-MSG-LOC-ID = TIWREC.XXX-MSG-LOC-ID;

    TI0FWCA1.XXX-MSG-NBR = TIWREC.XXX-MSG-NBR;

    TI0FWCA1.TI-CUTK-XMIT-CD = TIWREC.TI-CUTK-XMIT-CD;

    COMMAREA.CA-USER-WORKAREA-2K-B = TI0FWCA1.TI0FWCA1-REC;
    TI0FWCA2.TI0FWCA2-TI0FW01 = TI0FW01.TI0FW01-REC;

    TI0FWCA2.TI0FWCA2-TI0FW03 = TI0FW03.TI0FW03-REC;

    TI0FWCA2.TI0FWCA2-TI0FW04 = TI0FW04.TI0FW04-REC;

    TI0FWCA2.TI0FWCA2-TI0FW05 = TI0FW05.TI0FW05-REC;

    COMMAREA.CA-USER-WORKAREA-2K-C = TI0FWCA2.TI0FWCA2-REC;
    COMMAREA.CAFROMAP = "TI0F";

    COMMAREA.CACURRAP = "TI0F";

    COMMAREA.CATOAP = "GD01";

    COMMAREA.CAITEM = "TI0FM005";

    XSTIS-EXIT();

    set TI0FM001.CATOAP cursor, bold;

    TI0FW00.XXX-MAP-DSP-CD = "6";

    TIWREC.XXX-MSG-LOC-ID = "65000";
    converseLib.validationFailed(78);

    exit stack;

  end

  if (converseVar.eventKey is pf3)

    TI0FW00.XXX-MAP-DSP-CD = "5";

    converseLib.clearScreen();

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    exit stack;

  end

  if (converseVar.eventKey is pf7)

    TI0FM006.XXX-CURR-PAGE-NBR = TI0FM006.XXX-CURR-PAGE-NBR - 1;

    TI0FW00.TI0FW-M006-CURR-PAGE-NBR = TI0FM006.XXX-CURR-PAGE-NBR;

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    exit stack;

  end

  if (converseVar.eventKey is pf8)

    TI0FM006.XXX-CURR-PAGE-NBR = TI0FM006.XXX-CURR-PAGE-NBR + 1;

    TI0FW00.TI0FW-M006-CURR-PAGE-NBR = TI0FM006.XXX-CURR-PAGE-NBR;

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    exit stack;

  end

  if (converseVar.eventKey is enter)

    if (TI0FM006.XXX-CURR-PAGE-NBR != TI0FW00.XXX-CURR-PAGE-NBR)

      TI0FW00.TI0FW-M006-CURR-PAGE-NBR = TI0FM006.XXX-CURR-PAGE-NBR;

    else

      TI0FW00.XXX-MAP-DSP-CD = "5";

    end

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    converseLib.clearScreen();

    exit stack;

  end
end // end TI0F-65000

// Main process to display a map
Function TI0F-70000()
   /* ------------------------------------------------------------*/
   /* This is the main process used to display a map.  Processing*/
   /* always returns to the top of this process and falls through*/
   /* subordinate processes until an error is found or a valid*/
   /* request is processed.  Processing sequence is as follows:*/

   /* 1) Obtain the data to display.*/
   /* 2) Format the map output area and display the map.*/
   /* 3) Check the attention identifier used to respond.*/
   /* 4) Verify the data that was entered.*/
   /* 5) Process a valid input request.*/

   /* In all subordinate processes, "EZEFLO" is used to exit to*/
   /* redisplay the map when an error is found.  This is done to*/
   /* minimize the coding effort required to skip subsequent*/
   /* processing under error conditions.*/
   /* ------------------------------------------------------------*/

  TI0F-71000(); /* Obtain the data to display*/

  TI0F-72000(); /* Format and display the map*/

  TI0F-73000(); /* Check attention identifier*/

  TI0F-74000(); /* Verify the entered data*/

  TI0F-75000(); /* Process valid input request*/
end // end TI0F-70000

// Obtain the data to display
Function TI0F-71000()
  if (TI0FW00.XXX-RQT-DATA-FL != "Y"
   || converseVar.validationMsgNum != 0)

    return;

  end

  if (TIWREC.XXX-MSG-NBR == 0)

    TI0FW00.TI0FW-M007-CURR-PAGE-NBR = 1;

  end

  TI0FW00.TI0FW-M007-HI-PAGE-NBR = 0;

  TI0FS-TI0FW07-TP();

  set TI0FW07 empty;

  TI0FW00.XXX-MAP-FMAT-FL = "Y";

  TI0FW07.XXX-CURR-DT = TI0FM004.XXX-CURR-DT;
  TI0FW07.TI-CUTK-STAT-CD = TI0FW04.TI-CUTK-STAT-CD;

  TI0FW07.TI-CUTK-STAT-DESC = TI0FW04.TI-CUTK-STAT-DESC;

  TI0FW07.TI0FW-TI-CUTK-MSG-CD-TXT = TI0FW04.TI0FW-TI-CUTK-MSG-CD-TXT;

  TI0FW07.TI-CUTK-SPLR-CD = TI0FW04.TI-CUTK-SPLR-CD;

  TI0FW07.TI-CUTK-SPLR-NM = TI0FW04.TI-CUTK-SPLR-NM;

  TI0FW07.TI-CUTK-XMIT-CD = TI0FW04.TI-CUTK-XMIT-CD;

  TI0FW07.TI-CUTK-XMIT-ABRV = TI0FW04.TI-CUTK-XMIT-ABRV;

  TI0FW07.TI0FW-CUTK-EST-SND-DT = TI0FW04.TI0FW-CUTK-EST-SND-DT;

  TI0FW07.TI0FW-CUTK-SNT-DT = TI0FW04.TI0FW-CUTK-SNT-DT;

  TI0FW07.TI-CUTK-SEND-CD = TI0FW04.TI-CUTK-SEND-CD;

  TI0FW07.TI-CUTK-SEND-DESC = TI0FW04.TI-CUTK-SEND-DESC;

  TI0FW07.CU-BUY-SESN-ID = TI0FW04.CU-BUY-SESN-ID;

  set VTRMSG01 empty;

  VTRMSG01.OP-CUST-ORD-ID = TI0FW04.OP-CUST-ORD-ID;

  VTRMSG01.OP-NIKE-ORD-ID = TI0FW04.OP-NIKE-ORD-ID;

  VTRMSG01.TI-CUTK-RQT-NBR = TI0FW04.TI-CUTK-RQT-NBR;

  TI0FS-VTRMSG01-S1();

  if (SQLCA.VAGen_SQLCODE == 100)

    TIWREC.XXX-MSG-LOC-ID = "71000";
    converseLib.validationFailed(18);
    TI0FW00.XXX-MAP-DSP-CD = "4";

    exit stack;

  end

  TI0FW00.TI0FW-TRMSG-EOF-FL = "N";

  TI0FS-VTRMSG01-N1();

  if (SQLCA.VAGen_SQLCODE == 100)

    TI0FW00.TI0FW-TRMSG-EOF-FL = "Y";

  end

  TI0FW00.TI0FW-VTRMSG01-NBR = 1;

  TI0FW00.XXX-INX-LMT-NBR = 6;

  while ((TI0FW00.TI0FW-TRMSG-EOF-FL != "Y"))

    TI0FW07.TI-CUTK-MSG-CD[TI0FW-VTRMSG01-NBR] = VTRMSG01.TI-CUTK-MSG-CD;

    set VTOMSG01 empty;

    VTOMSG01.TI-CUTK-MSG-CD = VTRMSG01.TI-CUTK-MSG-CD;

    TI0FS-VTOMSG01-S();

    if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

      TI0FW07.TI-CUTK-MSG-DESC[TI0FW-VTRMSG01-NBR] = " ";

    else

      TI0FW07.TI-CUTK-MSG-DESC[TI0FW-VTRMSG01-NBR] = VTOMSG01.TI-CUTK-MSG-DESC;

    end

    TI0FS-VTRMSG01-N1(); /* Select the table row*/

    if (SQLCA.VAGen_SQLCODE == 100)

      TI0FW00.TI0FW-TRMSG-EOF-FL = "Y";

    end

    TI0FW00.TI0FW-VTRMSG01-NBR = TI0FW00.TI0FW-VTRMSG01-NBR + 1;

    if (TI0FW00.TI0FW-VTRMSG01-NBR > TI0FW00.XXX-INX-LMT-NBR)

      TI0FS-TI0FW07-TA();

      TI0FW00.TI0FW-VTRMSG01-NBR = 1;

    end

  end /* WHILE (TI0FW00.TI0FW-trmsg-eof-FL NE 'Y');*/

  TI0FW00.XXX-INX-LMT-NBR = 12;

  TI0FS-VTRMSG01-C1();

  if (TI0FW00.TI0FW-VTRMSG01-NBR > 1)

    TI0FS-TI0FW07-TA(); /* Add page to temporary storage*/

  end

  if (TI0FW00.TI0FW-M007-HI-PAGE-NBR == 0) /* No pages formatted*/

    TIWREC.XXX-MSG-LOC-ID = "71000"; /* Message location*/
    converseLib.validationFailed(18); /* No data was found to display*/
    TI0FW00.XXX-MAP-DSP-CD = "4";

    exit stack; /* Exit to display map*/

  end

  TI0FW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/

  return;

   /* END OF STATEMENT GROUP*/
end // end TI0F-71000

// Format and converse the map
Function TI0F-72000()
  if (converseVar.validationMsgNum != 0) /* Error was found*/
    TIWREC.XXX-MSG-NBR = converseVar.validationMsgNum; /* Message number*/
  end

  if ((TI0FW00.XXX-MAP-FMAT-FL == "Y"
   || TI0FW00.XXX-PAGE-UPD-FL == "Y"))

    converseLib.clearScreen();

    TI0FM007.XXX-CURR-PAGE-NBR = TI0FW00.TI0FW-M007-CURR-PAGE-NBR;

    TI0FW00.XXX-MAP-FMAT-FL = "N";

    if (TI0FW00.TI0FW-M007-HI-PAGE-NBR > 0) /* Pages were formatted*/

      if (TI0FW00.XXX-PAGE-UPD-FL == "Y") /* Current page was changed*/

        TA5REC.TA5TSQIX = TI0FW00.XXX-CURR-PAGE-NBR;

        TI0FS-TI0FW07-TU();

        TI0FW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

      end

      if (TI0FM007.XXX-CURR-PAGE-NBR != TA5REC.TA5TSQIX)

        if (TI0FM007.XXX-CURR-PAGE-NBR > TI0FW00.TI0FW-M007-HI-PAGE-NBR)

          TI0FM007.XXX-CURR-PAGE-NBR = TI0FW00.TI0FW-M007-HI-PAGE-NBR;

        end

        if (TI0FM007.XXX-CURR-PAGE-NBR < 1)

          TI0FM007.XXX-CURR-PAGE-NBR = 1;

        end

        TA5REC.TA5TSQIX = TI0FM007.XXX-CURR-PAGE-NBR;

        TI0FS-TI0FW07-TR(); /* Read temporary storage page*/

      end

      set TI0FM007.XXX-CURR-PAGE-DESC skip; /* "PAGE" literal*/

      TI0FW00.XXX-CURR-PAGE-NBR = TI0FM007.XXX-CURR-PAGE-NBR;

      set TI0FM007.XXX-HI-PAGE-DESC skip; /* "OF" literal*/

      TI0FM007.XXX-HI-PAGE-NBR = TI0FW00.TI0FW-M007-HI-PAGE-NBR;

    end

    TI0FM007.XXX-CURR-DT = TI0FW07.XXX-CURR-DT;
    TI0FM007.TI-CUTK-STAT-CD = TI0FW07.TI-CUTK-STAT-CD;

    TI0FM007.TI-CUTK-STAT-DESC = TI0FW07.TI-CUTK-STAT-DESC;

    TI0FM007.TI0FW-TI-CUTK-MSG-CD-TXT = TI0FW07.TI0FW-TI-CUTK-MSG-CD-TXT;

    TI0FM007.TI-CUTK-SPLR-CD = TI0FW07.TI-CUTK-SPLR-CD;

    TI0FM007.TI-CUTK-SPLR-NM = TI0FW07.TI-CUTK-SPLR-NM;

    if (TI0FM007.TI-CUTK-SPLR-CD > " ")

      TI0FW-TI-CUTK-SPLR-CD-HYPHEN = "-";

    end

    TI0FM007.TI-CUTK-XMIT-CD = TI0FW07.TI-CUTK-XMIT-CD;

    TI0FM007.TI-CUTK-XMIT-ABRV = TI0FW07.TI-CUTK-XMIT-ABRV;

    TI0FM007.TI0FW-CUTK-EST-SND-DT = TI0FW07.TI0FW-CUTK-EST-SND-DT;

    TI0FM007.TI0FW-CUTK-SNT-DT = TI0FW07.TI0FW-CUTK-SNT-DT;

    TI0FM007.TI-CUTK-SEND-CD = TI0FW07.TI-CUTK-SEND-CD;

    TI0FM007.TI-CUTK-SEND-DESC = TI0FW07.TI-CUTK-SEND-DESC;

    if (TI0FM007.TI-CUTK-SEND-CD > " ")

      TI0FW-TI-CUTK-SEND-CD-HYPHEN = "-";

    end

    TI0FM007.CU-BUY-SESN-ID = TI0FW07.CU-BUY-SESN-ID;

    TI0FW00.TI0FW-VTRMSG01-NBR = 1; /* Initialize line index*/

    TI0FW00.XXX-INX-LMT-NBR = 6;

    while ((TI0FW00.TI0FW-VTRMSG01-NBR <= TI0FW00.XXX-INX-LMT-NBR))

      TI0FM007.TI-CUTK-MSG-CD[TI0FW-VTRMSG01-NBR] = TI0FW07.TI-CUTK-MSG-CD[TI0FW-VTRMSG01-NBR];

      TI0FM007.TI-CUTK-MSG-DESC[TI0FW-VTRMSG01-NBR] = TI0FW07.TI-CUTK-MSG-DESC[TI0FW-VTRMSG01-NBR];

      TI0FW00.TI0FW-VTRMSG01-NBR = TI0FW00.TI0FW-VTRMSG01-NBR + 1;
    end

    TI0FW00.XXX-INX-LMT-NBR = 12;

  end

   /* ------------------------------------------------------------*/
   /* If a message to display, indicate sound audible alarm.*/
   /* ------------------------------------------------------------*/
  if (TIWREC.XXX-MSG-NBR != 0 /* Message to display*/
   || COMMAREA.CAMSG != " ")  /* or message text*/

    if (TIWREC.XXX-MSG-NBR != 0)

      if (TIWREC.XXX-MSG-NBR == 9999)
        converseLib.validationFailed();
      else
        converseLib.validationFailed(TIWREC.XXX-MSG-NBR);
      end

    end

    set TI0FM007 alarm; /* Indicate sound alarm*/

  end

  converse TI0FM007 ;

   /* ------------------------------------------------------------*/
   /* Clear the message fields.*/
   /* ------------------------------------------------------------*/

  TIWREC.XXX-MSG-LOC-ID = " "; /* Message location*/
  TIWREC.XXX-MSG-NBR = 0; /* Message number*/
  COMMAREA.CAMSG = " "; /* Message text*/
end // end TI0F-72000

// Check attention identifier
Function TI0F-73000()
  if (converseVar.eventKey is pf4) /* PF4 was pressed*/

    COMMAREA.CATOAP = "MN0M"; /* System Menu*/
    TI0FW00.XXX-MAP-DSP-CD = "1";

    TI0FS-TI0FW06-TP(); /* Purge any temporary storage*/

    XSTIS-EXIT(); /* Exit to another application*/

    exit stack; /* Exit to display map*/

  end

  if (converseVar.eventKey not enter /* RETURN*/
   && converseVar.eventKey not pf1   /* HELP*/
   && converseVar.eventKey not pf3   /* RETURN*/
   && converseVar.eventKey not pf7   /* SCROLL UP*/
   && converseVar.eventKey not pf8)  /* SCROOL DOWN*/

    TIWREC.XXX-MSG-LOC-ID = "73000";
    converseLib.validationFailed(4);

    if (converseVar.eventKey is pakey) /* PA key was pressed*/
      converseLib.clearScreen();
       /* Clear screen before display*/
    end

    exit stack; /* Exit to display map*/

  end
end // end TI0F-73000

// Verify data that was entered
Function TI0F-74000()
  if (converseVar.eventKey is pf1)

    return;

  end

  if (converseVar.eventKey is pf7
   || converseVar.eventKey is pf8)

    TI0F-74100();

    if (converseVar.validationMsgNum != 0)
      exit stack;
    end

  end
end // end TI0F-74000

// Verify scroll request
Function TI0F-74100()
  if (converseVar.eventKey is pf7
   && TI0FW00.TI0FW-M007-CURR-PAGE-NBR < 2)

    TIWREC.XXX-MSG-LOC-ID = "74100";
    converseLib.validationFailed(2);

  end

  if (converseVar.eventKey is pf8
   && TI0FW00.TI0FW-M007-CURR-PAGE-NBR
   >= TI0FW00.TI0FW-M007-HI-PAGE-NBR)

    TIWREC.XXX-MSG-LOC-ID = "74100";
    converseLib.validationFailed(3);

  end
end // end TI0F-74100

// Process valid input request
Function TI0F-75000()
  if (converseVar.eventKey is pf1)

    TIWREC.XXX-MSG-LOC-ID = "75000";

    TIWREC.XXX-MSG-NBR = 0;

    TIWREC.TI-CUTK-XMIT-CD = " ";
    COMMAREA.CAUSERA = TIWREC.CAUSERA;

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    TI0FWCA1.TI0FWCA1-TI0FW00 = TI0FW00.TI0FW00-REC;

    TI0FWCA1.TI0FWCA1-TI0FW02 = TI0FW02.TI0FW02-REC;

    TI0FWCA1.XXX-MSG-LOC-ID = TIWREC.XXX-MSG-LOC-ID;

    TI0FWCA1.XXX-MSG-NBR = TIWREC.XXX-MSG-NBR;

    TI0FWCA1.TI-CUTK-XMIT-CD = TIWREC.TI-CUTK-XMIT-CD;

    COMMAREA.CA-USER-WORKAREA-2K-B = TI0FWCA1.TI0FWCA1-REC;
    TI0FWCA2.TI0FWCA2-TI0FW01 = TI0FW01.TI0FW01-REC;

    TI0FWCA2.TI0FWCA2-TI0FW03 = TI0FW03.TI0FW03-REC;

    TI0FWCA2.TI0FWCA2-TI0FW04 = TI0FW04.TI0FW04-REC;

    TI0FWCA2.TI0FWCA2-TI0FW05 = TI0FW05.TI0FW05-REC;

    COMMAREA.CA-USER-WORKAREA-2K-C = TI0FWCA2.TI0FWCA2-REC;
    COMMAREA.CAFROMAP = "TI0F";

    COMMAREA.CACURRAP = "TI0F";

    COMMAREA.CATOAP = "GD01";

    COMMAREA.CAITEM = "TI0FM007";

    XSTIS-EXIT();

    set TI0FM001.CATOAP cursor, bold;

    TI0FW00.XXX-MAP-DSP-CD = "7";

    TIWREC.XXX-MSG-LOC-ID = "75000";
    converseLib.validationFailed(78);

    exit stack;

  end

  if (converseVar.eventKey is pf3)

    TI0FW00.XXX-MAP-DSP-CD = "4";

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    converseLib.clearScreen();

    exit stack;

  end

  if (converseVar.eventKey is pf7)

    TI0FM007.XXX-CURR-PAGE-NBR = TI0FM007.XXX-CURR-PAGE-NBR - 1;

    TI0FW00.TI0FW-M007-CURR-PAGE-NBR = TI0FM007.XXX-CURR-PAGE-NBR;

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    exit stack;

  end

  if (converseVar.eventKey is pf8)

    TI0FM007.XXX-CURR-PAGE-NBR = TI0FM007.XXX-CURR-PAGE-NBR + 1;

    TI0FW00.TI0FW-M007-CURR-PAGE-NBR = TI0FM007.XXX-CURR-PAGE-NBR;

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    exit stack;

  end

  if (converseVar.eventKey is enter)

    if (TI0FM007.XXX-CURR-PAGE-NBR != TI0FW00.XXX-CURR-PAGE-NBR)

      TI0FW00.TI0FW-M007-CURR-PAGE-NBR = TI0FM007.XXX-CURR-PAGE-NBR;

    else

      TI0FW00.XXX-MAP-DSP-CD = "4";

    end

    TI0FW00.XXX-MAP-FMAT-FL = "Y";

    converseLib.clearScreen();

    exit stack;

  end
end // end TI0F-75000

// FILTER SALES ORD BY NEED DATE
Function TI0FS-ASENTDT-ED()
   /* ------------------------------------------------------------*/
   /* Filter sales order according to need date from TI0FM001.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "Y";

  if (VTORQT01.TI-CUTK-SNT-DT < TI0FW00.TI0FW-CUST-ACT-SNT-DT-LOW
   || VTORQT01.TI-CUTK-SNT-DT > TI0FW00.TI0FW-CUST-ACT-SNT-DT-HI)

    TI0FW00.TI0FW-CUST-ACT-SNT-DT-OK-FL = "N";

  end
end // end TI0FS-ASENTDT-ED

// Edits all codes
Function TI0FS-CACHGLVL-11()
   /* **************************************************************/
   /* IF GPC IS "02", SUB-FLAG 1 MUST BE "Y"                    **/
   /* **************************************************************/
  if (VTORQT01.XGP-GPC-CD == "02"
  )
    if (COMMAREA.CACLVL[1] == "N")

      converseLib.validationFailed(112);

      exit stack;

    end

  end

   /* **************************************************************/
   /* IF GPC IS "03", SUB-FLAG 2 MUST BE "Y"                    **/
   /* **************************************************************/
  if (VTORQT01.XGP-GPC-CD == "03"
  )
    if (COMMAREA.CACLVL[2] == "N")

      converseLib.validationFailed(113);

      exit stack;

    end

  end

   /* **************************************************************/
   /* SUB-FLAG 3 RESERVED FOR FUTURE GPC                        **/
   /* **************************************************************/

   /* **************************************************************/
   /* CHECK FOR AT LEAST ONE "Y" IN REMAINING SUB-FLAGS         **/
   /* **************************************************************/
  TI0FW00.TI0FW-WORK-IDX = 4;

  TI0FW00.TI0FW-UPDATE-AUTHORIZED-FL = "N";

  while ((TI0FW-WORK-IDX <= 10
   && TI0FW00.TI0FW-UPDATE-AUTHORIZED-FL != "Y"))

    if (COMMAREA.CACLVL[TI0FW-WORK-IDX] == "Y")

      TI0FW00.TI0FW-UPDATE-AUTHORIZED-FL = "Y";

    end

    TI0FW00.TI0FW-WORK-IDX = TI0FW00.TI0FW-WORK-IDX + 1;

  end /* WHILE (TI0FW-WORK-IDX LE 10*/
       /* or TI0FW00.TI0FW-UPDATE-AUTHORIZED-FL eq 'y');*/

  if (TI0FW00.TI0FW-UPDATE-AUTHORIZED-FL == "N"
  )
    converseLib.validationFailed(111);

  end
end // end TI0FS-CACHGLVL-11

// Edits all codes
Function TI0FS-CACHGLVL-ED()
   /* **************************************************************/
   /* IF GPC IS "02", SUB-FLAG 1 MUST BE "Y"                    **/
   /* **************************************************************/
  if (VTORQT01.XGP-GPC-CD == "02"
  )
    if (COMMAREA.CACLVL[1] == "N")

      converseLib.validationFailed(62);

      exit stack;

    end

  end

   /* **************************************************************/
   /* IF GPC IS "03", SUB-FLAG 2 MUST BE "Y"                    **/
   /* **************************************************************/
  if (VTORQT01.XGP-GPC-CD == "03"
  )
    if (COMMAREA.CACLVL[2] == "N")

      converseLib.validationFailed(63);

      exit stack;

    end

  end

   /* **************************************************************/
   /* SUB-FLAG 3 RESERVED FOR FUTURE GPC                        **/
   /* **************************************************************/

   /* **************************************************************/
   /* CHECK FOR AT LEAST ONE "Y" IN REMAINING SUB-FLAGS         **/
   /* **************************************************************/
  TI0FW00.TI0FW-WORK-IDX = 4;

  TI0FW00.TI0FW-UPDATE-AUTHORIZED-FL = "N";

  while ((TI0FW-WORK-IDX <= 10
   && TI0FW00.TI0FW-UPDATE-AUTHORIZED-FL != "Y"))

    if (COMMAREA.CACLVL[TI0FW-WORK-IDX] == "Y")

      TI0FW00.TI0FW-UPDATE-AUTHORIZED-FL = "Y";

    end

    TI0FW00.TI0FW-WORK-IDX = TI0FW00.TI0FW-WORK-IDX + 1;

  end /* WHILE (TI0FW-WORK-IDX LE 10*/
       /* or TI0FW00.TI0FW-UPDATE-AUTHORIZED-FL eq 'y');*/

  if (TI0FW00.TI0FW-UPDATE-AUTHORIZED-FL == "N"
  )
    converseLib.validationFailed(64);

  end
end // end TI0FS-CACHGLVL-ED

// Edits all codes
Function TI0FS-CSRONERR-FL()
  TI0FW00.TI0FW-CSR-ON-ERR-FL = "Y";
end // end TI0FS-CSRONERR-FL

// edit op_cust_po
Function TI0FS-CUSTPO-ED()
   /* ------------------------------------------------------------*/
   /* Filter customer purchase order according to data from TI0FM001.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-OP-CUST-PO-OK-FL = "Y";

  VTOHDR01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

  VTOHDR01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

  TI0FS-VTOHDR01-S(); /* Declare and open cursor*/

  if (SQLCA.VAGen_SQLCODE == +100)

    TI0FW00.TI0FW-OP-CUST-PO-OK-FL = "N";

  else

    if (VTOHDR01.OP-CUST-PO != TI0FM001.TI0FW-OP-CUST-PO2)

      TI0FW00.TI0FW-OP-CUST-PO-OK-FL = "N";

    end

  end
end // end TI0FS-CUSTPO-ED

// Filter sales ord by err messge
Function TI0FS-EMSGCODE-ED()
   /* ------------------------------------------------------------*/
   /* Filter sales order according to handling code from TI0FM001.*/
   /* ------------------------------------------------------------*/

  set VTHMSG01 empty; /* Clear row storage area*/

  VTHMSG01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

  VTHMSG01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

  TI0FW00.TI0FW-THMSG-EOF-FL = "N"; /* VTRMSG01 record found*/

  TI0FS-VTHMSG01-S1(); /* Declare and Open cursor*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

    TI0FW00.TI0FW-THMSG-EOF-FL = "Y"; /* VTOHDR01 record found*/

  end

  if (TI0FW00.TI0FW-THMSG-EOF-FL != "Y"
  )
    TI0FS-VTHMSG01-N1(); /* Select the table row*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

      TI0FW00.TI0FW-THMSG-EOF-FL = "Y"; /* VTOHDR01 record found*/

    end

  end

  while ((TI0FW00.TI0FW-THMSG-EOF-FL != "Y"))

    TI0FW00.TI0FW-TI-CUTK-MSG-CD-IDX = 1;

    while ((TI0FW00.TI0FW-TI-CUTK-MSG-CD-IDX <= 5
     && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL != "Y"))

      if (VTHMSG01.TI-CUTK-MSG-CD
       == TI0FM001.TI-CUTK-MSG-CD[TI0FW-TI-CUTK-MSG-CD-IDX])

        TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";

      end

      TI0FW-TI-CUTK-MSG-CD-IDX = TI0FW-TI-CUTK-MSG-CD-IDX + 1;
    end /* (TI0FW00.TI0FW-TI-CUTK-MSG-CD-IDX LE 5)*/

    TI0FS-VTHMSG01-N1(); /* Select the table row*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

      TI0FW00.TI0FW-THMSG-EOF-FL = "Y"; /* VTOHDR01 record found*/

    end
  end /* WHILE (TI0FW00.TI0FW-THMSG-EOF-FL NE 'Y'*/

  TI0FS-VTHMSG01-C1(); /* Close selected set cursor*/

  set VTRMSG01 empty; /* Clear row storage area*/

  VTRMSG01.OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;

  VTRMSG01.OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;

  VTRMSG01.TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;

  TI0FW00.TI0FW-TRMSG-EOF-FL = "N"; /* VTRMSG01 record found*/

  TI0FS-VTRMSG01-S1(); /* Declare and Open cursor*/

  if (SQLCA.VAGen_SQLCODE == 100) /* Abnormal return code*/

    TI0FW00.TI0FW-TRMSG-EOF-FL = "Y"; /* VTOHDR01 record found*/

  end

  if (TI0FW00.TI0FW-TRMSG-EOF-FL != "Y"
  )
    TI0FS-VTRMSG01-N1(); /* Select the table row*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Normal return code*/

      TI0FW00.TI0FW-TRMSG-EOF-FL = "Y"; /* VTOHDR01 record found*/

    end

  end

  while ((TI0FW00.TI0FW-TRMSG-EOF-FL != "Y"))

    TI0FW00.TI0FW-TI-CUTK-MSG-CD-IDX = 1;

    while ((TI0FW00.TI0FW-TI-CUTK-MSG-CD-IDX <= 5
     && TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL != "Y"))

      if (VTRMSG01.TI-CUTK-MSG-CD
       == TI0FM001.TI-CUTK-MSG-CD[TI0FW-TI-CUTK-MSG-CD-IDX])

        TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "Y";

      end

      TI0FW-TI-CUTK-MSG-CD-IDX = TI0FW-TI-CUTK-MSG-CD-IDX + 1;
    end /* (TI0FW00.TI0FW-TI-CUTK-MSG-CD-IDX LE 5)*/

    TI0FS-VTRMSG01-N1(); /* Select the table row*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Record not found*/

      TI0FW00.TI0FW-TRMSG-EOF-FL = "Y"; /* VTOHDR01 record found*/

    end
  end /* WHILE (TI0FW00.TI0FW-TRMSG-EOF-FL NE 'Y'*/

  TI0FS-VTRMSG01-C1(); /* Close selected set cursor*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-EMSGCODE-ED

// FILTER SALES ORD BY NEED DATE
Function TI0FS-ESENDDT-ED()
   /* ------------------------------------------------------------*/
   /* Filter sales order according to need date from TI0FM001.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "Y";

  if (VTORQT01.TI-CUTK-EST-SND-DT < TI0FW00.TI0FW-CUST-EST-SNT-DT-LOW
   || VTORQT01.TI-CUTK-EST-SND-DT > TI0FW00.TI0FW-CUST-EST-SNT-DT-HI)

    TI0FW00.TI0FW-CUST-EST-SNT-DT-OK-FL = "N";

  end
end // end TI0FS-ESENDDT-ED

// Filter sales ord by err messge
Function TI0FS-HNDLCODE-ED()
   /* ------------------------------------------------------------*/
   /* Filter sales order according to handling code from TI0FM001.*/
   /* ------------------------------------------------------------*/

  OP2REC.OP1CUOID = VTORQT01.OP-CUST-ORD-ID;

  OP2REC.OP1NORID = VTORQT01.OP-NIKE-ORD-ID;

  OP2REC.OP2LNINB = VTORQT01.TI-CUTK-RQT-NBR;

  TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM = VTORQT01.OP-CUST-ORD-ID;

  TI0FW00.TI0FW-OP-CUST-ORD-ID-LCHA = TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM;

  OP2REC.OP1PARTN = TI0FW00.TI0FW-OP-ORD-PART-CHA;
  TI0FS-IO0440-S();

  if (converseVar.validationMsgNum == 0)

    TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL = "Y";

    if (TI0FM001.XHD-HNDL-CD
     in OP2REC.XHDCD from sysVar.arrayIndex)

      /* CONTINUE*/

    else

      TI0FW00.TI0FW-XHD-HNDL-CD-OK-FL = "N";

    end
  end
end // end TI0FS-HNDLCODE-ED

// Select the table row
Function TI0FS-IO0040-S()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "IO0040" ("S ", SQLCA, SY4REC) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "IO0040S"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-IO0040-S      "; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VSCALE01"; /* Table view name*/
  TA1REC.TA1TBLKE = SY4REC.SY4SZSCL; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-IO0040-S

// Select the table row
Function TI0FS-IO0120-S()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "IO0120" ("S ", SQLCA, SY1REC) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "IO0120S"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-IO0120-S      "; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VSTYLE01"; /* Table view name*/
  TA1REC.TA1TBLKE = SY1REC.SY1KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-IO0120-S

// Select the table row
Function TI0FS-IO0240-S()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "IO0240" ("S ", SQLCA, KUCREC) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "IO0240S"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-IO0240-S      "; /* Description*/
  TA1REC.TA1DBASE = "DCORP   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VCMPNY01"; /* Table view name*/
  TI0FW00.TI0FW-KUCCOID-NUM = KUCREC.KUCCOID; /* Table key*/
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-KUCCOID-NUM; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-IO0240-S

// Select the table row
Function TI0FS-IO0280-SN()
   /* ------------------------------------------------------------*/
   /* Select requested row from dorder.vorhdr01.*/
   /* ------------------------------------------------------------*/

  try
    call "IO0280" ("SN", SQLCA, KUNREC) {isNoRefresh = yes, isExternal = yes};
  end

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
  )                                 
    if (SQLCA.VAGen_SQLCODE == 0 /* If found*/
     || SQLCA.VAGen_SQLCODE == +100) /* or not found*/
      return;
    end

  end

   /* ------------------------------------------------------------*/
   /* If data not found or not available, return an error message.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "IO0280SN"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not availble*/

    converseLib.validationFailed(134); /* Data in use by another appl*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(124); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-IO0280-SN       "; /* Description*/
  TA1REC.TA1DBASE = "DCUST"; /* Data base name*/
  TA1REC.TA1TBLVU = "VCUST001"; /* Table view name*/
  TA1REC.TA1TBLKE = KUNREC.KUNGRP; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes};

  exit stack;
end // end TI0FS-IO0280-SN

// Select the table row
Function TI0FS-IO0280-SS()
   /* ------------------------------------------------------------*/
   /* Select requested row from dorder.vorhdr01.*/
   /* ------------------------------------------------------------*/

  try
    call "IO0280" ("SS", SQLCA, KUNREC) {isNoRefresh = yes, isExternal = yes};
  end

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
  )                                 
    if (SQLCA.VAGen_SQLCODE == 0 /* If found*/
     || SQLCA.VAGen_SQLCODE == +100) /* or not found*/
      return;
    end

  end

   /* ------------------------------------------------------------*/
   /* If data not found or not available, return an error message.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "IO0280SS"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not availble*/

    converseLib.validationFailed(134); /* Data in use by another appl*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(124); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-IO0280-S        "; /* Description*/
  TA1REC.TA1DBASE = "DCUST"; /* Data base name*/
  TA1REC.TA1TBLVU = "VCUST001"; /* Table view name*/
  TA1REC.TA1TBLKE = KUNREC.KUNGRP; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes};

  exit stack;
end // end TI0FS-IO0280-SS

// Select the table row
Function TI0FS-IO0430-S()
   /* ------------------------------------------------------------*/
   /* Select requested row from dorder.vorhdr01.*/
   /* ------------------------------------------------------------*/

  converseLib.validationFailed(0);

  try
    call "IO0430" ("S ", SQLCA, OP1REC) {isNoRefresh = yes, isExternal = yes};
  end

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
  )                                 
    if (SQLCA.VAGen_SQLCODE == 0 /* If found*/
     || SQLCA.VAGen_SQLCODE == +100) /* or not found*/
      return;
    end

  end

   /* ------------------------------------------------------------*/
   /* If data not found or not available, return an error message.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "IO0430S "; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not availble*/

    converseLib.validationFailed(134); /* Data in use by another appl*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(124); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2"; /* Type of error*/
  TA1REC.TA1PGMNM = "IO0430"; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-IO0430-S        "; /* Description*/
  TA1REC.TA1DBASE = "DORDER"; /* Data base name*/
  TA1REC.TA1TBLVU = "VORHDR01"; /* Table view name*/
  TA1REC.TA1TBLKE = OP1REC.OP1KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes};

  exit stack;


end // end TI0FS-IO0430-S

// Select the table row
Function TI0FS-IO0440-S()
   /* ------------------------------------------------------------*/
   /* Select requested row from dorder.vorhdr01.*/
   /* ------------------------------------------------------------*/

  converseLib.validationFailed(0);

  try
    call "IO0440" ("S ", SQLCA, OP2REC) {isNoRefresh = yes, isExternal = yes};
  end

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
  )                                 
    if (SQLCA.VAGen_SQLCODE == 0 /* If found*/
     || SQLCA.VAGen_SQLCODE == +100) /* or not found*/
      return;
    end

  end

   /* ------------------------------------------------------------*/
   /* If data not found or not available, return an error message.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "IO0430S "; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not availble*/

    converseLib.validationFailed(134); /* Data in use by another appl*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(124); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2"; /* Type of error*/
  TA1REC.TA1PGMNM = "IO0440"; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-IO0430-S        "; /* Description*/
  TA1REC.TA1DBASE = "DORDER"; /* Data base name*/
  TA1REC.TA1TBLVU = "VITEM001"; /* Table view name*/
  TA1REC.TA1TBLKE = OP2REC.OP2KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes};

  exit stack;


end // end TI0FS-IO0440-S

// Select the table row
Function TI0FS-IO0560-S()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "IO0560" ("S ", SQLCA, SYCREC) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "IO0560S"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SELECT THE TABLE ROW"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VCOLOR02"; /* Table view name*/
  TA1REC.TA1TBLKE = SYCREC.SYCKEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-IO0560-S

// Select the table row
Function TI0FS-IO0560-SN()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "IO0560" ("SN", SQLCA, SYCREC) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "IO0560S"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SELECT THE TABLE ROW"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VCOLOR02"; /* Table view name*/
  TA1REC.TA1TBLKE = SYCREC.SYCKEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-IO0560-SN

// Select the table row
Function TI0FS-IO0560-SS()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "IO0560" ("SS", SQLCA, SYCREC) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "IO0560S"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SELECT THE TABLE ROW"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VCOLOR02"; /* Table view name*/
  TA1REC.TA1TBLKE = SYCREC.SYCKEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-IO0560-SS

// Select the table row
Function TI0FS-IO2810-S()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "IO2810" ("S ", SQLCA, FY1REC) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "IO2810S"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-IO2810-S      "; /* Description*/
  TA1REC.TA1DBASE = "DFCTY   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VFCTY001"; /* Table view name*/
  TI0FW00.TI0FW-FCTY-S-XGP-GPC-CD = TI0FM001.XGP-GPC-CD;
  TI0FW00.TI0FW-FCTY-S-FY-FCTY-CD = TI0FM001.FY-FCTY-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-FCTY-S-KEY;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-IO2810-S

// Select the table row
Function TI0FS-IO3270-C5()
   /* ------------------------------------------------------------*/
   /* Select requested row from dorder.vorhdr01.*/
   /* ------------------------------------------------------------*/

  try
    call "IO3270" ("C5", SQLCA, PC3REC) {isNoRefresh = yes, isExternal = yes};
  end

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
  )                                 
    if (SQLCA.VAGen_SQLCODE == 0 /* If found*/
     || SQLCA.VAGen_SQLCODE == +100) /* or not found*/
      return;
    end

  end

   /* ------------------------------------------------------------*/
   /* If data not found or not available, return an error message.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "IO3270C5"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not availble*/

    converseLib.validationFailed(134); /* Data in use by another appl*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(124); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-IO3270-C5       "; /* Description*/
  TA1REC.TA1DBASE = "DPRODC"; /* Data base name*/
  TA1REC.TA1TBLVU = "VPOHDR01"; /* Table view name*/
  TA1REC.TA1TBLKE = PC3REC.PC3KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes};

  exit stack;


end // end TI0FS-IO3270-C5

// Select the table row
Function TI0FS-IO3270-N5()
   /* ------------------------------------------------------------*/
   /* Select requested row from dorder.vorhdr01.*/
   /* ------------------------------------------------------------*/

  try
    call "IO3270" ("N5", SQLCA, PC3REC) {isNoRefresh = yes, isExternal = yes};
  end

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
  )                                 
    if (SQLCA.VAGen_SQLCODE == 0 /* If found*/
     || SQLCA.VAGen_SQLCODE == +100) /* or not found*/
      return;
    end

  end

   /* ------------------------------------------------------------*/
   /* If data not found or not available, return an error message.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "IO3270N5"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not availble*/

    converseLib.validationFailed(134); /* Data in use by another appl*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(124); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-IO3270-N5       "; /* Description*/
  TA1REC.TA1DBASE = "DPRODC"; /* Data base name*/
  TA1REC.TA1TBLVU = "VPOHDR01"; /* Table view name*/
  TA1REC.TA1TBLKE = PC3REC.PC3KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes};

  exit stack;


end // end TI0FS-IO3270-N5

// Select the table row
Function TI0FS-IO3270-S()
   /* ------------------------------------------------------------*/
   /* Select requested row from dorder.vorhdr01.*/
   /* ------------------------------------------------------------*/

  try
    call "IO3270" ("S ", SQLCA, PC3REC) {isNoRefresh = yes, isExternal = yes};
  end

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
  )                                 
    if (SQLCA.VAGen_SQLCODE == 0 /* If found*/
     || SQLCA.VAGen_SQLCODE == +100) /* or not found*/
      return;
    end

  end

   /* ------------------------------------------------------------*/
   /* If data not found or not available, return an error message.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "IO3270S "; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not availble*/

    converseLib.validationFailed(134); /* Data in use by another appl*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(124); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-IO3270-S        "; /* Description*/
  TA1REC.TA1DBASE = "DPRODC"; /* Data base name*/
  TA1REC.TA1TBLVU = "VPOHDR01"; /* Table view name*/
  TA1REC.TA1TBLKE = PC3REC.PC3KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes};

  exit stack;


end // end TI0FS-IO3270-S

// Select the table row
Function TI0FS-IO3270-S5()
   /* ------------------------------------------------------------*/
   /* Select requested row from dorder.vorhdr01.*/
   /* ------------------------------------------------------------*/

  try
    call "IO3270" ("S5", SQLCA, PC3REC) {isNoRefresh = yes, isExternal = yes};
  end

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
  )                                 
    if (SQLCA.VAGen_SQLCODE == 0 /* If found*/
     || SQLCA.VAGen_SQLCODE == +100) /* or not found*/
      return;
    end

  end

   /* ------------------------------------------------------------*/
   /* If data not found or not available, return an error message.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "IO3270S5"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not availble*/

    converseLib.validationFailed(134); /* Data in use by another appl*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(124); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-IO3270-S5       "; /* Description*/
  TA1REC.TA1DBASE = "DPRODC"; /* Data base name*/
  TA1REC.TA1TBLVU = "VPOHDR01"; /* Table view name*/
  TA1REC.TA1TBLKE = PC3REC.PC3KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes};

  exit stack;


end // end TI0FS-IO3270-S5

// Select the table row
Function TI0FS-IO3340-S()
   /* ------------------------------------------------------------*/
   /* Select requested row from dorder.vorhdr01.*/
   /* ------------------------------------------------------------*/

  try
    call "IO3340" ("S ", SQLCA, PC2REC) {isNoRefresh = yes, isExternal = yes};
  end

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
  )                                 
    if (SQLCA.VAGen_SQLCODE == 0 /* If found*/
     || SQLCA.VAGen_SQLCODE == +100) /* or not found*/
      return;
    end

  end

   /* ------------------------------------------------------------*/
   /* If data not found or not available, return an error message.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "IO3340S "; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not availble*/

    converseLib.validationFailed(134); /* Data in use by another appl*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(124); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SELECT BY PRDCU+XGPCD "; /* Description*/
  TA1REC.TA1DBASE = "DPRODC"; /* Data base name*/
  TA1REC.TA1TBLVU = "VPRDCU01"; /* Table view name*/
  TA1REC.TA1TBLKE = PC2REC.PC2GROUP; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes};

  exit stack;


end // end TI0FS-IO3340-S

// FILTER SALES ORD BY NEED DATE
Function TI0FS-NEEDDATE-ED()
   /* ------------------------------------------------------------*/
   /* Filter sales order according to need date from TI0FM001.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-CUST-NEED-DT-OK-FL = "Y";

  if (TI0FM001.TI0FW-CUST-NEED-DT-TO == 0)

    TI0FM001.TI0FW-CUST-NEED-DT-TO = TI0FM001.TI0FW-CUST-NEED-DT-FROM;

  end

  TI0FW00.TI0FW-CUST-NEED-DT-FR-NUM = TI0FM001.TI0FW-CUST-NEED-DT-FROM;

  TI0FW00.TI0FW-CUST-NEED-DT-FR-CHA = TI0FW00.TI0FW-CUST-NEED-DT-FR-NUM;

  TI0FW00.TI0FW-CUST-NEED-DT-LOW-MM = TI0FW00.TI0FW-CUST-NEED-DT-FR-MM;

  TI0FW00.TI0FW-CUST-NEED-DT-LOW-DD = TI0FW00.TI0FW-CUST-NEED-DT-FR-DD;

  TI0FW00.TI0FW-CUST-NEED-DT-LOW-YY = TI0FW00.TI0FW-CUST-NEED-DT-FR-YY;

  TI0FW00.TI0FW-CUST-NEED-DT-LOW = TI0FW00.TI0FW-CUST-NEED-DT-LOW-CHA;

  TI0FW00.TI0FW-CUST-NEED-DT-TO-NUM = TI0FM001.TI0FW-CUST-NEED-DT-TO;

  TI0FW00.TI0FW-CUST-NEED-DT-TO-CHA = TI0FW00.TI0FW-CUST-NEED-DT-TO-NUM;

  TI0FW00.TI0FW-CUST-NEED-DT-HI-YY = TI0FW00.TI0FW-CUST-NEED-DT-TO-YY;

  TI0FW00.TI0FW-CUST-NEED-DT-HI-MM = TI0FW00.TI0FW-CUST-NEED-DT-TO-MM;

  TI0FW00.TI0FW-CUST-NEED-DT-HI-DD = TI0FW00.TI0FW-CUST-NEED-DT-TO-DD;

  TI0FW00.TI0FW-CUST-NEED-DT-HI = TI0FW00.TI0FW-CUST-NEED-DT-HI-CHA;

  if (TI0FW00.TI0FW-DATE-WRK6 < TI0FW00.TI0FW-CUST-NEED-DT-LOW
   || TI0FW00.TI0FW-DATE-WRK6 > TI0FW00.TI0FW-CUST-NEED-DT-HI)

    TI0FW00.TI0FW-CUST-NEED-DT-OK-FL = "N";

  end
end // end TI0FS-NEEDDATE-ED

// FILTER SALES ORD BY NEED DATE
Function TI0FS-SENDIND-ED()
   /* ------------------------------------------------------------*/
   /* Filter sales order according to send indicator from TI0FM001.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "N";

  if (VTORQT01.TI-CUTK-SEND-CD == TI0FW00.TI-CUTK-SEND-CD)

    TI0FW00.TI0FW-TI-CUTK-SEND-CD-OK-FL = "Y";

  end
end // end TI0FS-SENDIND-ED

// FILTER SALES ORD BY NEED DATE
Function TI0FS-SPLRCODE-ED()
   /* ------------------------------------------------------------*/
   /* Filter sales order according to need date from TI0FM001.*/
   /* ------------------------------------------------------------*/

  if (VTORQT01.TI-CUTK-SPLR-CD == TI0FM001.TI-CUTK-SPLR-CD)

    TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "Y";

  end
end // end TI0FS-SPLRCODE-ED

// FILTER SALES ORD BY NEED DATE
Function TI0FS-STATCODE-ED()
  TI0FW00.TI0FW-TI-CUTK-STAT-CD-ED-IDX = 6;

  while ((TI0FW-TI-CUTK-STAT-CD-ED-IDX >= 1)
   && (TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL != "Y"))

    if ((VTORQT01.TI-CUTK-STAT-CD
     == TI0FM001.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-ED-IDX]))

      TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL = "Y";

    end

    TI0FW00.TI0FW-TI-CUTK-STAT-CD-ED-IDX = TI0FW00.TI0FW-TI-CUTK-STAT-CD-ED-IDX - 1;

  end /* WHILE (TI0FW-TI-CUTK-STAT-CD-ED-IDX GE 1)*/
       /* AND (TI0FW00.TI0FW-TI-CUTK-STAT-CD-OK-FL NE 'Y')*/
end // end TI0FS-STATCODE-ED

// Filter sales ord by styl-colr
Function TI0FS-STYLCOLR-ED()
   /* ------------------------------------------------------------*/
   /* Filter sales order according to style and color entered in ti0fw00.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-STYLE-COLR-OK-FL = "Y";

  if (VTORQT01.SY-STY-NBR != TI0FW00.TI0FW-SY-STY-CD)

    TI0FW00.TI0FW-STYLE-COLR-OK-FL = "N";

  else

    if (VTORQT01.SY-COLR-CD-ID != TI0FW00.TI0FW-SY-COLR-CD-ID
     && TI0FW00.TI0FW-SY-COLR-CD-ID > " ")

      TI0FW00.TI0FW-STYLE-COLR-OK-FL = "N";

    end

  end
end // end TI0FS-STYLCOLR-ED

// Purge any temporary storage
Function TI0FS-TI0FW01-TP()
   /* ------------------------------------------------------------*/
   /* Initialize the storage areas and indicators to be used.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

  TA5REC.TA5TSQIX = 0; /* Displayed page number*/
  TI0FW00.XXX-HI-PAGE-NBR = 0; /* Highest page number*/

   /* ------------------------------------------------------------*/
   /* Purge any temporary storage for this application.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5APPID = "TIF1"; /* Application identification*/

  TA5REC.TA5FNCCD = "P"; /* Function code*/

  try
    call "TA0050" (TI0FW01, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Purge storage*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA5REC.TA5RTNCD == 0)          /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TA0050P"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "PURGE ANY TEMPORARY STORAGE"; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-TI0FW01-TP

// Add page to temporary storage
Function TI0FS-TI0FW02-TA()
   /* ------------------------------------------------------------*/
   /* Add the next page to the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  TI0FW02.XGP-GPC-CD = TI0FW01.XGP-GPC-CD;

  TI0FW02.XXX-TEMP-STG-LNTH = TI0FW00.XXX-TEMP-STG-LNTH;
                                  /* Temporary storage length*/
  TA5REC.TA5APPID = "TIF2"; /* Application identification*/

  TA5REC.TA5FNCCD = "A"; /* Function code*/

  try
    call "TA0050" (TI0FW02, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Add page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, initialize the storage area and*/
   /* indicators to be used and return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0) /* and normal return code*/

      set TI0FW02 empty; /* M001 display storage*/

      TI0FW00.TI0FW-M002-HI-PAGE-NBR = TA5REC.TA5TSQIX;

      TA5REC.TA5TSQIX = 0; /* Clear last page number*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TI0FW02A"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-TI0FW02-TA             "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-TI0FW02-TA

// Purge any temporary storage
Function TI0FS-TI0FW02-TP()
   /* ------------------------------------------------------------*/
   /* Initialize the storage areas and indicators to be used.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

  TA5REC.TA5TSQIX = 0; /* Displayed page number*/
  TI0FW00.XXX-HI-PAGE-NBR = 0; /* Highest page number*/

   /* ------------------------------------------------------------*/
   /* Purge any temporary storage for this application.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5APPID = "TIF2"; /* Application identification*/

  TA5REC.TA5FNCCD = "P"; /* Function code*/

  try
    call "TA0050" (TI0FW02, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Purge storage*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0) /* and normal return code*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TI0FW02P"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-TI0FW02-TP           "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-TI0FW02-TP

// Read temporary storage page
Function TI0FS-TI0FW02-TR()
   /* ------------------------------------------------------------*/
   /* Read the next page from the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  TI0FW02.XXX-TEMP-STG-LNTH = TI0FW00.XXX-TEMP-STG-LNTH;
                                   /* Temporary storage length*/

  TA5REC.TA5APPID = "TIF2"; /* Application identification*/

  TA5REC.TA5FNCCD = "R"; /* Function code*/

  try
    call "TA0050" (TI0FW02, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Read page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0) /* and normal return code*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TI0FW02R"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-TI0FW02-TR           "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

end // end TI0FS-TI0FW02-TR

// Update temporary storage page
Function TI0FS-TI0FW02-TU()
   /* ------------------------------------------------------------*/
   /* Update the page in the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5APPID = "TIF2";

  TA5REC.TA5FNCCD = "U"; /* Function code*/

  try
    call "TA0050" (TI0FW02, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Update page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0) /* and normal return code*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TI0FW02U"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-TI0FW02-TU             "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-TI0FW02-TU

// Add page to temporary storage
Function TI0FS-TI0FW03-TA()
   /* ------------------------------------------------------------*/
   /* Add the next page to the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  TI0FW03.XGP-GPC-CD = TI0FW01.XGP-GPC-CD;

  TI0FW03.XXX-TEMP-STG-LNTH = TI0FW00.XXX-TEMP-STG-LNTH;
                                  /* Temporary storage length*/
  TA5REC.TA5APPID = "TIF3"; /* Application identification*/

  TA5REC.TA5FNCCD = "A"; /* Function code*/

  try
    call "TA0050" (TI0FW03, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Add page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, initialize the storage area and*/
   /* indicators to be used and return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0) /* and normal return code*/

      set TI0FW03 empty; /* M001 display storage*/

      TI0FW00.TI0FW-M003-HI-PAGE-NBR = TA5REC.TA5TSQIX;

      TA5REC.TA5TSQIX = 0; /* Clear last page number*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TI0FW03A"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-TI0FW03-TA             "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-TI0FW03-TA

// Purge any temporary storage
Function TI0FS-TI0FW03-TP()
   /* ------------------------------------------------------------*/
   /* Initialize the storage areas and indicators to be used.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

  TA5REC.TA5TSQIX = 0; /* Displayed page number*/
  TI0FW00.XXX-HI-PAGE-NBR = 0; /* Highest page number*/

   /* ------------------------------------------------------------*/
   /* Purge any temporary storage for this application.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5APPID = "TIF3"; /* Application identification*/

  TA5REC.TA5FNCCD = "P"; /* Function code*/

  try
    call "TA0050" (TI0FW03, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Purge storage*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0) /* and normal return code*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TI0FW03P"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-TI0FW03-TP           "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-TI0FW03-TP

// Read temporary storage page
Function TI0FS-TI0FW03-TR()
   /* ------------------------------------------------------------*/
   /* Read the next page from the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  TI0FW03.XXX-TEMP-STG-LNTH = TI0FW00.XXX-TEMP-STG-LNTH;
                                   /* Temporary storage length*/

  TA5REC.TA5APPID = "TIF3"; /* Application identification*/

  TA5REC.TA5FNCCD = "R"; /* Function code*/

  try
    call "TA0050" (TI0FW03, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Read page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0) /* and normal return code*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TI0FW03R"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-TI0FW03-TR           "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

end // end TI0FS-TI0FW03-TR

// Update temporary storage page
Function TI0FS-TI0FW03-TU()
   /* ------------------------------------------------------------*/
   /* Update the page in the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5APPID = "TIF3";

  TA5REC.TA5FNCCD = "U"; /* Function code*/

  try
    call "TA0050" (TI0FW03, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Update page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0) /* and normal return code*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TI0FW03U"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-TI0FW03-TU             "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-TI0FW03-TU

// Add page to temporary storage
Function TI0FS-TI0FW05-TA()
   /* ------------------------------------------------------------*/
   /* Add the next page to the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  TI0FW05.XXX-TEMP-STG-LNTH = TI0FW00.XXX-TEMP-STG-LNTH;
                                  /* Temporary storage length*/
  TA5REC.TA5APPID = "TIF5"; /* Application identification*/

  TA5REC.TA5FNCCD = "A"; /* Function code*/

  try
    call "TA0050" (TI0FW05, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Add page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, initialize the storage area and*/
   /* indicators to be used and return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0) /* and normal return code*/

      set TI0FW05 empty; /* M001 display storage*/

      TI0FW00.TI0FW-M005-HI-PAGE-NBR = TA5REC.TA5TSQIX;

      TA5REC.TA5TSQIX = 0; /* Clear last page number*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TI0FW05A"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-TI0FW05-TA             "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-TI0FW05-TA

// Purge any temporary storage
Function TI0FS-TI0FW05-TP()
   /* ------------------------------------------------------------*/
   /* Initialize the storage areas and indicators to be used.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

  TA5REC.TA5TSQIX = 0; /* Displayed page number*/
  TI0FW00.XXX-HI-PAGE-NBR = 0; /* Highest page number*/

   /* ------------------------------------------------------------*/
   /* Purge any temporary storage for this application.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5APPID = "TIF5"; /* Application identification*/

  TA5REC.TA5FNCCD = "P"; /* Function code*/

  try
    call "TA0050" (TI0FW05, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Purge storage*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0) /* and normal return code*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TI0FW05P"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-TI0FW05-TP           "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-TI0FW05-TP

// Read temporary storage page
Function TI0FS-TI0FW05-TR()
   /* ------------------------------------------------------------*/
   /* Read the next page from the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  TI0FW05.XXX-TEMP-STG-LNTH = TI0FW00.XXX-TEMP-STG-LNTH;
                                   /* Temporary storage length*/

  TA5REC.TA5APPID = "TIF5"; /* Application identification*/

  TA5REC.TA5FNCCD = "R"; /* Function code*/

  try
    call "TA0050" (TI0FW05, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Read page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0) /* and normal return code*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TI0FW05R"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-TI0FW05-TR           "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

end // end TI0FS-TI0FW05-TR

// Update temporary storage page
Function TI0FS-TI0FW05-TU()
   /* ------------------------------------------------------------*/
   /* Update the page in the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5APPID = "TIF5";

  TA5REC.TA5FNCCD = "U"; /* Function code*/

  try
    call "TA0050" (TI0FW05, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Update page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0) /* and normal return code*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TI0FW05U"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-TI0FW05-TU             "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-TI0FW05-TU

// Add page to temporary storage
Function TI0FS-TI0FW06-TA()
   /* ------------------------------------------------------------*/
   /* Add the next page to the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  TI0FW06.XXX-TEMP-STG-LNTH = TI0FW00.XXX-TEMP-STG-LNTH;
                                  /* Temporary storage length*/
  TA5REC.TA5APPID = "TIF6"; /* Application identification*/

  TA5REC.TA5FNCCD = "A"; /* Function code*/

  try
    call "TA0050" (TI0FW06, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Add page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, initialize the storage area and*/
   /* indicators to be used and return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0) /* and normal return code*/

      set TI0FW06 empty; /* M001 display storage*/

      TI0FW00.TI0FW-M006-HI-PAGE-NBR = TA5REC.TA5TSQIX;

      TA5REC.TA5TSQIX = 0; /* Clear last page number*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TI0FW06A"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-TI0FW06-TA             "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-TI0FW06-TA

// Purge any temporary storage
Function TI0FS-TI0FW06-TP()
   /* ------------------------------------------------------------*/
   /* Initialize the storage areas and indicators to be used.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

  TA5REC.TA5TSQIX = 0; /* Displayed page number*/
  TI0FW00.XXX-HI-PAGE-NBR = 0; /* Highest page number*/

   /* ------------------------------------------------------------*/
   /* Purge any temporary storage for this application.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5APPID = "TIF6"; /* Application identification*/

  TA5REC.TA5FNCCD = "P"; /* Function code*/

  try
    call "TA0050" (TI0FW06, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Purge storage*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0) /* and normal return code*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TI0FW06P"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-TI0FW06-TP           "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-TI0FW06-TP

// Read temporary storage page
Function TI0FS-TI0FW06-TR()
   /* ------------------------------------------------------------*/
   /* Read the next page from the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  TI0FW06.XXX-TEMP-STG-LNTH = TI0FW00.XXX-TEMP-STG-LNTH;
                                   /* Temporary storage length*/

  TA5REC.TA5APPID = "TIF6"; /* Application identification*/

  TA5REC.TA5FNCCD = "R"; /* Function code*/

  try
    call "TA0050" (TI0FW06, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Read page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0) /* and normal return code*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TI0FW06R"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-TI0FW06-TR           "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

end // end TI0FS-TI0FW06-TR

// Update temporary storage page
Function TI0FS-TI0FW06-TU()
   /* ------------------------------------------------------------*/
   /* Update the page in the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5APPID = "TIF6";

  TA5REC.TA5FNCCD = "U"; /* Function code*/

  try
    call "TA0050" (TI0FW06, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Update page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0) /* and normal return code*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TI0FW06U"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-TI0FW06-TU             "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-TI0FW06-TU

// Add page to temporary storage
Function TI0FS-TI0FW07-TA()
   /* ------------------------------------------------------------*/
   /* Add the next page to the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  TI0FW07.XXX-TEMP-STG-LNTH = TI0FW00.XXX-TEMP-STG-LNTH;
                                  /* Temporary storage length*/
  TA5REC.TA5APPID = "TIF7"; /* Application identification*/

  TA5REC.TA5FNCCD = "A"; /* Function code*/

  try
    call "TA0050" (TI0FW07, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Add page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, initialize the storage area and*/
   /* indicators to be used and return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0) /* and normal return code*/

      set TI0FW07 empty; /* M001 display storage*/

      TI0FW00.TI0FW-M007-HI-PAGE-NBR = TA5REC.TA5TSQIX;

      TA5REC.TA5TSQIX = 0; /* Clear last page number*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TI0FW07A"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-TI0FW07-TA             "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-TI0FW07-TA

// Purge any temporary storage
Function TI0FS-TI0FW07-TP()
   /* ------------------------------------------------------------*/
   /* Initialize the storage areas and indicators to be used.*/
   /* ------------------------------------------------------------*/

  TI0FW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

  TA5REC.TA5TSQIX = 0; /* Displayed page number*/
  TI0FW00.XXX-HI-PAGE-NBR = 0; /* Highest page number*/

   /* ------------------------------------------------------------*/
   /* Purge any temporary storage for this application.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5APPID = "TIF7"; /* Application identification*/

  TA5REC.TA5FNCCD = "P"; /* Function code*/

  try
    call "TA0050" (TI0FW07, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Purge storage*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0) /* and normal return code*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TI0FW07P"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-TI0FW07-TP           "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-TI0FW07-TP

// Read temporary storage page
Function TI0FS-TI0FW07-TR()
   /* ------------------------------------------------------------*/
   /* Read the next page from the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  TI0FW07.XXX-TEMP-STG-LNTH = TI0FW00.XXX-TEMP-STG-LNTH;
                                   /* Temporary storage length*/

  TA5REC.TA5APPID = "TIF7"; /* Application identification*/

  TA5REC.TA5FNCCD = "R"; /* Function code*/

  try
    call "TA0050" (TI0FW07, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Read page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0) /* and normal return code*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TI0FW07R"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-TI0FW07-TR           "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

end // end TI0FS-TI0FW07-TR

// Update temporary storage page
Function TI0FS-TI0FW07-TU()
   /* ------------------------------------------------------------*/
   /* Update the page in the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5APPID = "TIF7";

  TA5REC.TA5FNCCD = "U"; /* Function code*/

  try
    call "TA0050" (TI0FW07, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Update page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0) /* and normal return code*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  TIWREC.XXX-MSG-LOC-ID = "TI0FW07U"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(10); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-TI0FW07-TU             "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-TI0FW07-TU

// Select the table row
Function TI0FS-TI9900-SC()
  try
    call "TI9900" (TIXREC, SQLCA, VTIMSG01) {isNoRefresh = yes, isExternal = yes};
  end

  if (sysVar.errorCode == "00000000")

    if (SQLCA.VAGen_SQLCODE == 0
     || SQLCA.VAGen_SQLCODE == 100
     || SQLCA.VAGen_SQLCODE == -811)

      return;

    end

  end

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/

  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "TI9900"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 ";
  TA1REC.TA1FUNC = "SC  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID;
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-TI9900-SC   ";
  TA1REC.TA1DBASE = "DCUTKT  ";
  TA1REC.TA1TBLVU = "VTIMSG01";
  TI0FW00.TI0FW-IMSG-S1-OP-CUST-ORD-ID = VTIMSG01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-IMSG-S1-OP-NIKE-ORD-ID = VTIMSG01.OP-NIKE-ORD-ID;
  TI0FW00.TI0FW-IMSG-S1-TI-CUTK-RQT-NBR = VTIMSG01.TI-CUTK-RQT-NBR;
  TI0FW00.TI0FW-IMSG-S1-TI-CUTK-LINE-NBR = VTIMSG01.TI-CUTK-LINE-NBR;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-IMSG-S1-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes};

  exit stack;
     /* END OF STATEMENT GROUP*/
end // end TI0FS-TI9900-SC

// Select the table row
Function TI0FS-TI9910-SS()
  try
    call "TI9910" (TIXREC, SQLCA, VTOITM01) {isNoRefresh = yes, isExternal = yes};
  end

  if (sysVar.errorCode == "00000000")

    if (SQLCA.VAGen_SQLCODE == 0
     || SQLCA.VAGen_SQLCODE == 100
     || SQLCA.VAGen_SQLCODE == -305)

      return;

    end

  end

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/

  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "TI9910"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 ";
  TA1REC.TA1FUNC = "SS  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID;
  TA1REC.TA1LOC = "TI0FS-TI9910-SS   ";
  TA1REC.TA1DBASE = "DCUTKT  ";
  TA1REC.TA1TBLVU = "VTOITM01";
  TI0FW00.TI0FW-ITM-S1-OP-CUST-ORD-ID = VTOITM01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-ITM-S1-OP-NIKE-ORD-ID = VTOITM01.OP-NIKE-ORD-ID;
  TI0FW00.TI0FW-ITM-S1-TI-CUTK-RQT-NBR = VTOITM01.TI-CUTK-RQT-NBR;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-ITM-S1-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes};

  exit stack;
     /* END OF STATEMENT GROUP*/
end // end TI0FS-TI9910-SS

// Select the table row
Function TI0FS-TI9920-SC()
  try
    call "TI9920" (TIXREC, SQLCA, VTRMSG01) {isNoRefresh = yes, isExternal = yes};
  end

  if (sysVar.errorCode == "00000000")

    if (SQLCA.VAGen_SQLCODE == 0
     || SQLCA.VAGen_SQLCODE == 100
     || SQLCA.VAGen_SQLCODE == -305)

      return;

    end

  end

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/

  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "TI9920"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 ";
  TA1REC.TA1FUNC = "SC  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID;
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-TI9920-SC   ";
  TA1REC.TA1DBASE = "DCUTKT  ";
  TA1REC.TA1TBLVU = "VTRMSG01";
  TI0FW00.TI0FW-RMSG-S1-OP-CUST-ORD-ID = VTRMSG01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-RMSG-S1-OP-NIKE-ORD-ID = VTRMSG01.OP-NIKE-ORD-ID;
  TI0FW00.TI0FW-RMSG-S1-TI-CUTK-RQT-NBR = VTRMSG01.TI-CUTK-RQT-NBR;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RMSG-S1-KEY;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes};

  exit stack;
     /* END OF STATEMENT GROUP*/
end // end TI0FS-TI9920-SC

// Edits all codes
Function TI0FS-TKORDER-ED()
  if (TI0FW00.TI0FW-TI-CUTK-MSG-EXISTS-FL == "Y")

    TI0FW00.TI0FW-TI-CUTK-MSG-CD-OK-FL = "N";

    TI0FS-EMSGCODE-ED();

  end

  if (TI0FW00.TI0FW-TI-CUTK-SPLR-CD-FL == "Y"
  )
    TI0FW00.TI0FW-TI-CUTK-SPLR-CD-OK-FL = "N";

    TI0FS-SPLRCODE-ED();

  end

  if (TI0FW00.TI0FW-TI-CUTK-XMIT-CD-FL == "Y")

    TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "N";

    TI0FS-XMITCODE-ED();

  end

  if (TI0FW00.TI0FW-SEND-DATE-RNG-FROM-FL == "Y")

    if (TI0FM001.TI0FW-SEND-DATE-RNG-TO == 0)

      TI0FM001.TI0FW-SEND-DATE-RNG-TO = TI0FM001.TI0FW-SEND-DATE-RNG-FROM;

      TI0FW01.TI0FW-SEND-DATE-RNG-TO = TI0FM001.TI0FW-SEND-DATE-RNG-FROM;

    end

    TI0FW-CUST-EST-SNT-DT-FR-NUM = TI0FM001.TI0FW-SEND-DATE-RNG-FROM;
    TI0FW00.TI0FW-CUST-EST-SNT-DT-FR-CHA = TI0FW00.TI0FW-CUST-EST-SNT-DT-FR-NUM;

    TI0FW00.TI0FW-CUST-EST-SNT-DT-LOW-MM = TI0FW00.TI0FW-CUST-EST-SNT-DT-FR-MM;

    TI0FW00.TI0FW-CUST-EST-SNT-DT-LOW-DD = TI0FW00.TI0FW-CUST-EST-SNT-DT-FR-DD;

    TI0FW00.TI0FW-CUST-EST-SNT-DT-LOW-YY = TI0FW00.TI0FW-CUST-EST-SNT-DT-FR-YY;

    if (TI0FW00.TI0FW-CUST-EST-SNT-DT-FR-YY > 50)
      TI0FW00.TI0FW-CUST-EST-SNT-DT-LOW-CC = 19;
    else
      TI0FW00.TI0FW-CUST-EST-SNT-DT-LOW-CC = 20;
    end

    TI0FW00.TI0FW-CUST-EST-SNT-DT-LOW-ZERO = 0;

    TI0FW00.TI0FW-CUST-EST-SNT-DT-LOW = TI0FW00.TI0FW-CUST-EST-SNT-DT-LOW-CHA;

    TI0FW00.TI0FW-CUST-EST-SNT-DT-TO-NUM = TI0FM001.TI0FW-SEND-DATE-RNG-TO;
    TI0FW00.TI0FW-CUST-EST-SNT-DT-TO-CHA = TI0FW00.TI0FW-CUST-EST-SNT-DT-TO-NUM;
    TI0FW00.TI0FW-CUST-EST-SNT-DT-HI-MM = TI0FW00.TI0FW-CUST-EST-SNT-DT-TO-MM;

    TI0FW00.TI0FW-CUST-EST-SNT-DT-HI-DD = TI0FW00.TI0FW-CUST-EST-SNT-DT-TO-DD;

    TI0FW00.TI0FW-CUST-EST-SNT-DT-HI-YY = TI0FW00.TI0FW-CUST-EST-SNT-DT-TO-YY;

    if (TI0FW00.TI0FW-CUST-EST-SNT-DT-TO-YY > 50)
      TI0FW00.TI0FW-CUST-EST-SNT-DT-HI-CC = 19;
    else
      TI0FW00.TI0FW-CUST-EST-SNT-DT-HI-CC = 20;
    end

    TI0FW00.TI0FW-CUST-EST-SNT-DT-HI-ZERO = 0;

    TI0FW00.TI0FW-CUST-EST-SNT-DT-HI = TI0FW00.TI0FW-CUST-EST-SNT-DT-HI-CHA;

    TI0FS-ESENDDT-ED();

  end

  if (TI0FW00.TI0FW-SENT-DATE-RNG-FROM-FL == "Y")

    if (TI0FM001.TI0FW-SENT-DATE-RNG-TO == 0)

      TI0FM001.TI0FW-SENT-DATE-RNG-TO = TI0FM001.TI0FW-SENT-DATE-RNG-FROM;

      TI0FW01.TI0FW-SENT-DATE-RNG-TO = TI0FM001.TI0FW-SENT-DATE-RNG-FROM;

    end

    TI0FW00.TI0FW-CUST-ACT-SNT-DT-FR-NUM = TI0FM001.TI0FW-SENT-DATE-RNG-FROM;

    TI0FW00.TI0FW-CUST-ACT-SNT-DT-FR-CHA = TI0FW00.TI0FW-CUST-ACT-SNT-DT-FR-NUM;
    TI0FW00.TI0FW-CUST-ACT-SNT-DT-LOW-MM = TI0FW00.TI0FW-CUST-ACT-SNT-DT-FR-MM;

    TI0FW00.TI0FW-CUST-ACT-SNT-DT-LOW-DD = TI0FW00.TI0FW-CUST-ACT-SNT-DT-FR-DD;

    TI0FW00.TI0FW-CUST-ACT-SNT-DT-LOW-YY = TI0FW00.TI0FW-CUST-ACT-SNT-DT-FR-YY;

    if (TI0FW00.TI0FW-CUST-ACT-SNT-DT-FR-YY > 50)
      TI0FW00.TI0FW-CUST-ACT-SNT-DT-LOW-CC = 19;
    else
      TI0FW00.TI0FW-CUST-ACT-SNT-DT-LOW-CC = 20;
    end

    TI0FW00.TI0FW-CUST-ACT-SNT-DT-LOW-ZERO = 0;

    TI0FW00.TI0FW-CUST-ACT-SNT-DT-LOW = TI0FW00.TI0FW-CUST-ACT-SNT-DT-LOW-CHA;

    TI0FW00.TI0FW-CUST-ACT-SNT-DT-TO-NUM = TI0FM001.TI0FW-SENT-DATE-RNG-TO;

    TI0FW00.TI0FW-CUST-ACT-SNT-DT-TO-CHA = TI0FW00.TI0FW-CUST-ACT-SNT-DT-TO-NUM;
    TI0FW00.TI0FW-CUST-ACT-SNT-DT-HI-MM = TI0FW00.TI0FW-CUST-ACT-SNT-DT-TO-MM;

    TI0FW00.TI0FW-CUST-ACT-SNT-DT-HI-DD = TI0FW00.TI0FW-CUST-ACT-SNT-DT-TO-DD;

    TI0FW00.TI0FW-CUST-ACT-SNT-DT-HI-YY = TI0FW00.TI0FW-CUST-ACT-SNT-DT-TO-YY;

    if (TI0FW00.TI0FW-CUST-ACT-SNT-DT-TO-YY > 50)
      TI0FW00.TI0FW-CUST-ACT-SNT-DT-HI-CC = 19;
    else
      TI0FW00.TI0FW-CUST-ACT-SNT-DT-HI-CC = 20;
    end

    TI0FW00.TI0FW-CUST-ACT-SNT-DT-HI-ZERO = 0;

    TI0FW00.TI0FW-CUST-ACT-SNT-DT-HI = TI0FW00.TI0FW-CUST-ACT-SNT-DT-HI-CHA;

    TI0FS-ASENTDT-ED();

  end

   /* IF TI0FW00.TI0FW-TI-CUTK-STAT-CD-FL = 'Y'*/

   /* TI0FS-STATCODE-ED;*/

   /* END;*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-TKORDER-ED

// move vtorqt01 items to m002
Function TI0FS-TORQTW02-MV()
  TI0FW02.OP-CUST-ORD-ID[XXX-INX-FLD-NBR] = VTORQT01.OP-CUST-ORD-ID;

  TI0FW02.OP-NIKE-ORD-ID[XXX-INX-FLD-NBR] = VTORQT01.OP-NIKE-ORD-ID;

  TI0FW02.TI-CUTK-RQT-NBR[XXX-INX-FLD-NBR] = VTORQT01.TI-CUTK-RQT-NBR;

  if (TI0FW00.XXX-INX-FLD-NBR == 1
   || TI0FW00.TI0FW-RQT-FIRST-REC-FL == "Y")

    TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM = VTOHDR01.OP-CUST-ORD-ID;

    TI0FW00.TI0FW-OP-CUST-ORD-ID-LCHA = TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM;

    TI0FW00.TI0FW-OP-CUST-ORD-ID-CHA = TI0FW00.TI0FW-OP-CUST-ORD-ID-SCHA;

    TI0FW00.TI0FW-SALES-ORD-PERIOD = ".";

    TI0FW00.TI0FW-OP-NIKE-ORD-ID-NUM = VTOHDR01.OP-NIKE-ORD-ID;

    TI0FW00.TI0FW-OP-NIKE-ORD-ID-LCHA = TI0FW00.TI0FW-OP-NIKE-ORD-ID-NUM;

    TI0FW00.TI0FW-OP-NIKE-ORD-ID-CHA = TI0FW00.TI0FW-OP-NIKE-ORD-ID-SCHA;

    TI0FW02.CU-CO-ID[XXX-INX-FLD-NBR] = VTOHDR01.CU-CO-ID; /* COMPANY ID*/

    TI0FW02.OP-CUST-PO[XXX-INX-FLD-NBR] = VTOHDR01.OP-CUST-PO; /* CUSTOMER PO*/

    TI0FW00.TI0FW-RQT-FIRST-REC-FL = "N";

  else

    TI0FW00.TI0FW-SALES-ORD-ID = " ";

    TI0FW02.CU-CO-ID[XXX-INX-FLD-NBR] = 0; /* COMPANY ID*/

    TI0FW02.OP-CUST-PO[XXX-INX-FLD-NBR] = " ";

  end

  TI0FW02.TI0FW-SALES-ORD-ID[XXX-INX-FLD-NBR] = TI0FW00.TI0FW-SALES-ORD-ID;

  TI0FW00.SY-STY-CD = VTORQT01.SY-STY-NBR;

  TI0FW00.TI0FW-STY-COLR-HYPHEN = "-";

  TI0FW00.SY-COLR-CD-ID = VTORQT01.SY-COLR-CD-ID;

  TI0FW02.TI0FW-STYLE-COLR[XXX-INX-FLD-NBR] = TI0FW00.TI0FW-STYLE-COLR;

   /* ------------------------------------------------------------*/
   /* Complete populating storage fields for screen M002*/
   /* ------------------------------------------------------------*/

  TI0FW02.TI0FW-OP-CUST-NEED-DT[XXX-INX-FLD-NBR] = TI0FW00.TI0FW-DATE-DISPLAY;

  TI0FW02.TI-CUTK-STAT-CD[XXX-INX-FLD-NBR] = VTORQT01.TI-CUTK-STAT-CD;

  TI0FW02.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] = VTORQT01.TI-CUTK-SEND-CD;

  if (TI0FW00.TI0FW-PREVIOUS-PF11 == "Y")
    TI0FW00.TI0FW-PF11-IDX = 1;
    while (TI0FW00.TI0FW-PF11-IDX <= 12)
      if (TI0FW02.OP-CUST-ORD-ID[XXX-INX-FLD-NBR]
       == TI0FW00.TI0FW-PF11-OP-CUST-ORD-ID[TI0FW-PF11-IDX]
       && TI0FW02.OP-NIKE-ORD-ID[XXX-INX-FLD-NBR]
       == TI0FW00.TI0FW-PF11-OP-NIKE-ORD-ID[TI0FW-PF11-IDX]
       && TI0FW02.TI-CUTK-RQT-NBR[XXX-INX-FLD-NBR]
       == TI0FW00.TI0FW-PF11-TI-CUTK-RQT-NBR[TI0FW-PF11-IDX])
        TI0FW02.TI0FW-SELECT[XXX-INX-FLD-NBR] = "R";
        TI0FW00.TI0FW-PF11-OP-CUST-ORD-ID[TI0FW-PF11-IDX] = 0;
        TI0FW00.TI0FW-PF11-OP-NIKE-ORD-ID[TI0FW-PF11-IDX] = 0;
        TI0FW00.TI0FW-PF11-TI-CUTK-RQT-NBR[TI0FW-PF11-IDX] = 0;
        TI0FW00.TI0FW-PF11-IDX = 12;
      end
      TI0FW00.TI0FW-PF11-IDX = TI0FW00.TI0FW-PF11-IDX + 1;
    end /* END WHILE*/
  end

   /* END OF PROC*/
end // end TI0FS-TORQTW02-MV

// move vtorqt01 items to m002
Function TI0FS-TORQTW03-MV()
  TI0FW03.PC-PO-NBR[XXX-INX-FLD-NBR] = VTORQT01.PC-PO-NBR;

  TI0FW00.TI0FW-PC-PO-ID-MO-RNG = VTORQT01.PC-PO-ID-MO-RNG;
  TI0FW00.TI0FW-PO-ID-YY = TI0FW00.TI0FW-PO-ID-YY-NUM;
  TI0FW00.TI0FW-PO-ID-BLD-MM = TI0FW00.TI0FW-PO-ID-BLD-MM-NUM;
  TI0FW00.TI0FW-PO-ID-SHP-MM = TI0FW00.TI0FW-PO-ID-SHP-MM-NUM;
  TI0FW03.TI0FW-PC-PO-ID[XXX-INX-FLD-NBR] = TI0FW00.TI0FW-PC-PO-ID;

  TI0FW03.FY-FCTY-CD[XXX-INX-FLD-NBR] = VTORQT01.FY-FCTY-CD;

  TI0FW03.PC-PRDCU-ID[XXX-INX-FLD-NBR] = VTORQT01.PC-PRDCU-ID;

  TI0FW00.SY-STY-CD = VTORQT01.SY-STY-NBR;

  TI0FW00.TI0FW-STY-COLR-HYPHEN = "-";

  TI0FW00.SY-COLR-CD-ID = VTORQT01.SY-COLR-CD-ID;

  TI0FW03.TI0FW-STYLE-COLR[XXX-INX-FLD-NBR] = TI0FW00.TI0FW-STYLE-COLR;

  TI0FW03.TI-CUTK-STAT-CD[XXX-INX-FLD-NBR] = VTORQT01.TI-CUTK-STAT-CD;

  TI0FW03.TI-CUTK-SEND-CD[XXX-INX-FLD-NBR] = VTORQT01.TI-CUTK-SEND-CD;

  TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM = VTORQT01.OP-CUST-ORD-ID;

  TI0FW00.TI0FW-OP-CUST-ORD-ID-LCHA = TI0FW00.TI0FW-OP-CUST-ORD-ID-NUM;

  TI0FW00.TI0FW-OP-CUST-ORD-ID-CHA = TI0FW00.TI0FW-OP-CUST-ORD-ID-SCHA;

  TI0FW00.TI0FW-SALES-ORD-PERIOD = ".";

  TI0FW00.TI0FW-OP-NIKE-ORD-ID-NUM = VTORQT01.OP-NIKE-ORD-ID;

  TI0FW00.TI0FW-OP-NIKE-ORD-ID-LCHA = TI0FW00.TI0FW-OP-NIKE-ORD-ID-NUM;

  TI0FW00.TI0FW-OP-NIKE-ORD-ID-CHA = TI0FW00.TI0FW-OP-NIKE-ORD-ID-SCHA;

  TI0FW03.TI0FW-SALES-ORD-ID[XXX-INX-FLD-NBR] = TI0FW00.TI0FW-SALES-ORD-ID;

  TI0FW03.OP-CUST-ORD-ID[XXX-INX-FLD-NBR] = VTORQT01.OP-CUST-ORD-ID;

  TI0FW03.OP-NIKE-ORD-ID[XXX-INX-FLD-NBR] = VTORQT01.OP-NIKE-ORD-ID;

  TI0FW03.TI-CUTK-RQT-NBR[XXX-INX-FLD-NBR] = VTORQT01.TI-CUTK-RQT-NBR;

  if (TI0FW00.TI0FW-PREVIOUS-PF11 == "Y")
    TI0FW00.TI0FW-PF11-IDX = 1;
    while (TI0FW00.TI0FW-PF11-IDX <= 12)
      if (TI0FW03.OP-CUST-ORD-ID[XXX-INX-FLD-NBR]
       == TI0FW00.TI0FW-PF11-OP-CUST-ORD-ID[TI0FW-PF11-IDX]
       && TI0FW03.OP-NIKE-ORD-ID[XXX-INX-FLD-NBR]
       == TI0FW00.TI0FW-PF11-OP-NIKE-ORD-ID[TI0FW-PF11-IDX]
       && TI0FW03.TI-CUTK-RQT-NBR[XXX-INX-FLD-NBR]
       == TI0FW00.TI0FW-PF11-TI-CUTK-RQT-NBR[TI0FW-PF11-IDX])
        TI0FW00.TI0FW-PF11-IDX = 12;
        TI0FW03.TI0FW-SELECT[XXX-INX-FLD-NBR] = "R";
      end
      TI0FW00.TI0FW-PF11-IDX = TI0FW00.TI0FW-PF11-IDX + 1;
    end /* END WHILE*/
  end

   /* END OF PROC*/
end // end TI0FS-TORQTW03-MV

// Select the table row
Function TI0FS-VTHMSG01-C1()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTHMSG01" ("C1", SQLCA, VTHMSG01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTHMSG01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-VTHMSG01-C1   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTHMSG01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-HMSG-S1-OP-CUST-ORD-ID = VTHMSG01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-HMSG-S1-OP-NIKE-ORD-ID = VTHMSG01.OP-NIKE-ORD-ID;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HMSG-S1-KEY;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTHMSG01-C1

// Select the table row
Function TI0FS-VTHMSG01-N1()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTHMSG01" ("N1", SQLCA, VTHMSG01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTHMSG01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-VTHMSG01-N1   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTHMSG01"; /* Table view name*/
  TI0FW00.TI0FW-HMSG-S1-OP-CUST-ORD-ID = VTHMSG01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-HMSG-S1-OP-NIKE-ORD-ID = VTHMSG01.OP-NIKE-ORD-ID;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HMSG-S1-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTHMSG01-N1

// Select the table row
Function TI0FS-VTHMSG01-S1()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTHMSG01" ("S1", SQLCA, VTHMSG01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTHMSG01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "S1  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTHMSG01-S1   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTHMSG01"; /* Table view name*/
  TI0FW00.TI0FW-HMSG-S1-OP-CUST-ORD-ID = VTHMSG01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-HMSG-S1-OP-NIKE-ORD-ID = VTHMSG01.OP-NIKE-ORD-ID;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HMSG-S1-KEY; /* Table key*/
   /* MOVE SQLCA.SQLCODE TO TA1REC.TA1FYICD;*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTHMSG01-S1

// Select the table row
Function TI0FS-VTIMSG01-C1()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTIMSG01" ("C1", SQLCA, VTIMSG01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTIMSG01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-VTIMSG01-C1   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTIMSG01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-IMSG-S1-OP-CUST-ORD-ID = VTIMSG01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-IMSG-S1-OP-NIKE-ORD-ID = VTIMSG01.OP-NIKE-ORD-ID;
  TI0FW00.TI0FW-IMSG-S1-TI-CUTK-RQT-NBR = VTIMSG01.TI-CUTK-RQT-NBR;
  TI0FW00.TI0FW-IMSG-S1-TI-CUTK-LINE-NBR = VTIMSG01.TI-CUTK-LINE-NBR;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-IMSG-S1-KEY;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTIMSG01-C1

// Select the table row
Function TI0FS-VTIMSG01-N1()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTIMSG01" ("N1", SQLCA, VTIMSG01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTIMSG01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-VTIMSG01-N1   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTIMSG01"; /* Table view name*/
  TI0FW00.TI0FW-IMSG-S1-OP-CUST-ORD-ID = VTIMSG01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-IMSG-S1-OP-NIKE-ORD-ID = VTIMSG01.OP-NIKE-ORD-ID;
  TI0FW00.TI0FW-IMSG-S1-TI-CUTK-RQT-NBR = VTIMSG01.TI-CUTK-RQT-NBR;
  TI0FW00.TI0FW-IMSG-S1-TI-CUTK-LINE-NBR = VTIMSG01.TI-CUTK-LINE-NBR;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-IMSG-S1-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTIMSG01-N1

// Select the table row
Function TI0FS-VTIMSG01-S1()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTIMSG01" ("S1", SQLCA, VTIMSG01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTIMSG01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "S1  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTIMSG01-S1   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTIMSG01"; /* Table view name*/
  TI0FW00.TI0FW-IMSG-S1-OP-CUST-ORD-ID = VTIMSG01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-IMSG-S1-OP-NIKE-ORD-ID = VTIMSG01.OP-NIKE-ORD-ID;
  TI0FW00.TI0FW-IMSG-S1-TI-CUTK-RQT-NBR = VTIMSG01.TI-CUTK-RQT-NBR;
  TI0FW00.TI0FW-IMSG-S1-TI-CUTK-LINE-NBR = VTIMSG01.TI-CUTK-LINE-NBR;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-IMSG-S1-KEY; /* Table key*/
   /* MOVE SQLCA.SQLCODE TO TA1REC.TA1FYICD;*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTIMSG01-S1

// Select the table row
Function TI0FS-VTODCD01-S()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTODCD01" ("S ", SQLCA, VTODCD01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTODCD01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-VTODCD01-S    "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTODCD01"; /* Table view name*/
  TA1REC.TA1TBLKE = VTODCD01.TI-CUTK-SEND-CD; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

end // end TI0FS-VTODCD01-S

// Select the table row
Function TI0FS-VTOHDR01-C1()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOHDR01" ("C1", SQLCA, VTOHDR01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOHDR01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "IO-EX-SELECT-SCAN-1 "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-HDR-S1-CU-CO-ID = TI0FW01.CU-CO-ID;
  TI0FW00.TI0FW-HDR-S1-CU-STOR-ID = TI0FW01.TI0FW-CU-STOR-ID;
  TI0FW00.TI0FW-HDR-S1-XNX-DEPT-ID-XREF = TI0FW01.TI0FW-XNX-DEPT-ID-XREF;
  TI0FW00.TI0FW-HDR-S1-XGP-GPC-CD = TI0FW01.XGP-GPC-CD;
  TI0FW00.TI0FW-HDR-S1-TI-CUTK-STAT-CD = TI0FW01.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HDR-S1-KEY;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOHDR01-C1

// Select the table row
Function TI0FS-VTOHDR01-C2()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOHDR01" ("C2", SQLCA, VTOHDR01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOHDR01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "IO-EX-SELECT-SCAN-2 "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-HDR-S2-CU-CO-ID = TI0FW01.CU-CO-ID;
  TI0FW00.TI0FW-HDR-S2-XGP-GPC-CD = TI0FW01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HDR-S2-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOHDR01-C2

// Select the table row
Function TI0FS-VTOHDR01-C3()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOHDR01" ("C3", SQLCA, VTOHDR01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOHDR01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SELECT THE TABLE ROW"; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-HDR-S3-CU-CO-ID = TI0FW01.CU-CO-ID;
  TI0FW00.TI0FW-HDR-S3-XGP-GPC-CD = TI0FW01.XGP-GPC-CD;
  TI0FW00.TI0FW-HDR-S3-OP-CUST-PO = TI0FW01.TI0FW-OP-CUST-PO1;
  TI0FW00.TI0FW-HDR-S3-TI-CUTK-STAT-CD = TI0FW01.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HDR-S3-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOHDR01-C3

// Select the table row
Function TI0FS-VTOHDR01-C4()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOHDR01" ("C4", SQLCA, VTOHDR01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOHDR01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "IO-EX-SELECT-SCAH-1 "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-HDR-S4-CU-CO-ID = TI0FW01.CU-CO-ID;
  TI0FW00.TI0FW-HDR-S4-XGP-GPC-CD = TI0FW01.XGP-GPC-CD;
  TI0FW00.TI0FW-HDR-S4-CU-STOR-ID = TI0FW01.TI0FW-CU-STOR-ID;
  TI0FW00.TI0FW-HDR-S4-XNX-DEPT-ID-XREF = TI0FW01.TI0FW-XNX-DEPT-ID-XREF;
  TI0FW00.TI0FW-HDR-S4-TI-CUTK-STAT-CD = TI0FW01.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HDR-S4-KEY;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOHDR01-C4

// Select the table row
Function TI0FS-VTOHDR01-C5()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOHDR01" ("C5", SQLCA, VTOHDR01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOHDR01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "IO-EX-SELECT-SCAH-1 "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-HDR-S5-CU-CO-ID = TI0FW01.CU-CO-ID;
  TI0FW00.TI0FW-HDR-S5-CU-STOR-ID = TI0FW01.TI0FW-CU-STOR-ID;
  TI0FW00.TI0FW-HDR-S5-OP-CUST-PO = TI0FW01.TI0FW-OP-CUST-PO1;
  TI0FW00.TI0FW-HDR-S5-XNX-DEPT-ID-XREF = TI0FW01.TI0FW-XNX-DEPT-ID-XREF;
  TI0FW00.TI0FW-HDR-S5-XGP-GPC-CD = TI0FW01.XGP-GPC-CD;
  TI0FW00.TI0FW-HDR-S5-TI-CUTK-STAT-CD = TI0FW01.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HDR-S5-KEY;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOHDR01-C5

// Select the table row
Function TI0FS-VTOHDR01-C6()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOHDR01" ("C6", SQLCA, VTOHDR01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOHDR01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "IO-EX-SELECT-SCAN-2 "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-VTOHDR01-C6   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/
  TI0FW00.TI0FW-HDR-S6-OP-CUST-ORD-ID = VTOHDR01.OP-CUST-ORD-ID;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HDR-S6-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOHDR01-C6

// Select the table row
Function TI0FS-VTOHDR01-N1()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOHDR01" ("N1", SQLCA, VTOHDR01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOHDR01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "IO-EX-SELECT-SCAH-1 "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-HDR-S1-CU-CO-ID = TI0FW01.CU-CO-ID;
  TI0FW00.TI0FW-HDR-S1-CU-STOR-ID = TI0FW01.TI0FW-CU-STOR-ID;
  TI0FW00.TI0FW-HDR-S1-XNX-DEPT-ID-XREF = TI0FW01.TI0FW-XNX-DEPT-ID-XREF;
  TI0FW00.TI0FW-HDR-S1-XGP-GPC-CD = TI0FW01.XGP-GPC-CD;
  TI0FW00.TI0FW-HDR-S1-TI-CUTK-STAT-CD = TI0FW01.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HDR-S1-KEY;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOHDR01-N1

// Select the table row
Function TI0FS-VTOHDR01-N2()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOHDR01" ("N2", SQLCA, VTOHDR01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOHDR01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "IO-EX-SELECT-SCAN-2 "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-HDR-S2-CU-CO-ID = TI0FW01.CU-CO-ID;
  TI0FW00.TI0FW-HDR-S2-XGP-GPC-CD = TI0FW01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HDR-S2-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOHDR01-N2

// Select the table row
Function TI0FS-VTOHDR01-N3()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOHDR01" ("N3", SQLCA, VTOHDR01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOHDR01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SELECT THE TABLE ROW"; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-HDR-S3-CU-CO-ID = TI0FW01.CU-CO-ID;
  TI0FW00.TI0FW-HDR-S3-XGP-GPC-CD = TI0FW01.XGP-GPC-CD;
  TI0FW00.TI0FW-HDR-S3-OP-CUST-PO = TI0FW01.TI0FW-OP-CUST-PO1;
  TI0FW00.TI0FW-HDR-S3-TI-CUTK-STAT-CD = TI0FW01.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HDR-S3-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOHDR01-N3

// Select the table row
Function TI0FS-VTOHDR01-N4()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOHDR01" ("N4", SQLCA, VTOHDR01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOHDR01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "IO-EX-SELECT-SCAH-1 "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-HDR-S4-CU-CO-ID = TI0FW01.CU-CO-ID;
  TI0FW00.TI0FW-HDR-S4-XGP-GPC-CD = TI0FW01.XGP-GPC-CD;
  TI0FW00.TI0FW-HDR-S4-CU-STOR-ID = TI0FW01.TI0FW-CU-STOR-ID;
  TI0FW00.TI0FW-HDR-S4-XNX-DEPT-ID-XREF = TI0FW01.TI0FW-XNX-DEPT-ID-XREF;
  TI0FW00.TI0FW-HDR-S4-TI-CUTK-STAT-CD = TI0FW01.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HDR-S4-KEY;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-VTOHDR01-N4

// Select the table row
Function TI0FS-VTOHDR01-N5()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOHDR01" ("N5", SQLCA, VTOHDR01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOHDR01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "IO-EX-SELECT-SCAH-1 "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-HDR-S5-CU-CO-ID = TI0FW01.CU-CO-ID;
  TI0FW00.TI0FW-HDR-S5-CU-STOR-ID = TI0FW01.TI0FW-CU-STOR-ID;
  TI0FW00.TI0FW-HDR-S5-OP-CUST-PO = TI0FW01.TI0FW-OP-CUST-PO1;
  TI0FW00.TI0FW-HDR-S5-XNX-DEPT-ID-XREF = TI0FW01.TI0FW-XNX-DEPT-ID-XREF;
  TI0FW00.TI0FW-HDR-S5-XGP-GPC-CD = TI0FW01.XGP-GPC-CD;
  TI0FW00.TI0FW-HDR-S5-TI-CUTK-STAT-CD = TI0FW01.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HDR-S5-KEY;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOHDR01-N5

// Select the table row
Function TI0FS-VTOHDR01-N6()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOHDR01" ("N6", SQLCA, VTOHDR01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOHDR01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "IO-EX-SELECT-SCAN-2 "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-VTOHDR01-N6   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/
  TI0FW00.TI0FW-HDR-S6-OP-CUST-ORD-ID = VTOHDR01.OP-CUST-ORD-ID;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HDR-S6-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOHDR01-N6

// Select the table row
Function TI0FS-VTOHDR01-S()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOHDR01" ("S ", SQLCA, VTOHDR01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOHDR01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SELECT THE TABLE ROW"; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/
  TI0FW00.TI0FW-HDR-S-OP-CUST-ORD-ID = VTOHDR01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-HDR-S-OP-NIKE-ORD-ID = VTOHDR01.OP-NIKE-ORD-ID;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HDR-S-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOHDR01-S

// Select the table row
Function TI0FS-VTOHDR01-S1()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOHDR01" ("S1", SQLCA, VTOHDR01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOHDR01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "IO-EX-SELECT-SCAH-1 "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-HDR-S1-CU-CO-ID = TI0FW01.CU-CO-ID;
  TI0FW00.TI0FW-HDR-S1-CU-STOR-ID = TI0FW01.TI0FW-CU-STOR-ID;
  TI0FW00.TI0FW-HDR-S1-XNX-DEPT-ID-XREF = TI0FW01.TI0FW-XNX-DEPT-ID-XREF;
  TI0FW00.TI0FW-HDR-S1-XGP-GPC-CD = TI0FW01.XGP-GPC-CD;
  TI0FW00.TI0FW-HDR-S1-TI-CUTK-STAT-CD = TI0FW01.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HDR-S1-KEY;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOHDR01-S1

// Select the table row
Function TI0FS-VTOHDR01-S2()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOHDR01" ("S2", SQLCA, VTOHDR01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOHDR01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "IO-EX-SELECT-SCAN-2 "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-HDR-S2-CU-CO-ID = TI0FW01.CU-CO-ID;
  TI0FW00.TI0FW-HDR-S2-XGP-GPC-CD = TI0FW01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HDR-S2-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOHDR01-S2

// Select the table row
Function TI0FS-VTOHDR01-S3()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOHDR01" ("S3", SQLCA, VTOHDR01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOHDR01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SELECT THE TABLE ROW"; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-HDR-S3-CU-CO-ID = TI0FW01.CU-CO-ID;
  TI0FW00.TI0FW-HDR-S3-XGP-GPC-CD = TI0FW01.XGP-GPC-CD;
  TI0FW00.TI0FW-HDR-S3-OP-CUST-PO = TI0FW01.TI0FW-OP-CUST-PO1;
  TI0FW00.TI0FW-HDR-S3-TI-CUTK-STAT-CD = TI0FW01.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HDR-S3-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOHDR01-S3

// Select the table row
Function TI0FS-VTOHDR01-S4()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOHDR01" ("S4", SQLCA, VTOHDR01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOHDR01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "IO-EX-SELECT-SCAH-1 "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-HDR-S4-CU-CO-ID = TI0FW01.CU-CO-ID;
  TI0FW00.TI0FW-HDR-S4-XGP-GPC-CD = TI0FW01.XGP-GPC-CD;
  TI0FW00.TI0FW-HDR-S4-CU-STOR-ID = TI0FW01.TI0FW-CU-STOR-ID;
  TI0FW00.TI0FW-HDR-S4-XNX-DEPT-ID-XREF = TI0FW01.TI0FW-XNX-DEPT-ID-XREF;
  TI0FW00.TI0FW-HDR-S4-TI-CUTK-STAT-CD = TI0FW01.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HDR-S4-KEY;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOHDR01-S4

// Select the table row
Function TI0FS-VTOHDR01-S5()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOHDR01" ("S5", SQLCA, VTOHDR01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOHDR01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "IO-EX-SELECT-SCAH-1 "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-HDR-S5-CU-CO-ID = TI0FW01.CU-CO-ID;
  TI0FW00.TI0FW-HDR-S5-CU-STOR-ID = TI0FW01.TI0FW-CU-STOR-ID;
  TI0FW00.TI0FW-HDR-S5-OP-CUST-PO = TI0FW01.TI0FW-OP-CUST-PO1;
  TI0FW00.TI0FW-HDR-S5-XNX-DEPT-ID-XREF = TI0FW01.TI0FW-XNX-DEPT-ID-XREF;
  TI0FW00.TI0FW-HDR-S5-XGP-GPC-CD = TI0FW01.XGP-GPC-CD;
  TI0FW00.TI0FW-HDR-S5-TI-CUTK-STAT-CD = TI0FW01.TI-CUTK-STAT-CD[TI0FW-TI-CUTK-STAT-CD-IDX];
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HDR-S5-KEY;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOHDR01-S5

// Select the table row
Function TI0FS-VTOHDR01-S6()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOHDR01" ("S6", SQLCA, VTOHDR01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOHDR01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-VTOHDR01-S6   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOHDR01"; /* Table view name*/
  TI0FW00.TI0FW-HDR-S6-OP-CUST-ORD-ID = VTOHDR01.OP-CUST-ORD-ID;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-HDR-S6-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOHDR01-S6

// Insert VTOITM01 row
Function TI0FS-VTOITM01-A()
   /* ------------------------------------------------------------*/
   /* Insert vtoitm01*/
   /* ------------------------------------------------------------*/

  try
    call "VTOITM01" ("A ", SQLCA, VTOITM01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     /* OR SQLCA.SQLCODE EQ 100;     /* or row not found*/
    )                           
      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOITMA "; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "A   ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTOITM01-A    "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOITM01"; /* Table view name*/
  TI0FW00.TI0FW-ITM-A-OP-CUST-ORD-ID = VTOITM01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-ITM-A-OP-NIKE-ORD-ID = VTOITM01.OP-NIKE-ORD-ID;
  TI0FW00.TI0FW-ITM-A-TI-CUTK-RQT-NBR = VTOITM01.TI-CUTK-RQT-NBR;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-ITM-A-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-VTOITM01-A

// Select the table row
Function TI0FS-VTOITM01-C1()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOITM01" ("C1", SQLCA, VTOITM01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOITM01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-VTOITM01-C1   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOITM01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-ITM-S1-OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-ITM-S1-OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;
  TI0FW00.TI0FW-ITM-S1-TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-ITM-S1-KEY;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-VTOITM01-C1

// Select the table row
Function TI0FS-VTOITM01-N1()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOITM01" ("N1", SQLCA, VTOITM01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOITM01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-VTOITM01-N1   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOITM01"; /* Table view name*/
  TI0FW00.TI0FW-ITM-S1-OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-ITM-S1-OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;
  TI0FW00.TI0FW-ITM-S1-TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-ITM-S1-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-VTOITM01-N1

// Select the table row
Function TI0FS-VTOITM01-S1()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOITM01" ("S1", SQLCA, VTOITM01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOITMS1"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "S1  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTOITM01-S1   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOITM01"; /* Table view name*/
  TI0FW00.TI0FW-ITM-S1-OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-ITM-S1-OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;
  TI0FW00.TI0FW-ITM-S1-TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-ITM-S1-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-VTOITM01-S1

// Select the table row
Function TI0FS-VTOMSG01-S()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOMSG01" ("S ", SQLCA, VTOMSG01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOMSG01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SELECT THE TABLE ROW"; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOMSG01"; /* Table view name*/
  TA1REC.TA1TBLKE = SY1REC.SY1KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOMSG01-S

// Select the table row
Function TI0FS-VTOPCD01-S()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOPCD01" ("S ", SQLCA, VTOPCD01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOPCD01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SELECT THE TABLE ROW"; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOPCD01"; /* Table view name*/
  TI0FW00.TI0FW-PCD-S-TI-CUTK-SPLR-CD = TI0FM004.TI-CUTK-SPLR-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-PCD-S-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOPCD01-S

// insert the vtorqt01 row
Function TI0FS-VTORQT01-A()
   /* ------------------------------------------------------------*/
   /* insert the vtorqt01 row.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("A ", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* insert row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
    )                           
      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "U   ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-A    "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S-OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-RQT-S-OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;
  TI0FW00.TI0FW-RQT-S-TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-A

// Select the table row
Function TI0FS-VTORQT01-C1()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("C1", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "C1  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-C1   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S1-OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-RQT-S1-OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S1-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-C1

// Select the table row
Function TI0FS-VTORQT01-C7()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("C7", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "C7  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-C7   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S7-PC-PO-NBR = VTORQT01.PC-PO-NBR;
  TI0FW00.TI0FW-RQT-S7-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S7-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-C7

// Select the table row
Function TI0FS-VTORQT01-C8()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("C8", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "C8  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-C8   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S8-PC-PO-ID-MO-RNG = VTORQT01.PC-PO-ID-MO-RNG;
  TI0FW00.TI0FW-RQT-S8-FY-FCTY-CD = VTORQT01.FY-FCTY-CD;
  TI0FW00.TI0FW-RQT-S8-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S8-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-C8

// Select the table row
Function TI0FS-VTORQT01-C9()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("C9", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "C9  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-C9   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S9-PC-PO-ID-MO-RNG = VTORQT01.PC-PO-ID-MO-RNG;
  TI0FW00.TI0FW-RQT-S9-XCT-CTRY-CD = VTORQT01.XCT-CTRY-CD;
  TI0FW00.TI0FW-RQT-S9-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S9-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-C9

// Select the table row
Function TI0FS-VTORQT01-CA()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("CA", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01CA"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "CA  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-CA   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-SA-PC-PRDCU-ID = VTORQT01.PC-PRDCU-ID;
  TI0FW00.TI0FW-RQT-SA-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-SA-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-VTORQT01-CA

// Select the table row
Function TI0FS-VTORQT01-CB()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("CB", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01CB"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "CB  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-CB   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S7-PC-PO-NBR = VTORQT01.PC-PO-NBR;
  TI0FW00.TI0FW-RQT-S7-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S7-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-CB

// Select the table row
Function TI0FS-VTORQT01-CC()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("CC", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "CC  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-CC   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S8-PC-PO-ID-MO-RNG = VTORQT01.PC-PO-ID-MO-RNG;
  TI0FW00.TI0FW-RQT-S8-FY-FCTY-CD = VTORQT01.FY-FCTY-CD;
  TI0FW00.TI0FW-RQT-S8-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S8-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-VTORQT01-CC

// Select the table row
Function TI0FS-VTORQT01-CD()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("CD", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "CD  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-CD   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S9-PC-PO-ID-MO-RNG = VTORQT01.PC-PO-ID-MO-RNG;
  TI0FW00.TI0FW-RQT-S9-XCT-CTRY-CD = VTORQT01.XCT-CTRY-CD;
  TI0FW00.TI0FW-RQT-S9-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S9-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-VTORQT01-CD

// Select the table row
Function TI0FS-VTORQT01-CE()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("CE", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "CE  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-CE   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-SA-PC-PRDCU-ID = VTORQT01.PC-PRDCU-ID;
  TI0FW00.TI0FW-RQT-SA-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-SA-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-VTORQT01-CE

// Select the table row
Function TI0FS-VTORQT01-CF()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("CF", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "CH  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-CF   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-SF-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TI0FW00.TI0FW-RQT-SF-SY-STY-NBR = VTORQT01.SY-STY-NBR;
  TI0FW00.TI0FW-RQT-SF-SY-COLR-CD-ID = VTORQT01.SY-COLR-CD-ID;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-SF-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-CF

// Select the table row
Function TI0FS-VTORQT01-CG()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("CG", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "CG  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-CG   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-SF-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TI0FW00.TI0FW-RQT-SF-SY-STY-NBR = VTORQT01.SY-STY-NBR;
  TI0FW00.TI0FW-RQT-SF-SY-COLR-CD-ID = VTORQT01.SY-COLR-CD-ID;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-SF-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-CG

// Select the table row
Function TI0FS-VTORQT01-CH()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("CH", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "CH  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-CH   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-SH-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TI0FW00.TI0FW-RQT-SH-TI-CUTK-SEND-CD = VTORQT01.TI-CUTK-SEND-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-SH-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-CH

// Select the table row
Function TI0FS-VTORQT01-N1()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("N1", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "N1  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-N1   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S1-OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-RQT-S1-OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S1-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-N1

// Select the table row
Function TI0FS-VTORQT01-N7()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("N7", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "N7  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-N7   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S7-PC-PO-NBR = VTORQT01.PC-PO-NBR;
  TI0FW00.TI0FW-RQT-S7-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S7-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-N7

// Select the table row
Function TI0FS-VTORQT01-N8()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("N8", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "N8  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-N8   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S8-PC-PO-ID-MO-RNG = VTORQT01.PC-PO-ID-MO-RNG;
  TI0FW00.TI0FW-RQT-S8-FY-FCTY-CD = VTORQT01.FY-FCTY-CD;
  TI0FW00.TI0FW-RQT-S8-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S8-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-N8

// Select the table row
Function TI0FS-VTORQT01-N9()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("N9", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "N9  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-N9   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S9-PC-PO-ID-MO-RNG = VTORQT01.PC-PO-ID-MO-RNG;
  TI0FW00.TI0FW-RQT-S9-XCT-CTRY-CD = VTORQT01.XCT-CTRY-CD;
  TI0FW00.TI0FW-RQT-S9-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S9-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-N9

// Select the table row
Function TI0FS-VTORQT01-NA()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("NA", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "NA  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-NA   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-SA-PC-PRDCU-ID = VTORQT01.PC-PRDCU-ID;
  TI0FW00.TI0FW-RQT-SA-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-SA-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-VTORQT01-NA

// Select the table row
Function TI0FS-VTORQT01-NB()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("NB", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "NB  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-NB   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S7-PC-PO-NBR = VTORQT01.PC-PO-NBR;
  TI0FW00.TI0FW-RQT-S7-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S7-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-NB

// Select the table row
Function TI0FS-VTORQT01-NC()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("NC", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "NC  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-NC   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S8-PC-PO-ID-MO-RNG = VTORQT01.PC-PO-ID-MO-RNG;
  TI0FW00.TI0FW-RQT-S8-FY-FCTY-CD = VTORQT01.FY-FCTY-CD;
  TI0FW00.TI0FW-RQT-S8-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S8-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-VTORQT01-NC

// Select the table row
Function TI0FS-VTORQT01-ND()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("ND", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "ND  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-ND   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S9-PC-PO-ID-MO-RNG = VTORQT01.PC-PO-ID-MO-RNG;
  TI0FW00.TI0FW-RQT-S9-XCT-CTRY-CD = VTORQT01.XCT-CTRY-CD;
  TI0FW00.TI0FW-RQT-S9-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S9-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-VTORQT01-ND

// Select the table row
Function TI0FS-VTORQT01-NE()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("NE", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "NE  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-NE   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-SA-PC-PRDCU-ID = VTORQT01.PC-PRDCU-ID;
  TI0FW00.TI0FW-RQT-SA-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-SA-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-VTORQT01-NE

// Select the table row
Function TI0FS-VTORQT01-NF()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("NF", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "NF  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-NF   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-SF-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TI0FW00.TI0FW-RQT-SF-SY-STY-NBR = VTORQT01.SY-STY-NBR;
  TI0FW00.TI0FW-RQT-SF-SY-COLR-CD-ID = VTORQT01.SY-COLR-CD-ID;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-SF-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-NF

// Select the table row
Function TI0FS-VTORQT01-NG()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("NG", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "NG  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-NG   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-SF-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TI0FW00.TI0FW-RQT-SF-SY-STY-NBR = VTORQT01.SY-STY-NBR;
  TI0FW00.TI0FW-RQT-SF-SY-COLR-CD-ID = VTORQT01.SY-COLR-CD-ID;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-SF-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-NG

// Select the table row
Function TI0FS-VTORQT01-NH()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("NH", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "NG  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-NH   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-SH-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TI0FW00.TI0FW-RQT-SH-TI-CUTK-SEND-CD = VTORQT01.TI-CUTK-SEND-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-SH-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-NH

// Select the table row
Function TI0FS-VTORQT01-S()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("S ", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "S   ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-S    "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S-OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-RQT-S-OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;
  TI0FW00.TI0FW-RQT-S-TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-S

// Select the table row
Function TI0FS-VTORQT01-S1()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("S1", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "S1  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-S1   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S1-OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-RQT-S1-OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S1-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-S1

// Select the table row
Function TI0FS-VTORQT01-S7()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("S7", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "S7  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-S7   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S7-PC-PO-NBR = VTORQT01.PC-PO-NBR;
  TI0FW00.TI0FW-RQT-S7-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S7-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-S7

// Select the table row
Function TI0FS-VTORQT01-S8()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("S8", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "S8  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-S8   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S8-PC-PO-ID-MO-RNG = VTORQT01.PC-PO-ID-MO-RNG;
  TI0FW00.TI0FW-RQT-S8-FY-FCTY-CD = VTORQT01.FY-FCTY-CD;
  TI0FW00.TI0FW-RQT-S8-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S8-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-S8

// Select the table row
Function TI0FS-VTORQT01-S9()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("S9", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "S9  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-S9   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S9-PC-PO-ID-MO-RNG = VTORQT01.PC-PO-ID-MO-RNG;
  TI0FW00.TI0FW-RQT-S9-XCT-CTRY-CD = VTORQT01.XCT-CTRY-CD;
  TI0FW00.TI0FW-RQT-S9-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S9-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-S9

// Select the table row
Function TI0FS-VTORQT01-SA()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("SA", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "SA  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-SA   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-SA-PC-PRDCU-ID = VTORQT01.PC-PRDCU-ID;
  TI0FW00.TI0FW-RQT-SA-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-SA-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-VTORQT01-SA

// Select the table row
Function TI0FS-VTORQT01-SB()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("SB", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "SB  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-SB   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S7-PC-PO-NBR = VTORQT01.PC-PO-NBR;
  TI0FW00.TI0FW-RQT-S7-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S7-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-SB

// Select the table row
Function TI0FS-VTORQT01-SC()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("SC", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "SC  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-SC   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S8-PC-PO-ID-MO-RNG = VTORQT01.PC-PO-ID-MO-RNG;
  TI0FW00.TI0FW-RQT-S8-FY-FCTY-CD = VTORQT01.FY-FCTY-CD;
  TI0FW00.TI0FW-RQT-S8-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S8-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-VTORQT01-SC

// Select the table row
Function TI0FS-VTORQT01-SD()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("SD", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "SD  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-SD   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S9-PC-PO-ID-MO-RNG = VTORQT01.PC-PO-ID-MO-RNG;
  TI0FW00.TI0FW-RQT-S9-XCT-CTRY-CD = VTORQT01.XCT-CTRY-CD;
  TI0FW00.TI0FW-RQT-S9-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S9-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-VTORQT01-SD

// Select the table row
Function TI0FS-VTORQT01-SE()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("SE", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "SE  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-SE   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-SA-PC-PRDCU-ID = VTORQT01.PC-PRDCU-ID;
  TI0FW00.TI0FW-RQT-SA-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-SA-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

   /* END OF STATEMENT GROUP*/
end // end TI0FS-VTORQT01-SE

// Select the table row
Function TI0FS-VTORQT01-SF()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("SF", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "SF  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-SF   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-SF-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TI0FW00.TI0FW-RQT-SF-SY-STY-NBR = VTORQT01.SY-STY-NBR;
  TI0FW00.TI0FW-RQT-SF-SY-COLR-CD-ID = VTORQT01.SY-COLR-CD-ID;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-SF-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-SF

// Select the table row
Function TI0FS-VTORQT01-SG()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("SG", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "SG  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-SG   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-SF-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TI0FW00.TI0FW-RQT-SF-SY-STY-NBR = VTORQT01.SY-STY-NBR;
  TI0FW00.TI0FW-RQT-SF-SY-COLR-CD-ID = VTORQT01.SY-COLR-CD-ID;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-SF-KEY; /* Table key*/
   /* MOVE SQLCA.SQLCODE TO TA1REC.TA1FYICD;*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-SG

// Select the table row
Function TI0FS-VTORQT01-SH()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("SH", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "SH  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-SH   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-SH-XGP-GPC-CD = VTORQT01.XGP-GPC-CD;
  TI0FW00.TI0FW-RQT-SH-TI-CUTK-SEND-CD = VTORQT01.TI-CUTK-SEND-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-SH-KEY; /* Table key*/
   /* MOVE SQLCA.SQLCODE TO TA1REC.TA1FYICD;*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-SH

// Select the table row
Function TI0FS-VTORQT01-SU()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("SU", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     /* OR SQLCA.SQLCODE EQ 100;     /* or row not found*/
    )                           
      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "SU  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-SU   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-SU-OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-RQT-SU-OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;
  TI0FW00.TI0FW-RQT-SU-OP-LINE-ITEM-NBR = VTORQT01.OP-LINE-ITEM-NBR;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-SU-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-SU

// Select the table row
Function TI0FS-VTORQT01-SX()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("SX", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select Max*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     /* OR SQLCA.SQLCODE EQ 100;     /* or row not found*/
    )                           
      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "SX  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-SX   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S-OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-RQT-S-OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;
  TI0FW00.TI0FW-RQT-S-TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-SX

// Select the table row
Function TI0FS-VTORQT01-U()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTORQT01" ("U ", SQLCA, VTORQT01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTORQT01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "U   ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTORQT01-U    "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTORQT01"; /* Table view name*/
  TI0FW00.TI0FW-RQT-S-OP-CUST-ORD-ID = VTORQT01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-RQT-S-OP-NIKE-ORD-ID = VTORQT01.OP-NIKE-ORD-ID;
  TI0FW00.TI0FW-RQT-S-TI-CUTK-RQT-NBR = VTORQT01.TI-CUTK-RQT-NBR;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RQT-S-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTORQT01-U

// Select the table row
Function TI0FS-VTOSCD01-S()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOSCD01" ("S ", SQLCA, VTOSCD01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOSCD01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SELECT THE TABLE ROW"; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOSCD01"; /* Table view name*/
  TA1REC.TA1TBLKE = SY1REC.SY1KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOSCD01-S

// Select the table row
Function TI0FS-VTOXCD01-S()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTOXCD01" ("S ", SQLCA, VTOXCD01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTOXCD01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SELECT THE TABLE ROW"; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTOXCD01"; /* Table view name*/
  TI0FW00.TI0FW-XCD-S-TI-CUTK-XMIT-CD = TI0FM004.TI-CUTK-XMIT-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-XCD-S-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTOXCD01-S

// Select the table row
Function TI0FS-VTRMSG01-C1()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTRMSG01" ("C1", SQLCA, VTRMSG01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTRMSG01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "IO-EX-SELECT-SCAH-1 "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTRMSG01"; /* Table view name*/

   /* ------------------------------------------------------------*/
   /* Build display key.*/
   /* ------------------------------------------------------------*/

  TI0FW00.TI0FW-RMSG-S1-OP-CUST-ORD-ID = VTRMSG01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-RMSG-S1-OP-NIKE-ORD-ID = VTRMSG01.OP-NIKE-ORD-ID;
  TI0FW00.TI0FW-RMSG-S1-TI-CUTK-RQT-NBR = VTRMSG01.TI-CUTK-RQT-NBR;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RMSG-S1-KEY;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTRMSG01-C1

// Select the table row
Function TI0FS-VTRMSG01-N1()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTRMSG01" ("N1", SQLCA, VTRMSG01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTRMSG01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-VTRMSG01-N1   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTRMSG01"; /* Table view name*/
  TI0FW00.TI0FW-RMSG-S1-OP-CUST-ORD-ID = VTRMSG01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-RMSG-S1-OP-NIKE-ORD-ID = VTRMSG01.OP-NIKE-ORD-ID;
  TI0FW00.TI0FW-RMSG-S1-TI-CUTK-RQT-NBR = VTRMSG01.TI-CUTK-RQT-NBR;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RMSG-S1-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTRMSG01-N1

// Select the table row
Function TI0FS-VTRMSG01-S1()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTRMSG01" ("S1", SQLCA, VTRMSG01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTRMSG01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1FUNC = "S1  ";
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1PGMAP = "TI0F";
  TA1REC.TA1LOC = "TI0FS-VTRMSG01-S1   "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTRMSG01"; /* Table view name*/
  TI0FW00.TI0FW-RMSG-S1-OP-CUST-ORD-ID = VTRMSG01.OP-CUST-ORD-ID;
  TI0FW00.TI0FW-RMSG-S1-OP-NIKE-ORD-ID = VTRMSG01.OP-NIKE-ORD-ID;
  TI0FW00.TI0FW-RMSG-S1-TI-CUTK-RQT-NBR = VTRMSG01.TI-CUTK-RQT-NBR;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-RMSG-S1-KEY; /* Table key*/
   /* MOVE SQLCA.SQLCODE TO TA1REC.TA1FYICD;*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTRMSG01-S1

// Select the table row
Function TI0FS-VTSPXM01-S()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VTSPXM01" ("S ", SQLCA, VTSPXM01) {isNoRefresh = yes, isExternal = yes};
  end /* Select row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or row not found*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  TIWREC.XXX-MSG-LOC-ID = "VTSPXM01"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(11); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(10); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = TIWREC.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "TI0FS-VTSPXM01-S    "; /* Description*/
  TA1REC.TA1DBASE = "DCUTKT  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTSPXM01"; /* Table view name*/
  TI0FW00.TI0FW-SPXM-S-TI-CUTK-SPLR-CD = TI0FM004.TI-CUTK-SPLR-CD;
  TI0FW00.TI0FW-SPXM-S-TI-CUTK-XMIT-CD = TI0FM004.TI-CUTK-XMIT-CD;
  TA1REC.TA1TBLKE = TI0FW00.TI0FW-SPXM-S-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end TI0FS-VTSPXM01-S

// FILTER SALES ORD BY NEED DATE
Function TI0FS-XMITCODE-ED()
   /* ------------------------------------------------------------*/
   /* Filter sales order according to need date from TI0FM001.*/
   /* ------------------------------------------------------------*/

  if (VTORQT01.TI-CUTK-XMIT-CD == TI0FM001.TI-CUTK-XMIT-CD)

    TI0FW00.TI0FW-TI-CUTK-XMIT-CD-OK-FL = "Y";

  end
end // end TI0FS-XMITCODE-ED

//*** RECORD=TI0FW00 ****
// ------------------------------------------------------------
// TI0F application working storage.
// ------------------------------------------------------------
// ***********************
Record TI0FW00 type basicRecord
  5 TI0FW00-REC char(1112) ; 
    10 XXX-RQT-DATA-FL XXX-RQT-DATA-FL ; 
    10 XXX-MAP-FMAT-FL XXX-MAP-FMAT-FL ; 
    10 XXX-MAP-DSP-CD XXX-MAP-DSP-CD ; 
    10 XXX-TEMP-STG-LNTH XXX-TEMP-STG-LNTH ; 
    10 XXX-INX-FLD-NBR XXX-INX-FLD-NBR ; 
    10 XXX-INX-LMT-NBR XXX-INX-LMT-NBR ; 
    10 XXX-CURR-PAGE-NBR XXX-CURR-PAGE-NBR ; 
    10 XXX-HI-PAGE-NBR XXX-HI-PAGE-NBR ; 
    10 XXX-PAGE-UPD-FL XXX-PAGE-UPD-FL ; 
    10 TI0FW-SEND-CD-SET-DEFINED-FL TI0FW-SEND-CD-SET-DEFINED-FL ; 
    10 TI0FW-SELECT-SET-DEFINED-FL TI0FW-SELECT-SET-DEFINED-FL ; 
    10 TI0FW-CSR-ON-ERR-FL TI0FW-CSR-ON-ERR-FL ; 
    10 TI0FW-VTORQT01-CHG-FL TI0FW-VTORQT01-CHG-FL ; 
    10 TI0FW-M002-CHG-FL TI0FW-M002-CHG-FL ; 
    10 TI0FW-M003-CHG-FL TI0FW-M003-CHG-FL ; 
    10 TI0FW-M004-CHG-FL TI0FW-M004-CHG-FL ; 
    10 TI0FW-RQT-FIRST-REC-FL TI0FW-RQT-FIRST-REC-FL ; 
    10 TI0FW-DATA-CHANGED-FL TI0FW-DATA-CHANGED-FL ; 
    10 TI0FW-UNPROTECT-FL TI0FW-UNPROTECT-FL ; 
    10 TI0FW-SALES-DATA-FL TI0FW-SALES-DATA-FL ; 
    10 TI0FW-SALES-ORDER-FL TI0FW-SALES-ORDER-FL ; 
    10 TI0FW-STYLE-COLR-FL TI0FW-STYLE-COLR-FL ; 
    10 TI0FW-CU-CO-ID-FL TI0FW-CU-CO-ID-FL ; 
    10 TI0FW-PRODC-DATA-FL TI0FW-PRODC-DATA-FL ; 
    10 TI0FW-PO-ID-FL TI0FW-PO-ID-FL ; 
    10 TI-CUTK-SEND-CD TI-CUTK-SEND-CD ; 
    10 TI0FW-TI-CUTK-STAT-CD-FL TI0FW-TI-CUTK-STAT-CD-FL ; 
    10 TI0FW-TI-CUTK-SEND-CD-FL TI0FW-TI-CUTK-SEND-CD-FL ; 
    10 TI0FW-TOHDR-EOF-FL TI0FW-TOHDR-EOF-FL ; 
    10 TI0FW-TORQT-EOF-FL TI0FW-TORQT-EOF-FL ; 
    10 TI0FW-TOITM-EOF-FL TI0FW-TOITM-EOF-FL ; 
    10 TI0FW-THMSG-EOF-FL TI0FW-THMSG-EOF-FL ; 
    10 TI0FW-TRMSG-EOF-FL TI0FW-TRMSG-EOF-FL ; 
    10 TI0FW-TIMSG-EOF-FL TI0FW-TIMSG-EOF-FL ; 
    10 TI0FW-HDR-FND-FL TI0FW-HDR-FND-FL ; 
    10 TI0FW-XNX-DEPT-ID-XREF-FL TI0FW-XNX-DEPT-ID-XREF-FL ; 
    10 TI0FW-CU-STOR-ID-FL TI0FW-CU-STOR-ID-FL ; 
    10 TI0FW-CUST-NEED-DT-FROM-FL TI0FW-CUST-NEED-DT-FROM-FL ; 
    10 TI0FW-CUST-NEED-DT-TO-FL TI0FW-CUST-NEED-DT-TO-FL ; 
    10 TI0FW-SEND-DATE-RNG-FROM-FL TI0FW-SEND-DATE-RNG-FROM-FL ; 
    10 TI0FW-SEND-DATE-RNG-TO-FL TI0FW-SEND-DATE-RNG-TO-FL ; 
    10 TI0FW-SENT-DATE-RNG-FROM-FL TI0FW-SENT-DATE-RNG-FROM-FL ; 
    10 TI0FW-SENT-DATE-RNG-TO-FL TI0FW-SENT-DATE-RNG-TO-FL ; 
    10 TI0FW-OP-CUST-PO-FL TI0FW-OP-CUST-PO-FL ; 
    10 TI0FW-A-ROW-WAS-SELECTED-FL TI0FW-A-ROW-WAS-SELECTED-FL ; 
    10 TI0FW-SELECTED-ROW-FOUND-FL TI0FW-SELECTED-ROW-FOUND-FL ; 
    10 TI0FW-TI-CUTK-STAT-CD-SAVE-FL TI0FW-TI-CUTK-STAT-CD-SAVE-FL ; 
    10 TI0FW-TI0FW02-PAGE-TO-READ TI0FW-TI0FW02-PAGE-TO-READ ; 
    10 TI0FW-TI0FW03-PAGE-TO-READ TI0FW-TI0FW03-PAGE-TO-READ ; 
    10 TI0FW-PREVIOUS-SCREEN-IND TI0FW-PREVIOUS-SCREEN-IND ; 
    10 TI0FW-VTIMSG01-NBR TI0FW-VTIMSG01-NBR ; 
    10 TI0FW-VTRMSG01-NBR TI0FW-VTRMSG01-NBR ; 
    10 TI0FW-VTOITM01-NBR TI0FW-VTOITM01-NBR ; 
    10 TI0FW-VTOITM01-SZ-ID TI0FW-VTOITM01-SZ-ID ; 
    10 TI0FW-M002-CURR-PAGE-NBR TI0FW-M002-CURR-PAGE-NBR ; 
    10 TI0FW-M002-HI-PAGE-NBR TI0FW-M002-HI-PAGE-NBR ; 
    10 TI0FW-M003-CURR-PAGE-NBR TI0FW-M003-CURR-PAGE-NBR ; 
    10 TI0FW-M003-HI-PAGE-NBR TI0FW-M003-HI-PAGE-NBR ; 
    10 TI0FW-M005-CURR-PAGE-NBR TI0FW-M005-CURR-PAGE-NBR ; 
    10 TI0FW-M005-HI-PAGE-NBR TI0FW-M005-HI-PAGE-NBR ; 
    10 TI0FW-M006-CURR-PAGE-NBR TI0FW-M006-CURR-PAGE-NBR ; 
    10 TI0FW-M006-HI-PAGE-NBR TI0FW-M006-HI-PAGE-NBR ; 
    10 TI0FW-M007-CURR-PAGE-NBR TI0FW-M007-CURR-PAGE-NBR ; 
    10 TI0FW-M007-HI-PAGE-NBR TI0FW-M007-HI-PAGE-NBR ; 
    10 TI0FW-WORK-IDX TI0FW-WORK-IDX ; 
    10 TI0FW-ITM-KEY TI0FW-ITM-KEY ; 
      15 TI0FW-RQT-KEY TI0FW-RQT-KEY ; 
        20 TI0FW-HDR-KEY TI0FW-HDR-KEY ; 
          25 OP-CUST-ORD-ID OP-CUST-ORD-ID ; 
          25 OP-NIKE-ORD-ID OP-NIKE-ORD-ID ; 
        20 TI-CUTK-RQT-NBR TI-CUTK-RQT-NBR ; 
      15 TI-CUTK-LINE-NBR TI-CUTK-LINE-NBR ; 
    10 TI0FW-FCTY-S-KEY TI0FW-FCTY-S-KEY ; 
      15 TI0FW-FCTY-S-XGP-GPC-CD TI0FW-FCTY-S-XGP-GPC-CD ; 
      15 TI0FW-FCTY-S-FY-FCTY-CD TI0FW-FCTY-S-FY-FCTY-CD ; 
    10 TI0FW-HDR-S-KEY TI0FW-HDR-S-KEY ; 
      15 TI0FW-HDR-S-OP-CUST-ORD-ID TI0FW-HDR-S-OP-CUST-ORD-ID ; 
      15 TI0FW-HDR-S-OP-NIKE-ORD-ID TI0FW-HDR-S-OP-NIKE-ORD-ID ; 
    10 TI0FW-HDR-S1-KEY TI0FW-HDR-S1-KEY ; 
      15 TI0FW-HDR-S1-CU-CO-ID TI0FW-HDR-S1-CU-CO-ID ; 
      15 TI0FW-HDR-S1-CU-STOR-ID TI0FW-HDR-S1-CU-STOR-ID ; 
      15 TI0FW-HDR-S1-XNX-DEPT-ID-XREF TI0FW-HDR-S1-XNX-DEPT-ID-XREF ; 
      15 TI0FW-HDR-S1-XGP-GPC-CD TI0FW-HDR-S1-XGP-GPC-CD ; 
      15 TI0FW-HDR-S1-TI-CUTK-STAT-CD TI0FW-HDR-S1-TI-CUTK-STAT-CD ; 
    10 TI0FW-HDR-S2-KEY TI0FW-HDR-S2-KEY ; 
      15 TI0FW-HDR-S2-CU-CO-ID TI0FW-HDR-S2-CU-CO-ID ; 
      15 TI0FW-HDR-S2-XGP-GPC-CD TI0FW-HDR-S2-XGP-GPC-CD ; 
    10 TI0FW-HDR-S3-KEY TI0FW-HDR-S3-KEY ; 
      15 TI0FW-HDR-S3-CU-CO-ID TI0FW-HDR-S3-CU-CO-ID ; 
      15 TI0FW-HDR-S3-XGP-GPC-CD TI0FW-HDR-S3-XGP-GPC-CD ; 
      15 TI0FW-HDR-S3-OP-CUST-PO TI0FW-HDR-S3-OP-CUST-PO ; 
      15 TI0FW-HDR-S3-TI-CUTK-STAT-CD TI0FW-HDR-S3-TI-CUTK-STAT-CD ; 
    10 TI0FW-HDR-S4-KEY TI0FW-HDR-S4-KEY ; 
      15 TI0FW-HDR-S4-CU-CO-ID TI0FW-HDR-S4-CU-CO-ID ; 
      15 TI0FW-HDR-S4-XGP-GPC-CD TI0FW-HDR-S4-XGP-GPC-CD ; 
      15 TI0FW-HDR-S4-CU-STOR-ID TI0FW-HDR-S4-CU-STOR-ID ; 
      15 TI0FW-HDR-S4-XNX-DEPT-ID-XREF TI0FW-HDR-S4-XNX-DEPT-ID-XREF ; 
      15 TI0FW-HDR-S4-TI-CUTK-STAT-CD TI0FW-HDR-S4-TI-CUTK-STAT-CD ; 
    10 TI0FW-HDR-S5-KEY TI0FW-HDR-S5-KEY ; 
      15 TI0FW-HDR-S5-CU-CO-ID TI0FW-HDR-S5-CU-CO-ID ; 
      15 TI0FW-HDR-S5-CU-STOR-ID TI0FW-HDR-S5-CU-STOR-ID ; 
      15 TI0FW-HDR-S5-XNX-DEPT-ID-XREF TI0FW-HDR-S5-XNX-DEPT-ID-XREF ; 
      15 TI0FW-HDR-S5-XGP-GPC-CD TI0FW-HDR-S5-XGP-GPC-CD ; 
      15 TI0FW-HDR-S5-OP-CUST-PO TI0FW-HDR-S5-OP-CUST-PO ; 
      15 TI0FW-HDR-S5-TI-CUTK-STAT-CD TI0FW-HDR-S5-TI-CUTK-STAT-CD ; 
    10 TI0FW-HDR-S6-KEY TI0FW-HDR-S6-KEY ; 
      15 TI0FW-HDR-S6-OP-CUST-ORD-ID TI0FW-HDR-S6-OP-CUST-ORD-ID ; 
    10 TI0FW-RQT-S-KEY TI0FW-RQT-S-KEY ; 
      15 TI0FW-RQT-S-OP-CUST-ORD-ID TI0FW-RQT-S-OP-CUST-ORD-ID ; 
      15 TI0FW-RQT-S-OP-NIKE-ORD-ID TI0FW-RQT-S-OP-NIKE-ORD-ID ; 
      15 TI0FW-RQT-S-TI-CUTK-RQT-NBR TI0FW-RQT-S-TI-CUTK-RQT-NBR ; 
    10 TI0FW-RQT-S1-KEY TI0FW-RQT-S1-KEY ; 
      15 TI0FW-RQT-S1-OP-CUST-ORD-ID TI0FW-RQT-S1-OP-CUST-ORD-ID ; 
      15 TI0FW-RQT-S1-OP-NIKE-ORD-ID TI0FW-RQT-S1-OP-NIKE-ORD-ID ; 
    10 TI0FW-RQT-S2-KEY TI0FW-RQT-S2-KEY ; 
      15 TI0FW-RQT-S2-OP-CUST-ORD-ID TI0FW-RQT-S2-OP-CUST-ORD-ID ; 
      15 TI0FW-RQT-S2-OP-NIKE-ORD-ID TI0FW-RQT-S2-OP-NIKE-ORD-ID ; 
      15 TI0FW-RQT-S2-SY-STY-NBR TI0FW-RQT-S2-SY-STY-NBR ; 
      15 TI0FW-RQT-S2-SY-COLR-CD-ID TI0FW-RQT-S2-SY-COLR-CD-ID ; 
    10 TI0FW-RQT-S5-KEY TI0FW-RQT-S5-KEY ; 
      15 TI0FW-RQT-S5-OP-CUST-ORD-ID TI0FW-RQT-S5-OP-CUST-ORD-ID ; 
      15 TI0FW-RQT-S5-OP-NIKE-ORD-ID TI0FW-RQT-S5-OP-NIKE-ORD-ID ; 
      15 TI0FW-RQT-S5-TI-CUTK-RQT-NBR TI0FW-RQT-S5-TI-CUTK-RQT-NBR ; 
    10 TI0FW-RQT-S5-OP-ORD-PART-CHAR TI0FW-RQT-S5-OP-ORD-PART-CHAR ; 
    10 TI0FW-RQT-S6-KEY TI0FW-RQT-S6-KEY ; 
      15 TI0FW-RQT-S6-PC-PO-NBR TI0FW-RQT-S6-PC-PO-NBR ; 
      15 TI0FW-RQT-S6-PC-ITM-SEQ-NBR TI0FW-RQT-S6-PC-ITM-SEQ-NBR ; 
      15 TI0FW-RQT-S6-XGP-GPC-CD TI0FW-RQT-S6-XGP-GPC-CD ; 
    10 TI0FW-RQT-S7-KEY TI0FW-RQT-S7-KEY ; 
      15 TI0FW-RQT-S7-PC-PO-NBR TI0FW-RQT-S7-PC-PO-NBR ; 
      15 TI0FW-RQT-S7-XGP-GPC-CD TI0FW-RQT-S7-XGP-GPC-CD ; 
    10 TI0FW-RQT-S8-KEY TI0FW-RQT-S8-KEY ; 
      15 TI0FW-RQT-S8-PC-PO-ID-MO-RNG TI0FW-RQT-S8-PC-PO-ID-MO-RNG ; 
      15 TI0FW-RQT-S8-FY-FCTY-CD TI0FW-RQT-S8-FY-FCTY-CD ; 
      15 TI0FW-RQT-S8-XGP-GPC-CD TI0FW-RQT-S8-XGP-GPC-CD ; 
    10 TI0FW-RQT-S9-KEY TI0FW-RQT-S9-KEY ; 
      15 TI0FW-RQT-S9-PC-PO-ID-MO-RNG TI0FW-RQT-S9-PC-PO-ID-MO-RNG ; 
      15 TI0FW-RQT-S9-XCT-CTRY-CD TI0FW-RQT-S9-XCT-CTRY-CD ; 
      15 TI0FW-RQT-S9-XGP-GPC-CD TI0FW-RQT-S9-XGP-GPC-CD ; 
    10 TI0FW-RQT-SA-KEY TI0FW-RQT-SA-KEY ; 
      15 TI0FW-RQT-SA-PC-PRDCU-ID TI0FW-RQT-SA-PC-PRDCU-ID ; 
      15 TI0FW-RQT-SA-XGP-GPC-CD TI0FW-RQT-SA-XGP-GPC-CD ; 
    10 TI0FW-RQT-SF-KEY TI0FW-RQT-SF-KEY ; 
      15 TI0FW-RQT-SF-SY-STY-NBR TI0FW-RQT-SF-SY-STY-NBR ; 
      15 TI0FW-RQT-SF-SY-COLR-CD-ID TI0FW-RQT-SF-SY-COLR-CD-ID ; 
      15 TI0FW-RQT-SF-XGP-GPC-CD TI0FW-RQT-SF-XGP-GPC-CD ; 
    10 TI0FW-RQT-SH-KEY TI0FW-RQT-SH-KEY ; 
      15 TI0FW-RQT-SH-XGP-GPC-CD TI0FW-RQT-SH-XGP-GPC-CD ; 
      15 TI0FW-RQT-SH-TI-CUTK-SEND-CD TI0FW-RQT-SH-TI-CUTK-SEND-CD ; 
    10 TI0FW-RQT-SU-KEY TI0FW-RQT-SU-KEY ; 
      15 TI0FW-RQT-SU-OP-CUST-ORD-ID TI0FW-RQT-SU-OP-CUST-ORD-ID ; 
      15 TI0FW-RQT-SU-OP-NIKE-ORD-ID TI0FW-RQT-SU-OP-NIKE-ORD-ID ; 
      15 TI0FW-RQT-SU-OP-LINE-ITEM-NBR TI0FW-RQT-SU-OP-LINE-ITEM-NBR ; 
    10 TI0FW-ITM-S1-KEY TI0FW-ITM-S1-KEY ; 
      15 TI0FW-ITM-S1-OP-CUST-ORD-ID TI0FW-ITM-S1-OP-CUST-ORD-ID ; 
      15 TI0FW-ITM-S1-OP-NIKE-ORD-ID TI0FW-ITM-S1-OP-NIKE-ORD-ID ; 
      15 TI0FW-ITM-S1-TI-CUTK-RQT-NBR TI0FW-ITM-S1-TI-CUTK-RQT-NBR ; 
    10 TI0FW-ITM-A-KEY TI0FW-ITM-A-KEY ; 
      15 TI0FW-ITM-A-OP-CUST-ORD-ID TI0FW-ITM-A-OP-CUST-ORD-ID ; 
      15 TI0FW-ITM-A-OP-NIKE-ORD-ID TI0FW-ITM-A-OP-NIKE-ORD-ID ; 
      15 TI0FW-ITM-A-TI-CUTK-RQT-NBR TI0FW-ITM-A-TI-CUTK-RQT-NBR ; 
    10 TI0FW-HMSG-S1-KEY TI0FW-HMSG-S1-KEY ; 
      15 TI0FW-HMSG-S1-OP-CUST-ORD-ID TI0FW-HMSG-S1-OP-CUST-ORD-ID ; 
      15 TI0FW-HMSG-S1-OP-NIKE-ORD-ID TI0FW-HMSG-S1-OP-NIKE-ORD-ID ; 
    10 TI0FW-RMSG-S1-KEY TI0FW-RMSG-S1-KEY ; 
      15 TI0FW-RMSG-S1-OP-CUST-ORD-ID TI0FW-RMSG-S1-OP-CUST-ORD-ID ; 
      15 TI0FW-RMSG-S1-OP-NIKE-ORD-ID TI0FW-RMSG-S1-OP-NIKE-ORD-ID ; 
      15 TI0FW-RMSG-S1-TI-CUTK-RQT-NBR TI0FW-RMSG-S1-TI-CUTK-RQT-NBR ; 
    10 TI0FW-IMSG-S1-KEY TI0FW-IMSG-S1-KEY ; 
      15 TI0FW-IMSG-S1-OP-CUST-ORD-ID TI0FW-IMSG-S1-OP-CUST-ORD-ID ; 
      15 TI0FW-IMSG-S1-OP-NIKE-ORD-ID TI0FW-IMSG-S1-OP-NIKE-ORD-ID ; 
      15 TI0FW-IMSG-S1-TI-CUTK-RQT-NBR TI0FW-IMSG-S1-TI-CUTK-RQT-NBR ; 
      15 TI0FW-IMSG-S1-TI-CUTK-LINE-NBR TI0FW-IMSG-S1-TI-CUTK-LINE-NBR ; 
    10 TI0FW-PCD-S-KEY TI0FW-PCD-S-KEY ; 
      15 TI0FW-PCD-S-TI-CUTK-SPLR-CD TI0FW-PCD-S-TI-CUTK-SPLR-CD ; 
    10 TI0FW-XCD-S-KEY TI0FW-XCD-S-KEY ; 
      15 TI0FW-XCD-S-TI-CUTK-XMIT-CD TI0FW-XCD-S-TI-CUTK-XMIT-CD ; 
    10 TI0FW-SPXM-S-KEY TI0FW-SPXM-S-KEY ; 
      15 TI0FW-SPXM-S-TI-CUTK-SPLR-CD TI0FW-SPXM-S-TI-CUTK-SPLR-CD ; 
      15 TI0FW-SPXM-S-TI-CUTK-XMIT-CD TI0FW-SPXM-S-TI-CUTK-XMIT-CD ; 
    10 TI0FW-DATE-NUM TI0FW-DATE-NUM ; 
    10 TI0FW-DATE-WORK TI0FW-DATE-WORK ; 
      15 * char(3) ; 
      15 TI0FW-DATE-WRK6 TI0FW-DATE-WRK6 ; 
        20 TI0FW-DATE-WRK6-YY TI0FW-DATE-WRK6-YY ; 
        20 TI0FW-DATE-WRK6-MM TI0FW-DATE-WRK6-MM ; 
        20 TI0FW-DATE-WRK6-DD TI0FW-DATE-WRK6-DD ; 
    10 TI0FW-DATE-DISPLAY TI0FW-DATE-DISPLAY ; 
      15 TI0FW-DATE-DISP-MM TI0FW-DATE-DISP-MM ; 
      15 TI0FW-DATE-DISP-SLASH1 TI0FW-DATE-DISP-SLASH1 ; 
      15 TI0FW-DATE-DISP-DD TI0FW-DATE-DISP-DD ; 
      15 TI0FW-DATE-DISP-SLASH2 TI0FW-DATE-DISP-SLASH2 ; 
      15 TI0FW-DATE-DISP-YY TI0FW-DATE-DISP-YY ; 
    10 * char(1) ; 
    10 TI0FW-WDATE-TIME-NUM TI0FW-WDATE-TIME-NUM ; 
      15 TI0FW-WDATE-HHMM-NUM TI0FW-WDATE-HHMM-NUM ; 
      15 TI0FW-WDATE-SEC-NUM TI0FW-WDATE-SEC-NUM ; 
    10 TI0FW-OP-CUST-ORD-ID-NUM TI0FW-OP-CUST-ORD-ID-NUM ; 
    10 TI0FW-OP-NIKE-ORD-ID-NUM TI0FW-OP-NIKE-ORD-ID-NUM ; 
    10 TI0FW-OP-CUST-ORD-ID-LCHA TI0FW-OP-CUST-ORD-ID-LCHA ; 
      15 * char(1) ; 
      15 TI0FW-OP-CUST-ORD-ID-SCHA TI0FW-OP-CUST-ORD-ID-SCHA ; 
        20 * char(7) ; 
        20 TI0FW-OP-ORD-PART-CHA TI0FW-OP-ORD-PART-CHA ; 
    10 TI0FW-OP-NIKE-ORD-ID-LCHA TI0FW-OP-NIKE-ORD-ID-LCHA ; 
      15 * char(2) ; 
      15 TI0FW-OP-NIKE-ORD-ID-SCHA TI0FW-OP-NIKE-ORD-ID-SCHA ; 
    10 TI0FW-SALES-ORD-ID TI0FW-SALES-ORD-ID ; 
      15 TI0FW-OP-CUST-ORD-ID-CHA TI0FW-OP-CUST-ORD-ID-CHA ; 
      15 TI0FW-SALES-ORD-PERIOD TI0FW-SALES-ORD-PERIOD ; 
      15 TI0FW-OP-NIKE-ORD-ID-CHA TI0FW-OP-NIKE-ORD-ID-CHA ; 
    10 TI0FW-STYLE-COLR TI0FW-STYLE-COLR ; 
      15 SY-STY-CD SY-STY-CD ; 
      15 TI0FW-STY-COLR-HYPHEN TI0FW-STY-COLR-HYPHEN ; 
      15 SY-COLR-CD-ID SY-COLR-CD-ID ; 
    10 PC-PO-ID-MO-RNG PC-PO-ID-MO-RNG ; 
    10 TI0FW-PC-PO-ID-MO-RNG TI0FW-PC-PO-ID-MO-RNG ; 
      15 TI0FW-PO-ID-ZERO-NUM num(1) ; 
      15 TI0FW-PO-ID-CC-NUM TI0FW-PO-ID-CC-NUM ; 
      15 TI0FW-PO-ID-YY-NUM TI0FW-PO-ID-YY-NUM ; 
      15 TI0FW-PO-ID-BLD-MM-NUM TI0FW-PO-ID-BLD-MM-NUM ; 
      15 TI0FW-PO-ID-SHP-MM-NUM TI0FW-PO-ID-SHP-MM-NUM ; 
    10 TI0FW-PC-PO-ID-MO-RNG-NUM TI0FW-PC-PO-ID-MO-RNG-NUM ; 
      15 * char(1) ; 
      15 TI0FW-PO-ID-CC-CHA TI0FW-PO-ID-CC-CHA ; 
      15 TI0FW-PO-ID-YY-CHA TI0FW-PO-ID-YY-CHA ; 
      15 TI0FW-PO-ID-BLD-MM-CHA TI0FW-PO-ID-BLD-MM-CHA ; 
      15 TI0FW-PO-ID-SHP-MM-CHA TI0FW-PO-ID-SHP-MM-CHA ; 
    10 TI0FW-PC-PO-ID TI0FW-PC-PO-ID ; 
      15 TI0FW-PO-ID-YY TI0FW-PO-ID-YY ; 
      15 TI0F-PC-PO-ID-SPACE1 char(1) ; 
      15 TI0FW-PO-ID-BLD-MM TI0FW-PO-ID-BLD-MM ; 
      15 TI0F-PC-PO-ID-SPACE2 char(1) ; 
      15 TI0FW-PO-ID-SHP-MM TI0FW-PO-ID-SHP-MM ; 
    10 TI0FW-CU-CO-ID-NUM TI0FW-CU-CO-ID-NUM ; 
    10 TI0FW-CU-CO-ID-LCHA TI0FW-CU-CO-ID-LCHA ; 
      15 * char(2) ; 
      15 TI0FW-CU-CO-ID-SCHA TI0FW-CU-CO-ID-SCHA ; 
    10 TI0FW-CU-STOR-ID-NUM TI0FW-CU-STOR-ID-NUM ; 
    10 TI0FW-CU-STOR-ID-LCHA TI0FW-CU-STOR-ID-LCHA ; 
      15 TI0FW-CU-STOR-ID-SCHA TI0FW-CU-STOR-ID-SCHA ; 
    10 TI0FW-XNX-DEPT-ID-XREF-NUM TI0FW-XNX-DEPT-ID-XREF-NUM ; 
    10 TI0FW-XNX-DEPT-ID-XREF-LCHA TI0FW-XNX-DEPT-ID-XREF-LCHA ; 
      15 * char(2) ; 
      15 TI0FW-XNX-DEPT-ID-XREF-SCHA TI0FW-XNX-DEPT-ID-XREF-SCHA ; 
    10 TI0FW-CUSTOMER-ID TI0FW-CUSTOMER-ID ; 
      15 TI0FW-CU-CO-ID-CHA TI0FW-CU-CO-ID-CHA ; 
      15 TI0F-CUSTOMER-PERIOD1 char(1) ; 
      15 TI0FW-CU-STOR-ID-CHA TI0FW-CU-STOR-ID-CHA ; 
      15 TI0F-CUSTOMER-PERIOD2 char(1) ; 
      15 TI0FW-XNX-DEPT-ID-XREF-CHA TI0FW-XNX-DEPT-ID-XREF-CHA ; 
    10 TI0FW-KUCCOID-NUM TI0FW-KUCCOID-NUM ; 
    10 TI0FW-CUST-NEED-DT-FR-NUM TI0FW-CUST-NEED-DT-FR-NUM ; 
    10 TI0FW-CUST-NEED-DT-FR-CHA TI0FW-CUST-NEED-DT-FR-CHA ; 
      15 TI0FW-CUST-NEED-DT-FR-MM TI0FW-CUST-NEED-DT-FR-MM ; 
      15 TI0FW-CUST-NEED-DT-FR-DD TI0FW-CUST-NEED-DT-FR-DD ; 
      15 TI0FW-CUST-NEED-DT-FR-YY TI0FW-CUST-NEED-DT-FR-YY ; 
    10 TI0FW-CUST-NEED-DT-TO-NUM TI0FW-CUST-NEED-DT-TO-NUM ; 
    10 TI0FW-CUST-NEED-DT-TO-CHA TI0FW-CUST-NEED-DT-TO-CHA ; 
      15 TI0FW-CUST-NEED-DT-TO-MM TI0FW-CUST-NEED-DT-TO-MM ; 
      15 TI0FW-CUST-NEED-DT-TO-DD TI0FW-CUST-NEED-DT-TO-DD ; 
      15 TI0FW-CUST-NEED-DT-TO-YY TI0FW-CUST-NEED-DT-TO-YY ; 
    10 TI0FW-CUST-NEED-DT-LOW TI0FW-CUST-NEED-DT-LOW ; 
    10 TI0FW-CUST-NEED-DT-LOW-CHA TI0FW-CUST-NEED-DT-LOW-CHA ; 
      15 TI0FW-CUST-NEED-DT-LOW-YY TI0FW-CUST-NEED-DT-LOW-YY ; 
      15 TI0FW-CUST-NEED-DT-LOW-MM TI0FW-CUST-NEED-DT-LOW-MM ; 
      15 TI0FW-CUST-NEED-DT-LOW-DD TI0FW-CUST-NEED-DT-LOW-DD ; 
    10 TI0FW-CUST-NEED-DT-HI TI0FW-CUST-NEED-DT-HI ; 
    10 TI0FW-CUST-NEED-DT-HI-CHA TI0FW-CUST-NEED-DT-HI-CHA ; 
      15 TI0FW-CUST-NEED-DT-HI-YY TI0FW-CUST-NEED-DT-HI-YY ; 
      15 TI0FW-CUST-NEED-DT-HI-MM TI0FW-CUST-NEED-DT-HI-MM ; 
      15 TI0FW-CUST-NEED-DT-HI-DD TI0FW-CUST-NEED-DT-HI-DD ; 
    10 TI0FW-CUST-EST-SNT-DT-FR-NUM TI0FW-CUST-EST-SNT-DT-FR-NUM ; 
    10 TI0FW-CUST-EST-SNT-DT-FR-CHA TI0FW-CUST-EST-SNT-DT-FR-CHA ; 
      15 TI0FW-CUST-EST-SNT-DT-FR-MM TI0FW-CUST-EST-SNT-DT-FR-MM ; 
      15 TI0FW-CUST-EST-SNT-DT-FR-DD TI0FW-CUST-EST-SNT-DT-FR-DD ; 
      15 TI0FW-CUST-EST-SNT-DT-FR-YY TI0FW-CUST-EST-SNT-DT-FR-YY ; 
    10 TI0FW-CUST-EST-SNT-DT-TO-NUM TI0FW-CUST-EST-SNT-DT-TO-NUM ; 
    10 TI0FW-CUST-EST-SNT-DT-TO-CHA TI0FW-CUST-EST-SNT-DT-TO-CHA ; 
      15 TI0FW-CUST-EST-SNT-DT-TO-MM TI0FW-CUST-EST-SNT-DT-TO-MM ; 
      15 TI0FW-CUST-EST-SNT-DT-TO-DD TI0FW-CUST-EST-SNT-DT-TO-DD ; 
      15 TI0FW-CUST-EST-SNT-DT-TO-YY TI0FW-CUST-EST-SNT-DT-TO-YY ; 
    10 TI0FW-CUST-EST-SNT-DT-LOW TI0FW-CUST-EST-SNT-DT-LOW ; 
    10 TI0FW-CUST-EST-SNT-DT-LOW-CHA TI0FW-CUST-EST-SNT-DT-LOW-CHA ; 
      15 TI0FW-CUST-EST-SNT-DT-LOW-ZERO TI0FW-CUST-EST-SNT-DT-LOW-ZERO ; 
      15 TI0FW-CUST-EST-SNT-DT-LOW-CC TI0FW-CUST-EST-SNT-DT-LOW-CC ; 
      15 TI0FW-CUST-EST-SNT-DT-LOW-YY TI0FW-CUST-EST-SNT-DT-LOW-YY ; 
      15 TI0FW-CUST-EST-SNT-DT-LOW-MM TI0FW-CUST-EST-SNT-DT-LOW-MM ; 
      15 TI0FW-CUST-EST-SNT-DT-LOW-DD TI0FW-CUST-EST-SNT-DT-LOW-DD ; 
    10 TI0FW-CUST-EST-SNT-DT-HI TI0FW-CUST-EST-SNT-DT-HI ; 
    10 TI0FW-CUST-EST-SNT-DT-HI-CHA TI0FW-CUST-EST-SNT-DT-HI-CHA ; 
      15 TI0FW-CUST-EST-SNT-DT-HI-ZERO TI0FW-CUST-EST-SNT-DT-HI-ZERO ; 
      15 TI0FW-CUST-EST-SNT-DT-HI-CC TI0FW-CUST-EST-SNT-DT-HI-CC ; 
      15 TI0FW-CUST-EST-SNT-DT-HI-YY TI0FW-CUST-EST-SNT-DT-HI-YY ; 
      15 TI0FW-CUST-EST-SNT-DT-HI-MM TI0FW-CUST-EST-SNT-DT-HI-MM ; 
      15 TI0FW-CUST-EST-SNT-DT-HI-DD TI0FW-CUST-EST-SNT-DT-HI-DD ; 
    10 TI0FW-CUST-ACT-SNT-DT-FR-NUM TI0FW-CUST-ACT-SNT-DT-FR-NUM ; 
    10 TI0FW-CUST-ACT-SNT-DT-FR-CHA TI0FW-CUST-ACT-SNT-DT-FR-CHA ; 
      15 TI0FW-CUST-ACT-SNT-DT-FR-MM TI0FW-CUST-ACT-SNT-DT-FR-MM ; 
      15 TI0FW-CUST-ACT-SNT-DT-FR-DD TI0FW-CUST-ACT-SNT-DT-FR-DD ; 
      15 TI0FW-CUST-ACT-SNT-DT-FR-YY TI0FW-CUST-ACT-SNT-DT-FR-YY ; 
    10 TI0FW-CUST-ACT-SNT-DT-TO-NUM TI0FW-CUST-ACT-SNT-DT-TO-NUM ; 
    10 TI0FW-CUST-ACT-SNT-DT-TO-CHA TI0FW-CUST-ACT-SNT-DT-TO-CHA ; 
      15 TI0FW-CUST-ACT-SNT-DT-TO-MM TI0FW-CUST-ACT-SNT-DT-TO-MM ; 
      15 TI0FW-CUST-ACT-SNT-DT-TO-DD TI0FW-CUST-ACT-SNT-DT-TO-DD ; 
      15 TI0FW-CUST-ACT-SNT-DT-TO-YY TI0FW-CUST-ACT-SNT-DT-TO-YY ; 
    10 TI0FW-CUST-ACT-SNT-DT-LOW TI0FW-CUST-ACT-SNT-DT-LOW ; 
    10 TI0FW-CUST-ACT-SNT-DT-LOW-CHA TI0FW-CUST-ACT-SNT-DT-LOW-CHA ; 
      15 TI0FW-CUST-ACT-SNT-DT-LOW-ZERO TI0FW-CUST-ACT-SNT-DT-LOW-ZERO ; 
      15 TI0FW-CUST-ACT-SNT-DT-LOW-CC TI0FW-CUST-ACT-SNT-DT-LOW-CC ; 
      15 TI0FW-CUST-ACT-SNT-DT-LOW-YY TI0FW-CUST-ACT-SNT-DT-LOW-YY ; 
      15 TI0FW-CUST-ACT-SNT-DT-LOW-MM TI0FW-CUST-ACT-SNT-DT-LOW-MM ; 
      15 TI0FW-CUST-ACT-SNT-DT-LOW-DD TI0FW-CUST-ACT-SNT-DT-LOW-DD ; 
    10 TI0FW-CUST-ACT-SNT-DT-HI TI0FW-CUST-ACT-SNT-DT-HI ; 
    10 TI0FW-CUST-ACT-SNT-DT-HI-CHA TI0FW-CUST-ACT-SNT-DT-HI-CHA ; 
      15 TI0FW-CUST-ACT-SNT-DT-HI-ZERO TI0FW-CUST-ACT-SNT-DT-HI-ZERO ; 
      15 TI0FW-CUST-ACT-SNT-DT-HI-CC TI0FW-CUST-ACT-SNT-DT-HI-CC ; 
      15 TI0FW-CUST-ACT-SNT-DT-HI-YY TI0FW-CUST-ACT-SNT-DT-HI-YY ; 
      15 TI0FW-CUST-ACT-SNT-DT-HI-MM TI0FW-CUST-ACT-SNT-DT-HI-MM ; 
      15 TI0FW-CUST-ACT-SNT-DT-HI-DD TI0FW-CUST-ACT-SNT-DT-HI-DD ; 
    10 TI0FW-STYLE-COLR-OK-FL TI0FW-STYLE-COLR-OK-FL ; 
    10 TI0FW-CUST-NEED-DT-OK-FL TI0FW-CUST-NEED-DT-OK-FL ; 
    10 TI0FW-XHD-HNDL-CD-OK-FL TI0FW-XHD-HNDL-CD-OK-FL ; 
    10 TI0FW-TI-CUTK-MSG-CD-OK-FL TI0FW-TI-CUTK-MSG-CD-OK-FL ; 
    10 TI0FW-TI-CUTK-MSG-EXISTS-FL TI0FW-TI-CUTK-MSG-EXISTS-FL ; 
    10 TI0FW-CUST-EST-SNT-DT-OK-FL TI0FW-CUST-EST-SNT-DT-OK-FL ; 
    10 TI0FW-CUST-ACT-SNT-DT-OK-FL TI0FW-CUST-ACT-SNT-DT-OK-FL ; 
    10 TI0FW-TI-CUTK-XMIT-CD-OK-FL TI0FW-TI-CUTK-XMIT-CD-OK-FL ; 
    10 TI0FW-TI-CUTK-XMIT-CD-FL TI0FW-TI-CUTK-XMIT-CD-FL ; 
    10 TI0FW-TI-CUTK-SPLR-CD-OK-FL TI0FW-TI-CUTK-SPLR-CD-OK-FL ; 
    10 TI0FW-TI-CUTK-SPLR-CD-FL TI0FW-TI-CUTK-SPLR-CD-FL ; 
    10 TI0FW-OP-CUST-PO-OK-FL TI0FW-OP-CUST-PO-OK-FL ; 
    10 TI0FW-TI-CUTK-SEND-CD-OK-FL TI0FW-TI-CUTK-SEND-CD-OK-FL ; 
    10 TI0FW-TI-CUTK-STAT-CD-OK-FL TI0FW-TI-CUTK-STAT-CD-OK-FL ; 
    10 TI0FW-SY-STY-CD TI0FW-SY-STY-CD ; 
    10 TI0FW-SY-COLR-CD-ID TI0FW-SY-COLR-CD-ID ; 
    10 TI0FW-TI-CUTK-MSG-CD TI0FW-TI-CUTK-MSG-CD [5] ; 
    10 TI0FW-TI-CUTK-MSG-CD-IDX TI0FW-TI-CUTK-MSG-CD-IDX ; 
    10 TI0FW-TI-CUTK-STAT-CD-IDX TI0FW-TI-CUTK-STAT-CD-IDX ; 
    10 TI0FW-TI-CUTK-STAT-CD-ED-IDX TI0FW-TI-CUTK-STAT-CD-ED-IDX ; 
    10 TI0FW-TI-CUTK-STAT-CD-SAVE-IDX TI0FW-TI-CUTK-STAT-CD-SAVE-IDX ; 
    10 TI0FW-CU-STOR-ID-IN-CHA TI0FW-CU-STOR-ID-IN-CHA ; 
      15 TI0FW-CU-STOR-ID-IN-CBYT TI0FW-CU-STOR-ID-IN-CBYT [4] ; 
    10 TI0FW-CU-STOR-ID-IN-NUM TI0FW-CU-STOR-ID-IN-NUM ; 
      15 TI0FW-CU-STOR-ID-IN-NBYT TI0FW-CU-STOR-ID-IN-NBYT [4] ; 
    10 TI0FW-CU-STOR-ID-WK-NUM TI0FW-CU-STOR-ID-WK-NUM ; 
      15 TI0FW-CU-STOR-ID-WK-BYTE TI0FW-CU-STOR-ID-WK-BYTE [4] ; 
    10 TI0FW-XNX-DEPT-ID-IN-CHA TI0FW-XNX-DEPT-ID-IN-CHA ; 
      15 TI0FW-XNX-DEPT-ID-IN-CBYT TI0FW-XNX-DEPT-ID-IN-CBYT [4] ; 
    10 TI0FW-XNX-DEPT-ID-IN-NUM TI0FW-XNX-DEPT-ID-IN-NUM ; 
      15 TI0FW-XNX-DEPT-ID-IN-NBYT TI0FW-XNX-DEPT-ID-IN-NBYT [4] ; 
    10 TI0FW-XNX-DEPT-ID-WK-NUM TI0FW-XNX-DEPT-ID-WK-NUM ; 
      15 TI0FW-XNX-DEPT-ID-WK-BYTE TI0FW-XNX-DEPT-ID-WK-BYTE [4] ; 
    10 TI0FW-TI0FW02-TA-COUNT TI0FW-TI0FW02-TA-COUNT ; 
    10 TI0FW-TI0FW03-TA-COUNT TI0FW-TI0FW03-TA-COUNT ; 
    10 TI0FW-TICKET-DATA-FL TI0FW-TICKET-DATA-FL ; 
    10 TI0FW-MAX-RECS-RETURNED-FL TI0FW-MAX-RECS-RETURNED-FL ; 
    10 TI0FW-UPDATE-AUTHORIZED-FL TI0FW-UPDATE-AUTHORIZED-FL ; 
    10 TI0FW-TI-CUTK-STAT-CD-SAVE-TBL TI0FW-TI-CUTK-STAT-CD-SAVE-TBL ; 
    10 TI0FW-TI-CUTK-STAT-CD-SAVE TI0FW-TI-CUTK-STAT-CD-SAVE [6] ; 
    10 TI0FW-TOT-ON-ORD-QTY TI0FW-TOT-ON-ORD-QTY ; 
    10 TI0FW-TI9900-CALL-GROUP TI0FW-TI9900-CALL-GROUP ; 
      15 TI0FW-TI9900-CALL-ACTION TI0FW-TI9900-CALL-ACTION ; 
      15 TI0FW-VTIMSG01-COUNT TI0FW-VTIMSG01-COUNT ; 
    10 TI0FW-TI9910-CALL-GROUP TI0FW-TI9910-CALL-GROUP ; 
      15 TI0FW-TI9910-CALL-ACTION TI0FW-TI9910-CALL-ACTION ; 
    10 TI0FW-TI9920-CALL-GROUP TI0FW-TI9920-CALL-GROUP ; 
      15 TI0FW-TI9920-CALL-ACTION TI0FW-TI9920-CALL-ACTION ; 
      15 TI0FW-VTRMSG01-COUNT TI0FW-VTRMSG01-COUNT ; 
    10 TI0FW-PREVIOUS-PF11 TI0FW-PREVIOUS-PF11 ; 
    10 TI0FW-PF11-IDX TI0FW-PF11-IDX ; 
    10 TI0FW-PF11-AREA TI0FW-PF11-AREA ; 
      15 TI0FW-PF11-OP-CUST-ORD-ID TI0FW-PF11-OP-CUST-ORD-ID [12] ; 
      15 TI0FW-PF11-OP-NIKE-ORD-ID TI0FW-PF11-OP-NIKE-ORD-ID [12] ; 
      15 TI0FW-PF11-TI-CUTK-RQT-NBR TI0FW-PF11-TI-CUTK-RQT-NBR [12] ; 
end // end TI0FW00

//*** RECORD=TI0FW01 ****
// ------------------------------------------------------------
// Map TI0FM001 display storage.
// ------------------------------------------------------------
// ***********************
Record TI0FW01 type basicRecord
  5 XXX-TEMP-STG-LNTH XXX-TEMP-STG-LNTH ; 
  5 TI0FW01-REC char(201) ; 
    10 XGP-GPC-CD XGP-GPC-CD ; 
    10 CU-CO-ID CU-CO-ID ; 
    10 TI0FW-CU-STOR-ID TI0FW-CU-STOR-ID ; 
    10 TI0FW-XNX-DEPT-ID-XREF TI0FW-XNX-DEPT-ID-XREF ; 
    10 TI0FW-OP-CUST-PO1 TI0FW-OP-CUST-PO1 ; 
    10 TI0FW-SY-STY-CD1 TI0FW-SY-STY-CD1 ; 
    10 TI0FW-SY-COLR-CD-ID1 TI0FW-SY-COLR-CD-ID1 ; 
    10 OP-CUST-ORD-ID OP-CUST-ORD-ID ; 
    10 OP-NIKE-ORD-ID OP-NIKE-ORD-ID ; 
    10 TI0FW-CUST-NEED-DT-FROM TI0FW-CUST-NEED-DT-FROM ; 
    10 TI0FW-CUST-NEED-DT-TO TI0FW-CUST-NEED-DT-TO ; 
    10 XHD-HNDL-CD XHD-HNDL-CD ; 
    10 TI0FW-TI-CUTK-SEND-CD1 TI0FW-TI-CUTK-SEND-CD1 ; 
    10 TI0FW-PO-ID-MO-RNG-YY TI0FW-PO-ID-MO-RNG-YY ; 
    10 TI0FW-PO-ID-MO-RNG-BLD-MM TI0FW-PO-ID-MO-RNG-BLD-MM ; 
    10 TI0FW-PO-ID-MO-RNG-SHP-MM TI0FW-PO-ID-MO-RNG-SHP-MM ; 
    10 FY-FCTY-CD FY-FCTY-CD ; 
    10 PC-PO-NBR PC-PO-NBR ; 
    10 XCT-CTRY-CD XCT-CTRY-CD ; 
    10 TI0FW-SY-STY-CD2 TI0FW-SY-STY-CD2 ; 
    10 TI0FW-SY-COLR-CD-ID2 TI0FW-SY-COLR-CD-ID2 ; 
    10 PC-PRDCU-ID PC-PRDCU-ID ; 
    10 TI0FW-OP-CUST-PO2 TI0FW-OP-CUST-PO2 ; 
    10 TI0FW-TI-CUTK-SEND-CD2 TI0FW-TI-CUTK-SEND-CD2 ; 
    10 TI-CUTK-STAT-CD TI-CUTK-STAT-CD [6] ; 
    10 TI0FW-INCLUDE-SENT-ORD-FL TI0FW-INCLUDE-SENT-ORD-FL ; 
    10 TI0FW-SEND-DATE-RNG-FROM TI0FW-SEND-DATE-RNG-FROM ; 
    10 TI0FW-SEND-DATE-RNG-TO TI0FW-SEND-DATE-RNG-TO ; 
    10 TI0FW-SENT-DATE-RNG-FROM TI0FW-SENT-DATE-RNG-FROM ; 
    10 TI0FW-SENT-DATE-RNG-TO TI0FW-SENT-DATE-RNG-TO ; 
    10 TI-CUTK-XMIT-CD TI-CUTK-XMIT-CD ; 
    10 TI-CUTK-SPLR-CD TI-CUTK-SPLR-CD ; 
    10 TI-CUTK-MSG-CD TI-CUTK-MSG-CD [5] ; 
    10 TI-CUTK-RQT-NBR smallint ; 
    10 CATOAP CATOAP ; 
    10 CAITEM CAITEM ; 
end // end TI0FW01

//*** RECORD=TI0FW02 ****
// ------------------------------------------------------------
// Map TI0FM002 display storage.
// ------------------------------------------------------------
// ***********************
Record TI0FW02 type basicRecord
  5 XXX-TEMP-STG-LNTH XXX-TEMP-STG-LNTH ; 
  5 TI0FW02-REC char(902) ; 
    10 XGP-GPC-CD XGP-GPC-CD ; 
    10 TI0FW-SELECT TI0FW-SELECT [12] ; 
    10 TI0FW-SALES-ORD-ID TI0FW-SALES-ORD-ID [12] ; 
    10 CU-CO-ID CU-CO-ID [12] ; 
    10 OP-CUST-PO OP-CUST-PO [12] ; 
    10 TI0FW-STYLE-COLR TI0FW-STYLE-COLR [12] ; 
    10 TI0FW-OP-CUST-NEED-DT TI0FW-OP-CUST-NEED-DT [12] ; 
    10 TI-CUTK-STAT-CD TI-CUTK-STAT-CD [12] ; 
    10 TI-CUTK-SEND-CD TI-CUTK-SEND-CD [12] ; 
    10 TI0FW-TOT-ON-ORD-QTY TI0FW-TOT-ON-ORD-QTY [12] ; 
    10 OP-CUST-ORD-ID OP-CUST-ORD-ID [12] ; 
    10 OP-NIKE-ORD-ID OP-NIKE-ORD-ID [12] ; 
    10 TI-CUTK-RQT-NBR TI-CUTK-RQT-NBR [12] ; 
end // end TI0FW02

//*** RECORD=TI0FW03 ****
// ------------------------------------------------------------
// Map TI0FM003 display storage.
// ------------------------------------------------------------
// ***********************
Record TI0FW03 type basicRecord
  5 XXX-TEMP-STG-LNTH XXX-TEMP-STG-LNTH ; 
  5 TI0FW03-REC char(662) ; 
    10 XGP-GPC-CD XGP-GPC-CD ; 
    10 TI0FW-SELECT TI0FW-SELECT [12] ; 
    10 PC-PO-NBR PC-PO-NBR [12] ; 
    10 TI0FW-PC-PO-ID TI0FW-PC-PO-ID [12] ; 
    10 FY-FCTY-CD FY-FCTY-CD [12] ; 
    10 PC-PRDCU-ID PC-PRDCU-ID [12] ; 
    10 TI0FW-STYLE-COLR TI0FW-STYLE-COLR [12] ; 
    10 TI-CUTK-STAT-CD TI-CUTK-STAT-CD [12] ; 
    10 TI-CUTK-SEND-CD TI-CUTK-SEND-CD [12] ; 
    10 TI0FW-SALES-ORD-ID TI0FW-SALES-ORD-ID [12] ; 
    10 OP-CUST-ORD-ID OP-CUST-ORD-ID [12] ; 
    10 OP-NIKE-ORD-ID OP-NIKE-ORD-ID [12] ; 
    10 TI-CUTK-RQT-NBR TI-CUTK-RQT-NBR [12] ; 
end // end TI0FW03

//*** RECORD=TI0FW04 ****
// ------------------------------------------------------------
// Map TI0FM004 display storage.
// ------------------------------------------------------------
// ***********************
Record TI0FW04 type basicRecord
  5 XXX-TEMP-STG-LNTH XXX-TEMP-STG-LNTH ; 
  5 TI0FW04-REC char(296) ; 
    10 TI0FW-TI-CUTK-MSG-CD-TXT TI0FW-TI-CUTK-MSG-CD-TXT ; 
    10 TI-CUTK-STAT-CD TI-CUTK-STAT-CD ; 
    10 TI-CUTK-STAT-DESC TI-CUTK-STAT-DESC ; 
    10 CU-BUY-SESN-ID CU-BUY-SESN-ID ; 
    10 TI-CUTK-SPLR-CD TI-CUTK-SPLR-CD ; 
    10 TI-CUTK-SPLR-NM char(30) ; 
    10 TI-CUTK-XMIT-CD TI-CUTK-XMIT-CD ; 
    10 TI-CUTK-XMIT-ABRV char(6) ; 
    10 TI0FW-CUTK-EST-SND-DT TI0FW-CUTK-EST-SND-DT ; 
    10 TI0FW-CUTK-SNT-DT TI0FW-CUTK-SNT-DT ; 
    10 TI-CUTK-SEND-CD TI-CUTK-SEND-CD ; 
    10 TI-CUTK-SEND-DESC TI-CUTK-SEND-DESC ; 
    10 TI0FW-CUTK-RQT-RVW-DT char(8) ; 
    10 TI0FW-CUSTOMER-ID TI0FW-CUSTOMER-ID ; 
    10 CU-CO-SHORT-NM CU-CO-SHORT-NM ; 
    10 TI0FW-PC-PO-ID TI0FW-PC-PO-ID ; 
    10 FY-FCTY-CD FY-FCTY-CD ; 
    10 TI0FW-SALES-ORD-ID TI0FW-SALES-ORD-ID ; 
    10 PC-PO-NBR PC-PO-NBR ; 
    10 XCT-CTRY-ABRV XCT-CTRY-ABRV ; 
    10 TI0FW-OP-CUST-NEED-DT TI0FW-OP-CUST-NEED-DT ; 
    10 XOS-ORD-STAT-CD XOS-ORD-STAT-CD ; 
    10 PC-PRDCU-ID PC-PRDCU-ID ; 
    10 TI0FW-STYLE-COLR TI0FW-STYLE-COLR ; 
    10 CU-CUST-PROD-ID CU-CUST-PROD-ID ; 
    10 SY-STY-NM SY-STY-NM ; 
    10 TI0FW-TOT-ON-ORD-QTY TI0FW-TOT-ON-ORD-QTY ; 
    10 OP-CUST-ORD-ID int ; // CUST ORD ID
    10 OP-NIKE-ORD-ID smallint ; // NIKE ORD ID
    10 TI-CUTK-RQT-NBR smallint ; 
    10 OP-LINE-ITEM-NBR smallint ; 
    10 TI0FW-PF11-CONFIRM-FL char(1) ; 
    10 TI0FW-TI-CUTK-RQT-MAX smallint ; 
    10 TI-CUTK-SNT-DT int ; 
end // end TI0FW04

//*** RECORD=TI0FW05 ****
// ------------------------
// Map TI0FM.TI0FM004 display storage.
// ------------------------
// ***********************
Record TI0FW05 type basicRecord
  5 XXX-TEMP-STG-LNTH XXX-TEMP-STG-LNTH ; 
  5 TI0FW05-REC char(819) ; 
    10 TI0FW-SALES-ORD-ID TI0FW-SALES-ORD-ID ; 
    10 TI0FW-STYLE-COLR TI0FW-STYLE-COLR ; 
    10 SY-STY-NM SY-STY-NM ; 
    10 TI0FW-PC-PO-ID TI0FW-PC-PO-ID ; 
    10 FY-FCTY-CD FY-FCTY-CD ; 
    10 PC-PO-NBR PC-PO-NBR ; 
    10 TI0FW-TOT-ON-ORD-QTY TI0FW-TOT-ON-ORD-QTY ; 
    10 SY-SZ-ID-DESC SY-SZ-ID-DESC [10] ; 
    10 TI-ON-ORD-QTY TI-ON-ORD-QTY [10] ; 
    10 CU-CUST-RTL-PRC CU-CUST-RTL-PRC [10] ; 
    10 CU-CUST-PROD-ID CU-CUST-PROD-ID [10] ; 
    10 CU-PROD-NM CU-PROD-NM [10] ; 
    10 TI0FW-TI-CUTK-MSG-CD-FL TI0FW-TI-CUTK-MSG-CD-FL [10] ; 
    10 OP-CUST-ORD-ID int ; // CUST ORD ID
    10 OP-NIKE-ORD-ID smallint ; // NIKE ORD ID
    10 TI-CUTK-RQT-NBR smallint ; 
    10 TI-CUTK-LINE-NBR smallint [10] ; 
end // end TI0FW05

//*** RECORD=TI0FW06 ****
// ------------------------
// Map TI0FM.TI0FM004 display storage.
// ------------------------
// ***********************
Record TI0FW06 type basicRecord
  5 XXX-TEMP-STG-LNTH XXX-TEMP-STG-LNTH ; 
  5 TI0FW06-REC char(366) ; 
    10 TI0FM-HYPHEN char(1) ; 
    10 XXX-MSG-LOC-ID char(8) ; // Message location identifier
    10 XXX-CURR-DT num(8) ; // Current date
    10 TI0FW-TI0FM005-CURR-PAGE-DESC char(4) ; 
    10 TI0FW-TI0FM005-CURR-PAGE-NBR char(4) ; 
    10 TI0FW-TI0FM005-HI-PAGE-DESC char(2) ; 
    10 TI0FW-TI0FM005-HI-PAGE-NBR char(4) ; 
    10 TI0FW-SALES-ORD-ID char(11) ; 
    10 TI0FW-STYLE-COLR char(10) ; 
    10 SY-STY-NM char(30) ; // SY_STY_NM
    10 TI0FW-PC-PO-ID char(8) ; 
    10 FY-FCTY-CD char(4) ; // FACTORY OF PC_PO_ID_MO_RNG
    10 PC-PO-NBR int ; // PC_PO_NBR
    10 TI0FW-TOT-ON-ORD-QTY int ; // Limit for map fields index
    10 SY-SZ-ID-DESC SY-SZ-ID-DESC ; 
    10 TI-ON-ORD-QTY TI-ON-ORD-QTY ; 
    10 CU-CUST-RTL-PRC CU-CUST-RTL-PRC ; 
    10 CU-CUST-PROD-ID CU-CUST-PROD-ID ; 
    10 CU-PROD-NM CU-PROD-NM ; 
    10 TI0FW-TI-CUTK-MSG-CD-FL TI0FW-TI-CUTK-MSG-CD-FL ; 
    10 TI-CUTK-MSG-CD TI-CUTK-MSG-CD [6] ; 
    10 TI-CUTK-MSG-DESC TI-CUTK-MSG-DESC [6] ; 
end // end TI0FW06

//*** RECORD=TI0FW07 ****
// ------------------------------------------------------------
// Map TI0FM004 display storage.
// ------------------------------------------------------------
// ***********************
Record TI0FW07 type basicRecord
  5 XXX-TEMP-STG-LNTH XXX-TEMP-STG-LNTH ; 
  5 TI0FW07-REC char(479) ; 
    10 XXX-CURR-DT XXX-CURR-DT ; 
    10 TI-CUTK-STAT-CD TI-CUTK-STAT-CD ; 
    10 TI-CUTK-STAT-DESC TI-CUTK-STAT-DESC ; 
    10 TI0FW-TI-CUTK-MSG-CD-TXT TI0FW-TI-CUTK-MSG-CD-TXT ; 
    10 TI-CUTK-SPLR-CD TI-CUTK-SPLR-CD ; 
    10 TI-CUTK-SPLR-NM char(30) ; 
    10 TI-CUTK-XMIT-CD TI-CUTK-XMIT-CD ; 
    10 TI-CUTK-XMIT-ABRV char(6) ; 
    10 TI0FW-CUTK-EST-SND-DT TI0FW-CUTK-EST-SND-DT ; 
    10 TI0FW-CUTK-SNT-DT TI0FW-CUTK-SNT-DT ; 
    10 TI-CUTK-SEND-CD TI-CUTK-SEND-CD ; 
    10 TI-CUTK-SEND-DESC TI-CUTK-SEND-DESC ; 
    10 CU-BUY-SESN-ID CU-BUY-SESN-ID ; 
    10 TI0FW-CUSTOMER-ID TI0FW-CUSTOMER-ID ; 
    10 CU-CO-SHORT-NM CU-CO-SHORT-NM ; 
    10 TI0FW-PC-PO-ID TI0FW-PC-PO-ID ; 
    10 FY-FCTY-CD FY-FCTY-CD ; 
    10 TI0FW-SALES-ORD-ID TI0FW-SALES-ORD-ID ; 
    10 PC-PO-NBR PC-PO-NBR ; 
    10 XCT-CTRY-ABRV XCT-CTRY-ABRV ; 
    10 TI0FW-OP-CUST-NEED-DT TI0FW-OP-CUST-NEED-DT ; 
    10 XOS-ORD-STAT-CD XOS-ORD-STAT-CD ; 
    10 PC-PRDCU-ID PC-PRDCU-ID ; 
    10 TI0FW-STYLE-COLR TI0FW-STYLE-COLR ; 
    10 CU-CUST-PROD-ID CU-CUST-PROD-ID ; 
    10 SY-STY-NM SY-STY-NM ; 
    10 TI0FW-TOT-ON-ORD-QTY TI0FW-TOT-ON-ORD-QTY ; 
    10 OP-CUST-ORD-ID int ; // CUST ORD ID
    10 OP-NIKE-ORD-ID smallint ; // NIKE ORD ID
    10 TI-CUTK-RQT-NBR smallint ; 
    10 TI-CUTK-MSG-CD char(2) [6] ; 
    10 TI-CUTK-MSG-DESC char(30) [6] ; 
end // end TI0FW07

//*** RECORD=TI0FWCA1 ****
// ------------------------------------------------------------
// TI0F application working storage.
// ------------------------------------------------------------
// ************************
Record TI0FWCA1 type basicRecord
  5 TI0FWCA1-REC char(2048) ; 
    10 TI0FWCA1-TI0FW00 TI0FWCA1-TI0FW00 ; 
    10 TI0FWCA1-TI0FW02 TI0FWCA1-TI0FW02 ; 
    10 XXX-MSG-LOC-ID XXX-MSG-LOC-ID ; 
    10 XXX-MSG-NBR XXX-MSG-NBR ; 
    10 TI-CUTK-XMIT-CD TI-CUTK-XMIT-CD ; 
    10 CATOAP CATOAP ; 
    10 CAITEM CAITEM ; 
    10 * char(136) ; 
end // end TI0FWCA1

//*** RECORD=TI0FWCA2 ****
// ------------------------------------------------------------
// TI0F application working storage.
// ------------------------------------------------------------
// ************************
Record TI0FWCA2 type basicRecord
  5 TI0FWCA2-REC char(2048) ; 
    10 TI0FWCA2-TI0FW01 TI0FWCA2-TI0FW01 ; 
    10 TI0FWCA2-TI0FW03 TI0FWCA2-TI0FW03 ; 
    10 TI0FWCA2-TI0FW04 TI0FWCA2-TI0FW04 ; 
    10 TI0FWCA2-TI0FW05 TI0FWCA2-TI0FW05 ; 
    10 * char(79) ; 
end // end TI0FWCA2

//*** RECORD=TIXREC ****
// ************ DEVELOPMENT MODEL SYSTEM COMMAREA *************
// 
// This record contains data fields that are passed between the
// Retailer Specified Ticketing system and other application.
// 
// -------  --------  ------  ---------------------------------
// CONTROL    DATE    USERID  DESCRIPTION OF CHANGE
// -------  --------  ------  ---------------------------------
// NEW      06/30/93  xxxxxx  New record.
// **********************
Record TIXREC type basicRecord
  5 * char(80) ; 
    10 TIX-GROUP TIX-GROUP ; 
    10 TIX-FILLER TIX-FILLER ; 
end // end TIXREC

Record VTHMSG01 type basicRecord
  5 * char(12) ; 
    10 OP-CUST-ORD-ID OP-CUST-ORD-ID ; 
    10 OP-NIKE-ORD-ID OP-NIKE-ORD-ID ; 
    10 TI-CUTK-MSG-CD TI-CUTK-MSG-CD ; 
    10 ZZ-SDT ZZ-SDT ; 
end // end VTHMSG01

Record VTIMSG01 type basicRecord
  5 * char(16) ; 
    10 OP-CUST-ORD-ID OP-CUST-ORD-ID ; 
    10 OP-NIKE-ORD-ID OP-NIKE-ORD-ID ; 
    10 TI-CUTK-RQT-NBR TI-CUTK-RQT-NBR ; 
    10 TI-CUTK-LINE-NBR TI-CUTK-LINE-NBR ; 
    10 TI-CUTK-MSG-CD TI-CUTK-MSG-CD ; 
    10 ZZ-SDT ZZ-SDT ; 
end // end VTIMSG01

//*** RECORD=VTOHDR01 ****
// Record layout for DCUKTK.VTOHDR01
// ************************
Record VTOHDR01 type basicRecord
  5 * char(83) ; 
    10 OP-CUST-ORD-ID OP-CUST-ORD-ID ; 
    10 OP-NIKE-ORD-ID OP-NIKE-ORD-ID ; 
    10 TI-CUTK-STAT-CD TI-CUTK-STAT-CD ; 
    10 TI-CUTK-STAT-DT TI-CUTK-STAT-DT ; 
    10 OP-ORD-PART-CHAR OP-ORD-PART-CHAR ; 
    10 CU-CO-ID CU-CO-ID ; 
    10 CU-STOR-ID CU-STOR-ID ; 
    10 XNX-DEPT-ID-XREF XNX-DEPT-ID-XREF ; 
    10 XGP-GPC-CD XGP-GPC-CD ; 
    10 XSO-SLS-OFC-ID XSO-SLS-OFC-ID ; 
    10 XOB-BASE-OT-CD XOB-BASE-OT-CD ; 
    10 XOT-ORD-TYP-CD XOT-ORD-TYP-CD ; 
    10 XDS-DIR-DHIP-CD XDS-DIR-DHIP-CD ; 
    10 XWH-WHSE-CD XWH-WHSE-CD ; 
    10 CU-DEPT-SELF-ID CU-DEPT-SELF-ID ; 
    10 OP-CUST-PO OP-CUST-PO ; 
    10 OP-CUST-NEED-DT OP-CUST-NEED-DT ; 
    10 ZZ-SDT ZZ-SDT ; 
    10 ZZ-CHNG-DT ZZ-CHNG-DT ; 
    10 ZZ-CHNG-HHMM ZZ-CHNG-HHMM ; 
    10 ZZ-CHNG-CNT ZZ-CHNG-CNT ; 
end // end VTOHDR01

//*** RECORD=VTOITM01 ****
// Record layout for table DCUTKT.VTOITM01
// ************************
Record VTOITM01 type basicRecord
  5 * char(310) ; 
    10 OP-CUST-ORD-ID OP-CUST-ORD-ID ; 
    10 OP-NIKE-ORD-ID OP-NIKE-ORD-ID ; 
    10 TI-CUTK-RQT-NBR TI-CUTK-RQT-NBR ; 
    10 TI-CUTK-LINE-NBR TI-CUTK-LINE-NBR ; 
    10 TI-CUTK-TYP-CD TI-CUTK-TYP-CD ; 
    10 OP-ORD-PART-CHAR OP-ORD-PART-CHAR ; 
    10 OP-LINE-ITEM-NBR OP-LINE-ITEM-NBR ; 
    10 OP-SZ-GRP-SEQ OP-SZ-GRP-SEQ ; 
    10 OP-CASE-LOT-NBR OP-CASE-LOT-NBR ; 
    10 XGP-GPC-CD XGP-GPC-CD ; 
    10 SY-STY-NBR SY-STY-NBR ; 
    10 SY-COLR-CD-ID SY-COLR-CD-ID ; 
    10 XDM-DIM-CD XDM-DIM-CD ; 
    10 SY-SZ-ID SY-SZ-ID ; 
    10 SY-UPC-SYS-NBR SY-UPC-SYS-NBR ; 
    10 SY-UPC-MFG-ID-NBR SY-UPC-MFG-ID-NBR ; 
    10 SY-UPC-ITM-NBR SY-UPC-ITM-NBR ; 
    10 SY-UPC-CK-DGIT SY-UPC-CK-DGIT ; 
    10 TI-ON-ORD-QTY TI-ON-ORD-QTY ; 
    10 TI-CNCL-QTY TI-CNCL-QTY ; 
    10 CU-CUST-PROD-ID CU-CUST-PROD-ID ; 
    10 CU-BUY-SESN-ID CU-BUY-SESN-ID ; 
    10 CU-PROD-XREF-EDT CU-PROD-XREF-EDT ; 
    10 CU-PROD-NM CU-PROD-NM ; 
    10 CU-PROD-SNM CU-PROD-SNM ; 
    10 CU-PROD-COLR-NM CU-PROD-COLR-NM ; 
    10 CU-PROD-SZ-ID CU-PROD-SZ-ID ; 
    10 CU-PROD-SZ-NM CU-PROD-SZ-NM ; 
    10 CU-CUST-RTL-PRC CU-CUST-RTL-PRC ; 
    10 CU-CUST-SPCL-PRC CU-CUST-SPCL-PRC ; 
    10 CU-SPCL-PRC-EDT CU-SPCL-PRC-EDT ; 
    10 CU-SUGG-RTL-PRC CU-SUGG-RTL-PRC ; 
    10 CU-VEND-CLS-ID CU-VEND-CLS-ID ; 
    10 CU-SKU-COMNT1 CU-SKU-COMNT1 ; 
    10 CU-SKU-COMNT2 CU-SKU-COMNT2 ; 
    10 CU-SKU-COMNT3 CU-SKU-COMNT3 ; 
    10 ZZ-SDT ZZ-SDT ; 
    10 ZZ-CHNG-HHMM ZZ-CHNG-HHMM ; 
    10 ZZ-CHNG-DT ZZ-CHNG-DT ; 
    10 ZZ-CHNG-CNT ZZ-CHNG-CNT ; 
end // end VTOITM01

//*** RECORD=VTORQT01 ****
// Record layout for DCUTKT.VTORQT01
// ************************
Record VTORQT01 type basicRecord
  5 * char(130) ; // OP_CUST_ORD_ID
    10 OP-CUST-ORD-ID OP-CUST-ORD-ID ; 
    10 OP-NIKE-ORD-ID OP-NIKE-ORD-ID ; 
    10 TI-CUTK-RQT-NBR TI-CUTK-RQT-NBR ; 
    10 TI-CUTK-STAT-CD TI-CUTK-STAT-CD ; 
    10 TI-CUTK-STAT-DT TI-CUTK-STAT-DT ; 
    10 TI-CUTK-TYP-CD TI-CUTK-TYP-CD ; 
    10 TI-CUTK-RQT-RVW-DT TI-CUTK-RQT-RVW-DT ; 
    10 OP-ORD-PART-CHAR OP-ORD-PART-CHAR ; 
    10 OP-LINE-ITEM-NBR OP-LINE-ITEM-NBR ; 
    10 OP-NBR-SZ OP-NBR-SZ ; 
    10 PK-LABL-CD PK-LABL-CD ; 
    10 XHD-HNDL-CD1 XHD-HNDL-CD1 ; 
    10 XHD-HNDL-CD2 XHD-HNDL-CD2 ; 
    10 XHD-HNDL-CD3 XHD-HNDL-CD3 ; 
    10 TI-CUTK-EST-SND-DT TI-CUTK-EST-SND-DT ; 
    10 TI-CUTK-SNT-DT TI-CUTK-SNT-DT ; 
    10 TI-CUTK-SEND-CD TI-CUTK-SEND-CD ; 
    10 TI-CUTK-SPLR-CD TI-CUTK-SPLR-CD ; 
    10 TI-CUTK-XMIT-CD TI-CUTK-XMIT-CD ; 
    10 XGP-GPC-CD XGP-GPC-CD ; 
    10 SY-STY-NBR SY-STY-NBR ; 
    10 SY-COLR-CD-ID SY-COLR-CD-ID ; 
    10 XDM-DIM-CD XDM-DIM-CD ; 
    10 XQA-QUAL-CD XQA-QUAL-CD ; 
    10 PC-PO-ID-MO-RNG PC-PO-ID-MO-RNG ; 
    10 PC-PO-NBR PC-PO-NBR ; 
    10 PC-ITM-SEQ-NBR PC-ITM-SEQ-NBR ; 
    10 FY-FCTY-CD FY-FCTY-CD ; 
    10 FY-FLD-OFC-CD FY-FLD-OFC-CD ; 
    10 XCT-CTRY-CD XCT-CTRY-CD ; 
    10 XCT-ISO-CTRY-CD XCT-ISO-CTRY-CD ; 
    10 TI-CUTK-CFM-LPT-DT TI-CUTK-CFM-LPT-DT ; 
    10 TI-CUTK-CFM-PT-CNT TI-CUTK-CFM-PT-CNT ; 
    10 TI-CUTK-CALL-FL TI-CUTK-CALL-FL ; 
    10 TI-CUTK-CALL-DT TI-CUTK-CALL-DT ; 
    10 PC-PRDCU-ID PC-PRDCU-ID ; 
    10 PC-PO-ID-SESN-CD PC-PO-ID-SESN-CD ; 
    10 OP-CU-PO-LINE-NBR OP-CU-PO-LINE-NBR ; 
    10 XGA-GNDR-AGE-ABRV XGA-GNDR-AGE-ABRV ; 
    10 TI-CUTK-RQT-CHG-DT TI-CUTK-RQT-CHG-DT ; 
    10 ZZ-SDT ZZ-SDT ; 
    10 ZZ-CHNG-DT ZZ-CHNG-DT ; 
    10 ZZ-CHNG-HHMM ZZ-CHNG-HHMM ; 
    10 ZZ-CHNG-CNT ZZ-CHNG-CNT ; 
end // end VTORQT01

Record VTRMSG01 type basicRecord
  5 * char(14) ; 
    10 OP-CUST-ORD-ID OP-CUST-ORD-ID ; 
    10 OP-NIKE-ORD-ID OP-NIKE-ORD-ID ; 
    10 TI-CUTK-RQT-NBR TI-CUTK-RQT-NBR ; 
    10 TI-CUTK-MSG-CD TI-CUTK-MSG-CD ; 
    10 ZZ-SDT ZZ-SDT ; 
end // end VTRMSG01

//*** RECORD=VXCL0001 ****
// Record layout for table row
// ************************
Record VXCL0001 type basicRecord
  5 * char(63) ; 
    10 XCL-COLR-CD XCL-COLR-CD ; 
    10 XCL-COLR-DESC XCL-COLR-DESC ; 
    10 XCL-COLR-ABRV1 XCL-COLR-ABRV1 ; 
    10 XCL-COLR-ABRV2 XCL-COLR-ABRV2 ; 
    10 XCL-SPN-COLR-DESC XCL-SPN-COLR-DESC ; 
    10 XXX-STAT XXX-STAT ; 
    10 ZZ-SDT ZZ-SDT ; 
    10 ZZ-CHNG-DT ZZ-CHNG-DT ; 
    10 ZZ-CHNG-HHMM ZZ-CHNG-HHMM ; 
    10 ZZ-CHNG-CNT ZZ-CHNG-CNT ; 
end // end VXCL0001

//*** RECORD=XHDREC ****
// WORKING  STORAGE IMAGE OF DCORP.VXHD0001
// **********************
Record XHDREC type basicRecord
  5 * char(75) ; 
    10 XHD-HNDL-CD XHD-HNDL-CD ; 
    10 XGP-GPC-CD XGP-GPC-CD ; 
    10 XHD-HNDL-DESC XHD-HNDL-DESC ; 
    10 XHD-HNDL-ABRV XHD-HNDL-ABRV ; 
    10 XHD-HNDL-CHG XHD-HNDL-CHG ; 
    10 XHD-UNIT-CHG-FL XHD-UNIT-CHG-FL ; 
    10 GL-GEN-LEDGER-CD GL-GEN-LEDGER-CD ; 
    10 XHD-SPCL-HNDL-MM XHD-SPCL-HNDL-MM ; 
    10 XHD-LVL-PRTY-FL XHD-LVL-PRTY-FL ; 
    10 XHD-HNDL-CST XHD-HNDL-CST ; 
    10 ZFC-CRCY-CD ZFC-CRCY-CD ; 
    10 XXX-STAT XXX-STAT ; 
    10 ZZ-SDT ZZ-SDT ; 
    10 ZZ-CHNG-DT ZZ-CHNG-DT ; 
    10 ZZ-CHNG-HHMM ZZ-CHNG-HHMM ; 
    10 ZZ-CHNG-CNT ZZ-CHNG-CNT ; 
end // end XHDREC

DataItem OP-NBR-SZ smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem SY-STY-CD char(6)  {
  align = none, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI-CNCL-QTY int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI-CUTK-CALL-DT int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI-CUTK-CALL-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI-CUTK-CFM-LPT-DT int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI-CUTK-CFM-PT-CNT smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI-CUTK-EST-SND-DT int {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI-CUTK-LINE-NBR smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI-CUTK-RQT-CHG-DT int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI-CUTK-RQT-NBR smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI-CUTK-RQT-RVW-DT int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI-CUTK-SNT-DT int {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI-CUTK-STAT-DT int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI-CUTK-TYP-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI-ON-ORD-QTY int {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-A-ROW-WAS-SELECTED-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CSR-ON-ERR-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CU-CO-ID-CHA char(7)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CU-CO-ID-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CU-CO-ID-LCHA char(9)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CU-CO-ID-NUM num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CU-CO-ID-SCHA char(7)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// CU_STOR_ID
DataItem TI0FW-CU-STOR-ID char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CU-STOR-ID-CHA char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CU-STOR-ID-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CU-STOR-ID-IN-CBYT char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CU-STOR-ID-IN-CHA char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CU-STOR-ID-IN-NBYT char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CU-STOR-ID-IN-NUM char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CU-STOR-ID-LCHA char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CU-STOR-ID-NUM num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CU-STOR-ID-SCHA char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CU-STOR-ID-WK-BYTE num(1)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CU-STOR-ID-WK-NUM num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-FR-CHA char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-FR-DD num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-FR-MM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-FR-NUM num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-FR-YY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-HI num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-HI-CC num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-HI-CHA char(9)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-HI-DD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-HI-MM char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-HI-YY char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-HI-ZERO num(1)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-LOW num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-LOW-CC num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-LOW-CHA char(9)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-LOW-DD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-LOW-MM char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-LOW-YY char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-LOW-ZERO num(1)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-OK-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-TO-CHA char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-TO-DD num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-TO-MM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-TO-NUM num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-ACT-SNT-DT-TO-YY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-FR-CHA char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-FR-DD num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-FR-MM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-FR-NUM num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-FR-YY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-HI num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-HI-CC num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-HI-CHA char(9)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-HI-DD num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-HI-MM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-HI-YY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-HI-ZERO num(1)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-LOW num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-LOW-CC num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-LOW-CHA char(9)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-LOW-DD num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-LOW-MM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-LOW-YY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-LOW-ZERO num(1)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-OK-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-TO-CHA char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-TO-DD num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-TO-MM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-TO-NUM num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-EST-SNT-DT-TO-YY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-FR-CHA char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-FR-DD num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-FR-MM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-FR-NUM num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-FR-YY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// OP_CUST_NEED_DT
DataItem TI0FW-CUST-NEED-DT-FROM num(6)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-FROM-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-HI num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-HI-CHA char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-HI-DD num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-HI-MM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-HI-YY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-LOW num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-LOW-CHA char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-LOW-DD num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-LOW-MM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-LOW-YY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-OK-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// OP_CUST_NEED_DT
DataItem TI0FW-CUST-NEED-DT-TO num(6)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-TO-CHA char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-TO-DD num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-TO-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-TO-MM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-TO-NUM num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUST-NEED-DT-TO-YY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-CUSTOMER-ID char(15)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUTK-EST-SND-DT char(8)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-CUTK-SNT-DT char(8)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-DATA-CHANGED-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-DATE-DISP-DD num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-DATE-DISP-MM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-DATE-DISP-SLASH1 char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-DATE-DISP-SLASH2 char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-DATE-DISP-YY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-DATE-DISPLAY char(8)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-DATE-NUM num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-DATE-WORK char(9)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-DATE-WRK6 char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-DATE-WRK6-DD num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-DATE-WRK6-MM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-DATE-WRK6-YY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-FCTY-S-FY-FCTY-CD char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-FCTY-S-KEY char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-FCTY-S-XGP-GPC-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HDR-FND-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HDR-KEY char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HDR-S-KEY char(13)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HDR-S-OP-CUST-ORD-ID num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-HDR-S-OP-NIKE-ORD-ID num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-HDR-S1-CU-CO-ID num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-HDR-S1-CU-STOR-ID num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-HDR-S1-KEY char(21)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HDR-S1-TI-CUTK-STAT-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HDR-S1-XGP-GPC-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HDR-S1-XNX-DEPT-ID-XREF num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-HDR-S2-CU-CO-ID num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-HDR-S2-KEY char(11)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HDR-S2-XGP-GPC-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HDR-S3-CU-CO-ID num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-HDR-S3-KEY char(38)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HDR-S3-OP-CUST-PO char(25)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HDR-S3-TI-CUTK-STAT-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HDR-S3-XGP-GPC-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HDR-S4-CU-CO-ID num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-HDR-S4-CU-STOR-ID num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-HDR-S4-KEY char(21)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HDR-S4-TI-CUTK-STAT-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HDR-S4-XGP-GPC-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HDR-S4-XNX-DEPT-ID-XREF num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-HDR-S5-CU-CO-ID num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-HDR-S5-CU-STOR-ID num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-HDR-S5-KEY char(46)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HDR-S5-OP-CUST-PO char(25)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HDR-S5-TI-CUTK-STAT-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HDR-S5-XGP-GPC-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HDR-S5-XNX-DEPT-ID-XREF num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-HDR-S6-KEY num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-HDR-S6-OP-CUST-ORD-ID num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-HMSG-S1-KEY char(13)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-HMSG-S1-OP-CUST-ORD-ID num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-HMSG-S1-OP-NIKE-ORD-ID num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-IMSG-S1-KEY char(21)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-IMSG-S1-OP-CUST-ORD-ID num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-IMSG-S1-OP-NIKE-ORD-ID num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-IMSG-S1-TI-CUTK-LINE-NBR num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-IMSG-S1-TI-CUTK-RQT-NBR num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-INCLUDE-SENT-ORD-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-ITM-A-KEY char(22)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-ITM-A-OP-CUST-ORD-ID num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-ITM-A-OP-NIKE-ORD-ID num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-ITM-A-TI-CUTK-RQT-NBR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-ITM-KEY char(10)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-ITM-S1-KEY char(22)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-ITM-S1-OP-CUST-ORD-ID num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-ITM-S1-OP-NIKE-ORD-ID num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-ITM-S1-TI-CUTK-RQT-NBR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-KUCCOID-NUM num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-M002-CHG-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-M002-CURR-PAGE-NBR num(4)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-M002-HI-PAGE-NBR num(4)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-M003-CHG-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-M003-CURR-PAGE-NBR num(4)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-M003-HI-PAGE-NBR num(4)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-M004-CHG-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-M005-CURR-PAGE-NBR num(4)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-M005-HI-PAGE-NBR num(4)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-M006-CURR-PAGE-NBR num(4)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-M006-HI-PAGE-NBR num(4)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-M007-CURR-PAGE-NBR num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-M007-HI-PAGE-NBR char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-MAX-RECS-RETURNED-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Cust Need Dt: op_cust_need_dt
DataItem TI0FW-OP-CUST-NEED-DT char(8)  {
  align = left, fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-OP-CUST-ORD-ID-CHA char(8)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-OP-CUST-ORD-ID-LCHA char(9)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-OP-CUST-ORD-ID-NUM num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-OP-CUST-ORD-ID-SCHA char(8)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-OP-CUST-PO-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-OP-CUST-PO-OK-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// OP_CUST_PO
DataItem TI0FW-OP-CUST-PO1 char(22)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-OP-CUST-PO2 char(22)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-OP-NIKE-ORD-ID-CHA char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-OP-NIKE-ORD-ID-LCHA char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-OP-NIKE-ORD-ID-NUM num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-OP-NIKE-ORD-ID-SCHA char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-OP-ORD-PART-CHA char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-PC-PO-ID char(8)  {
  align = none, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-PC-PO-ID-MO-RNG num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-PC-PO-ID-MO-RNG-NUM num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-PCD-S-KEY char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-PCD-S-TI-CUTK-SPLR-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-PF11-AREA char(96)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-PF11-IDX num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-PF11-OP-CUST-ORD-ID int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-PF11-OP-NIKE-ORD-ID smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-PF11-TI-CUTK-RQT-NBR smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-PO-ID-BLD-MM char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-PO-ID-BLD-MM-CHA char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-PO-ID-BLD-MM-NUM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-PO-ID-CC-CHA char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-PO-ID-CC-NUM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-PO-ID-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// BUILD MONTH OF PC-PO-ID-MO-RNG
DataItem TI0FW-PO-ID-MO-RNG-BLD-MM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// BUILD MONTH OF PC-PO-ID-MO-RNG
DataItem TI0FW-PO-ID-MO-RNG-SHP-MM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// YEAR OF PC-PO-ID-MO-RNG
DataItem TI0FW-PO-ID-MO-RNG-YY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-PO-ID-SHP-MM char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-PO-ID-SHP-MM-CHA char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-PO-ID-SHP-MM-NUM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-PO-ID-YY char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-PO-ID-YY-CHA char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-PO-ID-YY-NUM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-PREVIOUS-PF11 char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-PREVIOUS-SCREEN-IND num(1)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-PRODC-DATA-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RMSG-S1-KEY char(17)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RMSG-S1-OP-CUST-ORD-ID num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-RMSG-S1-OP-NIKE-ORD-ID num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-RMSG-S1-TI-CUTK-RQT-NBR num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-RQT-FIRST-REC-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-KEY char(8)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-S-KEY char(17)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-S-OP-CUST-ORD-ID num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-RQT-S-OP-NIKE-ORD-ID num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-RQT-S-TI-CUTK-RQT-NBR num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-RQT-S1-KEY char(13)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-S1-OP-CUST-ORD-ID num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-RQT-S1-OP-NIKE-ORD-ID num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-RQT-S2-KEY char(22)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-S2-OP-CUST-ORD-ID num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-RQT-S2-OP-NIKE-ORD-ID num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-RQT-S2-SY-COLR-CD-ID char(3)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-S2-SY-STY-NBR char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-S5-KEY char(17)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-S5-OP-CUST-ORD-ID num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-RQT-S5-OP-NIKE-ORD-ID num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-RQT-S5-OP-ORD-PART-CHAR char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-S5-TI-CUTK-RQT-NBR num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-RQT-S6-KEY char(15)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-S6-PC-ITM-SEQ-NBR num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-RQT-S6-PC-PO-NBR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-RQT-S6-XGP-GPC-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-S7-KEY char(11)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-S7-PC-PO-NBR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-RQT-S7-XGP-GPC-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-S8-FY-FCTY-CD char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-S8-KEY char(15)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-S8-PC-PO-ID-MO-RNG num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-RQT-S8-XGP-GPC-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-S9-KEY char(15)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-S9-PC-PO-ID-MO-RNG num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-RQT-S9-XCT-CTRY-CD char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-S9-XGP-GPC-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-SA-KEY char(7)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-SA-PC-PRDCU-ID char(5)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-SA-XGP-GPC-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-SF-KEY char(11)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-SF-SY-COLR-CD-ID char(3)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-SF-SY-STY-NBR char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-SF-XGP-GPC-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-SH-KEY char(3)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-SH-TI-CUTK-SEND-CD char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-SH-XGP-GPC-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-SU-KEY char(17)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-RQT-SU-OP-CUST-ORD-ID num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-RQT-SU-OP-LINE-ITEM-NBR num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-RQT-SU-OP-NIKE-ORD-ID num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-SALES-DATA-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-SALES-ORD-ID char(11)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-SALES-ORD-PERIOD char(1)  {
  align = none, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-SALES-ORDER-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// selection feild array
DataItem TI0FW-SELECT char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-SELECT-SET-DEFINED-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-SELECTED-ROW-FOUND-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-SEND-CD-SET-DEFINED-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-SEND-DATE-RNG-FROM num(6)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-SEND-DATE-RNG-FROM-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-SEND-DATE-RNG-TO num(6)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-SEND-DATE-RNG-TO-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-SENT-DATE-RNG-FROM num(6)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-SENT-DATE-RNG-FROM-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-SENT-DATE-RNG-TO num(6)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-SENT-DATE-RNG-TO-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-SPXM-S-KEY char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-SPXM-S-TI-CUTK-SPLR-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-SPXM-S-TI-CUTK-XMIT-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-STY-COLR-HYPHEN char(1)  {
  align = none, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-STYLE-COLR char(10)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-STYLE-COLR-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-STYLE-COLR-OK-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-SY-COLR-CD-ID char(3)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// SY_COLR_CD_ID
DataItem TI0FW-SY-COLR-CD-ID1 char(3)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// sy-colr-cd-id
DataItem TI0FW-SY-COLR-CD-ID2 char(3)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-SY-STY-CD char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// SY_STY_NBR
DataItem TI0FW-SY-STY-CD1 char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-SY-STY-CD2 char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-THMSG-EOF-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-MSG-CD char(3)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-MSG-CD-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-MSG-CD-IDX num(1)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-MSG-CD-OK-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-MSG-CD-TXT char(3)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-MSG-EXISTS-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-SEND-CD-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-SEND-CD-OK-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-SEND-CD1 char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-SEND-CD2 char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-SPLR-CD-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-SPLR-CD-OK-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-STAT-CD-ED-IDX num(1)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-STAT-CD-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-STAT-CD-IDX num(1)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-STAT-CD-OK-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-STAT-CD-SAVE char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-STAT-CD-SAVE-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-STAT-CD-SAVE-IDX num(1)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-STAT-CD-SAVE-TBL char(12)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-XMIT-CD-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI-CUTK-XMIT-CD-OK-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI0FW02-PAGE-TO-READ num(3)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-TI0FW02-TA-COUNT num(3)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-TI0FW03-PAGE-TO-READ num(3)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-TI0FW03-TA-COUNT num(3)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-TI9900-CALL-ACTION char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI9900-CALL-GROUP char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI9910-CALL-ACTION char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI9910-CALL-GROUP char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI9920-CALL-ACTION char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TI9920-CALL-GROUP char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TICKET-DATA-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TIMSG-EOF-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TOHDR-EOF-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TOITM-EOF-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TORQT-EOF-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Limit for map fields index
DataItem TI0FW-TOT-ON-ORD-QTY int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-TRMSG-EOF-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-UNPROTECT-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-UPDATE-AUTHORIZED-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-VTIMSG01-COUNT int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-VTIMSG01-NBR int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-VTOITM01-NBR int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-VTOITM01-SZ-ID smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-VTORQT01-CHG-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-VTRMSG01-COUNT int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-VTRMSG01-NBR int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-WDATE-HHMM-NUM num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-WDATE-SEC-NUM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-WDATE-TIME-NUM num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-WORK-IDX num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-XCD-S-KEY char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-XCD-S-TI-CUTK-XMIT-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-XHD-HNDL-CD-OK-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-XNX-DEPT-ID-IN-CBYT char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-XNX-DEPT-ID-IN-CHA char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-XNX-DEPT-ID-IN-NBYT char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-XNX-DEPT-ID-IN-NUM char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-XNX-DEPT-ID-WK-BYTE num(1)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-XNX-DEPT-ID-WK-NUM num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// XNX_DEPT_ID_XREF
DataItem TI0FW-XNX-DEPT-ID-XREF char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-XNX-DEPT-ID-XREF-CHA char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-XNX-DEPT-ID-XREF-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-XNX-DEPT-ID-XREF-LCHA char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FW-XNX-DEPT-ID-XREF-NUM num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem TI0FW-XNX-DEPT-ID-XREF-SCHA char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FWCA1-TI0FW00 char(974)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FWCA1-TI0FW02 char(902)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FWCA2-TI0FW01 char(201)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FWCA2-TI0FW03 char(662)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FWCA2-TI0FW04 char(287)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TI0FWCA2-TI0FW05 char(819)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem TIX-FILLER char(74)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// orig user workarea(1700 chars)
DataItem TIX-GROUP char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem XCL-SPN-COLR-DESC char(20)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem XDS-DIR-DHIP-CD char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem XGA-GNDR-AGE-ABRV char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem XHD-HNDL-ABRV char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem XHD-HNDL-CHG decimal(9,3)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem XHD-HNDL-DESC char(30)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem XHD-LVL-PRTY-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem XHD-SPCL-HNDL-MM decimal(5,3)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem XHD-UNIT-CHG-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

