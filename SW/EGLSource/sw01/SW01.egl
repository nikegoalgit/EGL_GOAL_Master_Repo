package sw01;
import corpcom1.*;
import corpcom2.*;
import corpcom3.*;
import corpcom4.*;
import corpcom5.*;
import corpcom6.*;
import corpcom7.*;
import corpx1.*;
import corpx2.*;
import corpy2.*;
import corpz3.*;
import fk.common.*;
import fy.common.*;
import in1.common.*;
import ku.common.*;
import op.common.*;
import pc.common.*;
import pg.common.*;
import pk.common.*;
import sl.common.*;
import sw.common.*;
import sy.common.*;
import ta.common.*;
import ts.common.*;
//*** PROGRAM=SW01 ****
// This application allows a user to inquire upon the plan
// reconcilation data.  The user may select data by warehouse
// and container and / or product.  If the user selects only
// selects the warehouse and container all products will be
// displayed the pf6 key, if pressed, will build/submit jcl
// to print the 'plan reconcilation summary report'.
// 
// The user may exit to any allowed application, via fast path
// or from this screen.  Pf7 pf8 allow the user to page forward
// and backwards.
// 
// -------  --------  ------  ---------------------------------
// CONTROL    DATE     NAME   DESCRIPTION OF CHANGE
// -------  --------  ------  ---------------------------------
//          03/17/91  jmoore  new program
//          04/26/91  jmoore  changed sw0u132 from sl8wopfl to
//                    slmwcpfl ne 'y'.
// SL#0     10/10/91  SPOPA   Change "Allow Implicits" to NO.
// tbl chg  03/04/94  Ryonke  Code changes for table changes.
// y2kproj  02-03-98  oricha  y2k modifications:  recompile to
//                            pick up new version of xx0xs01.
// *********************
Program SW01 type textUIProgram //VAGen Info - main text program
  {
  includeReferencedFunctions = yes, allowUnqualifiedItemReferences = yes, 
  throwNrfEofExceptions = yes, handleHardIOErrors = no, V60ExceptionCompatibility = yes, 
  I4GLItemsNullable = no, textLiteralDefaultIsString = no, localSQLScope = yes, 
  msgTablePrefix = "SL00", inputRecord = COMMAREA, segmented = yes
  }

  // Data Declarations
  COMMAREA COMMAREA ; // record
  ERRSQLCA ERRSQLCA; // record
  PC2REC PC2REC; // record
  PC3REC PC3REC; // record
  PCYREC PCYREC; // record
  SL1REC SL1REC; // record
  SL2REC SL2REC; // record
  SLKREC SLKREC; // record
  SLLREC SLLREC; // record
  SLOREC SLOREC; // record
  SLSREC SLSREC; // record
  SLWREC SLWREC; // record
  SQLCA SQLCA; // record
  SW01W00 SW01W00; // record
  SW01W01 SW01W01; // record
  SW01W02 SW01W02; // record
  SW01W03 SW01W03; // record
  SW01W04 SW01W04; // record
  SWVREC SWVREC; // record
  SYCREC SYCREC; // record
  SYPREC SYPREC; // record
  TA1REC TA1REC; // record
  TA2REC TA2REC; // record
  TA3REC TA3REC; // record
  TA5REC TA5REC; // record
  TA6REC TA6REC; // record
  TAEREC TAEREC; // record
  XOWREC XOWREC; // record
  XX0XW01 XX0XW01; // record
  XX0XW02 XX0XW02; // record

  // VAGen Info - items needed for migration
  VAGen_EZESYS char(8);
  VAGen_EZEREPLY num(1);
  VAGen_EZE_WAIT_TIME bin(9,2);
  VAGen_EZE_ITEMLEN int;

  // Use Declarations
  use SW01T01; // table
  use XDMTBL; // table
  use XEGTBL; // table
  use XGPTBL; // table
  use XOWTBL; // table
  use XPGTBL; // table
  use XQATBL; // table
  use XRETBL; // table
  use YRSTBL; // table
  use XSLTBL; // table
  use XUMTBL; // table
  use XWHTBL; // table
  use SW01M.SW01M001,  // forms
      SW01M.TA0PM001, 
      SW01M.XX0XM001
   {
    pfKeyEquate = no
  };

  function main()
    // VAGen Info - initialization needed for migration
    VAGen_EZESYS = VGLib.getVAGSysType();
    XPSL001: XPSL001();
     /* ------------------------------------------------------------*/
     /* Initialize working storage and display storage areas.*/
     /* ------------------------------------------------------------*/

    set SW01M001 initial; /* M001 input/output*/
    set TA0PM001 initial;
    set XX0XM001 initial; /* pop-up window put*/
    set SW01W00 empty; /* Working storage*/
    set SW01W01 empty; /* M001 header storage*/
    set SW01W02 empty; /* size array*/
    set SW01W03 empty; /* temp storage*/
    set SW01W04 empty; /* JCL work area*/
    set PCYREC empty;
    set PC2REC empty;
    set PC3REC empty;
    set SLKREC empty;
    set SLLREC empty;
    set SLOREC empty;
    set SLSREC empty;
    set SL1REC empty;
    set SL2REC empty;
    set SQLCA empty; /* SQL communication area*/
    set SWVREC empty;
    set SYCREC empty;
    set SYPREC empty;
    set TAEREC empty; /* Error diagnosis information*/
    set TA1REC empty; /* Error diagnosis parameters*/
    set TA2REC empty; /* date routine work area*/
    set TA3REC empty; /* date routine work area*/
    set TA5REC empty; /* temporary storage area*/
    set TA5REC empty; /* temporary storage area*/
    set TA6REC empty;
    set XOWREC empty;
    set XX0XW01 empty; /* Date/time subroutine parameters*/
    set XX0XW02 empty;
    set ERRSQLCA empty;


     /* ------------------------------------------------------------*/
     /* determine default data to be loaded*/
     /* ------------------------------------------------------------*/

    SW01W00.SW01WSWR = "N"; /* Request for data switch*/
    SW01W00.SW01WSWF = "Y"; /* format screen data switch*/

    SW01W00.XXXTSLEN = 316; /* temp storage length*/

    SLWREC.XXXAPPID = COMMAREA.CACURRAP;

    SW01W01.XWHCD = SLWREC.XWHCD; /* warehouse*/
    if (SLWREC.XWHCD == " ")
      SW01W01.XWHCD = COMMAREA.XWHCD;
    end
    if (SW01W01.XWHCD in XWHTBL.XWHCD)
      SW01W01.XWHABRV = XWHTBL.XWHABRV[sysVar.arrayIndex];
    end
    SW01W01.TSHCNTNR = SLWREC.TSHCNTNR; /* container*/

    if (SW01W01.XWHCD > " "
     && SW01W01.TSHCNTNR > " ")
      SW01W00.SW01WSWR = "Y"; /* Request for data switch*/
    end

    SW01W01.XGPCD = "03"; /* group code*/
    SW01W01.XDMCD = "00"; /* dimension code*/
    SW01W01.XQACD = "01"; /* quality code*/
    SW01W01.PC2INSEG = "000"; /* iseg*/
    SW01W01.XEGCD = "000"; /* engineering difference code*/
    SW01W01.XPGCD = "00"; /* package*/
    SW01W01.XUMCD = "00"; /* uom code*/
    SW01W01.XOWCD = "00"; /* own group code*/
    SW01W01.XSLCD = "000"; /* class code*/

     /* ------------------------------------------------------------*/
     /* Flow to mainline processing*/
     /* ------------------------------------------------------------*/

    goto SW01001;

    SW01001: SW01001();
    goto SW01001;
  end // end main
end // end SW01

// Inquire/maintainance m001
Function SW01001()
   /* ------------------------------------------------------------*/
   /* This is the main process used to display a map.  Processing*/
   /* always returns to the top of this process and falls through*/
   /* subordinate processes until an error is found or a valid*/
   /* request is processed.  Processing sequence is as follows:*/

   /* 1) Obtain the data to display.*/
   /* 2) Format the map output area and display the map.*/
   /* 3) Check the attention identifier used to respond.*/
   /* 4) Reset highlighted fields to normal intensity.*/
   /* 5) Verify the data that was entered.*/
   /* 6) Process a valid input request.*/

   /* In all subordinate processes, "EZEFLO" is used to exit to*/
   /* redisplay the map when an error is found.  This is done to*/
   /* minimize the coding effort required to skip subsequent*/
   /* processing under error conditions.*/
   /* ------------------------------------------------------------*/

  SW01100(); /* Obtain the data to display*/

  SW01200(); /* Format and display the map*/

  SW01300(); /* Check attention identifier*/

  SW01400(); /* Reset fields to normal intensity*/

  SW01500(); /* Verify the entered data*/

  SW01600(); /* Process valid input request*/

end // end SW01001

// OBTAIN THE DATA TO DISPLAY
Function SW01100()

   /* ------------------------------------------------------------*/
   /* If data was not requested or an error was found, return to*/
   /* the previous process.*/
   /* ------------------------------------------------------------*/

  if (SW01W00.SW01WSWR != "Y" /* Data was not requested*/
   || converseVar.validationMsgNum != 0) /* or an error was found*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* purge temporary storage*/
   /* ------------------------------------------------------------*/

  set SW01W02 empty; /* initialize w02*/

  SW01S01(); /* purge temp storage*/

   /* ------------------------------------------------------------*/
   /* if key data has been entered and is valid obtain*/
   /* the receipt log header information from display.*/
   /* ------------------------------------------------------------*/

  set SL1REC empty;

  SL1REC.XWHCD = SW01W01.XWHCD; /* warehouse*/
  SL1REC.TS3CNTNR = SW01W01.TSHCNTNR; /* container*/

  SW01S02(); /* Select 's ' dstloc.vrlhdr01 row*/

  if (SQLCA.VAGen_SQLCODE == 0)
    if (SL1REC.YRSCD == "02" /* Receiving status*/
     || SL1REC.YRSCD == "03" 
     || SL1REC.YRSCD == "04")

      SW01110(); /* load receipt log header data*/

    else

      set SW01M001.XWHCD cursor;
      converseLib.validationFailed(317); /* receiving status invalid*/
      SLWREC.XXXLOCID = "100";

      return;

    end
  else

    if (SQLCA.VAGen_SQLCODE == 100)
      converseLib.validationFailed(350); /* no products to display*/
      SLWREC.XXXLOCID = "100";

      return;

    end
  end

   /* ------------------------------------------------------------*/
   /* obtain the w/o group number for display*/
   /* ------------------------------------------------------------*/

  set SLLREC empty;

  SLLREC.XWHCD = SL1REC.XWHCD; /* warehouse*/
  SLLREC.SWEPLLNB = SL1REC.SWEPLLNB; /* plan*/
  SLLREC.TSHCNTNR = SL1REC.TS3CNTNR; /* container*/

  SW01S07(); /* Select 's5' dstloc.vwophd01 rows*/

  SW01S08(); /* fetch  'n5' dstloc.vwophd01 row*/

  if (SQLCA.VAGen_SQLCODE == 100) /* not found*/
    SLWREC.XXXLOCID = "100";
    converseLib.validationFailed(384); /* w/o grp not defined*/
  else
    SW01W01.SL8WOGRP = SLLREC.SL8WOGRP; /* work order group*/
  end

  SW01S09(); /* close  'c5' dstloc.vwophd01 row*/

   /* ------------------------------------------------------------*/
   /* obtain receipt log compare data for display.  the user*/
   /* has the option of selecting all products for a specific*/
   /* whse/container, or request a specific product.*/
   /* ------------------------------------------------------------*/

  set SLKREC empty;

  if (SW01W00.SW01WPRF == "Y") /* user requested a specific product*/

     /* build slkkey*/

    SLKREC.XWHCD = SW01W01.XWHCD; /* warehouse*/
    SLKREC.TSHCNTNR = SW01W01.TSHCNTNR; /* container*/
    SLKREC.PC3PONBR = SW01W01.PC3PONBR; /* po nbr*/
    SLKREC.XGPCD = SW01W01.XGPCD;
    SLKREC.SY1STNBR = SW01W01.SY1STNBR;
    SLKREC.SY2CLRID = SW01W01.SY2CLRID;
    SLKREC.XDMCD = SW01W01.XDMCD;
    SLKREC.XQACD = SW01W01.XQACD;
    SLKREC.XOWCD = SW01W01.XOWCD;
    SLKREC.PC2INSEG = SW01W01.PC2INSEG;
    SLKREC.XPGCD = SW01W01.XPGCD;
    SLKREC.XUMCD = SW01W01.XUMCD;
    SLKREC.XSLCD = SW01W01.XSLCD;

    SW01S10(); /* select 's ' dstloc.vrlcmp01*/

    if (SQLCA.VAGen_SQLCODE == 100) /* not found*/
      SLWREC.XXXLOCID = "100";
      converseLib.validationFailed(44); /* no data found for product*/
    else

      SW01120(); /* format po id and determine l/c*/

      SW01130(); /* load vrlcmp01 data into w/s*/

    end

  else

    SW01W00.SW01WEOF = "N"; /* product flag*/
    SLKREC.XWHCD = SL1REC.XWHCD; /* warehouse*/
    SLKREC.TSHCNTNR = SL1REC.TS3CNTNR; /* container*/

    SW01S11(); /* select 's1' dstloc.vrlcmp01*/

    SW01S12(); /* select 'n1' dstloc.vrlcmp01*/

    if (SW01W00.SW01WEOF == "Y")
      converseLib.validationFailed(350); /* no products to display*/
      SLWREC.XXXLOCID = "100";
    else

      while (SW01W00.SW01WEOF == "N") /* more products*/

        SW01120(); /* format po id and determine l/c*/

        SW01130(); /* process dstloc.vrlcmp01 dta*/

        SW01S12(); /* select 'n1' dstloc.vrlcmp01*/

      end

      SW01S13(); /* select 'c1' dstloc.vrlcmp01*/

    end
  end

  if (SW01W00.TA5TSQIX <= 0) /* if no p/l and/or recvd qty found*/
    SLWREC.XXXLOCID = "100";
    converseLib.validationFailed(44); /* no data found for product*/
  end

  if (converseVar.validationMsgNum != 0)
    return;
  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  SW01W00.SW01WSWR = "N"; /* Request for data switch*/
  SW01W00.SW01WPRF = "N"; /* Request product*/
  SW01W01.CACHGFL = "Y"; /* data is available for change*/
  SW01W00.XXXTSPAG = 1; /* first page*/

end // end SW01100

// LOAD DSTLOC.VRLHDR01 INTO W/S
Function SW01110()
   /* ------------------------------------------------------*/
   /* load receipt data into w/s*/
   /* ------------------------------------------------------*/

  SW01W01.SWEPLLNB = SL1REC.SWEPLLNB; /* plan*/
  SW01W01.YRSCD = SL1REC.YRSCD; /* rcv status*/
  if (SW01W01.YRSCD in YRSTBL.YRSCD)
    SW01W01.YRSABRV = YRSTBL.YRSABRV[sysVar.arrayIndex];
  end /* rcv abrv*/
  SW01W01.XITCD = SL1REC.XITCD;
  SW01W01.SL1RCRNO = SL1REC.SL1RCRNO;
  SW01W01.XARCD = SL1REC.XARCD; /* area*/
  SW01W01.SL4ZONE = SL1REC.SL4ZONE; /* zone*/
  SW01W01.XURUSRNM = " ";

  if (SL1REC.SL1UPDBY != " ")

    SW01111(); /* get user name -- call ta0230*/

    if (TA3REC.XURUSRNM == " ")
      SW01W01.XURUSRID = SL1REC.SL1UPDBY;
      SW01W01.SW01WDSH = " - ";
      SW01W01.SW01WLTR = "UNKNOWN";
    else
      SW01W01.XURUSRNM = TA3REC.XURUSRNM;
    end
  end

  SW01W01.IN7STNBR = SL1REC.IN7STNBR;


end // end SW01110

// get the user name using ta0230
Function SW01111()
   /* ------------------------------------------------------------*/
   /* Obtain the user information.*/
   /* ------------------------------------------------------------*/

  set TA3REC empty; /* Initialize subroutine parameters*/

  TA3REC.TA3OPTN = "NAMEONLY"; /* Indicate subroutine option*/
  TA3REC.TA3USRID = SL1REC.SL1UPDBY;

  try
    call "TA0230" (TA3REC) {isNoRefresh = yes, isExternal = yes};
  end /* Obtain user information*/

   /* ------------------------------------------------------------*/
   /* If call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call was successful*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Post the error information to the Error Diagnosis Facility.*/
   /* ------------------------------------------------------------*/

  converseLib.validationFailed(1);
  SLWREC.XXXLOCID = "111";
  TAEREC.TAEDESC1 = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC2 = TA3REC.TA3GROUP; /* Error information*/

  TA1REC.TA1FUNC = "RETN"; /* Termination function*/
  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1LOC = "OBTAIN THE USER INFORMATION";
  TA1REC.TA1PGMNM = "SW01111"; /* Process name*/
  TA1REC.TA1MAP = "SW01M001"; /* Map name*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Return to calling application*/


end // end SW01111

// FMT/LOAD PRODUCT DISPLAY DATA
Function SW01120()

   /* ------------------------------------------------------*/
   /* Format po id/ type using the common routine*/
                               /* xsslp01/xsslw01*/
   /* ------------------------------------------------------*/

  set SWVREC empty; /* initialize swvrec*/
  SWVREC.XGPCD = SLKREC.XGPCD; /* gpc code*/
  SWVREC.PC3PONBR = SLKREC.PC3PONBR; /* po number*/
  SWVREC.SWVWFNC = "ID"; /* function*/

  XSSLS10(); /* obtain po id*/

  if (SWVREC.SWVWRTN == 0) /* Call successful*/

    SW01W01.PC3PONBR = SWVREC.PC3PONBR; /* po number*/
    SW01W01.SWVWPOID = SWVREC.SWVWPOID; /* po id*/
    SW01W01.PC4ORTYP = SWVREC.PC4ORTYP; /* po type*/

  else

    SW01W01.PC3PONBR = 0; /* po number*/
    SW01W01.SWVWPOID = " "; /* po id*/
    SW01W01.PC4ORTYP = " "; /* po type*/

  end

   /* ------------------------------------------------------*/
   /* load product data into w/s*/
   /* ------------------------------------------------------*/

  if (SW01W00.SW01WPRF != "Y") /* product not entered*/

    SW01W01.XGPCD = SLKREC.XGPCD;
    SW01W01.SY1STNBR = SLKREC.SY1STNBR;
    SW01W01.SY2CLRID = SLKREC.SY2CLRID;
    SW01W01.XDMCD = SLKREC.XDMCD;
    SW01W01.XQACD = SLKREC.XQACD;
    SW01W01.PC2INSEG = SLKREC.PC2INSEG;
    SW01W01.XEGCD = SLKREC.XEGCD;
    SW01W01.XPGCD = SLKREC.XPGCD;
    SW01W01.XUMCD = SLKREC.XUMCD;
    SW01W01.XOWCD = SLKREC.XOWCD;
    SW01W01.XSLCD = SLKREC.XSLCD;

  end

   /* ------------------------------------------------------*/
    /* get color and style descriptions/determine l/c code*/
   /* ------------------------------------------------------*/

  SW01121(); /* get desc / determine l/c*/

   /* ------------------------------------------------------*/
    /* checkif product is a production setaside*/
   /* ------------------------------------------------------*/

  SW01W01.SW01WSTA = " ";

  if (SLKREC.XRECD > " ")
    if (SLKREC.XRECD in XRETBL.XRECD)
      if (XRETBL.XXXSTAT[sysVar.arrayIndex] == "A"
       && XRETBL.XREHRDFL[sysVar.arrayIndex] == "Y")
        SW01W01.SW01WSTA = "*"; /* prod set aside*/
      end
    end
  end


end // end SW01120

// get sty/clr desc and l/c code
Function SW01121()

   /* ------------------------------------------------------------*/
   /* obtain the style and color description from dprod.vcolor02*/
   /* ------------------------------------------------------------*/

  set SYCREC empty; /* Clear row storage area*/

  SYCREC.XGPCD = SW01W01.XGPCD;
  SYCREC.SY1STNBR = SW01W01.SY1STNBR;
  SYCREC.SY2CLRID = SW01W01.SY2CLRID;
  SYCREC.XDMCD = SW01W01.XDMCD;
  SW01W01.XLCCD = "**";

  SW01S05(); /* select 's ' dprod.vcolor02 row*/

  if (SQLCA.VAGen_SQLCODE == 0)

    SW01W01.SY1SSTNM = SYCREC.SY1SSTNM; /* style desc*/
    SW01W01.SY2CLRAB = SYCREC.SY2CLRAB; /* color desc*/

      /* get current date*/

    XX0XS01();

    if (SYCREC.SY2CEDT1 <= XX0XW01.XX0XWDAT)
      SW01W01.XLCCD = SYCREC.XLCCD1; /* L/C*/
    else

      if (SYCREC.SY2CEDT2 <= XX0XW01.XX0XWDAT)
        SW01W01.XLCCD = SYCREC.XLCCD2; /* L/C*/
      else

        if (SYCREC.SY2CEDT3 <= XX0XW01.XX0XWDAT)
          SW01W01.XLCCD = SYCREC.XLCCD3; /* L/C*/
        else

          if (SYCREC.SY2CEDT4 <= XX0XW01.XX0XWDAT)
            SW01W01.XLCCD = SYCREC.XLCCD4; /* L/C*/
          end
        end
      end
    end
  end

end // end SW01121

// LOAD DSTLOC.VRLCMP01 INTO W/S
Function SW01130()
   /* ------------------------------------------------------------*/
    /* load product detail data*/
   /* ------------------------------------------------------------*/

  SW01W02.SW01WSHT = 0; /* zero out product totals*/
  SW01W02.SW01WRCT = 0;
  SW01W02.SW01WDFT = 0;
  SW01W02.SW01WUXT = 0;
  SW01W02.SW01WUPT = 0;

  SW01W00.SW01WIDX = 1; /* initialize index*/
  SW01W02.SW01W2IX = 1; /* initialize index*/
  while (SW01W00.SW01WIDX <= 40) /* walk thru sizes 1 - 40*/

    if (SLKREC.TSOSHPQT[SW01WIDX] > 0 /* shipped qty*/
     || SLKREC.SL2RCVD[SW01WIDX] > 0) /* received qty*/

      SW01W02.SY5SZID[SW01W2IX] = SW01W00.SW01WIDX; /* size*/

      SW01W02.SW01WSHP[SW01W2IX] = SLKREC.TSOSHPQT[SW01WIDX];
      SW01W00.SW01WSHP = SLKREC.TSOSHPQT[SW01WIDX]; /* ship qty*/
      SW01W02.SW01WRCV[SW01W2IX] = SLKREC.SL2RCVD[SW01WIDX];
      SW01W00.SW01WRCV = SLKREC.SL2RCVD[SW01WIDX]; /* rec qty*/
      SW01W00.SW01WDIF = SW01W00.SW01WRCV - SW01W00.SW01WSHP; /* diff qty*/
      SW01W02.SW01WDIF[SW01W2IX] = SW01W00.SW01WDIF;

       /* obtain unexpected quantities*/

      SW01131(); /* build sl2rec key*/

      SW01S16(); /* select 'ss' dstloc.vrlitm01*/

      SW01W02.SL2RCVD[SW01W2IX] = 0; /* unex qty*/
      if (SLSREC.SLSIND >= 0)
        SW01W02.SL2RCVD[SW01W2IX] = SL2REC.SL2RCVD; /* unex qty*/
      end

       /* obtain unprinted label quantities*/

      SW01132(); /* build slorec key*/

      SW01S17(); /* select 'ss' dstloc.vwophd02*/

      SW01W02.SL9WOQTY[SW01W2IX] = 0; /* unpt qty*/
      if (SLSREC.SLSIND >= 0)
        SW01W02.SL9WOQTY[SW01W2IX] = SLOREC.SL9WOQTY; /* unpt qty*/
      end

       /* add to product total*/

      SW01W02.SW01WSHT = SW01W02.SW01WSHT + SW01W02.SW01WSHP[SW01W2IX];
      SW01W02.SW01WRCT = SW01W02.SW01WRCT + SW01W02.SW01WRCV[SW01W2IX];
      SW01W02.SW01WDFT = SW01W02.SW01WDFT + SW01W02.SW01WDIF[SW01W2IX];
      SW01W02.SW01WUXT = SW01W02.SW01WUXT + SW01W02.SL2RCVD[SW01W2IX];
      SW01W02.SW01WUPT = SW01W02.SW01WUPT + SW01W02.SL9WOQTY[SW01W2IX];

      SW01W02.SW01W2MX = SW01W02.SW01W2IX; /* set max w02 index*/
      SW01W02.SW01W2IX = SW01W02.SW01W2IX + 1; /* increment w02 index*/
    end
    SW01W00.SW01WIDX = SW01W00.SW01WIDX + 1; /* increment size index*/
  end

  if (SW01W02.SW01W2IX > 1)

    SW01133(); /* size description*/

    SW01134(); /* load temp storage*/

  end


end // end SW01130

// build dstloc.vrlitm01 key
Function SW01131()
   /* ------------------------------------------------------*/
   /* load data into sl2rec key*/
   /* ------------------------------------------------------*/

  set SL2REC empty; /* initaialize sl2rec*/

  SL2REC.XWHCD = SW01W01.XWHCD; /* warehouse*/
  SL2REC.TS3CNTNR = SW01W01.TSHCNTNR; /* container*/
  SL2REC.XGPCD = SW01W01.XGPCD;
  SL2REC.PC3PONBR = SW01W01.PC3PONBR;
  SL2REC.SY1STNBR = SW01W01.SY1STNBR;
  SL2REC.SY2CLRID = SW01W01.SY2CLRID;
  SL2REC.XDMCD = SW01W01.XDMCD;
  SL2REC.XQACD = SW01W01.XQACD;
  SL2REC.PC2INSEG = SW01W01.PC2INSEG;
  SL2REC.XEGCD = SW01W01.XEGCD;
  SL2REC.XPGCD = SW01W01.XPGCD;
  SL2REC.XUMCD = SW01W01.XUMCD;
  SL2REC.XOWCD = SW01W01.XOWCD;
  SL2REC.XSLCD = SW01W01.XSLCD;
  SL2REC.SY5SZID = SW01W00.SW01WIDX; /* size*/
  SL2REC.SWHLNCAT = "UX"; /* lane category*/

end // end SW01131

// build dstloc.vwophd02 key
Function SW01132()
   /* ------------------------------------------------------*/
   /* load data into slorec key*/
   /* ------------------------------------------------------*/

  set SLOREC empty; /* initaialize slorec*/

  SLOREC.XWHCD = SW01W01.XWHCD; /* warehouse*/
  SLOREC.TSHCNTNR = SW01W01.TSHCNTNR; /* container*/
  SLOREC.XGPCD = SW01W01.XGPCD;
  SLOREC.SWEPLLNB = SW01W01.SWEPLLNB;
  SLOREC.SL8WOGRP = SW01W01.SL8WOGRP;
  SLOREC.PC3PONBR = SW01W01.PC3PONBR;
  SLOREC.SY1STNBR = SW01W01.SY1STNBR;
  SLOREC.SY2CLRID = SW01W01.SY2CLRID;
  SLOREC.XDMCD = SW01W01.XDMCD;
  SLOREC.XQACD = SW01W01.XQACD;
  SLOREC.PC2INSEG = SW01W01.PC2INSEG;
  SLOREC.XEGCD = SW01W01.XEGCD;
  SLOREC.XPGCD = SW01W01.XPGCD;
  SLOREC.XUMCD = SW01W01.XUMCD;
  SLOREC.XOWCD = SW01W01.XOWCD;
  SLOREC.XSLCD = SW01W01.XSLCD;
  SLOREC.SY5SZID = SW01W00.SW01WIDX; /* size*/
  SLOREC.SLMWCPFL = "Y"; /* io mod checks for w/o print flag*/
   /* not equal 'y')*/

end // end SW01132

// convert size id to size desc.
Function SW01133()
   /* ------------------------------------------------------------*/
   /* translate size id to size description for display*/
   /* ------------------------------------------------------------*/

  set SYPREC empty;

  SW01W00.SW01WTFL = "N"; /* init translate flag*/
  SYPREC.SYPFC = "IE"; /* internal to external translate*/
  SYPREC.SYPCMPSW = "C"; /* indicate not compressed format*/

  SYPREC.XGPCD = SW01W01.XGPCD;
  SYPREC.SY1STNBR = SW01W01.SY1STNBR;
  SYPREC.SY2CLRID = SW01W01.SY2CLRID;
  SYPREC.XDMCD = SW01W01.XDMCD;
  SYPREC.XQACD = SW01W01.XQACD;

  SW01W00.SW01WLIX = +1; /* initialize load index*/
  SW01W02.SW01W2IX = +1; /* initialize w05 index*/
  while (SW01W02.SW01W2IX <= SW01W02.SW01W2MX) /* all table w05 entries*/
    if (SW01W02.SY5SZID[SW01W2IX] > 0)
      SYPREC.SY5SZID[SW01WLIX] = SW01W02.SY5SZID[SW01W2IX];
      SW01W00.SW01WLIX = SW01W00.SW01WLIX + 1;
      SW01W00.SW01WTFL = "Y";
    end
    SW01W02.SW01W2IX = SW01W02.SW01W2IX + 1;
  end

  if (SW01W00.SW01WTFL == "Y") /* size id's to translate*/

    /* ------------------------------------------------------------*/
      /* This routine will move each xlated size description to w/s*/
    /* ------------------------------------------------------------*/

    SW01S06(); /* convert sizes*/

    SW01W02.SW01W2IX = 1; /* initialize index*/
    while (SW01W02.SW01W2IX <= SW01W02.SW01W2MX) /* all table w05 entries*/
      if (SYPREC.SYPSZRC[SW01W2IX] == 0) /* good size return code*/
        SW01W02.SY4IDDSC[SW01W2IX] = SYPREC.SY4IDDSC[SW01W2IX];
      else
        SW01W02.SY4IDDSC[SW01W2IX] = "*****";
      end
      SW01W02.SW01W2IX = SW01W02.SW01W2IX + 1;
    end
  end

end // end SW01133

// move w02 to w03 Temp storage
Function SW01134()
   /* ------------------------------------------------------------*/
   /* write to temp storage*/
   /* ------------------------------------------------------------*/

  set SW01W03 empty; /* init temp storage*/
  SW01W03.SW01W3IX = 1; /* init temp storage index*/
  SW01W02.SW01W2IX = 1; /* init w02 size array index*/
  SW01W00.SW01W3PG = 1; /* first page for product*/
        /* total pages = total sizes / 8 lines per page*/
  SW01W00.SW01W3PM = SW01W02.SW01W2MX / 8; /* total prod pages*/
  SW01W00.SW01WRMD = SW01W02.SW01W2MX % 8; /* remainder*/
  if (SW01W00.SW01WRMD > 0)
    SW01W00.SW01W3PM = SW01W00.SW01W3PM + 1; /* last page*/
  end

  while (SW01W02.SW01W2IX <= SW01W02.SW01W2MX)

    SW01W03.SY4IDDSC[SW01W3IX] = SW01W02.SY4IDDSC[SW01W2IX];
    SW01W03.SW01WSHP[SW01W3IX] = SW01W02.SW01WSHP[SW01W2IX];
    SW01W03.SW01WRCV[SW01W3IX] = SW01W02.SW01WRCV[SW01W2IX];
    SW01W03.SW01WDIF[SW01W3IX] = SW01W02.SW01WDIF[SW01W2IX];
    SW01W03.SL2RCVD[SW01W3IX] = SW01W02.SL2RCVD[SW01W2IX];
    SW01W03.SL9WOQTY[SW01W3IX] = SW01W02.SL9WOQTY[SW01W2IX];

    SW01W03.SW01W3IX = SW01W03.SW01W3IX + 1;
    SW01W02.SW01W2IX = SW01W02.SW01W2IX + 1;

    /* ------------------------------------------------------------*/
     /* if the page is full, add to temporary storage*/
    /* ------------------------------------------------------------*/

    if (SW01W03.SW01W3IX > 8) /* page is full*/
      SW01W03.SW01W3MX = SW01W03.SW01W3IX - 1; /* total lines*/
      SW01W03.SW01W3PG = SW01W00.SW01W3PG; /* current page*/
      SW01W03.SW01W3PM = SW01W00.SW01W3PM; /* product max page*/
      SW01135(); /* move w01 to w03 header*/
      if (SW01W00.SW01W3PG >= SW01W00.SW01W3PM) /* page is full*/
        SW01136(); /* move totals to page*/
      end
      SW01S28(); /* add page to temp storage*/
      set SW01W03 empty; /* initialize w03*/
      SW01W03.SW01W3IX = 1; /* w03 index*/
      SW01W00.SW01W3PG = SW01W00.SW01W3PG + 1; /* w03 index*/
    end

  end

   /* ------------------------------------------------------------*/
   /* add any partially formatted last page to the queue*/
   /* ------------------------------------------------------------*/

  if (SW01W03.SW01W3IX > 1) /* fill the last page*/
    SW01W03.SW01W3MX = SW01W03.SW01W3IX - 1; /* total lines*/
    SW01W03.SW01W3PG = SW01W00.SW01W3PG; /* current page*/
    SW01W03.SW01W3PM = SW01W00.SW01W3PM; /* product max page*/
    SW01135(); /* move w01 to w03 header*/
    SW01136(); /* move totals to page*/
    SW01S28(); /* add page to temp storage*/
  end
end // end SW01134

// move product to w03 temp stor
Function SW01135()
   /* ------------------------------------------------------*/
   /* load product data into w/s*/
   /* ------------------------------------------------------*/

   /* po data*/

  SW01W03.PC3PONBR = SW01W01.PC3PONBR; /* po nbr*/
  SW01W03.SWVWPOID = SW01W01.SWVWPOID; /* po id*/
  SW01W03.PC4ORTYP = SW01W01.PC4ORTYP; /* po type*/
  SW01W03.SW01WSTA = SW01W01.SW01WSTA; /* sas altert*/

   /* product data*/

  SW01W03.XGPCD = SW01W01.XGPCD;
  SW01W03.SY1STNBR = SW01W01.SY1STNBR;
  SW01W03.SY2CLRID = SW01W01.SY2CLRID;
  SW01W03.XDMCD = SW01W01.XDMCD;
  SW01W03.SY1SSTNM = SW01W01.SY1SSTNM;
  SW01W03.SY2CLRAB = SW01W01.SY2CLRAB;
  SW01W03.XQACD = SW01W01.XQACD;
  SW01W03.XLCCD = SW01W01.XLCCD;
  SW01W03.PC2INSEG = SW01W01.PC2INSEG;
  SW01W03.XEGCD = SW01W01.XEGCD;
  SW01W03.XPGCD = SW01W01.XPGCD;
  SW01W03.XUMCD = SW01W01.XUMCD;
  SW01W03.XOWCD = SW01W01.XOWCD;
  SW01W03.XSLCD = SW01W01.XSLCD;


end // end SW01135

// move totals to w03 temp storag
Function SW01136()
   /* ------------------------------------------------------------*/
   /* write to total line to temp storage*/
   /* ------------------------------------------------------------*/

  SW01W03.SW01WSHT = SW01W02.SW01WSHT; /* shipped total*/
  SW01W03.SW01WRCT = SW01W02.SW01WRCT; /* received total*/
  SW01W03.SW01WDFT = SW01W02.SW01WDFT; /* diff total*/
  SW01W03.SW01WUXT = SW01W02.SW01WUXT; /* unexpect qty total*/
  SW01W03.SW01WUPT = SW01W02.SW01WUPT; /* unprt qty total*/

end // end SW01136

// Format and converse the map
Function SW01200()
   /* ------------------------------------------------------------*/
   /* If an error was found, save the error message number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    SLWREC.SLWMSGNO = converseVar.validationMsgNum; /* Message number*/
  end

   /* ------------------------------------------------------------*/
   /* If obtain data failed or no error, format data to display.*/
   /* ------------------------------------------------------------*/

  if (SW01W00.SW01WSWR == "Y" /* Obtain data failed*/
   || converseVar.validationMsgNum == 0) /* or no error found*/

    if (SW01W00.SW01WSWF == "Y") /* Map must be formatted*/
      SW01210(); /* Format the data on the map*/
    end

  end

   /* ------------------------------------------------------------*/
   /* display/load paging information*/
   /* ------------------------------------------------------------*/

  if (SW01W00.TA5TSQIX > 0)
    set SW01M001.SW01MPAG skip;
    SW01M001.XXXTSPAG = SW01W00.XXXTSPAG;
    set SW01M001.SW01MOF skip;
    SW01M001.TA5TSQIX = SW01W00.TA5TSQIX;
  end

  SW01M001.XXXCURDT = VGVar.currentShortGregorianDate; /* Current date*/
  SW01M001.CATOAP = COMMAREA.CATOAP; /* TO application*/
  SW01M001.CAITEM = COMMAREA.CAITEM; /* Application data*/

   /* ------------------------------------------------------------*/
   /* If a message to display, indicate sound audible alarm.*/
   /* ------------------------------------------------------------*/

  if (SLWREC.SLWMSGNO != 0 /* Message to display*/
   || COMMAREA.CAMSG != " ") /* or message text*/

    if (SLWREC.SLWMSGNO != 0) /* Message to display*/

      if (SLWREC.SLWMSGNO == 9999)
        converseLib.validationFailed();
      else
        converseLib.validationFailed(SLWREC.SLWMSGNO);
      end /* Message number*/
    else
      SW01M001.VAGen_EZEMSG = COMMAREA.CAMSG; /* Message text*/

    end

    SW01M001.XXXLOCID = SLWREC.XXXLOCID; /* Module identification*/

    set SW01M001 alarm; /* Indicate sound alarm*/

  end


  converse SW01M001 ;

   /* ------------------------------------------------------------*/
   /* Clear the message fields and save FAST PATH information.*/
   /* ------------------------------------------------------------*/

  SLWREC.XXXLOCID = " "; /* Module identification*/
  SLWREC.SLWMSGNO = 0;
  COMMAREA.CAMSG = " "; /* commarea message*/

  COMMAREA.CATOAP = SW01M001.CATOAP; /* TO application*/
  COMMAREA.CAITEM = SW01M001.CAITEM; /* Application data*/


end // end SW01200

// Format m001 display data
Function SW01210()

   /* ------------------------------------------------------------*/
   /* init map sw01m001*/
   /* ------------------------------------------------------------*/

  set SW01M001 initial; /* m001 input/ouput area*/

  SW01W00.SW01WSWF = "N"; /* init map switch*/

   /* ------------------------------------------------------------*/
   /* Format sw01m001 using key data*/
   /* ------------------------------------------------------------*/

  SW01211(); /* move w01 heading to map*/

   /* ------------------------------------------------------------*/
   /* if data has not been loaded bypass load map fields*/
   /* ------------------------------------------------------------*/

  if (SW01W01.CACHGFL != "Y")
    return;
  end

   /* ------------------------------------------------------------*/
   /* read temporary storage*/
   /* ------------------------------------------------------------*/

  SW01S25(); /* read temp storage*/

   /* ------------------------------------------------------------*/
   /* load product data from temporary storage*/
   /* ------------------------------------------------------------*/

  SW01212(); /* move heading to map*/

   /* ------------------------------------------------------------*/
   /* load detail data from temporary storage*/
   /* ------------------------------------------------------------*/

  SW01W03.SW01W3IX = 1; /* init index*/
  while (SW01W03.SW01W3IX <= 8)

    SW01M001.SY4IDDSC[SW01W3IX] = SW01W03.SY4IDDSC[SW01W3IX]; /* size*/
    SW01M001.SW01MPLQ[SW01W3IX] = SW01W03.SW01WSHP[SW01W3IX]; /* ship qty*/
    SW01M001.SW01MRCQ[SW01W3IX] = SW01W03.SW01WRCV[SW01W3IX]; /* rcvd qty*/
    SW01M001.SW01MDFQ[SW01W3IX] = SW01W03.SW01WDIF[SW01W3IX]; /* diff qty*/
    SW01M001.SW01MUPQ[SW01W3IX] = SW01W03.SL2RCVD[SW01W3IX]; /* unex qty*/
    SW01M001.SW01MMSQ[SW01W3IX] = SW01W03.SL9WOQTY[SW01W3IX]; /* miss qty*/

    SW01W03.SW01W3IX = SW01W03.SW01W3IX + 1;

  end

   /* ------------------------------------------------------------*/
   /* this code is to be saved just in case the user decides to*/
   /* display the number of pages per product being displayed*/
   /* ------------------------------------------------------------*/

   /* IF SW01W03.SW01W3PG Gt 0;*/
    /* MOVE SW01W03.SW01W3PG TO SW01M001.SW01MCPG;curr pg for prd*/
    /* SET SW01M001.SW01MPAG AUTOSKIP       ; normal*/
    /* MOVE SW01W03.SW01W3PM TO SW01M001.SW01MMPG;last pg for prd*/
    /* SET SW01M001.SW01MOF AUTOSKIP ; normal*/
   /* END ;*/

   /* ------------------------------------------------------------*/
   /* if last page for product being displayed, load product*/
   /* totals.*/
   /* ------------------------------------------------------------*/

  if (SW01W03.SW01W3PG >= SW01W03.SW01W3PM) /* last page for product*/

    set SW01M001.SW01MTOT skip; /* total literal*/
    SW01M001.SW01MPLT = SW01W03.SW01WSHT; /* total ship qty*/
    set SW01M001.SW01MPLT skip; /* total ship qty*/
    SW01M001.SW01MRCT = SW01W03.SW01WRCT; /* total rcvd qty*/
    set SW01M001.SW01MRCT skip; /* total rcvd qty*/
    SW01M001.SW01MDFT = SW01W03.SW01WDFT; /* total diff qty*/
    set SW01M001.SW01MDFT skip; /* total diff qty*/
    SW01M001.SW01MUPT = SW01W03.SW01WUXT; /* total unex qty*/
    set SW01M001.SW01MUPT skip; /* total unex qty*/
    SW01M001.SW01MMST = SW01W03.SW01WUPT; /* total miss qty*/
    set SW01M001.SW01MMST skip; /* total miss qty*/
  else

    set SW01M001.SW01MTOT initialAttributes;
    set SW01M001.SW01MPLT initialAttributes;
    set SW01M001.SW01MRCT initialAttributes;
    set SW01M001.SW01MDFT initialAttributes;
    set SW01M001.SW01MUPT initialAttributes;
    set SW01M001.SW01MMST initialAttributes;
  end

end // end SW01210

// Format m001 with w01 data
Function SW01211()
   /* ------------------------------------------------------------*/
   /* Format sw01m001 using key data*/
   /* ------------------------------------------------------------*/

  SW01M001.XWHCD = SW01W01.XWHCD; /* warehouse code*/
  SW01M001.XWHABRV = SW01W01.XWHABRV; /* warehous abrv desc*/
  SW01M001.TSHCNTNR = SW01W01.TSHCNTNR; /* container*/
  SW01M001.SWEPLLNB = SW01W01.SWEPLLNB; /* plan*/
  SW01M001.XARCD = SW01W01.XARCD; /* area*/
  SW01M001.SL4ZONE = SW01W01.SL4ZONE; /* zone*/
  SW01M001.YRSCD = SW01W01.YRSCD; /* rcv status*/
  SW01M001.YRSABRV = SW01W01.YRSABRV; /* rcv abrv*/
  SW01M001.XURUSRNM = SW01W01.XURUSRNM; /* user name*/
  SW01M001.IN7STNBR = SW01W01.IN7STNBR; /* stock transfer*/
  SW01M001.SL8WOGRP = SW01W01.SL8WOGRP; /* w/o grp*/
  SW01M001.XITCD = SW01W01.XITCD; /* rcv type*/
  SW01M001.SL1RCRNO = SW01W01.SL1RCRNO; /* rcv report*/

   /* ------------------------------------------------------------*/
   /* move po nbr/id/type*/
   /* ------------------------------------------------------------*/

  SW01M001.PC3PONBR = SW01W01.PC3PONBR;
  SW01M001.SWVWPOID = SW01W01.SWVWPOID;
  SW01M001.PC4ORTYP = SW01W01.PC4ORTYP;
  SW01M001.SW01MSTA = SW01W01.SW01WSTA; /* sas alert*/

   /* move product to map*/

  SW01M001.XGPCD = SW01W01.XGPCD; /* gpc code*/
  SW01M001.SY1STNBR = SW01W01.SY1STNBR; /* style nbr*/
  SW01M001.SY2CLRID = SW01W01.SY2CLRID; /* color id*/
  SW01M001.XDMCD = SW01W01.XDMCD; /* dimension code*/
  SW01M001.SY1SSTNM = SW01W01.SY1SSTNM; /* style description*/
  SW01M001.SY2CLRAB = SW01W01.SY2CLRAB; /* color id description*/
  SW01M001.XQACD = SW01W01.XQACD; /* quality code*/
  SW01M001.XLCCD = SW01W01.XLCCD; /* L/C code*/
  SW01M001.PC2INSEG = SW01W01.PC2INSEG; /* iseg code*/
  SW01M001.XEGCD = SW01W01.XEGCD; /* edif code*/
  SW01M001.XPGCD = SW01W01.XPGCD; /* package code*/
  SW01M001.XUMCD = SW01W01.XUMCD; /* unit of measure*/
  SW01M001.XOWCD = SW01W01.XOWCD; /* owner group code*/
  SW01M001.XSLCD = SW01W01.XSLCD; /* class code*/
end // end SW01211

// Format m001 header data
Function SW01212()
   /* ------------------------------------------------------------*/
   /* move po nbr/id/type*/
   /* ------------------------------------------------------------*/

  SW01M001.PC3PONBR = SW01W03.PC3PONBR;
  SW01W01.PC3PONBR = SW01W03.PC3PONBR;
  SW01M001.SWVWPOID = SW01W03.SWVWPOID;
  SW01W01.SWVWPOID = SW01W03.SWVWPOID;
  SW01M001.PC4ORTYP = SW01W03.PC4ORTYP;
  SW01W01.PC4ORTYP = SW01W03.PC4ORTYP;
  SW01M001.SW01MSTA = SW01W03.SW01WSTA;
  SW01W01.SW01WSTA = SW01W03.SW01WSTA;

   /* move product to map*/

  SW01M001.XGPCD = SW01W03.XGPCD; /* gpc code*/
  SW01W01.XGPCD = SW01W03.XGPCD; /* gpc code*/
  SW01M001.SY1STNBR = SW01W03.SY1STNBR; /* style nbr*/
  SW01W01.SY1STNBR = SW01W03.SY1STNBR; /* style nbr*/
  SW01M001.SY2CLRID = SW01W03.SY2CLRID; /* color id*/
  SW01W01.SY2CLRID = SW01W03.SY2CLRID; /* color id*/
  SW01M001.XDMCD = SW01W03.XDMCD; /* dimension code*/
  SW01W01.XDMCD = SW01W03.XDMCD; /* dimension code*/
  SW01M001.SY1SSTNM = SW01W03.SY1SSTNM; /* style description*/
  SW01W01.SY1SSTNM = SW01W03.SY1SSTNM; /* style description*/
  SW01M001.SY2CLRAB = SW01W03.SY2CLRAB; /* color id description*/
  SW01W01.SY2CLRAB = SW01W03.SY2CLRAB; /* color id description*/
  SW01M001.XQACD = SW01W03.XQACD; /* quality code*/
  SW01W01.XQACD = SW01W03.XQACD; /* quality code*/
  SW01M001.XLCCD = SW01W03.XLCCD; /* L/C code*/
  SW01W01.XLCCD = SW01W03.XLCCD; /* L/C code*/
  SW01M001.PC2INSEG = SW01W03.PC2INSEG; /* iseg code*/
  SW01W01.PC2INSEG = SW01W03.PC2INSEG; /* iseg code*/
  SW01M001.XEGCD = SW01W03.XEGCD; /* edif code*/
  SW01W01.XEGCD = SW01W03.XEGCD; /* edif code*/
  SW01M001.XPGCD = SW01W03.XPGCD; /* package code*/
  SW01W01.XPGCD = SW01W03.XPGCD; /* package code*/
  SW01M001.XUMCD = SW01W03.XUMCD; /* unit of measure*/
  SW01W01.XUMCD = SW01W03.XUMCD; /* unit of measure*/
  SW01M001.XOWCD = SW01W03.XOWCD; /* owner group code*/
  SW01W01.XOWCD = SW01W03.XOWCD; /* owner group code*/
  SW01M001.XSLCD = SW01W03.XSLCD; /* class code*/
  SW01W01.XSLCD = SW01W03.XSLCD; /* class code*/
end // end SW01212

// Check attention identifier
Function SW01300()
   /* ------------------------------------------------------------*/
   /* If CANCEL was requested, clear the map fields and exit.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pa2) /* PA2 was pressed*/

    converseLib.clearScreen();
     /* refresh map*/

    SW01W00.SW01WSWR = "N"; /* request for data*/
    SW01W00.SW01WSWF = "Y"; /* format screen m001*/

    COMMAREA.CATOAP = " "; /* to application*/
    COMMAREA.CAITEM = " "; /* passed data*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* If FAST PATH was requested, transfer to the application.*/
   /* ------------------------------------------------------------*/

  if (SW01M001.CATOAP > " ") /* FAST PATH was requested*/

    if (converseVar.eventKey is enter) /* ENTER was pressed*/

      SW01S01(); /* Purge temporary storage*/

      XSSL001(); /* Exit to another application*/

      set SW01M001.CATOAP cursor, bold; /* Highlight*/

    else

      SLWREC.XXXLOCID = "300"; /* Module identification*/
      converseLib.validationFailed(259); /* Indicate PF key not valid*/

    end

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* If HELP, exit to the previous level or exit to the Master*/
   /* Menu was requested, exit to another application.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf1 /* PF1 was pressed*/
   || converseVar.eventKey is pf3 /* or PF3 was pressed*/
   || converseVar.eventKey is pf4 /* or PF4 was pressed*/
   || converseVar.eventKey is pf5) /* or PF5 was pressed*/

    COMMAREA.XWHCD = SW01M001.XWHCD;

    if (converseVar.eventKey is pf1) /* PF1 was pressed*/
      COMMAREA.CAITEM = "SW01M001"; /* Application find code*/
    end

    if (converseVar.eventKey is pf3) /* PF3 was pressed*/
      COMMAREA.CATOAP = "SW0R"; /* Application find code*/
    end

    if (converseVar.eventKey is pf4) /* PF4 was pressed*/
      COMMAREA.CATOAP = "MN0M"; /* Application find code*/
    end

    if (converseVar.eventKey is pf5) /* PF5 was pressed*/
      COMMAREA.CATOAP = "SL0M"; /* Application find code*/
    end

    SW01S01(); /* Purge temporary storage*/

    XSSL001(); /* Exit to another application*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Determine whether a valid attention identifier was used to*/
   /* invoke the transaction.  Display an error message to the*/
   /* user if the PF key used is not supported.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey not enter /* ENTER was not pressed*/
   && converseVar.eventKey not pf6   /* pf6  was not pressed*/
   && converseVar.eventKey not pf7   /* pf7  was not pressed*/
   && converseVar.eventKey not pf8   /* pf8  was not pressed*/
   && converseVar.eventKey not pf16) /* pf16 was not pressed*/

    SLWREC.XXXLOCID = "300"; /* Module identification*/
    converseLib.validationFailed(4); /* Indicate invalid attention key*/

    if (converseVar.eventKey is pakey) /* PA key was pressed*/
      converseLib.clearScreen();
       /* Clear screen before display*/
    end

    exit stack; /* Exit to display map*/

  end


end // end SW01300

// Reset highlighted fields
Function SW01400()
   /* ------------------------------------------------------------*/
   /* Reset field attributes to normal intensity.*/
   /* ------------------------------------------------------------*/

  set SW01M001.XWHCD initialAttributes; /* warehouse*/
  set SW01M001.TSHCNTNR initialAttributes; /* container*/
  set SW01M001.PC3PONBR initialAttributes; /* PO nbr*/
  set SW01M001.SWVWPOID initialAttributes; /* PO ID*/
  set SW01M001.PC4ORTYP initialAttributes; /* PO Type*/
  set SW01M001.XGPCD initialAttributes; /* GPC code*/
  set SW01M001.SY1STNBR initialAttributes; /* style nbr*/
  set SW01M001.SY2CLRID initialAttributes; /* color id*/
  set SW01M001.XDMCD initialAttributes; /* dimension code*/
  set SW01M001.XQACD initialAttributes; /* quality code*/
  set SW01M001.PC2INSEG initialAttributes; /* iseg code*/
  set SW01M001.XEGCD initialAttributes; /* edif code*/
  set SW01M001.XPGCD initialAttributes; /* package code*/
  set SW01M001.XUMCD initialAttributes; /* unit of measure*/
  set SW01M001.XOWCD initialAttributes; /* owner group code*/
  set SW01M001.XSLCD initialAttributes; /* class code*/

  set SW01M001.CATOAP initialAttributes;
  set SW01M001.CAITEM initialAttributes;

   /* ------------------------------------------------------------*/
   /* If no lists were requested, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XWHCD == "?" /* warehouse list req*/
   || SW01M001.XGPCD == "?" /* or gen product code*/
   || SW01M001.XDMCD == "?" /* or dimension list req*/
   || SW01M001.XQACD == "?" /* or quality code req*/
   || SW01M001.XEGCD == "?" /* or edif list req*/
   || SW01M001.XPGCD == "?" /* or package list req*/
   || SW01M001.XUMCD == "?" /* or unit of measure list*/
   || SW01M001.XOWCD == "?" /* or owner group code*/
   || SW01M001.XSLCD == "?") /* or class code*/

    if (converseVar.eventKey not enter) /* ENTER was not pressed*/

      SLWREC.XXXLOCID = "400"; /* Module identification*/
      converseLib.validationFailed(4); /* Indicate PF key not valid*/

      exit stack; /* Exit to display map*/

    end

  else

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If requested, display the list of warehouse codes*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XWHCD == "?") /* warehouse requested*/

    XPXX001(); /* Window initialization*/
    XX0XW02.XX0XWHDR = "WAREHOUSE CODES"; /* Heading*/

    while (XX0XW02.XX0XWEND == "N") /* Until end of request*/
      XPXWH01(); /* Display the list*/
    end

    if (XX0XW02.XX0XWPIX == 0) /* No selection made*/

      SW01M001.XWHCD = SW01W01.XWHCD; /* Restore prior code*/
    else
      SW01M001.XWHCD = XWHTBL.XWHCD[XX0XWPIX]; /* Selected code*/
      SW01M001.XWHABRV = XWHTBL.XWHABRV[XX0XWPIX];
      SW01W01.XWHCD = XWHTBL.XWHCD[XX0XWPIX]; /* Selected code*/
      SW01W01.XWHABRV = XWHTBL.XWHABRV[XX0XWPIX];

    end

    set SW01M001.XWHCD cursor; /* Establish cursor position*/

  end

   /* ------------------------------------------------------------*/
   /* If requested, display the list of GPC codes*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XGPCD == "?") /* GPC code list requested*/

    XPXX001(); /* window initialization*/
    XX0XW02.XX0XWHDR = " GPC CODES "; /* Heading*/

    while (XX0XW02.XX0XWEND == "N") /* Until end of request*/
      XPXGP01(); /* Display the GPC code list*/
    end

    if (XX0XW02.XX0XWPIX == 0) /* No selection made*/

      SW01M001.XGPCD = SW01W01.XGPCD; /* Restore prior code*/
    else
      SW01W01.XGPCD = XGPTBL.XGPCD[XX0XWPIX]; /* Selected code*/
      SW01M001.XGPCD = XGPTBL.XGPCD[XX0XWPIX]; /* Selected code*/

    end

    set SW01M001.XGPCD cursor; /* Establish cursor position*/

  end

   /* ------------------------------------------------------------*/
   /* If requested, display the list of dimension codes*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XDMCD == "?") /* dimension list requested*/

    XPXX001(); /* window initialization*/
    XX0XW02.XX0XWHDR = " DIMENSION CODES"; /* Heading*/

    while (XX0XW02.XX0XWEND == "N") /* Until end of request*/
      XPXDM01(); /* Display the dimension list*/
    end

    if (XX0XW02.XX0XWPIX == 0) /* No selection made*/

      SW01M001.XDMCD = SW01W01.XDMCD; /* Restore prior code*/
    else
      SW01W01.XDMCD = XDMTBL.XDMCD[XX0XWPIX]; /* Selected code*/
      SW01M001.XDMCD = XDMTBL.XDMCD[XX0XWPIX]; /* Selected code*/

    end

    set SW01M001.XDMCD cursor; /* Establish cursor position*/

  end

   /* ------------------------------------------------------------*/
   /* If requested, display the list of quality codes*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XQACD == "?") /* quality list requested*/

    XPXX001(); /* window initialization*/
    XX0XW02.XX0XWHDR = " QUALITY CODES"; /* Heading*/

    while (XX0XW02.XX0XWEND == "N") /* Until end of request*/
      XPXQA01(); /* Display the quality list*/
    end

    if (XX0XW02.XX0XWPIX == 0) /* No selection made*/

      SW01M001.XQACD = SW01W01.XQACD; /* Restore prior code*/
    else
      SW01W01.XQACD = XQATBL.XQACD[XX0XWPIX]; /* Selected code*/
      SW01M001.XQACD = XQATBL.XQACD[XX0XWPIX]; /* Selected code*/

    end

    set SW01M001.XQACD cursor; /* Establish cursor position*/

  end

   /* ------------------------------------------------------------*/
   /* If requested, display the list of engineering difference*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XEGCD == "?") /* eng. dif list requested*/

    XPXX001(); /* window initialization*/
    XX0XW02.XX0XWHDR = "ENGINEERING CODES"; /* Heading*/

    while (XX0XW02.XX0XWEND == "N") /* Until end of request*/
      XPXEG01(); /* Display the edf list*/
    end

    if (XX0XW02.XX0XWPIX == 0) /* No selection made*/

      SW01M001.XEGCD = SW01W01.XEGCD; /* Restore prior code*/
    else
      SW01W01.XEGCD = XEGTBL.XEGCD[XX0XWPIX]; /* Selected code*/
      SW01M001.XEGCD = XEGTBL.XEGCD[XX0XWPIX]; /* Selected code*/

    end

    set SW01M001.XEGCD cursor; /* Establish cursor position*/

  end

   /* ------------------------------------------------------------*/
   /* If requested, display the list of package codes.*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XPGCD == "?") /* Package list requested*/

    XPXX001(); /* window initialization*/
    XX0XW02.XX0XWHDR = "PACKAGE TYPE"; /* Heading*/

    while (XX0XW02.XX0XWEND == "N") /* Until end of request*/
      XPXPG01(); /* Display the package list*/
    end

    if (XX0XW02.XX0XWPIX == 0) /* No selection made*/

      SW01M001.XPGCD = SW01W01.XPGCD; /* Restore prior code*/
    else
      SW01W01.XPGCD = XPGTBL.XPGCD[XX0XWPIX]; /* Selected code*/
      SW01M001.XPGCD = XPGTBL.XPGCD[XX0XWPIX]; /* Selected code*/
    end

    set SW01M001.XPGCD cursor; /* Establish cursor position*/


  end
   /* ------------------------------------------------------------*/
   /* If requested, display the list of unit of measure codes*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XUMCD == "?") /* Unit of measure requested*/

    XPXX001(); /* Window initialization*/
    XX0XW02.XX0XWHDR = "UNIT OF MEASURE"; /* Heading*/

    while (XX0XW02.XX0XWEND == "N") /* Until end of request*/
      XPXUM01(); /* Display the list*/
    end

    if (XX0XW02.XX0XWPIX == 0) /* No selection made*/

      SW01M001.XUMCD = SW01W01.XUMCD; /* Restore prior code*/
    else
      SW01M001.XUMCD = XUMTBL.XUMCD[XX0XWPIX]; /* Selected code*/
      SW01W01.XUMCD = XUMTBL.XUMCD[XX0XWPIX]; /* Selected code*/

    end

    set SW01M001.XUMCD cursor; /* Establish cursor position*/

  end

   /* ------------------------------------------------------------*/
   /* If requested, display the list of owner group codes.*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XOWCD == "?") /* Owner group list requested*/

    XPXX001(); /* window initialization*/
    XX0XW02.XX0XWHDR = "OWNER GROUP CODES"; /* Heading*/
    XX0XW02.XWHCD = SW01M001.XWHCD;

    while (XX0XW02.XX0XWEND == "N") /* Until end of request*/
      XPXOW01(); /* Display the owner group list*/
    end

    if (XX0XW02.XX0XWPIX == 0) /* No selection made*/

      SW01M001.XOWCD = SW01W01.XOWCD; /* Restore prior code*/
    else
      SW01W01.XOWCD = XOWTBL.XOWCD[XX0XWPIX]; /* Selected code*/
      SW01M001.XOWCD = XOWTBL.XOWCD[XX0XWPIX]; /* Selected code*/

    end

    set SW01M001.XOWCD cursor; /* Establish cursor position*/

  end

   /* ------------------------------------------------------------*/
   /* If requested, display the list of stock locate class codes*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XSLCD == "?") /* Owner group list requested*/

    XPXX001(); /* window initialization*/
    XX0XW02.XX0XWHDR = "S.L. CLASS CODES"; /* Heading*/

    while (XX0XW02.XX0XWEND == "N") /* Until end of request*/
      XPXSL01(); /* Display the owner group list*/
    end

    if (XX0XW02.XX0XWPIX == 0) /* No selection made*/

      SW01M001.XSLCD = SW01W01.XSLCD; /* Restore prior code*/
    else
      SW01W01.XSLCD = XSLTBL.XSLCD[XX0XWPIX]; /* Selected code*/
      SW01M001.XSLCD = XSLTBL.XSLCD[XX0XWPIX]; /* Selected code*/

    end

    set SW01M001.XSLCD cursor; /* Establish cursor position*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the requested lists have been displayed and*/
   /* that ENTER must be pressed to process any changes.*/
   /* ------------------------------------------------------------*/

  converseLib.clearScreen();
   /* Clear screen before display*/

  SLWREC.XXXLOCID = "400"; /* Module identification*/
  converseLib.validationFailed(264); /* Indicate press ENTER*/

  exit stack; /* Exit to display map*/


end // end SW01400

// Verify the entered data
Function SW01500()
   /* ------------------------------------------------------------*/
   /* Highlight any application data that was entered.*/
   /* ------------------------------------------------------------*/

  if (COMMAREA.CAITEM > " ") /* Application data was entered*/

    SLWREC.XXXLOCID = "500"; /* Module identification*/
    set SW01M001.CAITEM cursor, bold; /* Highlight*/
    converseLib.validationFailed(259); /* Enter only with FAST PATH*/

  end

   /* ------------------------------------------------------------*/
   /* if requested screen print(pf6)*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf6) /* request to print screen data(pf6)*/

    SW01505();

    if (converseVar.validationMsgNum == 0)
      if (SW01W01.CACHGFL != "Y") /* if no data has been displayed*/
        converseLib.validationFailed(287); /* print function invalid*/
        SLWREC.XXXLOCID = "500";
      end
    end

  end

   /* ------------------------------------------------------------*/
   /* request to scroll*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf7 /* scroll forward*/
   || converseVar.eventKey is pf8) /* scroll backward*/

    SW01505();

    if (converseVar.validationMsgNum == 0)
      SW01520(); /* scroll*/
    end

  end

   /* ------------------------------------------------------------*/
   /* request to display reconcilation detail*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf16) /* request to display sw02*/

    SW01505();

  end

   /* ------------------------------------------------------------*/
   /* validate entry fields*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is enter)

    SW01510();

    SW01530(); /* validate entry fields*/

    if (SW01W00.SW01WMOD == "Y")
      if (converseVar.validationMsgNum == 0)
        SW01W00.SW01WSWR = "Y"; /* request data request*/
      end
    end
  end


  if (converseVar.validationMsgNum != 0)
    exit stack;
  end


end // end SW01500

// check modifiable fields
Function SW01505()

   /* -----------------------------------------------------*/
   /* verify modifiable key fields*/
   /* -----------------------------------------------------*/

  if (SW01W01.XSLCD != SW01M001.XSLCD)
    set SW01M001.XSLCD cursor, bold;
    converseLib.validationFailed(265);
  end

  if (SW01W01.XUMCD != SW01M001.XUMCD)
    set SW01M001.XUMCD cursor, bold;
    converseLib.validationFailed(265);
  end

  if (SW01W01.XOWCD != SW01M001.XOWCD)
    set SW01M001.XOWCD cursor, bold;
    converseLib.validationFailed(265);
  end

  if (SW01W01.XPGCD != SW01M001.XPGCD)
    set SW01M001.XPGCD cursor, bold;
    converseLib.validationFailed(265);
  end

  if (SW01W01.XEGCD != SW01M001.XEGCD)
    set SW01M001.XEGCD cursor, bold;
    converseLib.validationFailed(265);
  end

  if (SW01W01.PC2INSEG != SW01M001.PC2INSEG)
    set SW01M001.PC2INSEG cursor, bold;
    converseLib.validationFailed(265);
  end

  if (SW01W01.XQACD != SW01M001.XQACD)
    set SW01M001.XQACD cursor, bold;
    converseLib.validationFailed(265);
  end

  if (SW01W01.XDMCD != SW01M001.XDMCD)
    set SW01M001.XDMCD cursor, bold;
    converseLib.validationFailed(265);
  end

  if (SW01W01.SY2CLRID != SW01M001.SY2CLRID) /* color id*/
    set SW01M001.SY2CLRID cursor, bold;
    converseLib.validationFailed(265);
  end

  if (SW01W01.SY1STNBR != SW01M001.SY1STNBR)
    set SW01M001.SY1STNBR cursor, bold;
    converseLib.validationFailed(265);
  end

  if (SW01W01.XGPCD != SW01M001.XGPCD)
    set SW01M001.XGPCD cursor, bold;
    converseLib.validationFailed(265);
  end

  if (SW01W01.PC4ORTYP != SW01M001.PC4ORTYP)
    set SW01M001.PC4ORTYP cursor, bold;
    converseLib.validationFailed(265);
  end

  if (SW01W01.SWVWPOID != SW01M001.SWVWPOID)
    set SW01M001.SWVWPOID cursor, bold;
    converseLib.validationFailed(265);
  end

  if (SW01W01.PC3PONBR != SW01M001.PC3PONBR)
    set SW01M001.PC3PONBR cursor, bold;
    converseLib.validationFailed(265);
  end

  if (SW01W01.TSHCNTNR != SW01M001.TSHCNTNR)
    set SW01M001.TSHCNTNR cursor, bold;
    converseLib.validationFailed(265);
  end

  if (SW01W01.XWHCD != SW01M001.XWHCD)
    set SW01M001.XWHCD cursor, bold;
    converseLib.validationFailed(265);
  end

  if (converseVar.validationMsgNum == 265)
    SLWREC.XXXLOCID = "505";
  end


end // end SW01505

// verify data has been modified
Function SW01510()
   /* -----------------------------------------------------*/
   /* check modifiable fields*/
   /* -----------------------------------------------------*/

  SW01W00.SW01WMOD = "N";
  SW01W00.SW01WPRF = "N"; /* request product*/

  if (SW01W01.XWHCD != SW01M001.XWHCD /* warehouse*/
   || SW01W01.TSHCNTNR != SW01M001.TSHCNTNR) /* container*/
    SW01W00.SW01WMOD = "Y";
  end

  if (SW01W01.PC3PONBR != SW01M001.PC3PONBR /* po nbr*/
   || SW01W01.SWVWPOID != SW01M001.SWVWPOID /* po id*/
   || SW01W01.PC4ORTYP != SW01M001.PC4ORTYP /* po type*/
   || SW01W01.XGPCD != SW01M001.XGPCD       /* GPC code*/
   || SW01W01.SY1STNBR != SW01M001.SY1STNBR /* style nbr*/
   || SW01W01.SY2CLRID != SW01M001.SY2CLRID /* color id*/
   || SW01W01.XDMCD != SW01M001.XDMCD       /* dimension code*/
   || SW01W01.XQACD != SW01M001.XQACD       /* quality code*/
   || SW01W01.PC2INSEG != SW01M001.PC2INSEG /* iseg code*/
   || SW01W01.XEGCD != SW01M001.XEGCD       /* edif code*/
   || SW01W01.XPGCD != SW01M001.XPGCD       /* package code*/
   || SW01W01.XOWCD != SW01M001.XOWCD       /* owner group code*/
   || SW01W01.XUMCD != SW01M001.XUMCD       /* unit of measure*/
   || SW01W01.XSLCD != SW01M001.XSLCD)      /* class code*/
    SW01W00.SW01WMOD = "Y";
    SW01W00.SW01WPRF = "Y"; /* product entered by user*/
  end


end // end SW01510

// verify data for scrolling
Function SW01520()
   /* --------------------------------------------------------*/
   /* If scroll back was requested, ensure that pages exist.*/
   /* --------------------------------------------------------*/

  if (converseVar.eventKey is pf7 /* scroll back request*/
   && SW01W00.XXXTSPAG < 2)       /* no previous pages*/
    SLWREC.XXXLOCID = "520"; /* application module*/
    converseLib.validationFailed(7); /* no previous pages to display*/
  end

   /* --------------------------------------------------------*/
   /* If scroll forward was requested, ensure that pages exist.*/
   /* --------------------------------------------------------*/

  if (converseVar.eventKey is pf8 /* scroll forward request*/
   && SW01W00.XXXTSPAG >= SW01W00.TA5TSQIX) /* no more pages*/
    SLWREC.XXXLOCID = "520"; /* application module*/
    converseLib.validationFailed(8); /* no more pages to display*/
  end

end // end SW01520

// Verify the entered data
Function SW01530()
   /* ------------------------------------------------------------*/
   /* Edit the required fields starting at the bottom of the*/
   /* map.*/
   /* ------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* sl class code*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XSLCD != SW01W01.XSLCD) /* class code*/
    if (SW01M001.XSLCD in XSLTBL.XSLCD)
      if (XSLTBL.XXXSTAT[sysVar.arrayIndex] == "A")
        /* next sentence*/
      else
        set SW01M001.XSLCD cursor, bold;
        converseLib.validationFailed(10); /* inactive field*/
        SW01M001.XXXLOCID = "530";
      end
    else
      set SW01M001.XSLCD cursor, bold;
      converseLib.validationFailed(360); /* invalid class code*/
      SW01M001.XXXLOCID = "530";
    end
  end

   /* ------------------------------------------------------------*/
   /* Edit the owner group code*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XOWCD != SW01W01.XOWCD) /* Unit of measure entered*/
    XOWREC.XWHCD = SW01M001.XWHCD;
    XOWREC.XOWCD = SW01M001.XOWCD;
    if (XOWREC.XOWKEY in XOWTBL.XOWKEY)
      if (XOWTBL.XXXSTAT[sysVar.arrayIndex] == "A")
        /* next sentence*/
      else
        set SW01M001.XOWCD cursor, bold;
        converseLib.validationFailed(10); /* inactive field*/
        SW01M001.XXXLOCID = "530";
      end
    else
      set SW01M001.XOWCD cursor, bold;
      converseLib.validationFailed(361); /* invalid owner group code*/
      SW01M001.XXXLOCID = "530";
    end
  end

   /* ------------------------------------------------------------*/
   /* Edit unit of measure*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XUMCD != SW01W01.XUMCD) /* Unit of measure entered*/
    if (SW01M001.XUMCD in XUMTBL.XUMCD)
      if (XUMTBL.XXXSTAT[sysVar.arrayIndex] == "A")
        /* next sentence*/
      else
        set SW01M001.XUMCD cursor, bold;
        converseLib.validationFailed(10); /* inactive field*/
        SW01M001.XXXLOCID = "530";
      end
    else
      set SW01M001.XUMCD cursor, bold;
      converseLib.validationFailed(362); /* invalid unit of measure*/
      SW01M001.XXXLOCID = "530";
    end
  end

   /* ------------------------------------------------------------*/
   /* Edit the package type*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XPGCD != SW01W01.XPGCD) /* package type code*/
    if (SW01M001.XPGCD in XPGTBL.XPGCD)
      if (XPGTBL.XXXSTAT[sysVar.arrayIndex] == "A")
        /* next sentence*/
      else
        set SW01M001.XPGCD cursor, bold;
        converseLib.validationFailed(10); /* inactive*/
        SW01M001.XXXLOCID = "530";
      end
    else
      set SW01M001.XPGCD cursor, bold;
      converseLib.validationFailed(363); /* invalid package type code*/
      SW01M001.XXXLOCID = "530";
    end
  end

   /* ------------------------------------------------------------*/
   /* Edit the edf*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XEGCD != SW01W01.XEGCD) /* edf code*/
    if (SW01M001.XEGCD in XEGTBL.XEGCD)
      if (XEGTBL.XXXSTAT[sysVar.arrayIndex] == "A")
        /* next sentence*/
      else
        set SW01M001.XEGCD cursor, bold;
        converseLib.validationFailed(10); /* inactive field*/
        SW01M001.XXXLOCID = "530";
      end
    else
      set SW01M001.XEGCD cursor, bold;
      converseLib.validationFailed(364); /* invalid engineering difference code*/
      SW01M001.XXXLOCID = "530";
    end
  end

   /* ------------------------------------------------------------*/
   /* validate iseg code*/
   /* ------------------------------------------------------------*/

  if (SW01M001.PC2INSEG != SW01W01.PC2INSEG) /* seg code*/
    set PC2REC empty; /* Clear row storage area*/
    PC2REC.XGPCD = SW01M001.XGPCD;
    PC2REC.PC2INSEG = SW01M001.PC2INSEG;

    SW01S20(); /* select 's ' dprodc.vprdcu01*/

    if (SQLCA.VAGen_SQLCODE != 0) /* normal return*/
      set SW01M001.PC2INSEG cursor, bold;
      converseLib.validationFailed(365); /* invalid customer segment code*/
      SW01M001.XXXLOCID = "530";
    end
  end

   /* ------------------------------------------------------------*/
   /* Edit the quality code*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XQACD != SW01W01.XQACD) /* quality code*/
    if (SW01M001.XQACD in XQATBL.XQACD)
      if (XQATBL.XXXSTAT[sysVar.arrayIndex] == "A")
         /* next sentence*/
      else
        set SW01M001.XQACD cursor, bold;
        converseLib.validationFailed(10); /* inactive field*/
        SW01M001.XXXLOCID = "530";
      end
    else
      set SW01M001.XQACD cursor, bold;
      converseLib.validationFailed(366); /* invalid quality code*/
      SW01M001.XXXLOCID = "530";
    end
  end

   /* ------------------------------------------------------------*/
   /* Edit the dimension code*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XDMCD != SW01W01.XDMCD) /* Unit of measure entered*/
    if (SW01M001.XDMCD in XDMTBL.XDMCD)
      if (XDMTBL.XXXSTAT[sysVar.arrayIndex] == "A")
         /* next sentence*/
      else
        set SW01M001.XDMCD cursor, bold;
        converseLib.validationFailed(10); /* inactive field*/
        SW01M001.XXXLOCID = "530";
      end
    else
      set SW01M001.XDMCD cursor, bold;
      converseLib.validationFailed(367); /* inactive field*/
      SW01M001.XXXLOCID = "530";
    end
  end

   /* ------------------------------------------------------------*/
   /* Edit the product style color and dimension.*/
   /* ------------------------------------------------------------*/

  if (SW01M001.SY1STNBR != SW01W01.SY1STNBR
   || SW01M001.SY2CLRID != SW01W01.SY2CLRID)
    if (SW01M001.SY1STNBR == " " /* Style not entered*/
     || SW01M001.SY2CLRID == " ") /* color not entered*/
      if (SW01M001.SY2CLRID == " ") /* color not entered*/
        converseLib.validationFailed(9); /* required field*/
        SW01M001.XXXLOCID = "530";
        set SW01M001.SY2CLRID cursor, bold;
      end
      if (SW01M001.SY1STNBR == " ") /* Style not entered*/
        converseLib.validationFailed(9); /* required field*/
        SW01M001.XXXLOCID = "530";
        set SW01M001.SY1STNBR cursor, bold;
      end
    else

      set SYCREC empty;

      SYCREC.XGPCD = SW01M001.XGPCD;
      SYCREC.SY1STNBR = SW01M001.SY1STNBR;
      SYCREC.SY2CLRID = SW01M001.SY2CLRID;
      SYCREC.XDMCD = SW01M001.XDMCD;

      SW01S05(); /* ; validate using dprod.vcolor02*/

      if (SQLCA.VAGen_SQLCODE == 100) /* Row not found*/
        converseLib.validationFailed(56); /* Style/color is missing or invalid*/
        SW01M001.XXXLOCID = "530";
        set SW01M001.SY1STNBR cursor, bold;
        set SW01M001.SY2CLRID bold;
        set SW01M001.XDMCD bold;
        SW01M001.SY1SSTNM = " ";
        SW01M001.SY2CLRAB = " ";
      else
        SW01M001.SY1SSTNM = SYCREC.SY1SSTNM;
        SW01M001.SY2CLRAB = SYCREC.SY2CLRAB;
      end
    end
  else
    SW01M001.SY1SSTNM = SW01W01.SY1SSTNM;
    SW01M001.SY2CLRAB = SW01W01.SY2CLRAB;
  end

   /* ------------------------------------------------------------*/
   /* Edit the GPC code*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XGPCD != SW01W01.XGPCD) /* GPC code*/
    if (SW01M001.XGPCD in XGPTBL.XGPCD)
      if (XGPTBL.XXXSTAT[sysVar.arrayIndex] == "A")
         /* next sentence*/
      else
        set SW01M001.XGPCD cursor, bold;
        converseLib.validationFailed(10); /* inactive field*/
        SW01M001.XXXLOCID = "530";
      end
    else
      set SW01M001.XGPCD cursor, bold;
      converseLib.validationFailed(11); /* inactive field*/
      SW01M001.XXXLOCID = "530";
    end
  end

   /* ------------------------------------------------------------*/
   /* validate po number/id/type using xssls10*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XGPCD == SW01W01.XGPCD       /* gpc code*/
   && SW01M001.PC3PONBR == SW01W01.PC3PONBR /* po number*/
   && SW01M001.SWVWPOID == SW01W01.SWVWPOID /* po id*/
   && SW01M001.PC4ORTYP == SW01W01.PC4ORTYP) /* po type*/
    /* next sentence;*/
  else

    SW01531();

  end

   /* ------------------------------------------------------------*/
   /* validate whse/container combination*/
   /* ------------------------------------------------------------*/

  if (SW01M001.TSHCNTNR == " ")
    set SW01M001.TSHCNTNR cursor, bold;
    converseLib.validationFailed(9); /* required field*/
    SLWREC.XXXLOCID = "530";
  else

    set SL1REC empty; /* Clear row storage area*/
    SL1REC.XWHCD = SW01M001.XWHCD; /* warehouse*/
    SL1REC.TS3CNTNR = SW01M001.TSHCNTNR; /* container*/

    SW01535(); /* select 's ' dstloc.vrlhdr01*/

    if (SQLCA.VAGen_SQLCODE == 100) /* not found*/
      set SW01M001.TSHCNTNR cursor, bold; /* hilite*/
      converseLib.validationFailed(85); /* container not on file*/
      SLWREC.XXXLOCID = "530";
    else
      if (SQLCA.VAGen_SQLCODE == 0) /* normal*/

        if (SL1REC.YRSCD == "02"
         || SL1REC.YRSCD == "03"
         || SL1REC.YRSCD == "04")
          /* next sentence;*/
        else
          set SW01M001.XWHCD cursor;
          converseLib.validationFailed(317); /* receiving status invalid*/
          SLWREC.XXXLOCID = "530";
        end
      end
    end
  end

   /* ------------------------------------------------------------*/
   /* Edit whse code*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XWHCD == "  ")
    set SW01M001.XWHCD cursor, bold;
    converseLib.validationFailed(9); /* required field*/
    SLWREC.XXXLOCID = "530";
  else
    if (SW01M001.XWHCD in XWHTBL.XWHCD)
      if (XWHTBL.XXXSTAT[sysVar.arrayIndex] == "A")
        SW01M001.XWHABRV = XWHTBL.XWHABRV[sysVar.arrayIndex];
      else
        SW01M001.XWHABRV = " ";
        set SW01M001.XWHCD cursor, bold;
        converseLib.validationFailed(10); /* inactive*/
        SLWREC.XXXLOCID = "530";
      end
    else
      SW01M001.XWHABRV = " ";
      set SW01M001.XWHCD cursor, bold;
      converseLib.validationFailed(373); /* invalid warehouse code entered*/
      SLWREC.XXXLOCID = "530";
    end
  end

  if (converseVar.validationMsgNum == 0
   && SW01W00.SW01WPRF == "Y")
    if (SW01M001.SY2CLRID == " ") /* color not entered*/
      converseLib.validationFailed(9); /* required field*/
      SW01M001.XXXLOCID = "530";
      set SW01M001.SY2CLRID cursor, bold;
    end
    if (SW01M001.SY1STNBR == " ")
      converseLib.validationFailed(9); /* required field*/
      SW01M001.XXXLOCID = "530";
      set SW01M001.SY1STNBR cursor, bold;
    end
  end

end // end SW01530

// call xssls10 for po id/type
Function SW01531()
   /* ------------------------------------------------------------*/
   /* validate footwear*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XGPCD == "02") /* footwear*/
    if (SW01M001.PC3PONBR != 0)
      SW01532(); /* use 'id' function*/
    else
      if (SW01M001.SWVWPOID != " " /* po id*/
       || SW01M001.PC4ORTYP != " ") /* po type*/
        SW01533(); /* use 'no' function*/
      else
        converseLib.validationFailed(268); /* enter po id/type or po no*/
        SLWREC.XXXLOCID = "531"; /* appl module*/
        set SW01M001.PC4ORTYP bold;
        set SW01M001.SWVWPOID bold;
        set SW01M001.PC3PONBR cursor, bold;
      end
    end
  end

   /* ------------------------------------------------------------*/
   /* validate apparel*/
   /* ------------------------------------------------------------*/

  if (SW01M001.XGPCD == "03") /* apparel*/
    if (SW01M001.PC3PONBR != 0)
      SW01532(); /* use 'id' function*/
    else
      converseLib.validationFailed(9); /* enter po number*/
      SLWREC.XXXLOCID = "531"; /* appl module*/
      set SW01M001.PC3PONBR cursor, bold;
    end
  end


end // end SW01531

// call xssls10 for po number
Function SW01532()
   /* ------------------------------------------------------------*/
   /* move data to swvrec*/
   /* ------------------------------------------------------------*/

  set SWVREC empty; /* initialize swvrec*/
  SWVREC.XGPCD = SW01M001.XGPCD; /* gpc code*/
  SWVREC.PC3PONBR = SW01M001.PC3PONBR; /* po number*/
  SWVREC.SWVWFNC = "ID"; /* function*/

  XSSLS10(); /* obtain po id*/

   /* ------------------------------------------------------------*/
   /* If successful return code*/
   /* ------------------------------------------------------------*/

  if (SWVREC.SWVWRTN == 0) /* Call successful*/
    SW01M001.SWVWPOID = SWVREC.SWVWPOID; /* po id*/
    SW01M001.PC4ORTYP = SWVREC.PC4ORTYP; /* po type*/
  else
    set SW01M001.PC3PONBR cursor, bold; /* hilite po number*/
    converseLib.validationFailed(272); /* invalid po number*/
    SLWREC.XXXLOCID = "532"; /* appl module*/
  end

end // end SW01532

// call xssls10 for po id/type
Function SW01533()
   /* ------------------------------------------------------------*/
   /* move data to swvrec*/
   /* ------------------------------------------------------------*/

  set SWVREC empty; /* initialize swvrec*/
  SWVREC.XGPCD = SW01M001.XGPCD; /* gpc code*/
  SWVREC.SWVWPOID = SW01M001.SWVWPOID; /* po id*/
  SWVREC.PC4ORTYP = SW01M001.PC4ORTYP; /* po type*/
  SWVREC.SWVWFNC = "NO"; /* function*/

  XSSLS10(); /* obtain po id*/

   /* ------------------------------------------------------------*/
   /* If successful return code*/
   /* ------------------------------------------------------------*/

  if (SWVREC.SWVWRTN == 0) /* Call successful*/
    SW01M001.PC3PONBR = SWVREC.PC3PONBR; /* po number*/
  else
    set SW01M001.SWVWPOID cursor, bold; /* hilite po id*/
    set SW01M001.PC4ORTYP bold; /* hilite po type*/
    converseLib.validationFailed(271); /* invalid po id/type*/
    SLWREC.XXXLOCID = "533"; /* appl module*/
  end

end // end SW01533

// select 's ' dstloc.vrlhdr01
Function SW01535()
   /* ------------------------------------------------------------*/
   /* select set from dstloc.vrlhdr01*/
   /* ------------------------------------------------------------*/

  try
    call "IO1570" ("S ", SQLCA, SL1REC) {isNoRefresh = yes, isExternal = yes};
  end /* Select unq*/

   /* ------------------------------------------------------------*/
   /* If successful return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* Not found*/

      return;

    end
  end
   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that a system error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL Commarea*/

  SLWREC.XXXLOCID = "536"; /* module identification*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(31); /* Indicate not available*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(1); /* Indicate system error*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "SELECT UNQ ON DSTLOC.VRLHDR01";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = SLWREC.XXXLOCID; /* Program number*/
  TA1REC.TA1DBASE = "DSTLOC  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VRLHDR01"; /* Table view name*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SW01535

// Process valid input request
Function SW01600()

   /* ------------------------------------------------------------*/
   /* indicate map must be reformatted before display*/
   /* ------------------------------------------------------------*/

  SW01W00.SW01WSWF = "Y"; /* set format map switch*/

   /* ------------------------------------------------------------*/
   /* update working storage w01*/
   /* ------------------------------------------------------------*/

  SW01610(); /* move m001 to w01*/

   /* --------------------------------------------------------*/
   /* Build and submit PLAN RECONCILIATION SUMMARY REPORT.*/
   /* --------------------------------------------------------*/

  if (converseVar.eventKey is pf6) /* print report*/
    SW01620(); /* build/submit job SL4341*/
    return;
  end

   /* ------------------------------------------------------------*/
   /* Request to scroll back*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf7) /* backward*/
    SW01W00.XXXTSPAG = SW01W00.XXXTSPAG - 1; /* decrement page*/
    return;
  end

   /* ------------------------------------------------------------*/
   /* Request to scroll forward*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf8) /* forward*/
    SW01W00.XXXTSPAG = SW01W00.XXXTSPAG + 1; /* increment page*/
    return;
  end

   /* ------------------------------------------------------------*/
   /* Display new request*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is enter
   && SW01W00.SW01WSWR == "Y") /* KEY DATA MODIFIED*/
    SW01W00.SW01WMOD = "N";
    SW01W01.CACHGFL = "N";
    return;
  end

   /* --------------------------------------------------------*/
   /* request to transfer to Plan Reconciliation detail.*/
   /* --------------------------------------------------------*/

  if (converseVar.eventKey is pf16) /* transfer to application sw02*/

    COMMAREA.XWHCD = SW01M001.XWHCD;
    SLWREC.TSHCNTNR = SW01M001.TSHCNTNR;
    COMMAREA.CATOAP = "SW02"; /* transfer to applicaiton*/

    SW01S01(); /* Purge temp storage*/

    XSSL001(); /* Exit to another application*/

    set SW01M001.CATOAP cursor, bold; /* Highlight*/

    exit stack; /* Exit to display map*/

  end

end // end SW01600

// move m001 to w01
Function SW01610()

   /* ------------------------------------------------------------*/
   /* move key data fields from the map (m001) to work rec (m001)*/
   /* ------------------------------------------------------------*/

  SW01W01.XWHCD = SW01M001.XWHCD;
  if (SW01W01.XWHCD in XWHTBL.XWHCD)
    SW01W01.XWHABRV = XWHTBL.XWHABRV[sysVar.arrayIndex];
  end /* warehouse desc*/

  SW01W01.TSHCNTNR = SW01M001.TSHCNTNR;
  SW01W01.PC3PONBR = SW01M001.PC3PONBR;
  SW01W01.SWVWPOID = SW01M001.SWVWPOID;
  SW01W01.PC4ORTYP = SW01M001.PC4ORTYP;
  SW01W01.XGPCD = SW01M001.XGPCD;
  SW01W01.SY1STNBR = SW01M001.SY1STNBR;
  SW01W01.SY2CLRID = SW01M001.SY2CLRID;
  SW01W01.XDMCD = SW01M001.XDMCD;
  SW01W01.XQACD = SW01M001.XQACD;
  SW01W01.PC2INSEG = SW01M001.PC2INSEG;
  SW01W01.XEGCD = SW01M001.XEGCD;
  SW01W01.XPGCD = SW01M001.XPGCD;
  SW01W01.XUMCD = SW01M001.XUMCD;
  SW01W01.XOWCD = SW01M001.XOWCD;
  SW01W01.XSLCD = SW01M001.XSLCD;


end // end SW01610

// Process valid input request
Function SW01620()
   /* ------------------------------------------------------------*/
   /* process valid input request*/
   /* ------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* format plan reconciliation summary parameter*/
   /* ------------------------------------------------------------*/

  set SW01W04 empty;

  SW01W04.XWHCD1 = SW01M001.XWHCD; /* warehouse code*/
  SW01W04.TSHCNTNR = SW01M001.TSHCNTNR; /* container*/
  SW01W04.XURUSRNM = SW01M001.XURUSRNM; /* user name*/

   /* ------------------------------------------------------------*/
   /* Initialize the work area and indexes to be used.*/
   /* ------------------------------------------------------------*/

  move " " to TA6REC.TA6ROW[1] for all; /* Clear JCL array rows*/

  SW01W00.SW01WIXT = 1; /* input table*/
  TA6REC.TA6INDEX = 1; /* Output array index*/

   /* ------------------------------------------------------------*/
   /* Format JCL and parameters into the subroutine work area.*/
   /* ------------------------------------------------------------*/

  while (TA6REC.TA6INDEX > 0) /* Until end of table*/

    if (SW01T01.TARTYPE[SW01WIXT] == "P") /* Parameters statement*/
      TA6REC.TARJCL[TA6INDEX] = SW01W04.SW01WPRM; /* Parameters*/
    else
      if (SW01T01.TARTYPE[SW01WIXT] == "S") /* symbolic*/
        SW01W04.SW01WSYM = SW01T01.TARJCL[SW01WIXT];
        SW01W04.XWHCD2 = SW01M001.XWHCD; /* warehouse code*/
        TA6REC.TARJCL[TA6INDEX] = SW01W04.SW01WSYM; /* symbolic*/
      else
        if (SW01T01.TARTYPE[SW01WIXT] == "D") /* symbolic*/
          SW01W04.SW01WDAS = SW01T01.TARJCL[SW01WIXT];
          SW01W04.XWHCD3 = SW01M001.XWHCD; /* warehouse code*/
          TA6REC.TARJCL[TA6INDEX] = SW01W04.SW01WDAS; /* symbolic*/
        else
          /* ------------------------------------------------------------*/
           /* Format the Job Control Language statement from the table.*/
          /* ------------------------------------------------------------*/

          TA6REC.TARJCL[TA6INDEX] = SW01T01.TARJCL[SW01WIXT]; /* JCL*/
          TA6REC.TARTYPE[TA6INDEX] = SW01T01.TARTYPE[SW01WIXT]; /* Type*/

        end
      end
    end

    TA6REC.TA6INDEX = TA6REC.TA6INDEX + 1; /* Output array index*/

    /* ------------------------------------------------------------*/
     /* If not end of table, increment the table index.*/
    /* ------------------------------------------------------------*/

    if (SW01T01.TARJCL[SW01WIXT] == "/*EOF") /* End of table*/

      TA6REC.TA6INDEX = 0; /* Indicate end of table*/
    else
      SW01W00.SW01WIXT = SW01W00.SW01WIXT + 1; /* Input table index*/

    end

  end

   /* ------------------------------------------------------------*/
   /* Submit the JCL and parameters for batch execution.*/
   /* ------------------------------------------------------------*/

  TA6REC.TA6SUBSW = "Y"; /* Tailor and submit the JCL*/
  TA6REC.TA6MSGSW = "Y"; /* EOJ online message switch*/

  XPTA0P(); /* Submit JCL for background job*/

   /* ------------------------------------------------------------*/
   /* If submit was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  SLWREC.XXXLOCID = "620"; /* Module identification*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA6REC.TA6RTNCD == "0")        /* and normal return*/

    SW01W00.SW01WSWF = "Y"; /* format map switch*/

    SLWREC.SLWMSGNO = 059; /* print request submitted*/

    set SW01M001 initial; /* Clear map output area*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode != "00000000" /* Call not successful*/
   || TA6REC.TA6RTNCD > "1")         /* or unexpected error*/

    converseLib.validationFailed(01); /* Unexpected error occurred*/

  end

  exit stack; /* Exit to display map*/



end // end SW01620

// purge temporary storage
Function SW01S01()
   /* ------------------------------------------------------------*/
   /* Initialize the storage areas and indicators to be used.*/
   /* ------------------------------------------------------------*/

  set SW01W03 empty; /* M001 temporary storage*/

  TA5REC.TA5TSQIX = 0; /* Current page number*/
  SW01W00.TA5TSQIX = 0; /* Highest page number*/

   /* ------------------------------------------------------------*/
   /* Purge any temporary storage for this application.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5APPID = COMMAREA.CACURRAP; /* Application identification*/
  TA5REC.TA5FNCCD = "P"; /* Function code*/

  try
    call "TA0050" (SW01W03, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Temporary storage*/

   /* ------------------------------------------------------------*/
   /* If successful, return to previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (TA5REC.TA5RTNCD == 0 /* and normal return code*/
     || TA5REC.TA5RTNCD == 4) /* and not found*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that a system error occurred.*/
   /* ------------------------------------------------------------*/

  TAEREC.TAEDESC1 = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC2 = TA5REC.TA5DATA; /* Subroutine parameters*/

  SLWREC.XXXLOCID = "S01"; /* Module identification*/
  converseLib.validationFailed(01); /* Indicate system error*/

  TA1REC.TA1FUNC = "RETN"; /* Termination function*/
  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1LOC = "PURGE ANY TEMPORARY STORAGE";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = SLWREC.XXXLOCID; /* Program number*/
  TA1REC.TA1MAPAP = COMMAREA.CACURRAP; /* Map application*/
  TA1REC.TA1MAPNO = "M001"; /* Map number*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SW01S01

// sel 's' dstloc.vrlhdr01 row
Function SW01S02()
   /* ------------------------------------------------------------*/
   /* Select dstloc.vrlhdr01 table row*/
   /* ------------------------------------------------------------*/

  try
    call "IO1570" ("S ", SQLCA, SL1REC) {isNoRefresh = yes, isExternal = yes};
  end /* Select set*/

   /* ------------------------------------------------------------*/
   /* If successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* row not found*/

      return;

    end
  end
   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that a system error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL Commarea*/

  SLWREC.XXXLOCID = "S02"; /* Module identification*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(31); /* Indicate not available*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(1); /* Indicate system error*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "SELECT THE TABLE ROW";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = SLWREC.XXXLOCID; /* Program number*/
  TA1REC.TA1DBASE = "DSTLOC  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VRLHDR01"; /* Table view name*/
  TA1REC.TA1TBLKE = SL1REC.SL1KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SW01S02

// sel 's' dprod.vcolor02 row
Function SW01S05()

   /* ------------------------------------------------------------*/
   /* Select dprod.vcolor02 table row*/
   /* ------------------------------------------------------------*/

  try
    call "IO0560" ("S ", SQLCA, SYCREC) {isNoRefresh = yes, isExternal = yes};
  end /* Select set*/

   /* ------------------------------------------------------------*/
   /* If successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* row not found*/

      return;

    end
  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that a system error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL Commarea*/

  SLWREC.XXXLOCID = "S05"; /* Module identification*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(31); /* Indicate not available*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(1); /* Indicate system error*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "SELECT S TABLE ROW";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = SLWREC.XXXLOCID; /* Program number*/
  TA1REC.TA1DBASE = "DPROD  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VCOLOR02"; /* Table view name*/
  TA1REC.TA1TBLKE = SYCREC.SYCKEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/



end // end SW01S05

// sz id to sz desc using xssypi1
Function SW01S06()

   /* ------------------------------------------------------------*/
    /* This routine will translate the size id to size desc*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1LOCAT[2] = "SW01S06 ";
  TA1REC.TA1MAP = SLWREC.SLWTAMAP;

  XSSYPI1(); /* <=== get size xlations*/

  if (SYPREC.SYPRC == 0)
     /* ** next sentence ***/
  else
    if (SYPREC.SYPRC > 8)
      if (SYPREC.SYPRC == +10)
        SLWREC.XXXLOCID = "S06";
        converseLib.validationFailed(12); /* <--- not on db msg*/
      else
        if (SYPREC.SYPRC == +9)
          SLWREC.XXXLOCID = "S06";
          converseLib.validationFailed(31); /* <--- try again msg*/
        else
          SLWREC.XXXLOCID = "S06";
          converseLib.validationFailed(1); /* <--- severe error msg*/
        end
        exit stack;
      end
    end
  end


end // end SW01S06

// sel 's5' dstloc.vwophd01
Function SW01S07()
   /* ------------------------------------------------------------*/
   /* select set from dstloc.vwophd01*/
   /* ------------------------------------------------------------*/

  try
    call "IO5400" ("S5", SQLCA, SLLREC) {isNoRefresh = yes, isExternal = yes};
  end /* Select set*/

   /* ------------------------------------------------------------*/
   /* If successful return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    return;

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that a system error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL Commarea*/

  SLWREC.XXXLOCID = "S07"; /* module identification*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(31); /* Indicate not available*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(1); /* Indicate system error*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "SELECT S5 ON DSTLOC.VWOPHD01";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = SLWREC.XXXLOCID; /* Program number*/
  TA1REC.TA1DBASE = "DSTLOC  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VWOPHD01"; /* Table view name*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SW01S07

// fetch 'n5' dstloc.vwophd01
Function SW01S08()
   /* ------------------------------------------------------------*/
   /* fetch dstloc.vwophd01*/
   /* ------------------------------------------------------------*/

  try
    call "IO5400" ("N5", SQLCA, SLLREC) {isNoRefresh = yes, isExternal = yes};
  end /* Select set*/

   /* ------------------------------------------------------------*/
   /* If successful return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* row not found*/

      return;

    end
  end
   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that a system error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL Commarea*/

  SLWREC.XXXLOCID = "S08"; /* module identification*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(31); /* Indicate not available*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(1); /* Indicate system error*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "FETCH N5 ON DSTLOC.VWOPHD01";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = SLWREC.XXXLOCID; /* Program number*/
  TA1REC.TA1DBASE = "DSTLOC  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VWOPHD01"; /* Table view name*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SW01S08

// close 'c5' dstloc.vwophd01
Function SW01S09()
   /* ------------------------------------------------------------*/
   /* close dstloc.vwophd01*/
   /* ------------------------------------------------------------*/

  try
    call "IO5400" ("C5", SQLCA, SLLREC) {isNoRefresh = yes, isExternal = yes};
  end /* Select set*/

   /* ------------------------------------------------------------*/
   /* If successful return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* Normal return code*/

    return;

  end
   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that a system error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL Commarea*/

  SLWREC.XXXLOCID = "S09"; /* module identification*/
  converseLib.clearScreen();
   /* Clear screen before display*/
  converseLib.validationFailed(1); /* Indicate system error*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/
  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "CLOSE C5 ON DSTLOC.VWOPHD01";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = SLWREC.XXXLOCID; /* Program number*/
  TA1REC.TA1DBASE = "DSTLOC  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VWOPHD01"; /* Table view name*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SW01S09

// sel 's' dstloc.vrlcmp01 row
Function SW01S10()
   /* ------------------------------------------------------------*/
   /* Select dstloc.vrlcmp01 table row*/
   /* ------------------------------------------------------------*/

  try
    call "IO4930" ("S ", SQLCA, SLKREC) {isNoRefresh = yes, isExternal = yes};
  end /* Select set*/

   /* ------------------------------------------------------------*/
   /* If successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* row not found*/

      return;

    end
  end
   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that a system error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL Commarea*/

  SLWREC.XXXLOCID = "S10"; /* Module identification*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(31); /* Indicate not available*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(1); /* Indicate system error*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "SELECT THE TABLE ROW";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = SLWREC.XXXLOCID; /* Program number*/
  TA1REC.TA1DBASE = "DSTLOC  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VRLCMP01"; /* Table view name*/
  TA1REC.TA1TBLKE = SLKREC.XWHCD; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SW01S10

// sel 's1' dstloc.vrlcmp01
Function SW01S11()

   /* ------------------------------------------------------------*/
   /* select set dstloc.vrlcmp01*/
   /* ------------------------------------------------------------*/

  try
    call "IO4930" ("S1", SQLCA, SLKREC) {isNoRefresh = yes, isExternal = yes};
  end /* Select set*/

   /* ------------------------------------------------------------*/
   /* If successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/

      return;

    end
  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that a system error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL Commarea*/

  SLWREC.XXXLOCID = "S11"; /* Module identification*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(31); /* Indicate not available*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(1); /* Indicate system error*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "SELECT S1 TABLE DSTLOC.VRLCMP01";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = SLWREC.XXXLOCID; /* Program number*/
  TA1REC.TA1DBASE = "DSTLOC  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VRLCMP01"; /* Table view name*/
  TA1REC.TA1TBLKE = SW01W01.SW01WKEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SW01S11

// fetch 'n1' dstloc.vrlcmp01
Function SW01S12()
   /* ------------------------------------------------------------*/
   /* fetch dstloc.vrlcmp01 row*/
   /* ------------------------------------------------------------*/

  try
    call "IO4930" ("N1", SQLCA, SLKREC) {isNoRefresh = yes, isExternal = yes};
  end /* Select set*/

   /* ------------------------------------------------------------*/
   /* If successful or not found, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/
      return;
    end

    if (SQLCA.VAGen_SQLCODE == 100) /* not found*/
      SW01W00.SW01WEOF = "Y"; /* eof flag*/
      return;
    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that a system error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL Commarea*/

  SLWREC.XXXLOCID = "S12"; /* Module identification*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(31); /* Indicate not available*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(1); /* Indicate system error*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "FETCH N1 DSTLOC.VRLCMP01 ROW  ";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = SLWREC.XXXLOCID; /* Program number*/
  TA1REC.TA1DBASE = "DSTLOC  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VRLCMP01"; /* Table view name*/
  TA1REC.TA1TBLKE = SW01W01.SW01WKEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SW01S12

// close 'c1' dstloc.vrlcmp01
Function SW01S13()
   /* ------------------------------------------------------------*/
   /* close dstloc.vrlcmp01 row*/
   /* ------------------------------------------------------------*/

  try
    call "IO4930" ("C1", SQLCA, SLKREC) {isNoRefresh = yes, isExternal = yes};
  end /* Select set*/

   /* ------------------------------------------------------------*/
   /* If successful or not found, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/

      return;

    end
  end

  SLWREC.XXXLOCID = "S13";
  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "CLOSE C1 DSTLOC.VRLCMP01";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = SLWREC.XXXLOCID; /* Program number*/
  TA1REC.TA1DBASE = "DSTLOC  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VRLCMP01"; /* Table view name*/
  TA1REC.TA1TBLKE = SW01W01.SW01WKEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SW01S13

// sel 'ss' dstloc.vrlitm01
Function SW01S16()
   /* ------------------------------------------------------------*/
   /* Select dstloc.vrlitm01 table row*/
   /* ------------------------------------------------------------*/

  set SLSREC empty; /* Clear row storage area*/
  SLSREC.SLSFNC = "SS"; /* function*/

  try
    call "IO1580" (SLSREC, SQLCA, SL2REC) {isNoRefresh = yes, isExternal = yes};
  end /* Select set*/

   /* ------------------------------------------------------------*/
   /* If successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/

      return;

    end
  end
   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that a system error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL Commarea*/

  SLWREC.XXXLOCID = "S16"; /* Module identification*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(31); /* Indicate not available*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(1); /* Indicate system error*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback();
  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "SELECT SUM          ";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = SLWREC.XXXLOCID; /* Program number*/
  TA1REC.TA1DBASE = "DSTLOC  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VRLITM01"; /* Table view name*/
  TA1REC.TA1TBLKE = SL2REC.SL2KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/



end // end SW01S16

// sel 'ss' dstloc.vwophd02
Function SW01S17()
   /* ------------------------------------------------------------*/
   /* select set from dstloc.vwophd02*/
   /* ------------------------------------------------------------*/

  set SLSREC empty;
  SLSREC.SLSFNC = "SS";

  try
    call "IO5460" (SLSREC, SQLCA, SLOREC) {isNoRefresh = yes, isExternal = yes};
  end /* Select set*/

   /* ------------------------------------------------------------*/
   /* If successful return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/

      return;

    end
  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that a system error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL Commarea*/

  SLWREC.XXXLOCID = "S17"; /* module identification*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(31); /* Indicate not available*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(1); /* Indicate system error*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "SELECT SS ON DSTLOC.VWOPHD02";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = SLWREC.XXXLOCID; /* Program number*/
  TA1REC.TA1DBASE = "DSTLOC  "; /* Data base name*/
  TA1REC.TA1TBLVU = "VWOPHD02"; /* Table view name*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SW01S17

// sel 's ' dprodc.vprdcu01 row
Function SW01S20()
   /* ------------------------------------------------------------*/
   /* Select dprodc.vprdcu01 table row*/
   /* ------------------------------------------------------------*/

  try
    call "IO3340" ("SG", SQLCA, PC2REC) {isNoRefresh = yes, isExternal = yes};
  end /* Select set*/

   /* ------------------------------------------------------------*/
   /* If successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* row not found*/

      return;

    end
  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that a system error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL Commarea*/

  SLWREC.XXXLOCID = "S20"; /* Module identification*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(31); /* Indicate not available*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(1); /* Indicate system error*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "SELECT S TABLE ROW";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = SLWREC.XXXLOCID; /* Program number*/
  TA1REC.TA1DBASE = "DSTLOC "; /* Data base name*/
  TA1REC.TA1TBLVU = "VPRDCU01"; /* Table view name*/
  TA1REC.TA1TBLKE = PC2REC.PC2KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SW01S20

// read temporary storage
Function SW01S25()
   /* ------------------------------------------------------------*/
   /* Obtain the next page of orders to display.*/
   /* ------------------------------------------------------------*/

  SW01W03.XXXTSLEN = SW01W00.XXXTSLEN; /* temp storage length*/
  TA5REC.TA5TSQIX = SW01W00.XXXTSPAG; /* page number*/
  TA5REC.TA5APPID = "SW01"; /* Application identification*/
  TA5REC.TA5FNCCD = "R"; /* Function code*/

  call "TA0050" (SW01W03, TA5REC) {isNoRefresh = yes, isExternal = yes};
                                   /* Temporary storage subroutine*/

  if (sysVar.errorCode == "00000000" /* successful call*/
   && TA5REC.TA5RTNCD == 0)          /* normal return code*/

    return; /* Return to previous process*/

  end
  converseLib.validationFailed(1); /* Indicate system error*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/
  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = "SW01S25"; /* Process name*/
  TA1REC.TA1LOC = "READ PAGE FROM TEMPORARY STORAGE";
  TA1REC.TA1MAP = "SW01M001"; /* Map name*/
  SQLCA.SQLCAREC = TA5REC.TA5DATA; /* Subroutine parameters*/

  call "TA0020" (TA1REC, SQLCA) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  SLWREC.XXXLOCID = "S25 "; /* Error location*/
  exit stack;

end // end SW01S25

// add temporary storage
Function SW01S28()
   /* ------------------------------------------------------------*/
   /* add page to temporary storage.*/
   /* ------------------------------------------------------------*/

  SW01W03.XXXTSLEN = SW01W00.XXXTSLEN; /* temp storage length*/
  TA5REC.TA5APPID = "SW01"; /* Application identification*/
  TA5REC.TA5FNCCD = "A"; /* Function code*/

  call "TA0050" (SW01W03, TA5REC) {isNoRefresh = yes, isExternal = yes};
                                   /* Temporary storage subroutine*/

  if (TA5REC.TA5RTNCD != 0) /* Error was found*/

    converseLib.validationFailed(1); /* Indicate system error*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    TA1REC.TA1TYPE = "APPL"; /* Type of error*/
    TA1REC.TA1PGMNM = "SW01S25"; /* Process name*/
    TA1REC.TA1LOC = "READ PAGE FROM TEMPORARY STORAGE";
    TA1REC.TA1MAP = "SW01M001"; /* Map name*/
    SQLCA.SQLCAREC = TA5REC.TA5DATA; /* Subroutine parameters*/

    call "TA0020" (TA1REC, SQLCA) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

    SLWREC.XXXLOCID = "S25 "; /* Error location*/
    return; /* Return to previous process*/

  end

  SW01W00.TA5TSQIX = TA5REC.TA5TSQIX; /* highest page*/

end // end SW01S28

//*** RECORD=SW01W00 ****
// ------------------------------------------------------------
// APPLICATION WORKING STROAGE.
// ------------------------------------------------------------
// ***********************
Record SW01W00 type basicRecord
  10 SW01WSWR SW01WSWR ; 
  10 SW01WSWF SW01WSWF ; 
  10 SW01WPRF SW01WPRF ; 
  10 SW01WEOF SW01WEOF ; 
  10 SW01WTFL SW01WTFL ; 
  10 SW01WMOD SW01WMOD ; 
  10 SW01WIDX SW01WIDX ; 
  10 SW01WLIX SW01WLIX ; 
  10 SW01WIXT SW01WIXT ; 
  10 SW01WSHP SW01WSHP ; 
  10 SW01WRCV SW01WRCV ; 
  10 SW01WDIF SW01WDIF ; 
  10 XGPCD XGPCD ; 
  10 XDMCD XDMCD ; 
  10 PC2INSEG PC2INSEG ; 
  10 XQACD XQACD ; 
  10 XEGCD XEGCD ; 
  10 XPGCD XPGCD ; 
  10 XUMCD XUMCD ; 
  10 XOWCD XOWCD ; 
  10 XSLCD XSLCD ; 
  10 YRSCD YRSCD ; 
  10 XXXTSLEN XXXTSLEN ; 
  10 XXXTSPAG XXXTSPAG ; 
  10 SW01WPAG SW01WPAG ; 
  10 SW01W3PG SW01W3PG ; 
  10 SW01W3PM SW01W3PM ; 
  10 SW01WRMD SW01WRMD ; 
  10 TA5TSQIX TA5TSQIX ; 
end // end SW01W00

//*** RECORD=SW01W01 ****
// ------------------------------------------------------------
// Map 001 display storage
// ------------------------------------------------------------
// ***********************
Record SW01W01 type basicRecord
  5 SW01WGP1 SW01WGP1 ; 
    10 SW01WKEY SW01WKEY ; 
      15 XWHCD XWHCD ; 
      15 TSHCNTNR TSHCNTNR ; 
    10 XWHABRV XWHABRV ; 
    10 SWEPLLNB SWEPLLNB ; 
    10 YRSCD YRSCD ; 
    10 YRSABRV YRSABRV ; 
    10 XITCD XITCD ; 
    10 SL1RCRNO SL1RCRNO ; 
    10 XARCD XARCD ; 
    10 SL4ZONE SL4ZONE ; 
    10 SL1CRTBY SL1CRTBY ; 
    10 IN7STNBR IN7STNBR ; 
    10 SL8WOGRP SL8WOGRP ; 
    10 SW01WSTA SW01WSTA ; 
    10 TSOCRTNB TSOCRTNB ; 
    10 SL2CASE SL2CASE ; 
    10 * char(1) ; 
    10 PC3PONBR PC3PONBR ; 
    10 SWVWPOID SWVWPOID ; 
    10 PC4ORTYP PC4ORTYP ; 
    10 XGPCD XGPCD ; 
    10 SY1STNBR SY1STNBR ; 
    10 SY2CLRID SY2CLRID ; 
    10 XDMCD XDMCD ; 
    10 XQACD XQACD ; 
    10 XLCCD XLCCD ; 
    10 PC2INSEG PC2INSEG ; 
    10 XEGCD XEGCD ; 
    10 XPGCD XPGCD ; 
    10 XUMCD XUMCD ; 
    10 XOWCD XOWCD ; 
    10 XSLCD XSLCD ; 
    10 SY1SSTNM SY1SSTNM ; 
    10 SY2CLRAB SY2CLRAB ; 
    10 XURUSRNM XURUSRNM ; 
      15 XURUSRID XURUSRID ; 
      15 SW01WDSH SW01WDSH ; 
      15 SW01WLTR SW01WLTR ; 
      15 * char(4) ; 
    10 CACHGFL CACHGFL ; 
end // end SW01W01

//*** RECORD=SW01W02 ****
// ------------------------------------------------------------
// WORKING STORAGE - LOAD/ACCUMULATE DETAIL DATA FOR 40 SIZES
// ------------------------------------------------------------
// ***********************
Record SW01W02 type basicRecord
  5 SW01WGP5 SW01WGP5 ; 
    10 SW01W2IX SW01W2IX ; 
    10 SW01W2MX SW01W2MX ; 
    10 * char(27) [40] ; 
      15 SY5SZID SY5SZID ; 
      15 SY4IDDSC SY4IDDSC ; 
      15 SW01WSHP SW01WSHP ; 
      15 SW01WRCV SW01WRCV ; 
      15 SW01WDIF SW01WDIF ; 
      15 SL2RCVD SL2RCVD ; 
      15 SL9WOQTY SL9WOQTY ; 
    10 * char(20) ; 
      15 SW01WSHT SW01WSHT ; 
      15 SW01WRCT SW01WRCT ; 
      15 SW01WDFT SW01WDFT ; 
      15 SW01WUXT SW01WUXT ; 
      15 SW01WUPT SW01WUPT ; 
end // end SW01W02

//*** RECORD=SW01W03 ****
// ------------------------------------------------------------
// WORKING STORAGE - USED WHEN ADDING TO TEMPORARY STORAGE
// ------------------------------------------------------------
// ***********************
Record SW01W03 type basicRecord
  5 XXXTSLEN XXXTSLEN ; 
  5 SW01WGP3 SW01WGP3 ; 
    10 SW01W3IX SW01W3IX ; 
    10 SW01W3MX SW01W3MX ; 
    10 SW01W3PG SW01W3PG ; 
    10 SW01W3PM SW01W3PM ; 
    10 * char(15) ; 
    10 PC3PONBR PC3PONBR ; 
    10 SWVWPOID SWVWPOID ; 
    10 PC4ORTYP PC4ORTYP ; 
    10 SW01WSTA SW01WSTA ; 
    10 XGPCD XGPCD ; 
    10 SY1STNBR SY1STNBR ; 
    10 SY2CLRID SY2CLRID ; 
    10 XDMCD XDMCD ; 
    10 XQACD XQACD ; 
    10 XLCCD XLCCD ; 
    10 PC2INSEG PC2INSEG ; 
    10 XEGCD XEGCD ; 
    10 XPGCD XPGCD ; 
    10 XUMCD XUMCD ; 
    10 XOWCD XOWCD ; 
    10 XSLCD XSLCD ; 
    10 SY1SSTNM SY1SSTNM ; 
    10 SY2CLRAB SY2CLRAB ; 
    10 * char(25) [8] ; 
      15 SY4IDDSC SY4IDDSC ; 
      15 SW01WSHP SW01WSHP ; 
      15 SW01WRCV SW01WRCV ; 
      15 SW01WDIF SW01WDIF ; 
      15 SL2RCVD SL2RCVD ; 
      15 SL9WOQTY SL9WOQTY ; 
    10 * char(20) ; 
      15 SW01WSHT SW01WSHT ; 
      15 SW01WRCT SW01WRCT ; 
      15 SW01WDFT SW01WDFT ; 
      15 SW01WUXT SW01WUXT ; 
      15 SW01WUPT SW01WUPT ; 
end // end SW01W03

//*** RECORD=SW01W04 ****
// ------------------------------------------------------------
// PARAMETERS FOR SL434D - PLAN RECONCILIATION SUMMARY REPORT
// ------------------------------------------------------------
// ***********************
Record SW01W04 type basicRecord
  5 SW01WPRM SW01WPRM ; 
    10 XWHCD1 XWHCD1 ; 
    10 TSHCNTNR TSHCNTNR ; 
    10 XURUSRNM XURUSRNM ; 
    10 * char(44) ; 
  5 SW01WSYM SW01WSYM ; 
    10 * char(21) ; 
    10 XWHCD2 XWHCD2 ; 
    10 * char(57) ; 
  5 SW01WDAS SW01WDAS ; 
    10 * char(52) ; 
    10 XWHCD3 XWHCD3 ; 
    10 * char(26) ; 
end // end SW01W04

// size index
DataItem SW01W2IX smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// max sizes
DataItem SW01W2MX smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// temp storage index
DataItem SW01W3IX smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// max lines per page
DataItem SW01W3MX smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// current page
DataItem SW01W3PG smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// max pages
DataItem SW01W3PM smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem SW01WDAS char(80)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// total qty difference
DataItem SW01WDFT int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = "0", dateFormat = "yy-MM-dd", inputRequired = no
}
end

// qty difference
DataItem SW01WDIF int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = "0", dateFormat = "yy-MM-dd", inputRequired = no
}
end

// ' - '
DataItem SW01WDSH char(3)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// EOF flag
DataItem SW01WEOF char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// sw01w01 group level
DataItem SW01WGP1 char(173)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem SW01WGP3 char(316)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem SW01WGP5 char(1104)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// work index
DataItem SW01WIDX smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = "0", inputRequired = no
}
end

// jcl index
DataItem SW01WIXT smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = "0", inputRequired = no
}
end

DataItem SW01WKEY char(16)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// load index
DataItem SW01WLIX smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = "0", inputRequired = no
}
end

// LITERIAL 'UNKNOWN'
DataItem SW01WLTR char(7)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// data modified switch
DataItem SW01WMOD char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// hold page number
DataItem SW01WPAG num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// request product flag
DataItem SW01WPRF char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem SW01WPRM char(80)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// total receiving qty
DataItem SW01WRCT int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = "0", dateFormat = "yy-MM-dd", inputRequired = no
}
end

// receiving qty
DataItem SW01WRCV int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = "0", dateFormat = "yy-MM-dd", inputRequired = no
}
end

// reaminder
DataItem SW01WRMD smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// shipped qty
DataItem SW01WSHP int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = "0", dateFormat = "yy-MM-dd", inputRequired = no
}
end

// total shipped qty
DataItem SW01WSHT int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = "0", dateFormat = "yy-MM-dd", inputRequired = no
}
end

// prod set aside
DataItem SW01WSTA char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Format the map switch
DataItem SW01WSWF char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Request for data switch
DataItem SW01WSWR char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem SW01WSYM char(80)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// translate size desc flag
DataItem SW01WTFL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// total unprt qty
DataItem SW01WUPT int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// total unexp qty
DataItem SW01WUXT int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

