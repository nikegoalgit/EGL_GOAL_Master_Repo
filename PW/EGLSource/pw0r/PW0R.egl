package pw0r;
import corpcom1.*;
import corpcom3.*;
import corpcom4.*;
import corpcom5.*;
import corpcom6.*;
import corpcom7.*;
import corpx1.*;
import corpx2.*;
import corpz3.*;
import gd00.GD00M;
import in1.common.*;
import op.common.*;
import pk.common.*;
import pw.common.*;
import ta.common.*;
import tf.common.*;
import ts.common.*;
//*** PROGRAM=PW0R ****
// This application allows users to see the unit totals that
// have been previously selected.  The program can be accessed
// from the menu or any program within the Memphis Apparel
// Picking (and Pick Planning) Selection screens.  This screen
// is for inquiry only.
// 
// The user can transfer out of this application by using one
// of the PF keys displayed at the bottom of the map, or by
// entering FastPath information (also at the bottom of map).
// 
// -------   --------  ------  --------------------------------
// CONTROL     DATE     NAME   DESCRIPTION OF CHANGE
// -------   --------  ------  --------------------------------
// NEW       01/14/91  MSMIT3  New Application
// add       04/16/91  SBEAUC  Add selected order line
// fix       04/24/91  SBEAUC  Remove accumulation of VSELOR01
//                             amounts from 'by qty' lines.
// fix       09/24/91  SHENDE  Program wasn't displaying sel'd
//                             by order (stock transfer) qty.
// fix       09/25/91  SHENDE  Allow access to whse '07' and
//                             Wilsonville changes.
//           03/10/92  SHENDE  Correct error diag in PW0R116.
// fix       03/16/92  SHENDE  Allow access to whse '02' & '04'
// fix       03/16/92  SHENDE  Allow access to whse '02' & '04'
//           04/20/92  SHENDE  Include qtys for in-store promo
//                             and add in-store promo lines.
//           05/15/92  GRAY    CALCULATE AND DISPLAY PICK TIME.
//                             and add in-store promo lines.
// tbl chgs  06/24/92  MWALTO  Move '*' to gpc before call
//                             io5500 in pw0r115.
// ColeHaan  07/27/92  SHENDE  Display brand cd and brand total
//                             Also, allow wildcard for brand.
//           07/29/93  RCREAM  Added a second map for Picking
//                             screen to display as pink. Also
//                             made logic changes to 000,200,
//                             210,300. Added conv-map1 & map2.
//           10/13/93  kande1  rename new procs for standards
// pk00      12/06/93  hchapm  added "extra qty" fields
// pk00      08/30/95  Ryonke  Added warehouse specific logic
//                             for Canada warehouse (whse=42).
// y2kfix    02/09/98  pharwo  y2k changes to pw0r000.
// TT#3670   09/25/00  jsunda  A new row for Equipment is added
//                             in the Map and a new procedure
//                             PW0R170 is added to handle equi-
//                             -pments quantities.
//                             Also new selection type codes
//                             24 thru 41 are added in the
//                             application for footwear and
//                             apparel.
// *********************
Program PW0R type textUIProgram //VAGen Info - main text program
  {
  includeReferencedFunctions = yes, allowUnqualifiedItemReferences = yes, 
  throwNrfEofExceptions = yes, handleHardIOErrors = no, V60ExceptionCompatibility = yes, 
  I4GLItemsNullable = no, textLiteralDefaultIsString = no, localSQLScope = yes, 
  msgTablePrefix = "PK00", inputRecord = COMMAREA, segmented = yes
  }

  // Data Declarations
  COMMAREA COMMAREA ; // record
  PKDREC PKDREC; // record
  PKHREC PKHREC; // record
  PKWREC PKWREC; // record
  PW0RW00 PW0RW00; // record
  PW0RW01 PW0RW01; // record
  PWMREC PWMREC; // record
  SQLCA SQLCA; // record
  TA1REC TA1REC; // record
  TA9REC TA9REC; // record
  TAEREC TAEREC; // record

  // VAGen Info - items needed for migration
  VAGen_EZESYS char(8);
  VAGen_EZEREPLY num(1);
  VAGen_EZE_WAIT_TIME bin(9,2);
  VAGen_EZE_ITEMLEN int;

  // Use Declarations
  use XWHTBL; // table
  use XDVTBL; // table
  use XBCTBL; // table
  use PW0RM.PW0RM001,  // forms
      PW0RM.PW0RM002
   {
    helpKey = pf1,
    pfKeyEquate = no
  };
  use GD00M {
    helpGroup = yes,
    helpKey = pf1,
    pfKeyEquate = no
  };

  function main()
    // VAGen Info - initialization needed for migration
    VAGen_EZESYS = VGLib.getVAGSysType();
    XPPK001: XPPK001();
     /* ------------------------------------------------------------*/
     /* Initialize Working Storage And Display Storage Areas.*/
     /* ------------------------------------------------------------*/

    set PW0RM001 initial; /* M001 input/output*/
    set PW0RM002 initial; /* M001 input/output*/
    set PW0RW00 empty; /* Working storage*/
    set PW0RW01 empty; /* M001 display storage*/
    set SQLCA empty; /* SQL Communications Area*/
    set TAEREC empty; /* Error diagnosis information*/
    set TA1REC empty; /* Error diagnosis parameters*/

    PW0RW00.PW0RWSWF = "Y"; /* Format the map switch*/
    PW0RW00.PW0RWSWR = "N"; /* Request for data switch*/

     /* ------------------------------------------------------------*/
     /* If data was passed in the COMMAREA, use as the initial key.*/
     /* ------------------------------------------------------------*/

    if (PKWREC.XWHCD > "  ") /* Warehouse passed*/

      if (PKWREC.XWHCD == "51" /* Warehouse is valid*/
       || PKWREC.XWHCD == "07" 
       || PKWREC.XWHCD == "04" 
       || PKWREC.XWHCD == "02" 
       || PKWREC.XWHCD == "42") /* Canada*/

        PW0RM001.XWHCD = PKWREC.XWHCD; /* Move whse code to map*/
        PW0RM001.XWHABRV = PKWREC.XWHABRV; /* Move whse name to map*/

        PW0RW00.PW0RWSWR = "Y"; /* Request for data switch*/

      end

    end

    if (PKWREC.PKWSELSW == "PK") /* picking*/

      /* MOVE '   PICKING   ' TO PW0RM001.PW0RMAPL; /* set map heading*/
      PW0RW00.PKURUNMD = " "; /* set run mode*/

    end

    if (PKWREC.PKWSELSW == "PP") /* pick planning*/

      /* MOVE 'PICK PLANNING' TO PW0RM001.PW0RMAPL; /* set map heading*/
      PW0RW00.PKURUNMD = "P"; /* set run mode*/

    end

     /* ------------------------------------------------------------*/
     /* Flow To Converse The Main Process Used To Display A Map.*/
     /* ------------------------------------------------------------*/

    goto PW0R000;


    PW0R000: PW0R000();
     /* ------------------------------------------------------------*/
     /* Flow To Converse The Main Process Used To Display A Map.*/
     /* ------------------------------------------------------------*/

    goto PW0R001; /* converse the main process*/


    PW0R001: PW0R001();
     /* ------------------------------------------------------------*/
     /* Flow To Converse The Main Process Used To Display A Map.*/
     /* ------------------------------------------------------------*/

    goto PW0R001; /* converse the main process*/


  end // end main
end // end PW0R

// Format and Converse the Map
Function PW0R-20001()
   /* ------------------------------------------------------------*/
   /* note: Apply the same changes to pw0r-20002*/
   /* ------------------------------------------------------------*/

  converse PW0RM001 ;

   /* ------------------------------------------------------------*/
   /* Clear the message fields and save FAST PATH information.*/
   /* ------------------------------------------------------------*/

  PW0RW00.XXXMODID = " "; /* Module identification*/
  PW0RW00.XXXMSGNO = 0; /* Message number*/
  COMMAREA.CAMSG = " "; /* Message text*/

  COMMAREA.CATOAP = PW0RM001.CATOAP; /* TO application*/
  COMMAREA.CAITEM = PW0RM001.CAITEM; /* Application data*/


end // end PW0R-20001

// Format and Converse the Map
Function PW0R-20002()
   /* ------------------------------------------------------------*/
   /* note: Apply the same changes to pw0r-20001*/
   /* ------------------------------------------------------------*/

  move PW0RM001 to PW0RM002 byName;

  converse PW0RM002 ;

   /* ------------------------------------------------------------*/
   /* Clear the message fields and save FAST PATH information.*/
   /* ------------------------------------------------------------*/

  PW0RW00.XXXMODID = " "; /* Module identification*/
  PW0RW00.XXXMSGNO = 0; /* Message number*/
  COMMAREA.CAMSG = " "; /* Message text*/

  COMMAREA.CATOAP = PW0RM002.CATOAP; /* TO application*/
  COMMAREA.CAITEM = PW0RM002.CAITEM; /* Application data*/


end // end PW0R-20002

// Check the FROM application
Function PW0R000()
   /* ------------------------------------------------------------*/
   /* Determine whether control came from an allowed application.*/
   /* ------------------------------------------------------------*/

                                  /* from allowed applications:*/
  if (COMMAREA.CAFROMAP == "GD00" /* help*/
   || COMMAREA.CAFROMAP == "PW0I" /* order detail*/
   || COMMAREA.CAFROMAP == "PW0J" /* spcl hndl totals by*/
   || COMMAREA.CAFROMAP == "PW0M" /* P & H spcl hndl sel*/
   || COMMAREA.CAFROMAP == "PW0N" /* P & H spcl hndl order sel*/
   || COMMAREA.CAFROMAP == "PW0O" /* P & H order detail*/
   || COMMAREA.CAFROMAP == "PW0P" /* P & H non-spcl hndl sel*/
   || COMMAREA.CAFROMAP == "PW0Q" /* P & H non-spcl hndl ord sel*/
   || COMMAREA.CAFROMAP == "PW0R" /* itself*/
   || COMMAREA.CAFROMAP == "PW0S" /* sel hndl code dtl*/
   || COMMAREA.CAFROMAP == "PW0V" /* picking sel menu*/
   || COMMAREA.CAFROMAP == "PW0W" /* pick planning sel menu*/
   || COMMAREA.CAFROMAP == "PW0X" /* P & H non-spcl hndl ord sel*/
   || COMMAREA.CAFROMAP == "PW06" /* B-grade/Closeout sel*/
   || COMMAREA.CAFROMAP == "PW07" /* B-grade/Closeout ord sel*/
   || COMMAREA.CAFROMAP == "PW08") /* In-store promo order sel*/

  else

    /* ------------------------------------------------------------*/
    /* Indicate invalid transfer and return to FROM application.*/
    /* ------------------------------------------------------------*/

    COMMAREA.CATOAPP = COMMAREA.CAFROMAP;

    XSNOWAY(); /* Invalid transfer was attempted*/

  end

   /* ------------------------------------------------------------*/
   /* Determine whether warehouse is valid.  If valid, proceed;*/
   /* Otherwise, display message and return to application*/
   /* initiating transfer.*/
   /* ------------------------------------------------------------*/

  XPPK003(); /* common procedure to validate passed*/
                                   /* warehouse*/

   /* ------------------------------------------------------------*/
   /* Initial move into working storage and map.*/
   /* ------------------------------------------------------------*/

  if (PKWREC.XDVCD[1] != "*")
    XPPK004(); /* common procedure to validate division*/
                                   /* code*/

    if (converseVar.validationMsgNum == 0)
      PW0RM001.XDVCD = PKWREC.XDVCD[1];
      PW0RW01.XDVCD = PKWREC.XDVCD[1];
      if (PKWREC.XDVCD[1] in XDVTBL.XDVCD)
        PW0RW01.XDVDESC = XDVTBL.XDVDESC[sysVar.arrayIndex];
      end
      if (PKWREC.XDVCD[1] in XDVTBL.XDVCD)
        PW0RM001.XDVDESC = XDVTBL.XDVDESC[sysVar.arrayIndex];
      end
    end
  else
    PW0RM001.XDVDESC = "ALL DIVISIONS";
    PW0RW01.XDVDESC = "ALL DIVISIONS";
    PW0RM001.XDVCD = PKWREC.XDVCD[1];
    PW0RW01.XDVCD = PKWREC.XDVCD[1];
  end


  if (PKWREC.XBCCD[1] != "*")
    if (PKWREC.XBCCD in XBCTBL.XBCCD)
      if (XBCTBL.XXXSTAT[sysVar.arrayIndex] == "A")
        PW0RW01.XBCCD = PKWREC.XBCCD[1];
        PW0RM001.XBCCD = PKWREC.XBCCD[1];
        PW0RW01.XBCABRV = XBCTBL.XBCABRV[sysVar.arrayIndex];
        PW0RM001.XBCABRV = XBCTBL.XBCABRV[sysVar.arrayIndex];
      end
    end
  else
    PW0RW01.XBCCD = PKWREC.XBCCD[1];
    PW0RM001.XBCCD = PKWREC.XBCCD[1];
    PW0RW01.XBCABRV = " ";
    PW0RM001.XBCABRV = " ";
  end

   /* ------------------------------------------------------------*/
   /* Determine minimum pack and hold date.*/
   /* ------------------------------------------------------------*/

   /* -----------------------  Y2K OUT BEGIN  ------------------------*/
   /*  */
   /* MOVE EZEDTE TO PW0RW00.PW0RWEDT; /* save system date*/
   /* ;*/
   /* SET TA9REC EMPTY;                /* clear record*/
   /* MOVE 19 TO TA9REC.TA9BEGCC;      /* cen*/
   /* MOVE PW0RW00.PW0RWEYY TO TA9REC.TA9BEGYY;/* year*/
   /* MOVE PW0RW00.PW0RWEMM TO TA9REC.TA9BEGMM;/* month*/
   /* MOVE PW0RW00.PW0RWEDD TO TA9REC.TA9BEGDD;/* day*/
   /* ;*/
   /*  */
   /* ------------------------  Y2K OUT END  -------------------------*/
   /* -----------------------  Y2K IN BEGIN  -------------------------*/
   /*  */
  PW0RW00.PW0RWEDT = VGVar.currentGregorianDate; /* save system date*/

  set TA9REC empty; /* clear record*/
  TA9REC.TA9BEGDT = PW0RW00.PW0RWEDT; /* cen*/
   /*  */
   /* ------------------------  Y2K IN END  --------------------------*/
  if (PKWREC.PKWSELSW == "PK") /* picking*/

    TA9REC.TA9OFSET = 2; /* add 2 working days*/
    PW0RW00.PK4SLIND = "S"; /* status*/

  else

    if (PKWREC.PKWSELSW == "PP") /* pick planning*/

      TA9REC.TA9OFSET = 3; /* add 3 working days*/
      PW0RW00.PK4SLIND = "P"; /* status*/

    end
  end

  call "TA0190" (TA9REC) {isNoRefresh = yes, isExternal = yes}; /* call subroutine*/

  if (TA9REC.TA9RTNFL != 0) /* if not valid date*/

    PW0RW01.XXXMODID = "000"; /* module id*/
    converseLib.validationFailed(29); /* unexpected error has occured*/
    PW0RW00.PW0RWSWR = "N"; /* request for data switch*/

  else

    /* -----------------------  Y2K OUT BEGIN  ------------------------*/
    /*  */
    /* MOVE 19 TO PW0RW00.PW0RWPCC;   /* cen*/
    /* MOVE TA9REC.TA9RTNYY TO PW0RW00.PW0RWPYY;/* year*/
    /* MOVE TA9REC.TA9RTNMM TO PW0RW00.PW0RWPMM;/* month*/
    /* MOVE TA9REC.TA9RTNDD TO PW0RW00.PW0RWPDD;/* day*/
    /* ;*/
    /*  */
    /* ------------------------  Y2K OUT END  -------------------------*/
    /* -----------------------  Y2K IN BEGIN  -------------------------*/
    /*  */
    PW0RW00.PW0RWMPH = TA9REC.TA9RTNDT; /* year*/
    /*  */
    /* ------------------------  Y2K IN END  --------------------------*/
  end


end // end PW0R000

// Main Process to display a map
Function PW0R001()
   /* ------------------------------------------------------------*/
   /* This is the main process used to display a map.  Processing*/
   /* always returns to the top of this process and falls through*/
   /* subordinate process untial an error is found or a valid*/
   /* request is processed.  Processing sequence is as follows:*/

   /* 1) Obtain the data to display.*/
   /* 2) Format the map output area and display the map.*/
   /* 3) Check the attention identifier used to respond.*/
   /* 4) Reset highlighted fields to normal intensity.*/
   /* 5) Verify the data that was entered.*/
   /* 6) Process a valid input request.*/

   /* In all subordinate processes, "EZEFLO" is used to exit to*/
   /* re-display the map when an error is found.  This is done to*/
   /* minimize the coding effort required to skip subsequent*/
   /* processing under error conditions.*/
   /* ------------------------------------------------------------*/

  PW0R100(); /* Obtain the data to display*/

  PW0R200(); /* Format and display the map*/

  PW0R300(); /* Check attention identifier*/

  PW0R400(); /* Reset fields to normal intensity*/

  PW0R500(); /* Verify the entered data*/

  PW0R600(); /* Process valid input request*/


end // end PW0R001

// Obtain the data to display
Function PW0R100()
   /* ------------------------------------------------------------*/
   /* If data was not requested or an error was found, return to*/
   /* the previous process.*/
   /* ------------------------------------------------------------*/

  if (PW0RW00.PW0RWSWR != "Y" /* Data was not requested*/
   || converseVar.validationMsgNum != 0) /* or an error was found*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Clear the map display storage area and save the key fields.*/
   /* ------------------------------------------------------------*/

  set PW0RW01 empty; /* M001 display storage*/

  PW0RW01.XWHCD = PW0RM001.XWHCD; /* Whse code*/
  PW0RW01.XWHABRV = PW0RM001.XWHABRV; /* Whse abbreviation*/
   /* MOVE PW0RM001.PW0RMAPL TO PW0RW01.PW0RMAPL; /* Map title*/

   /* ------------------------------------------------------------*/
   /* Obtain division code*/
   /* ------------------------------------------------------------*/

  if (PW0RM001.XDVCD == " ")
    converseLib.validationFailed(393);
    set PW0RM001.XDVCD cursor, bold;
    PW0RW00.XXXMODID = "100";
    exit stack;
  end

  PKWREC.XDVCD[1] = PW0RM001.XDVCD;

  if (PKWREC.XDVCD[1] != "*")
    XPPK004(); /* Validate division code*/

    if (converseVar.validationMsgNum == 0) /* no errors, move div. code & abrv to*/
                                   /* w/s*/
      PW0RW01.XDVCD = PKWREC.XDVCD[1];
      PW0RW01.XDVDESC = XDVTBL.XDVDESC[sysVar.arrayIndex];
    else
      converseLib.validationFailed(393);
      set PW0RM001.XDVCD cursor, bold;
      PW0RW00.XXXMODID = "100";
      exit stack;
    end
  else
    PW0RW01.XDVCD = PKWREC.XDVCD[1];
    PW0RW01.XDVDESC = "ALL DIVISIONS";
  end

   /* ------------------------------------------------------------*/
   /* Obtain brand code*/
   /* ------------------------------------------------------------*/

  if (PW0RM001.XBCCD == " ")
    converseLib.validationFailed(413); /* INVALID BRAND CODE*/
    set PW0RM001.XBCCD cursor, bold;
    PW0RW00.XXXMODID = "100";
    exit stack;
  end

  PKWREC.XBCCD[1] = PW0RM001.XBCCD;

  if (PKWREC.XBCCD[1] != "*")
    if (PKWREC.XBCCD[1] in XBCTBL.XBCCD)
      if (XBCTBL.XXXSTAT[sysVar.arrayIndex] != "A")
        converseLib.validationFailed(414); /* INACTIVE BRAND CODE*/
        set PW0RM001.XBCCD cursor, bold;
        PW0RW00.XXXMODID = "100";
        exit stack;
      else
        PW0RW01.XBCCD = PKWREC.XBCCD[1];
        PW0RW01.XBCABRV = XBCTBL.XBCABRV[sysVar.arrayIndex];
      end
    else
      converseLib.validationFailed(413); /* INVALID BRAND CODE*/
      set PW0RM001.XBCCD cursor, bold;
      PW0RW00.XXXMODID = "100";
      exit stack;
    end
  else
    PW0RW00.XXXMSGNO = 421;
    PW0RW01.XBCCD = PKWREC.XBCCD[1];
    PW0RW01.XBCABRV = " ";
  end


   /* ----- at once -----------*/
  PW0RW00.PW0RMASR = 0; /* Spec Handling At Once Units*/
  PW0RW00.PW0RMARF = 0; /* Reg Handling At Once Full Case Units*/
  PW0RW00.PW0RMARR = 0; /* Reg Handling At Once Repack Units*/
  PW0RW00.PW0RMABG = 0; /* B-Grade At Once Units*/
  PW0RW00.PW0RMACO = 0; /* Closeout At Once Units*/
  PW0RW00.PW0RMAPF = 0; /* In-store Promo At Once Full case*/
  PW0RW00.PW0RMAPR = 0; /* In-store Promo At Once Repack*/
   /* TT# 3670 change begins*/
  PW0RW00.PW0RMAER = 0; /* Equipment At Once Units*/
   /* TT# 3670 change ends*/

   /* ----- p & h -------------*/
  PW0RW00.PW0RMPSR = 0; /* Spec Handling Pack & Hold Units*/
  PW0RW00.PW0RMPRF = 0; /* Reg Handling Pack & Hold Full Case*/
                                   /* Unts*/
  PW0RW00.PW0RMPRR = 0; /* Reg Handling Pack & Hold Repack Units*/
  PW0RW00.PW0RMPBG = 0; /* B-Grade Pack & Hold Units*/
  PW0RW00.PW0RMPCO = 0; /* Closeout Pack & Hold Units*/
  PW0RW00.PW0RMPPF = 0; /* In-store Promo Pack & Hold Full Case*/
  PW0RW00.PW0RMPPR = 0; /* In-store Promo Pack & Hold Repack*/

   /* ----- sel'd by order ----*/
  PW0RW00.PW0RMOSR = 0; /* Spec Handling sel'd order Units*/
  PW0RW00.PW0RMORF = 0; /* Reg Handling sel'd order Full Case*/
                                   /* Unts*/
  PW0RW00.PW0RMORR = 0; /* Reg Handling sel'd order Repack Units*/
  PW0RW00.PW0RMOXF = 0; /* Stock xfer full cs units*/
  PW0RW00.PW0RMOXR = 0; /* Stock xfer repack units*/
  PW0RW00.PW0RMOBG = 0; /* B-Grade sel'd order Units*/
  PW0RW00.PW0RMOCO = 0; /* Closeout sel'd order Units*/
  PW0RW00.PW0RMOPF = 0; /* In-store Promo sel'd Full Case*/
  PW0RW00.PW0RMOPR = 0; /* In-store Promo sel'd Repack*/
   /* TT# 3670 change begins*/
  PW0RW00.PW0RMOER = 0; /* Equipment sel'd order Units*/
   /* TT# 3670 change ends*/

   /* ----- total by div cd ---*/
  PW0RW00.PW0RMDSR = 0; /* Spec handling sel'd order units*/
  PW0RW00.PW0RMDRF = 0; /* Reg handling sel'd order full case*/
                                   /* unts*/
  PW0RW00.PW0RMDRR = 0; /* Reg handling sel'd order repack units*/
  PW0RW00.PW0RMDXF = 0; /* Stock xfer full cs units*/
  PW0RW00.PW0RMDXR = 0; /* Stock xfer repack units*/
  PW0RW00.PW0RMDBG = 0; /* B-Grade sel'd order units*/
  PW0RW00.PW0RMDCO = 0; /* Closeout sel'd order units*/
  PW0RW00.PW0RMDPF = 0; /* In-store Promo Full Case*/
  PW0RW00.PW0RMDPR = 0; /* In-store Promo Repack*/
   /* TT# 3670 change begins*/
  PW0RW00.PW0RMDER = 0; /* Equipment div Units*/
   /* TT# 3670 change ends*/

   /* ----- total by brand cd ---*/
  PW0RW00.PW0RMBSR = 0; /* Spec handling sel'd order units*/
  PW0RW00.PW0RMBRF = 0; /* Reg handling sel'd order full case*/
                                   /* unts*/
  PW0RW00.PW0RMBRR = 0; /* Reg handling sel'd order repack units*/
  PW0RW00.PW0RMBXF = 0; /* Stock xfer full cs units*/
  PW0RW00.PW0RMBXR = 0; /* Stock xfer repack units*/
  PW0RW00.PW0RMBBG = 0; /* B-Grade sel'd order units*/
  PW0RW00.PW0RMBCO = 0; /* Closeout sel'd order units*/
  PW0RW00.PW0RMBPF = 0; /* In-store Promo Full Case*/
  PW0RW00.PW0RMBPR = 0; /* In-store Promo Repack*/
   /* TT# 3670 change begins*/
  PW0RW00.PW0RMBER = 0; /* Equipment brand Units*/
   /* TT# 3670 change ends*/

   /* ----- total by whse cd --*/
  PW0RW00.PW0RMWSR = 0; /* Spec handling sel'd order units*/
  PW0RW00.PW0RMWRF = 0; /* Reg handling sel'd order full case*/
                                   /* unts*/
  PW0RW00.PW0RMWRR = 0; /* Reg handling sel'd order repack units*/
  PW0RW00.PW0RMWXF = 0; /* Stock xfer full cs units*/
  PW0RW00.PW0RMWXR = 0; /* Stock xfer repack units*/
  PW0RW00.PW0RMWBG = 0; /* B-Grade sel'd order units*/
  PW0RW00.PW0RMWCO = 0; /* Closeout sel'd order units*/
  PW0RW00.PW0RMWPF = 0; /* In-store Promo Full Case*/
  PW0RW00.PW0RMWPR = 0; /* In-store Promo Repack*/
   /* TT# 3670 change begins*/
  PW0RW00.PW0RMWER = 0; /* Equipment ware house Units*/
   /* TT# 3670 change ends*/

   /* ----- hour/minutes fields ---*/
  PW0RW00.PW0RWAHW = 0;
  PW0RW00.PW0RWPHW = 0;
  PW0RW00.PW0RWOHW = 0;
  PW0RW00.PW0RWDHW = 0;
  PW0RW00.PW0RWBHW = 0;
  PW0RW00.PW0RWWHW = 0;


   /* TT# 3670 change begins*/
   /* ----------------------------------------------------*/
   /* The pk-sel-typ-cds for Equipment, footwear & apparel*/
   /* are initialized*/
   /* ----------------------------------------------------*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[1] = " 1"; /* special handling code*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[2] = "22"; /* new spcl hndl code*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[3] = "23"; /* new spcl hndl code*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[4] = "24"; /* new spcl hndl code*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[5] = "25"; /* new spcl hndl code*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[6] = " 2"; /* reg full cs & repack*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[7] = "30"; /* New reg full cs*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[8] = "31"; /* New reg full cs*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[9] = "34"; /* New reg repack*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[10] = "35"; /* New reg repack*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[11] = "10"; /* B-grade full cs & repak*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[12] = "40"; /* New B-gra full cs & rep*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[13] = "41"; /* New B-gra full cs & rep*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[14] = "12"; /* Close out code*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[15] = "28"; /* New Close out code*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[16] = "29"; /* New Close out code*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[17] = "26"; /* New Equipment code*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[18] = "27"; /* New Equipment code*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[19] = "36"; /* New Equipment code*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[20] = "37"; /* New Equipment code*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[21] = "38"; /* New Equipment code*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[22] = "39"; /* New Equipment code*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[23] = "42"; /* New Equipment code*/
  PW0RW00.PW0RW-PK-SEL-TYP-CDS[24] = "43"; /* New Equipment code*/
   /* TT# 3670 change ends*/

   /* ------------------------------------------------------------*/
   /* Obtain Data From Tables To Be Displayed.*/
   /* ------------------------------------------------------------*/

  PW0R110(); /* sel'd by qty special handling units*/

  PW0R120(); /* "        regular Handling Units*/

  PW0R150(); /* "        B-Grade Units spcl hndl*/
  PW0R155(); /* "        B-Grade Units non-spcl*/

  PW0R160(); /* "        Closeout Units spcl hndl*/
  PW0R165(); /* "        Closeout Units non-spcl*/

   /* TT# 3670 change begins*/
   /* ------------------------------------------------------------*/
   /* A new procedure is added to handle the new Equipment row.*/
   /* ------------------------------------------------------------*/

  PW0R170(); /* Equipment Handling proc*/

   /* TT# 3670 change ends*/

  PW0R140(); /* sel'd by order units*/

  PW0R130(); /* Calculate Totals*/

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  PW0RW00.PW0RWSWR = "N"; /* Request for data switch*/
  PW0RW01.CACHGFL = "Y"; /* There is data to display*/


end // end PW0R100

// Get Spec Handling units
Function PW0R110()
   /* ============================================================*/
   /* GET SPECIAL HANDLING UNITS*/
   /* ============================================================*/

   /* ------------------------------------------------------------*/
   /* Select Special Handling (at once) Units from DPICK.VSELQT01*/
   /* ------------------------------------------------------------*/

   /* TT# 3670 change begins*/
   /* ------------------------------------------------------------*/
   /* Changes made to include selection type codes 22,23,24 and 25*/
   /* ------------------------------------------------------------*/
  PW0RW00.PW0RW-PK-SEL-TYP-CNT = 1; /* Set count to 1*/

  while (PW0RW00.PW0RW-PK-SEL-TYP-CNT <= 5) /* while count le 5*/

    /* MOVE ' 1' TO PW0RW00.PK-SEL-TYP-CD;*/
    /* Set indicator to special handling*/

    PW0RW00.PK-SEL-TYP-CD = PW0RW00.PW0RW-PK-SEL-TYP-CDS[PW0RW-PK-SEL-TYP-CNT];
                                  /* Set indicator to special handling*/
    /* TT# 3670 change ends*/

    PW0R115(); /* Open cursor in DPICK.VSELQT01*/

    PW0RW00.PW0RWCSR = "N"; /* end of cursor switch*/

    while (PW0RW00.PW0RWCSR == "N") /* until eof*/

      PW0R116(); /* fetch row in DPICK.VSELQT01*/

      if (PW0RW00.PW0RWCSR == "N") /* not end of file*/

        /* ------------------------------------------------------------*/
        /* Accumulate totals for either wildcard or specific values.*/
        /* ------------------------------------------------------------*/
        if (PW0RW01.XDVCD == "*") /* division code NE to wildcard*/

          PW0R134(); /* Add special handling division*/
          if (PW0RW01.XBCCD == "*") /* brand code NE to wildcard*/
            if (PWMREC.XBCCD != "08") /* NE to ColeHaan*/
              PW0R117(); /* Add special handling*/
              PW0R136(); /* Add special handling brand*/
            end
          else
            if (PW0RW01.XBCCD == PWMREC.XBCCD)
              PW0R117(); /* Add special handling*/
              PW0R136(); /* Add special handling brand*/
            end
          end

        else

          if (PW0RW01.XBCCD == "*")
            if (PWMREC.XBCCD != "08") /* NE to ColeHaan*/
              PW0R136(); /* Add special handling brand*/
              if (PW0RW01.XDVCD == PWMREC.XDVCD)
                PW0R117(); /* Add special handling*/
                PW0R134(); /* Add special handling division*/
              end
            else
              if (PW0RW01.XDVCD == PWMREC.XDVCD)
                PW0R134(); /* Add special handling division*/
              end
            end
          else
            if (PW0RW01.XBCCD == PWMREC.XBCCD)
              PW0R136(); /* Add special handling brand*/
              if (PW0RW01.XDVCD == PWMREC.XDVCD)
                PW0R117(); /* Add special handling*/
                PW0R134(); /* Add special handling division*/
              end
            else
              if (PW0RW01.XDVCD == PWMREC.XDVCD)
                PW0R134(); /* Add special handling division*/
              end
            end
          end

        end

        PW0R131(); /* Add totals for warehouse*/
      end
    end

    PW0R118(); /* close cursor in DPICK.VSELQT01*/

    /* TT# 3670 change begins*/

    PW0RW00.PW0RW-PK-SEL-TYP-CNT = PW0RW00.PW0RW-PK-SEL-TYP-CNT + 1;
                                   /* Increment count*/

  end
   /* TT# 3670 change ends*/

   /* ------------------------------------------------------------*/
   /* Select Special Handling (P & H) Units from DPICK.VSELQT01*/
   /* ------------------------------------------------------------*/

  PW0RW00.PK-SEL-TYP-CD = " 3"; /* Set indicator to special handling*/

  PW0R115(); /* Open cursor in DPICK.VSELQT01*/

  PW0RW00.PW0RWCSR = "N"; /* end of cursor switch*/

  while (PW0RW00.PW0RWCSR == "N") /* until eof*/

    PW0R116(); /* fetch row in DPICK.VSELQT01*/

    if (PW0RW00.PW0RWCSR == "N") /* not end of file*/

      /* ------------------------------------------------------------*/
      /* Accumulate totals for either wildcard or specific values.*/
      /* ------------------------------------------------------------*/
      if (PW0RW01.XDVCD == "*") /* division code NE to wildcard*/

        PW0R134(); /* Add special handling division*/
        if (PW0RW01.XBCCD == "*") /* brand code NE to wildcard*/
          if (PWMREC.XBCCD != "08") /* NE to ColeHaan*/
            PW0R117(); /* Add special handling*/
            PW0R136(); /* Add special handling brand*/
          end
        else
          if (PW0RW01.XBCCD == PWMREC.XBCCD)
            PW0R117(); /* Add special handling*/
            PW0R136(); /* Add special handling brand*/
          end
        end

      else

        if (PW0RW01.XBCCD == "*")
          if (PWMREC.XBCCD != "08") /* NE to ColeHaan*/
            PW0R136(); /* Add special handling brand*/
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R117(); /* Add special handling*/
              PW0R134(); /* Add special handling division*/
            end
          else
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R134(); /* Add special handling division*/
            end
          end
        else
          if (PW0RW01.XBCCD == PWMREC.XBCCD)
            PW0R136(); /* Add special handling brand*/
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R117(); /* Add special handling*/
              PW0R134(); /* Add special handling division*/
            end
          else
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R134(); /* Add special handling division*/
            end
          end
        end

      end

      PW0R131(); /* Add totals for warehouse*/
    end
  end

  PW0R118(); /* close cursor in DPICK.VSELQT01*/


   /* ------------------------------------------------------------*/
   /* Select Special Handling (in-store promo) DPICK.VSELQT01*/
   /* ------------------------------------------------------------*/

  PW0RW00.PK-SEL-TYP-CD = "14"; /* Set indicator to special handling*/

  PW0R115(); /* Open cursor in DPICK.VSELQT01*/

  PW0RW00.PW0RWCSR = "N"; /* end of cursor switch*/

  while (PW0RW00.PW0RWCSR == "N") /* until eof*/

    PW0R116(); /* fetch row in DPICK.VSELQT01*/

    if (PW0RW00.PW0RWCSR == "N") /* not end of file*/

      /* ------------------------------------------------------------*/
      /* Accumulate totals for either wildcard or specific values.*/
      /* ------------------------------------------------------------*/
      if (PW0RW01.XDVCD == "*") /* division code NE to wildcard*/

        PW0R134(); /* Add special handling division*/
        if (PW0RW01.XBCCD == "*") /* brand code NE to wildcard*/
          if (PWMREC.XBCCD != "08") /* NE to ColeHaan*/
            PW0R117(); /* Add special handling*/
            PW0R136(); /* Add special handling brand*/
          end
        else
          if (PW0RW01.XBCCD == PWMREC.XBCCD)
            PW0R117(); /* Add special handling*/
            PW0R136(); /* Add special handling brand*/
          end
        end

      else

        if (PW0RW01.XBCCD == "*")
          if (PWMREC.XBCCD != "08") /* NE to ColeHaan*/
            PW0R136(); /* Add special handling brand*/
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R117(); /* Add special handling*/
              PW0R134(); /* Add special handling division*/
            end
          else
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R134(); /* Add special handling division*/
            end
          end
        else
          if (PW0RW01.XBCCD == PWMREC.XBCCD)
            PW0R136(); /* Add special handling brand*/
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R117(); /* Add special handling*/
              PW0R134(); /* Add special handling division*/
            end
          else
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R134(); /* Add special handling division*/
            end
          end
        end

      end

      PW0R131(); /* Add totals for warehouse*/
    end
  end

  PW0R118(); /* close cursor in DPICK.VSELQT01*/


   /* ------------------------------------------------------------*/
   /* Select Extra special handling Quantites  DPICK.VSELQT01*/
   /* ------------------------------------------------------------*/

  PW0RW00.PK-SEL-TYP-CD = "16"; /* Set indicator to special handling*/

  PW0R115(); /* Open cursor in DPICK.VSELQT01*/

  PW0RW00.PW0RWCSR = "N"; /* end of cursor switch*/

  while (PW0RW00.PW0RWCSR == "N") /* until eof*/

    PW0R116(); /* fetch row in DPICK.VSELQT01*/

    if (PW0RW00.PW0RWCSR == "N") /* not end of file*/

      /* ------------------------------------------------------------*/
      /* Accumulate totals for either wildcard or specific values.*/
      /* ------------------------------------------------------------*/
      if (PW0RW01.XDVCD == "*") /* division code NE to wildcard*/

        PW0R134(); /* Add special handling division*/
        if (PW0RW01.XBCCD == "*") /* brand code NE to wildcard*/
          if (PWMREC.XBCCD != "08") /* NE to ColeHaan*/
            PW0R117(); /* Add special handling*/
            PW0R136(); /* Add special handling brand*/
          end
        else
          if (PW0RW01.XBCCD == PWMREC.XBCCD)
            PW0R117(); /* Add special handling*/
            PW0R136(); /* Add special handling brand*/
          end
        end

      else

        if (PW0RW01.XBCCD == "*")
          if (PWMREC.XBCCD != "08") /* NE to ColeHaan*/
            PW0R136(); /* Add special handling brand*/
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R117(); /* Add special handling*/
              PW0R134(); /* Add special handling division*/
            end
          else
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R134(); /* Add special handling division*/
            end
          end
        else
          if (PW0RW01.XBCCD == PWMREC.XBCCD)
            PW0R136(); /* Add special handling brand*/
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R117(); /* Add special handling*/
              PW0R134(); /* Add special handling division*/
            end
          else
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R134(); /* Add special handling division*/
            end
          end
        end

      end

      PW0R131(); /* Add totals for warehouse*/
    end
  end

  PW0R118(); /* close cursor in DPICK.VSELQT01*/

end // end PW0R110

// Open cursor in DPICK.VSELOR01
Function PW0R111()
   /* ------------------------------------------------------------*/
   /* open cursor in DPICK.VSELOR01*/
   /* ------------------------------------------------------------*/

  set PKHREC empty; /* Clear row storage area*/

  PKHREC.XWHCD = PW0RW01.XWHCD; /* Warehouse code*/
  PKHREC.PK-SEL-TYP-CD = PW0RW00.PK-SEL-TYP-CD;
  PKHREC.OP1DSBDT = -1; /* wildcard dsnsb*/
  PKHREC.XDVCD = "*"; /* division code*/
  PKHREC.XBCCD = "*"; /* brand code*/
  PKHREC.PKURUNMD = PW0RW00.PKURUNMD; /* run mode*/

  try
    call "IO1740" ("S2", SQLCA, PKHREC) {isNoRefresh = yes, isExternal = yes};
  end /* Select Row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Successful Call*/

    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user,*/
   /* Otherwise, indicate that an unexpected error has occured.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL Commarea*/

  PW0RW01.XXXMODID = "111"; /* module identification*/

  if (sysVar.errorCode == "00000000" /* Call sucessful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(028); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(029); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "SELECT SET"; /* Location of error*/
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = PW0RW01.XXXMODID; /* Program number*/
  TA1REC.TA1DBASE = "DPICK   "; /* database name*/
  TA1REC.TA1TBLVU = "VSELOR01"; /* table view name*/
  TA1REC.TA1TBLKE = PKHREC.PKHKEY; /* table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error Diagnosis Routine*/

  exit stack; /* Exit to display map*/


end // end PW0R111

// Fetch row in DPICK.VSELOR01
Function PW0R112()
   /* ------------------------------------------------------------*/
   /* Fetch the next row from DPICK.VSELOR01.*/
   /* ------------------------------------------------------------*/

  try
    call "IO1740" ("N2", SQLCA, PKHREC) {isNoRefresh = yes, isExternal = yes};
  end /* Fetch next row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/
      return; /* Return to previous process*/
    end

    /* ------------------------------------------------------------*/
     /* If end of the selected set, indicate end of cursor.*/
    /* ------------------------------------------------------------*/

    if (SQLCA.VAGen_SQLCODE == 100) /* End of selected set*/

      PW0RW00.PW0RWCSR = "Y"; /* Indicate end of cursor*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(28); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(29); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  PW0RW01.XXXMODID = "112"; /* module id*/
  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "FETCH NEXT TABLE ROW";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = "112"; /* Program number*/
  TA1REC.TA1DBASE = "DPICK   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VSELOR01"; /* Table view name*/
  TA1REC.TA1TBLKE = PKHREC.PKHKEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end PW0R112

// Close cursor in DPICK.VSELOR01
Function PW0R114()
   /* ------------------------------------------------------------*/
   /* Close the selected set of table rows.*/
   /* ------------------------------------------------------------*/

  try
    call "IO1740" ("C2", SQLCA, PKHREC) {isNoRefresh = yes, isExternal = yes};
  end /* Close table set*/

   /* ------------------------------------------------------------*/
   /* If successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  converseLib.validationFailed(29); /* Unexpected error occurred*/

  PW0RW01.XXXMODID = "114"; /* module id*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/
  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "CLOSE SELECTED SET OF TABLE ROWS";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = "114"; /* Program number*/
  TA1REC.TA1DBASE = "DPICK   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VSELOR01"; /* Table view name*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end PW0R114

// Open cursor in DPICK.VSELQT01
Function PW0R115()
   /* ------------------------------------------------------------*/
   /* Select Set from DPICK.VSELQT01*/
   /* ------------------------------------------------------------*/

  set PWMREC empty; /* Clear row storage area*/

  PWMREC.XWHCD = PW0RW01.XWHCD; /* Warehouse code*/
  PWMREC.PK-SEL-TYP-CD = PW0RW00.PK-SEL-TYP-CD;
  PWMREC.PKURUNMD = PW0RW00.PKURUNMD; /* run mode*/
  PWMREC.OP1DSBDT = -1; /* wildcard dnsb date*/
  PWMREC.XDVCD = "*"; /* division code*/
  PWMREC.XBCCD = "*"; /* brand code*/
  PWMREC.TF1CARCD = "*"; /* carrier code*/
  PWMREC.XHDCD = "*"; /* handling code*/
  PWMREC.XGPCD = "*"; /* general product code*/

  try
    call "IO5500" ("S1", SQLCA, PWMREC) {isNoRefresh = yes, isExternal = yes};
  end /* Select Row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Successful Call*/

    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user,*/
   /* Otherwise, indicate that an unexpected error has occured.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL Commarea*/

  PW0RW01.XXXMODID = "115"; /* module identification*/

  if (sysVar.errorCode == "00000000" /* Call sucessful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(028); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(029); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "SELECT SET"; /* Location of error*/
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = PW0RW01.XXXMODID; /* Program number*/
  TA1REC.TA1DBASE = "DPICK   "; /* database name*/
  TA1REC.TA1TBLVU = "VSELQT01"; /* table view name*/
  TA1REC.TA1TBLKE = PWMREC.XWHCD; /* table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error Diagnosis Routine*/

  exit stack; /* Exit to display map*/


end // end PW0R115

// Fetch row in DPICK.VSELQT01
Function PW0R116()
   /* ------------------------------------------------------------*/
   /* Fetch the next row from DPICK.VSELQT01.*/
   /* ------------------------------------------------------------*/

  try
    call "IO5500" ("N1", SQLCA, PWMREC) {isNoRefresh = yes, isExternal = yes};
  end /* Fetch next row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/
      return; /* Return to previous process*/
    end

    /* ------------------------------------------------------------*/
     /* If end of the selected set, indicate end of cursor.*/
    /* ------------------------------------------------------------*/

    if (SQLCA.VAGen_SQLCODE == 100) /* End of selected set*/

      PW0RW00.PW0RWCSR = "Y"; /* Indicate end of cursor*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(28); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(29); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  PW0RW01.XXXMODID = "116"; /* module id*/
  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "FETCH NEXT TABLE ROW";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = "116"; /* Program number*/
  TA1REC.TA1DBASE = "DPICK   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VSELQT01"; /* Table view name*/
  TA1REC.TA1TBLKE = PWMREC.PWMKEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end PW0R116

// Add Totals For Display Storage
Function PW0R117()
   /* ------------------------------------------------------------*/
   /* Accumulate Totals (type = 1,3,2,4)*/
   /* ------------------------------------------------------------*/

  if (PW0RW00.PK-SEL-TYP-CD == " 1" /* special handling*/
   /* TT# 3670 change begins*/
   || PW0RW00.PK-SEL-TYP-CD == "22" /* new special handling code*/
   || PW0RW00.PK-SEL-TYP-CD == "23" /* new special handling code*/
   || PW0RW00.PK-SEL-TYP-CD == "24" /* new special handling code*/
   || PW0RW00.PK-SEL-TYP-CD == "25") /* new special handling code*/
    /* TT# 3670 change ends*/

    PW0RW00.PW0RMASR = PW0RW00.PW0RMASR + PWMREC.PKHPVSFC; /* full cs*/
    PW0RW00.PW0RMASR = PW0RW00.PW0RMASR + PWMREC.PKHPVSRP; /* repack*/
    PW0RW00.PW0RWAHW = PW0RW00.PW0RWAHW + PWMREC.PKHPVSMM; /* minutes*/

  end

  if (PW0RW00.PK-SEL-TYP-CD == " 3") /* p&h special handling*/

    PW0RW00.PW0RMPSR = PW0RW00.PW0RMPSR + PWMREC.PKHPVSFC; /* full cs*/
    PW0RW00.PW0RMPSR = PW0RW00.PW0RMPSR + PWMREC.PKHPVSRP; /* repack*/
    PW0RW00.PW0RWPHW = PW0RW00.PW0RWPHW + PWMREC.PKHPVSMM; /* minutes*/

  end

  if (PW0RW00.PK-SEL-TYP-CD == " 2") /* regular handling*/
    PW0RW00.PW0RMARF = PW0RW00.PW0RMARF + PWMREC.PKHPVSFC; /* full cs*/
    PW0RW00.PW0RMARR = PW0RW00.PW0RMARR + PWMREC.PKHPVSRP; /* repack*/
  end
     /* TT# 3670 change begins*/
  if (PW0RW00.PK-SEL-TYP-CD == "30" /* new regular handling code*/
   || PW0RW00.PK-SEL-TYP-CD == "31" /* new regular handling code*/
  )                                
    PW0RW00.PW0RMARF = PW0RW00.PW0RMARF + PWMREC.PKHPVSFC; /* full cs*/
  else
    if (PW0RW00.PK-SEL-TYP-CD == "34" /* new regular handling code*/
     || PW0RW00.PK-SEL-TYP-CD == "35") /* new regular handling code*/
      PW0RW00.PW0RMARR = PW0RW00.PW0RMARR + PWMREC.PKHPVSRP; /* repack*/
    end

  end
     /* TT# 3670 change ends*/

  if (PW0RW00.PK-SEL-TYP-CD == " 4") /* p&h regular handling*/

    PW0RW00.PW0RMPRF = PW0RW00.PW0RMPRF + PWMREC.PKHPVSFC; /* full cs*/
    PW0RW00.PW0RMPRR = PW0RW00.PW0RMPRR + PWMREC.PKHPVSRP; /* repack*/

  end

  if (PW0RW00.PK-SEL-TYP-CD == "10" /* b-grade spcl hndl*/
   || PW0RW00.PK-SEL-TYP-CD == "11" /* b-grade non-spcl hndl*/
   /* TT# 3670 change begins*/
   || PW0RW00.PK-SEL-TYP-CD == "40" /* new b-grade hndl code*/
   || PW0RW00.PK-SEL-TYP-CD == "41") /* new b-grade hndl code*/
  /* TT# 3670 change ends*/

    if (PWMREC.OP1DSBDT < PW0RW00.PW0RWMPH)
      /* +--------------------------------------+*/
      /*    "At Once" B-Grade Units            */
      /* +--------------------------------------+*/
      PW0RW00.PW0RMABG = PW0RW00.PW0RMABG + PWMREC.PKHPVSFC; /* full cs*/
      PW0RW00.PW0RMABG = PW0RW00.PW0RMABG + PWMREC.PKHPVSRP; /* repack*/

    else
      /* +--------------------------------------+*/
      /*    " P & H " B-Grade Units            */
      /* +--------------------------------------+*/
      PW0RW00.PW0RMPBG = PW0RW00.PW0RMPBG + PWMREC.PKHPVSFC; /* full cs*/
      PW0RW00.PW0RMPBG = PW0RW00.PW0RMPBG + PWMREC.PKHPVSRP; /* repack*/

    end
  end


  if (PW0RW00.PK-SEL-TYP-CD == "12" /* closeouts spcl hndl*/
   || PW0RW00.PK-SEL-TYP-CD == "13" /* closeouts non-spcl hndl*/
   /* TT# 3670 change begins*/
   || PW0RW00.PK-SEL-TYP-CD == "28" /* new closeouts hndl cde*/
   || PW0RW00.PK-SEL-TYP-CD == "29") /* new closeouts hndl cde*/
  /* TT# 3670 change ends*/

    if (PWMREC.OP1DSBDT < PW0RW00.PW0RWMPH)
      /* +--------------------------------------+*/
      /*    "At Once" Closeout Units           */
      /* +--------------------------------------+*/
      PW0RW00.PW0RMACO = PW0RW00.PW0RMACO + PWMREC.PKHPVSFC; /* full cs*/
      PW0RW00.PW0RMACO = PW0RW00.PW0RMACO + PWMREC.PKHPVSRP; /* repack*/

    else
      /* +--------------------------------------+*/
      /*    " P & H " Closeout Units           */
      /* +--------------------------------------+*/
      PW0RW00.PW0RMPCO = PW0RW00.PW0RMPCO + PWMREC.PKHPVSFC; /* full cs*/
      PW0RW00.PW0RMPCO = PW0RW00.PW0RMPCO + PWMREC.PKHPVSRP; /* repack*/

    end
  end


  if (PW0RW00.PK-SEL-TYP-CD == "14" /* in-store promo spcl*/
   || PW0RW00.PK-SEL-TYP-CD == "15") /* in-store promo non-spcl*/

    if (PWMREC.OP1DSBDT < PW0RW00.PW0RWMPH)
      /* +--------------------------------------+*/
      /*    "At Once" In-store Promo Units     */
      /* +--------------------------------------+*/
      PW0RW00.PW0RMAPF = PW0RW00.PW0RMAPF + PWMREC.PKHPVSFC; /* full cs*/
      PW0RW00.PW0RMAPR = PW0RW00.PW0RMAPR + PWMREC.PKHPVSRP; /* repack*/

    else
      /* +--------------------------------------+*/
      /*    " P & H " In-store Promo Units     */
      /* +--------------------------------------+*/
      PW0RW00.PW0RMPPF = PW0RW00.PW0RMPPF + PWMREC.PKHPVSFC; /* full cs*/
      PW0RW00.PW0RMPPR = PW0RW00.PW0RMPPR + PWMREC.PKHPVSRP; /* repack*/

    end
  end

  if (PW0RW00.PK-SEL-TYP-CD == "16" /* extra special handling*/
  )                                
    PW0RW00.PW0RW-EX-SP-RP-QTY = PW0RW00.PW0RW-EX-SP-RP-QTY     + PWMREC.PKHPVSRP; /* repack*/

  end

  if (PW0RW00.PK-SEL-TYP-CD == "17" /* extra non-special handling*/
  )                                
    PW0RW00.PW0RW-EX-NS-RP-QTY = PW0RW00.PW0RW-EX-NS-RP-QTY     + PWMREC.PKHPVSRP; /* repack*/
    PW0RW00.PW0RW-EX-NS-FC-QTY = PW0RW00.PW0RW-EX-NS-FC-QTY     + PWMREC.PKHPVSFC; /* fullcase*/

  end

   /* TT# 3670 change begins*/
   /* ------------------------------------------------------------*/
   /* Check for new Equipment codes 26,27,36,37,38,39,42 & 43*/
   /* ------------------------------------------------------------*/
  if (PW0RW00.PK-SEL-TYP-CD == "26" /* equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "27" /* equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "36" /* equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "37" /* equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "38" /* equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "39" /* equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "42" /* equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "43") /* equipment code*/

    PW0RW00.PW0RMAER = PW0RW00.PW0RMAER + PWMREC.PKHPVSFC; /* full cs*/
    PW0RW00.PW0RMAER = PW0RW00.PW0RMAER + PWMREC.PKHPVSRP; /* repack*/

  end
   /* TT# 3670 change ends*/

end // end PW0R117

// close cursor in DPICK.VSELQT01
Function PW0R118()
   /* ------------------------------------------------------------*/
   /* Close the selected set of table rows.*/
   /* ------------------------------------------------------------*/

  try
    call "IO5500" ("C1", SQLCA, PWMREC) {isNoRefresh = yes, isExternal = yes};
  end /* Close table set*/

   /* ------------------------------------------------------------*/
   /* If successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  converseLib.validationFailed(29); /* Unexpected error occurred*/

  PW0RW01.XXXMODID = "118"; /* module id*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/
  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "CLOSE SELECTED SET OF TABLE ROWS";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = "118"; /* Program number*/
  TA1REC.TA1DBASE = "DPICK   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VSELQT01"; /* Table view name*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end PW0R118

// Get Regular handling units
Function PW0R120()
   /* ============================================================*/
   /* GET REGULAR HANDLING UNITS*/
   /* ============================================================*/

   /* ------------------------------------------------------------*/
   /* Select regular Handling (at once) Units from DPICK.VSELQT01*/
   /* ------------------------------------------------------------*/

   /* TT# 3670 change begins*/
   /* ------------------------------------------------------------*/
   /* Additional reg Handling codes 30,31,34 & 35 are included*/
   /* ------------------------------------------------------------*/
  PW0RW00.PW0RW-PK-SEL-TYP-CNT = 6; /* Set count to 1*/

  while (PW0RW00.PW0RW-PK-SEL-TYP-CNT <= 10) /* while count le 10*/

    /* MOVE ' 2' TO PW0RW00.PK-SEL-TYP-CD;*/
    /* Set indicator to special handling*/

    PW0RW00.PK-SEL-TYP-CD = PW0RW00.PW0RW-PK-SEL-TYP-CDS[PW0RW-PK-SEL-TYP-CNT]; /* Set indicator to Reg handling*/

    /* TT# 3670 change ends*/

    PW0R115(); /* Open cursor in DPICK.VSELQT01*/

    PW0RW00.PW0RWCSR = "N"; /* end of cursor switch*/

    while (PW0RW00.PW0RWCSR == "N") /* until eof*/

      PW0R116(); /* fetch row in DPICK.VSELQT01*/

      if (PW0RW00.PW0RWCSR == "N") /* not end of file*/

        /* ------------------------------------------------------------*/
        /* Accumulate totals for either wildcard or specific values.*/
        /* ------------------------------------------------------------*/
        if (PW0RW01.XDVCD == "*") /* division code NE to wildcard*/

          PW0R134(); /* Add special handling division*/
          if (PW0RW01.XBCCD == "*") /* brand code NE to wildcard*/
            if (PWMREC.XBCCD != "08") /* NE ColeHaan*/
              PW0R117(); /* Add special handling*/
              PW0R136(); /* Add special handling brand*/
            end
          else
            if (PW0RW01.XBCCD == PWMREC.XBCCD)
              PW0R117(); /* Add special handling*/
              PW0R136(); /* Add special handling brand*/
            end
          end

        else

          if (PW0RW01.XBCCD == "*")
            if (PWMREC.XBCCD != "08") /* NE ColeHaan*/
              PW0R136(); /* Add special handling brand*/
              if (PW0RW01.XDVCD == PWMREC.XDVCD)
                PW0R117(); /* Add special handling*/
                PW0R134(); /* Add special handling division*/
              end
            else
              if (PW0RW01.XDVCD == PWMREC.XDVCD)
                PW0R134(); /* Add special handling division*/
              end
            end
          else
            if (PW0RW01.XBCCD == PWMREC.XBCCD)
              PW0R136(); /* Add special handling brand*/
              if (PW0RW01.XDVCD == PWMREC.XDVCD)
                PW0R117(); /* Add special handling*/
                PW0R134(); /* Add special handling division*/
              end
            else
              if (PW0RW01.XDVCD == PWMREC.XDVCD)
                PW0R134(); /* Add special handling division*/
              end
            end
          end

        end

        PW0R131(); /* Add totals for warehouse*/
      end
    end

    PW0R118(); /* close cursor in DPICK.VSELQT01*/

    /* TT# 3670 change begins*/

    PW0RW00.PW0RW-PK-SEL-TYP-CNT = PW0RW00.PW0RW-PK-SEL-TYP-CNT + 1;
                                  /* Increment count*/
  end
   /* TT# 3670 change ends*/

   /* ------------------------------------------------------------*/
   /* Select regular Handling (P & H) Units from DPICK.VSELQT01*/
   /* ------------------------------------------------------------*/

  PW0RW00.PK-SEL-TYP-CD = " 4"; /* Set indicator to special handling*/

  PW0R115(); /* Open cursor in DPICK.VSELQT01*/

  PW0RW00.PW0RWCSR = "N"; /* end of cursor switch*/

  while (PW0RW00.PW0RWCSR == "N") /* until eof*/

    PW0R116(); /* fetch row in DPICK.VSELQT01*/

    if (PW0RW00.PW0RWCSR == "N") /* not end of file*/

      /* ------------------------------------------------------------*/
      /* Accumulate totals for either wildcard or specific values.*/
      /* ------------------------------------------------------------*/
      if (PW0RW01.XDVCD == "*") /* division code NE to wildcard*/

        PW0R134(); /* Add special handling division*/
        if (PW0RW01.XBCCD == "*") /* brand code NE to wildcard*/
          if (PWMREC.XBCCD != "08") /* NE ColeHaan*/
            PW0R117(); /* Add special handling*/
            PW0R136(); /* Add special handling brand*/
          end
        else
          if (PW0RW01.XBCCD == PWMREC.XBCCD)
            PW0R117(); /* Add special handling*/
            PW0R136(); /* Add special handling brand*/
          end
        end

      else

        if (PW0RW01.XBCCD == "*")
          if (PWMREC.XBCCD != "08") /* NE ColeHaan*/
            PW0R136(); /* Add special handling brand*/
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R117(); /* Add special handling*/
              PW0R134(); /* Add special handling division*/
            end
          else
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R134(); /* Add special handling division*/
            end
          end
        else
          if (PW0RW01.XBCCD == PWMREC.XBCCD)
            PW0R136(); /* Add special handling brand*/
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R117(); /* Add special handling*/
              PW0R134(); /* Add special handling division*/
            end
          else
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R134(); /* Add special handling division*/
            end
          end
        end

      end

      PW0R131(); /* Add totals for warehouse*/
    end
  end

  PW0R118(); /* close cursor in DPICK.VSELQT01*/


   /* ------------------------------------------------------------*/
   /* Select regular Handling In-store promo units DPICK.VSELQT01*/
   /* ------------------------------------------------------------*/

  PW0RW00.PK-SEL-TYP-CD = "15"; /* Set indicator to special handling*/

  PW0R115(); /* Open cursor in DPICK.VSELQT01*/

  PW0RW00.PW0RWCSR = "N"; /* end of cursor switch*/

  while (PW0RW00.PW0RWCSR == "N") /* until eof*/

    PW0R116(); /* fetch row in DPICK.VSELQT01*/

    if (PW0RW00.PW0RWCSR == "N") /* not end of file*/

      /* ------------------------------------------------------------*/
      /* Accumulate totals for either wildcard or specific values.*/
      /* ------------------------------------------------------------*/
      if (PW0RW01.XDVCD == "*") /* division code NE to wildcard*/

        PW0R134(); /* Add special handling division*/
        if (PW0RW01.XBCCD == "*") /* brand code NE to wildcard*/
          if (PWMREC.XBCCD != "08") /* NE ColeHaan*/
            PW0R117(); /* Add special handling*/
            PW0R136(); /* Add special handling brand*/
          end
        else
          if (PW0RW01.XBCCD == PWMREC.XBCCD)
            PW0R117(); /* Add special handling*/
            PW0R136(); /* Add special handling brand*/
          end
        end

      else

        if (PW0RW01.XBCCD == "*")
          if (PWMREC.XBCCD != "08") /* NE ColeHaan*/
            PW0R136(); /* Add special handling brand*/
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R117(); /* Add special handling*/
              PW0R134(); /* Add special handling division*/
            end
          else
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R134(); /* Add special handling division*/
            end
          end
        else
          if (PW0RW01.XBCCD == PWMREC.XBCCD)
            PW0R136(); /* Add special handling brand*/
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R117(); /* Add special handling*/
              PW0R134(); /* Add special handling division*/
            end
          else
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R134(); /* Add special handling division*/
            end
          end
        end

      end

      PW0R131(); /* Add totals for warehouse*/
    end
  end

  PW0R118(); /* close cursor in DPICK.VSELQT01*/


   /* ------------------------------------------------------------*/
   /* Select regular Handling Extra Quantities     DPICK.VSELQT01*/
   /* ------------------------------------------------------------*/

  PW0RW00.PK-SEL-TYP-CD = "17"; /* Set indicator to special handling*/

  PW0R115(); /* Open cursor in DPICK.VSELQT01*/

  PW0RW00.PW0RWCSR = "N"; /* end of cursor switch*/

  while (PW0RW00.PW0RWCSR == "N") /* until eof*/

    PW0R116(); /* fetch row in DPICK.VSELQT01*/

    if (PW0RW00.PW0RWCSR == "N") /* not end of file*/

      /* ------------------------------------------------------------*/
      /* Accumulate totals for either wildcard or specific values.*/
      /* ------------------------------------------------------------*/
      if (PW0RW01.XDVCD == "*") /* division code NE to wildcard*/

        PW0R134(); /* Add special handling division*/
        if (PW0RW01.XBCCD == "*") /* brand code NE to wildcard*/
          if (PWMREC.XBCCD != "08") /* NE ColeHaan*/
            PW0R117(); /* Add special handling*/
            PW0R136(); /* Add special handling brand*/
          end
        else
          if (PW0RW01.XBCCD == PWMREC.XBCCD)
            PW0R117(); /* Add special handling*/
            PW0R136(); /* Add special handling brand*/
          end
        end

      else

        if (PW0RW01.XBCCD == "*")
          if (PWMREC.XBCCD != "08") /* NE ColeHaan*/
            PW0R136(); /* Add special handling brand*/
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R117(); /* Add special handling*/
              PW0R134(); /* Add special handling division*/
            end
          else
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R134(); /* Add special handling division*/
            end
          end
        else
          if (PW0RW01.XBCCD == PWMREC.XBCCD)
            PW0R136(); /* Add special handling brand*/
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R117(); /* Add special handling*/
              PW0R134(); /* Add special handling division*/
            end
          else
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R134(); /* Add special handling division*/
            end
          end
        end

      end

      PW0R131(); /* Add totals for warehouse*/
    end
  end

  PW0R118(); /* close cursor in DPICK.VSELQT01*/


end // end PW0R120

// Calculate totals
Function PW0R130()
   /* +------------------------+*/
   /*  INITIALIZE TOTAL UNITS */
   /* +------------------------+*/
  PW0RW00.PW0RMTAO = 0; /* Total 'at once' units*/
  PW0RW00.PW0RMTPH = 0; /* Total 'pack & hold' units*/
  PW0RW00.PW0RMTSO = 0; /* Total selected order units*/
  PW0RW00.PW0RMTDV = 0; /* Total units by division code*/
  PW0RW00.PW0RMTBR = 0; /* Total units by brand code*/
  PW0RW00.PW0RMTWH = 0; /* Total units by warehouse code*/


   /* +------------------+*/
   /*  CALCULATE TOTALS */
   /* +------------------+*/

   /* ---- At once total units ------------------------------------------*/
  PW0RW00.PW0RMTAO = PW0RW00.PW0RMASR + PW0RW00.PW0RMARF + PW0RW00.PW0RMARR;
  PW0RW00.PW0RMTAO = PW0RW00.PW0RMTAO + PW0RW00.PW0RMAXF + PW0RW00.PW0RMAXR;
  PW0RW00.PW0RMTAO = PW0RW00.PW0RMTAO + PW0RW00.PW0RMABG + PW0RW00.PW0RMACO;
  PW0RW00.PW0RMTAO = PW0RW00.PW0RMTAO + PW0RW00.PW0RMAPF + PW0RW00.PW0RMAPR;
  PW0RW00.PW0RMTAO = PW0RW00.PW0RMTAO + PW0RW00.PW0RW-EX-NS-FC-QTY;
  PW0RW00.PW0RMTAO = PW0RW00.PW0RMTAO + PW0RW00.PW0RW-EX-NS-RP-QTY;
  PW0RW00.PW0RMTAO = PW0RW00.PW0RMTAO + PW0RW00.PW0RW-EX-SP-RP-QTY;
   /* TT# 3670 change begins*/
  PW0RW00.PW0RMTAO = PW0RW00.PW0RMTAO + PW0RW00.PW0RMAER; /* add equipment*/
   /* TT# 3670 change ends*/

   /* ----- Pack & hold total units -------------------------------------*/
  PW0RW00.PW0RMTPH = PW0RW00.PW0RMPSR + PW0RW00.PW0RMPRF + PW0RW00.PW0RMPRR;
  PW0RW00.PW0RMTPH = PW0RW00.PW0RMTPH + PW0RW00.PW0RMPXF + PW0RW00.PW0RMPXR;
  PW0RW00.PW0RMTPH = PW0RW00.PW0RMTPH + PW0RW00.PW0RMPBG + PW0RW00.PW0RMPCO;
  PW0RW00.PW0RMTPH = PW0RW00.PW0RMTPH + PW0RW00.PW0RMPPF + PW0RW00.PW0RMPPR;
   /* ----- Selected order total units ----------------------------------*/
  PW0RW00.PW0RMTSO = PW0RW00.PW0RMOSR + PW0RW00.PW0RMORF + PW0RW00.PW0RMORR;
  PW0RW00.PW0RMTSO = PW0RW00.PW0RMTSO + PW0RW00.PW0RMOXF + PW0RW00.PW0RMOXR;
  PW0RW00.PW0RMTSO = PW0RW00.PW0RMTSO + PW0RW00.PW0RMOBG + PW0RW00.PW0RMOCO;
  PW0RW00.PW0RMTSO = PW0RW00.PW0RMTSO + PW0RW00.PW0RMOPF + PW0RW00.PW0RMOPR; /* TT# 3670 change begins*/
  PW0RW00.PW0RMTSO = PW0RW00.PW0RMTSO + PW0RW00.PW0RMOER; /* add equipment*/
   /* TT# 3670 change ends*/


   /* ----- Totals by division code -------------------------------------*/
  PW0RW00.PW0RMTDV = PW0RW00.PW0RMTDV + PW0RW00.PW0RMDSR; /* add spec hdlg*/
  PW0RW00.PW0RMTDV = PW0RW00.PW0RMTDV + PW0RW00.PW0RMDRF; /* add reg fc*/
  PW0RW00.PW0RMTDV = PW0RW00.PW0RMTDV + PW0RW00.PW0RMDRR; /* add reg rp*/
  PW0RW00.PW0RMTDV = PW0RW00.PW0RMTDV + PW0RW00.PW0RMDXF; /* add s xfer fc*/
  PW0RW00.PW0RMTDV = PW0RW00.PW0RMTDV + PW0RW00.PW0RMDXR; /* add s xfer rp*/
  PW0RW00.PW0RMTDV = PW0RW00.PW0RMTDV + PW0RW00.PW0RMDBG; /* add b-grade*/
  PW0RW00.PW0RMTDV = PW0RW00.PW0RMTDV + PW0RW00.PW0RMDCO; /* add closeouts*/
  PW0RW00.PW0RMTDV = PW0RW00.PW0RMTDV + PW0RW00.PW0RMDPF; /* add in-store f*/
  PW0RW00.PW0RMTDV = PW0RW00.PW0RMTDV + PW0RW00.PW0RMDPR; /* add in-store r*/
  /* extra quantities*/
  PW0RW00.PW0RMTDV = PW0RW00.PW0RMTDV + PW0RW00.PW0RW-EX-NS-FC-DIV;
  PW0RW00.PW0RMTDV = PW0RW00.PW0RMTDV + PW0RW00.PW0RW-EX-NS-RP-DIV;
  PW0RW00.PW0RMTDV = PW0RW00.PW0RMTDV + PW0RW00.PW0RW-EX-SP-RP-DIV;
   /* TT# 3670 change begins*/
  PW0RW00.PW0RMTDV = PW0RW00.PW0RMTDV + PW0RW00.PW0RMDER; /* add equipment*/
   /* TT# 3670 change ends*/

   /* ----- Totals by brand code ----------------------------------------*/
  PW0RW00.PW0RMTBR = PW0RW00.PW0RMTBR + PW0RW00.PW0RMBSR; /* add spec hdlg*/
  PW0RW00.PW0RMTBR = PW0RW00.PW0RMTBR + PW0RW00.PW0RMBRF; /* add reg fc*/
  PW0RW00.PW0RMTBR = PW0RW00.PW0RMTBR + PW0RW00.PW0RMBRR; /* add reg rp*/
  PW0RW00.PW0RMTBR = PW0RW00.PW0RMTBR + PW0RW00.PW0RMBXF; /* add s xfer fc*/
  PW0RW00.PW0RMTBR = PW0RW00.PW0RMTBR + PW0RW00.PW0RMBXR; /* add s xfer rp*/
  PW0RW00.PW0RMTBR = PW0RW00.PW0RMTBR + PW0RW00.PW0RMBBG; /* add b-grade*/
  PW0RW00.PW0RMTBR = PW0RW00.PW0RMTBR + PW0RW00.PW0RMBCO; /* add closeouts*/
  PW0RW00.PW0RMTBR = PW0RW00.PW0RMTBR + PW0RW00.PW0RMBPF; /* add in-store f*/
  PW0RW00.PW0RMTBR = PW0RW00.PW0RMTBR + PW0RW00.PW0RMBPR; /* add in-store r*/
  /* extra quantities*/
  PW0RW00.PW0RMTBR = PW0RW00.PW0RMTBR + PW0RW00.PW0RW-EX-NS-FC-BRAND;
  PW0RW00.PW0RMTBR = PW0RW00.PW0RMTBR + PW0RW00.PW0RW-EX-NS-RP-BRAND;
  PW0RW00.PW0RMTBR = PW0RW00.PW0RMTBR + PW0RW00.PW0RW-EX-SP-RP-BRAND;
   /* TT# 3670 change begins*/
  PW0RW00.PW0RMTBR = PW0RW00.PW0RMTBR + PW0RW00.PW0RMBER; /* add equipment*/
   /* TT# 3670 change ends*/

   /* ----- Totals by warehouse code ------------------------------------*/
  PW0RW00.PW0RMTWH = PW0RW00.PW0RMTWH + PW0RW00.PW0RMWSR; /* add spec hdlg*/
  PW0RW00.PW0RMTWH = PW0RW00.PW0RMTWH + PW0RW00.PW0RMWRF; /* add reg fc*/
  PW0RW00.PW0RMTWH = PW0RW00.PW0RMTWH + PW0RW00.PW0RMWRR; /* add reg rp*/
  PW0RW00.PW0RMTWH = PW0RW00.PW0RMTWH + PW0RW00.PW0RMWXF; /* add s xfer fc*/
  PW0RW00.PW0RMTWH = PW0RW00.PW0RMTWH + PW0RW00.PW0RMWXR; /* add s xfer rp*/
  PW0RW00.PW0RMTWH = PW0RW00.PW0RMTWH + PW0RW00.PW0RMWBG; /* add b-grade*/
  PW0RW00.PW0RMTWH = PW0RW00.PW0RMTWH + PW0RW00.PW0RMWCO; /* add closeouts*/
  PW0RW00.PW0RMTWH = PW0RW00.PW0RMTWH + PW0RW00.PW0RMWPF; /* add in-store f*/
  PW0RW00.PW0RMTWH = PW0RW00.PW0RMTWH + PW0RW00.PW0RMWPR; /* add in-store r*/
  /* extra quantities*/
  PW0RW00.PW0RMTWH = PW0RW00.PW0RMTWH + PW0RW00.PW0RW-EX-NS-FC-WHSE;
  PW0RW00.PW0RMTWH = PW0RW00.PW0RMTWH + PW0RW00.PW0RW-EX-NS-RP-WHSE;
  PW0RW00.PW0RMTWH = PW0RW00.PW0RMTWH + PW0RW00.PW0RW-EX-SP-RP-WHSE;
   /* TT# 3670 change begins*/
  PW0RW00.PW0RMTWH = PW0RW00.PW0RMTWH + PW0RW00.PW0RMWER; /* add equipment*/
   /* TT# 3670 change ends*/

   /* +------------------------------+*/
   /*   BREAKOUT HOURS AND MINUTES  */
   /* +------------------------------+*/

   /* --- Calculate Spec Hndl Hrs / Brand Cd ---*/
  PW0RW00.PW0RWWHM = 0; /* init work hours/min*/

  PW0RW00.PW0RWWHH = PW0RW00.PW0RWBHW / 60; /* min/60 = hhhh.mm*/
  PW0RW00.PW0RWRMM = PW0RW00.PW0RWWHH * 60; /* interim work field for mins*/
  PW0RW00.PW0RWWMM = PW0RW00.PW0RWBHW - PW0RW00.PW0RWRMM;

  PW0RW01.PW0RMBHH = PW0RW00.PW0RWWHH; /* display tot hours*/
  PW0RW01.PW0RMBCL = ":"; /* colon*/
  PW0RW01.PW0RMBMM = PW0RW00.PW0RWWMM; /* display tot min*/

   /* --- Calculate Spec Hndl Hrs / Div Cd -----*/
  PW0RW00.PW0RWWHM = 0; /* init work hours/min*/

  PW0RW00.PW0RWWHH = PW0RW00.PW0RWDHW / 60; /* min/60 = hhhh.mm*/
  PW0RW00.PW0RWRMM = PW0RW00.PW0RWWHH * 60; /* interim work field for mins*/
  PW0RW00.PW0RWWMM = PW0RW00.PW0RWDHW - PW0RW00.PW0RWRMM;

  PW0RW01.PW0RMDHH = PW0RW00.PW0RWWHH; /* display tot hours*/
  PW0RW01.PW0RMDCL = ":"; /* colon*/
  PW0RW01.PW0RMDMM = PW0RW00.PW0RWWMM; /* display tot min*/

   /* --- Calculate Spec Hndl Hrs / Whse Cd ----*/
  PW0RW00.PW0RWWHM = 0; /* init work hours/min*/

  PW0RW00.PW0RWWHH = PW0RW00.PW0RWWHW / 60; /* min/60 = hhhh.mm*/
  PW0RW00.PW0RWRMM = PW0RW00.PW0RWWHH * 60; /* interim work field for mins*/
  PW0RW00.PW0RWWMM = PW0RW00.PW0RWWHW - PW0RW00.PW0RWRMM;

  PW0RW01.PW0RMWHH = PW0RW00.PW0RWWHH; /* display tot hours*/
  PW0RW01.PW0RMWCL = ":"; /* colon*/
  PW0RW01.PW0RMWMM = PW0RW00.PW0RWWMM; /* display tot min*/


   /* --- Calculate Spec Hndl At Once Hours ----*/
  PW0RW00.PW0RWWHM = 0; /* init work hours/min*/

  PW0RW00.PW0RWWHH = PW0RW00.PW0RWAHW / 60; /* min/60 = hhhh.mm*/
  PW0RW00.PW0RWRMM = PW0RW00.PW0RWWHH * 60; /* interim work field for mins*/
  PW0RW00.PW0RWWMM = PW0RW00.PW0RWAHW - PW0RW00.PW0RWRMM;

  PW0RW01.PW0RMAHH = PW0RW00.PW0RWWHH; /* tot hours*/
  PW0RW01.PW0RMACL = ":"; /* colon*/
  PW0RW01.PW0RMAMM = PW0RW00.PW0RWWMM; /* tot min*/


   /* --- Calculate Spec Hndl P & H  Hours -----*/
  PW0RW00.PW0RWWHM = 0; /* init work hours/min*/

  PW0RW00.PW0RWWHH = PW0RW00.PW0RWPHW / 60; /* min/60 = hhhh.mm*/
  PW0RW00.PW0RWRMM = PW0RW00.PW0RWWHH * 60; /* INTERIM WORK FIELD FOR MINS*/
  PW0RW00.PW0RWWMM = PW0RW00.PW0RWPHW - PW0RW00.PW0RWRMM;

  PW0RW01.PW0RMPHH = PW0RW00.PW0RWWHH; /* tot hours*/
  PW0RW01.PW0RMPCL = ":"; /* colon*/
  PW0RW01.PW0RMPMM = PW0RW00.PW0RWWMM; /* tot min*/


   /* --- Calculate Selected Order Hours -------*/
  PW0RW00.PW0RWWHM = 0; /* init work hours/min*/

  PW0RW00.PW0RWWHH = PW0RW00.PW0RWOHW / 60; /* min/60 = hhhh.mm*/
  PW0RW00.PW0RWRMM = PW0RW00.PW0RWWHH * 60; /* INTERIM WORK FIELD FOR MINS*/
  PW0RW00.PW0RWWMM = PW0RW00.PW0RWOHW - PW0RW00.PW0RWRMM;

  PW0RW01.PW0RMOHH = PW0RW00.PW0RWWHH; /* tot hours*/
  PW0RW01.PW0RMOCL = ":"; /* colon*/
  PW0RW01.PW0RMOMM = PW0RW00.PW0RWWMM; /* tot min*/

   /* --- COME UP WITH TOTAL UNITS BY FULL CASE AND REPACK. EACH WAREHOUSE*/
   /* --- HAS A DIFFERENT SPLIT ON SPECIAL, B-GRADE AND CLOSEOUT.*/
  PW0RW00.PW0RMTWF = 0; /* CLEAR FULLCASE BUCKET*/
  PW0RW00.PW0RMTWR = 0; /* CLEAR REPACK BUCKET*/
                                  /* WHSE 02 GREENLAND*/
  if (PKWREC.XWHCD == "02")

     /* 33% SPEC HANDL, 33% B-GRADE, 33% CLOSE-OUT IS FULLCASE.*/
    PW0RW00.PW0RMTWF = PW0RW00.PW0RMTWF + PW0RW00.PW0RMWSR * .33;
    PW0RW00.PW0RMTWF = PW0RW00.PW0RMTWF + PW0RW00.PW0RMWBG * .33;
    PW0RW00.PW0RMTWF = PW0RW00.PW0RMTWF + PW0RW00.PW0RMWCO * .33;

     /* 67% SPEC HANDL, 67% B-GRADE, 67% CLOSE-OUT IS REPACK.*/
    PW0RW00.PW0RMTWR = PW0RW00.PW0RMTWR + PW0RW00.PW0RMWSR * .67;
    PW0RW00.PW0RMTWR = PW0RW00.PW0RMTWR + PW0RW00.PW0RMWBG * .67;
    PW0RW00.PW0RMTWR = PW0RW00.PW0RMTWR + PW0RW00.PW0RMWCO * .67;
  end
                                  /* WHSE 04 MEMPHIS FOOTWEAR*/
  if (PKWREC.XWHCD == "04")

     /* 0% SPEC HANDL, 40% B-GRADE, 40% CLOSE-OUT IS FULLCASE.*/
    PW0RW00.PW0RMTWF = PW0RW00.PW0RMTWF + PW0RW00.PW0RMWSR * .00;
    PW0RW00.PW0RMTWF = PW0RW00.PW0RMTWF + PW0RW00.PW0RMWBG * .40;
    PW0RW00.PW0RMTWF = PW0RW00.PW0RMTWF + PW0RW00.PW0RMWCO * .40;

     /* 100% SPEC HANDL, 60% B-GRADE, 60% CLOSE-OUT IS REPACK.*/
    PW0RW00.PW0RMTWR = PW0RW00.PW0RMTWR + PW0RW00.PW0RMWSR * 1.00;
    PW0RW00.PW0RMTWR = PW0RW00.PW0RMTWR + PW0RW00.PW0RMWBG * .60;
    PW0RW00.PW0RMTWR = PW0RW00.PW0RMTWR + PW0RW00.PW0RMWCO * .60;
  end
                                  /* WHSE 07 WILSONVILLE*/
  if (PKDREC.XWHCD == "07")

     /* 70% SPEC HANDL, 70% B-GRADE, 70% CLOSE-OUT IS FULLCASE.*/
    PW0RW00.PW0RMTWF = PW0RW00.PW0RMTWF + PW0RW00.PW0RMWSR * .70;
    PW0RW00.PW0RMTWF = PW0RW00.PW0RMTWF + PW0RW00.PW0RMWBG * .70;
    PW0RW00.PW0RMTWF = PW0RW00.PW0RMTWF + PW0RW00.PW0RMWCO * .70;

     /* 30% SPEC HANDL, 30% B-GRADE, 30% CLOSE-OUT IS REPACK.*/
    PW0RW00.PW0RMTWR = PW0RW00.PW0RMTWR + PW0RW00.PW0RMWSR * .30;
    PW0RW00.PW0RMTWR = PW0RW00.PW0RMTWR + PW0RW00.PW0RMWBG * .30;
    PW0RW00.PW0RMTWR = PW0RW00.PW0RMTWR + PW0RW00.PW0RMWCO * .30;
  end
                                  /* WHSE 51 MEMPHIS APPAREL*/
  if (PKWREC.XWHCD == "51")

     /* 05% SPEC HANDL, 20% B-GRADE, 25% CLOSE-OUT IS FULLCASE.*/
    PW0RW00.PW0RMTWF = PW0RW00.PW0RMTWF + PW0RW00.PW0RMWSR * .05;
    PW0RW00.PW0RMTWF = PW0RW00.PW0RMTWF + PW0RW00.PW0RMWBG * .20;
    PW0RW00.PW0RMTWF = PW0RW00.PW0RMTWF + PW0RW00.PW0RMWCO * .25;

     /* 95% SPEC HANDL, 80% B-GRADE, 75% CLOSE-OUT IS REPACK.*/
    PW0RW00.PW0RMTWR = PW0RW00.PW0RMTWR + PW0RW00.PW0RMWSR * .95;
    PW0RW00.PW0RMTWR = PW0RW00.PW0RMTWR + PW0RW00.PW0RMWBG * .80;
    PW0RW00.PW0RMTWR = PW0RW00.PW0RMTWR + PW0RW00.PW0RMWCO * .75;
  end
                                  /* WHSE 42 Canada*/
  if (PKWREC.XWHCD == "42")

     /* 05% SPEC HANDL, 20% B-GRADE, 25% CLOSE-OUT IS FULLCASE.*/
    PW0RW00.PW0RMTWF = PW0RW00.PW0RMTWF + PW0RW00.PW0RMWSR * .05;
    PW0RW00.PW0RMTWF = PW0RW00.PW0RMTWF + PW0RW00.PW0RMWBG * .20;
    PW0RW00.PW0RMTWF = PW0RW00.PW0RMTWF + PW0RW00.PW0RMWCO * .25;

     /* 95% SPEC HANDL, 80% B-GRADE, 75% CLOSE-OUT IS REPACK.*/
    PW0RW00.PW0RMTWR = PW0RW00.PW0RMTWR + PW0RW00.PW0RMWSR * .95;
    PW0RW00.PW0RMTWR = PW0RW00.PW0RMTWR + PW0RW00.PW0RMWBG * .80;
    PW0RW00.PW0RMTWR = PW0RW00.PW0RMTWR + PW0RW00.PW0RMWCO * .75;
  end

   /* NOW ADD-UP THE REST OF THE FC AND RP units.*/

   /* SPLITS FROM ABOVE*/
   /* REGULAR FULL CASE*/
   /* STOCK X-FER FULL CASE*/
  PW0RW00.PW0RMTWF = PW0RW00.PW0RMTWF +   PW0RW00.PW0RMWRF +   PW0RW00.PW0RMWXF +   PW0RW00.PW0RMWPF; /* PROMO FULL CASE*/

   /* SPLITS FROM ABOVE*/
   /* REGULAR REPACK*/
   /* STOCK X-FER REPACK*/
  PW0RW00.PW0RMTWR = PW0RW00.PW0RMTWR +   PW0RW00.PW0RMWRR +   PW0RW00.PW0RMWXR +   PW0RW00.PW0RMWPR; /* PROMO REPACK*/

  PW0R133(); /* GET PICK RATES FROM DPICK.VPKCTL01*/

   /* --- Calculate repack pick time ----*/
   /* units times minutes per unit*/
  PW0RW00.PW0RMTWR = PW0RW00.PW0RMTWR *   PKDREC.PKDDRPPM; /* equals minutes*/
  PW0RW00.PW0RWWHH = PW0RW00.PW0RMTWR / 60; /* minutes / 60 = hours*/
  PW0RW00.PW0RWRMM = PW0RW00.PW0RWWHH * 60; /* whole hours back to minutes*/
   /* diff is remainder in minutes*/
  PW0RW00.PW0RWWMM = PW0RW00.PW0RMTWR -   PW0RW00.PW0RWRMM;

  PW0RW01.PW0RMRHH = PW0RW00.PW0RWWHH; /* repack hours*/
  PW0RW01.PW0RMRCL = ":"; /* colon*/
  PW0RW01.PW0RMRMM = PW0RW00.PW0RWWMM; /* repack minutes*/

   /* --- Calculate fullcase pick time ----*/
   /* units times minutes per unit*/
  PW0RW00.PW0RMTWF = PW0RW00.PW0RMTWF *   PKDREC.PKDDFCPM; /* equals minutes*/
  PW0RW00.PW0RWWHH = PW0RW00.PW0RMTWF / 60; /* minutes / 60 = hours*/
  PW0RW00.PW0RWRMM = PW0RW00.PW0RWWHH * 60; /* whole hours back to minutes*/
   /* diff is remainder in minutes*/
  PW0RW00.PW0RWWMM = PW0RW00.PW0RMTWF -   PW0RW00.PW0RWRMM;

  PW0RW01.PW0RMFHH = PW0RW00.PW0RWWHH; /* full case hours*/
  PW0RW01.PW0RMFCL = ":"; /* colon*/
  PW0RW01.PW0RMFMM = PW0RW00.PW0RWWMM; /* full case minutes*/


   /* +----------------------------+*/
   /*    Move To Display Storage  */
   /* +----------------------------+*/

   /* -------- at once units -----------------*/
  PW0RW01.PW0RMASR = PW0RW00.PW0RMASR; /* Spec Handling Units*/
  PW0RW01.PW0RMARF = PW0RW00.PW0RMARF; /* regular full case*/
  PW0RW01.PW0RMARR = PW0RW00.PW0RMARR; /* regular repack*/
  PW0RW01.PW0RMAXF = PW0RW00.PW0RMAXF; /* stock xfer full case*/
  PW0RW01.PW0RMAXR = PW0RW00.PW0RMAXR; /* stock xfer repack*/
  PW0RW01.PW0RMABG = PW0RW00.PW0RMABG; /* b-grade*/
  PW0RW01.PW0RMACO = PW0RW00.PW0RMACO; /* closeouts*/
  PW0RW01.PW0RMAPF = PW0RW00.PW0RMAPF; /* in-store promo full case*/
  PW0RW01.PW0RMAPR = PW0RW00.PW0RMAPR; /* in-store promo repack*/
   /* TT# 3670 change begins*/
  PW0RW01.PW0RMAER = PW0RW00.PW0RMAER; /* Equipment Units*/
   /* TT# 3670 change ends*/
  /* extra qty*/
  PW0RW01.PW0R-EX-NS-FC-QTY = PW0RW00.PW0RW-EX-NS-FC-QTY;
  PW0RW01.PW0R-EX-NS-RP-QTY = PW0RW00.PW0RW-EX-NS-RP-QTY;
  PW0RW01.PW0R-EX-SP-RP-QTY = PW0RW00.PW0RW-EX-SP-RP-QTY;

   /* -------- p & h  units ------------------*/
  PW0RW01.PW0RMPSR = PW0RW00.PW0RMPSR; /* p&h spec handling units*/
  PW0RW01.PW0RMPRF = PW0RW00.PW0RMPRF; /* p&h full case*/
  PW0RW01.PW0RMPRR = PW0RW00.PW0RMPRR; /* p&h repack*/
  PW0RW01.PW0RMPXF = PW0RW00.PW0RMPXF; /* stock xfer full case*/
  PW0RW01.PW0RMPXR = PW0RW00.PW0RMPXR; /* stock xfer repack*/
  PW0RW01.PW0RMPBG = PW0RW00.PW0RMPBG; /* b-grade*/
  PW0RW01.PW0RMPCO = PW0RW00.PW0RMPCO; /* closeouts*/
  PW0RW01.PW0RMPPF = PW0RW00.PW0RMPPF; /* in-store promo full case*/
  PW0RW01.PW0RMPPR = PW0RW00.PW0RMPPR; /* in-store promo repack*/

   /* -------- sel'd by order units ----------*/
  PW0RW01.PW0RMOSR = PW0RW00.PW0RMOSR; /* ord spec handling units*/
  PW0RW01.PW0RMORF = PW0RW00.PW0RMORF; /* ord full case*/
  PW0RW01.PW0RMORR = PW0RW00.PW0RMORR; /* ord repack*/
  PW0RW01.PW0RMOXF = PW0RW00.PW0RMOXF; /* ord stock xfer full case*/
  PW0RW01.PW0RMOXR = PW0RW00.PW0RMOXR; /* ord stock xfer repack*/
  PW0RW01.PW0RMOBG = PW0RW00.PW0RMOBG; /* b-grade*/
  PW0RW01.PW0RMOCO = PW0RW00.PW0RMOCO; /* closeouts*/
  PW0RW01.PW0RMOPF = PW0RW00.PW0RMOPF; /* in-store promo full case*/
  PW0RW01.PW0RMOPR = PW0RW00.PW0RMOPR; /* in-store promo repack*/
   /* TT# 3670 change begins*/
  PW0RW01.PW0RMOER = PW0RW00.PW0RMOER; /* equipment units*/
   /* TT# 3670 change ends*/

   /* -------- total units by division code --*/
  PW0RW01.PW0RMDSR = PW0RW00.PW0RMDSR; /* Total spcl handle units*/
  PW0RW01.PW0RMDRF = PW0RW00.PW0RMDRF; /* Total reg handling full cs*/
  PW0RW01.PW0RMDRR = PW0RW00.PW0RMDRR; /* Total reg handling repack*/
  PW0RW01.PW0RMDXF = PW0RW00.PW0RMDXF; /* Total stock xfer full case*/
  PW0RW01.PW0RMDXR = PW0RW00.PW0RMDXR; /* Total stock xfer repack*/
  PW0RW01.PW0RMDBG = PW0RW00.PW0RMDBG; /* Total b-grade*/
  PW0RW01.PW0RMDCO = PW0RW00.PW0RMDCO; /* Total closeouts*/
  PW0RW01.PW0RMDPF = PW0RW00.PW0RMDPF; /* Total in-store promo fc*/
  PW0RW01.PW0RMDPR = PW0RW00.PW0RMDPR; /* Total in-store promo rp*/
   /* TT# 3670 change begins*/
  PW0RW01.PW0RMDER = PW0RW00.PW0RMDER; /* Total Equipment units*/
   /* TT# 3670 change ends*/
  /* extra qty*/
  PW0RW01.PW0R-EX-NS-FC-DIV = PW0RW00.PW0RW-EX-NS-FC-DIV;
  PW0RW01.PW0R-EX-NS-RP-DIV = PW0RW00.PW0RW-EX-NS-RP-DIV;
  PW0RW01.PW0R-EX-SP-RP-DIV = PW0RW00.PW0RW-EX-SP-RP-DIV;

   /* -------- total units by brand code -----*/
  PW0RW01.PW0RMBSR = PW0RW00.PW0RMBSR; /* Total spcl handle units*/
  PW0RW01.PW0RMBRF = PW0RW00.PW0RMBRF; /* Total reg handling full cs*/
  PW0RW01.PW0RMBRR = PW0RW00.PW0RMBRR; /* Total reg handling repack*/
  PW0RW01.PW0RMBXF = PW0RW00.PW0RMBXF; /* Total stock xfer full case*/
  PW0RW01.PW0RMBXR = PW0RW00.PW0RMBXR; /* Total stock xfer repack*/
  PW0RW01.PW0RMBBG = PW0RW00.PW0RMBBG; /* Total b-grade*/
  PW0RW01.PW0RMBCO = PW0RW00.PW0RMBCO; /* Total closeouts*/
  PW0RW01.PW0RMBPF = PW0RW00.PW0RMBPF; /* Total in-store promo fc*/
  PW0RW01.PW0RMBPR = PW0RW00.PW0RMBPR; /* Total in-store promo rp*/
   /* TT# 3670 change begins*/
  PW0RW01.PW0RMBER = PW0RW00.PW0RMBER; /* Total equipment units*/
   /* TT# 3670 change ends*/
  /* extra qty*/
  PW0RW01.PW0R-EX-NS-FC-BRAND = PW0RW00.PW0RW-EX-NS-FC-BRAND;
  PW0RW01.PW0R-EX-NS-RP-BRAND = PW0RW00.PW0RW-EX-NS-RP-BRAND;
  PW0RW01.PW0R-EX-SP-RP-BRAND = PW0RW00.PW0RW-EX-SP-RP-BRAND;

   /* -------- total units by warehouse code --*/
  PW0RW01.PW0RMWSR = PW0RW00.PW0RMWSR; /* Total spcl handle units*/
  PW0RW01.PW0RMWRF = PW0RW00.PW0RMWRF; /* Total reg handling full cs*/
  PW0RW01.PW0RMWRR = PW0RW00.PW0RMWRR; /* Total reg handling repack*/
  PW0RW01.PW0RMWXF = PW0RW00.PW0RMWXF; /* Total stock xfer full case*/
  PW0RW01.PW0RMWXR = PW0RW00.PW0RMWXR; /* Total stock xfer repack*/
  PW0RW01.PW0RMWBG = PW0RW00.PW0RMWBG; /* Total b-grade*/
  PW0RW01.PW0RMWCO = PW0RW00.PW0RMWCO; /* Total closeouts*/
  PW0RW01.PW0RMWPF = PW0RW00.PW0RMWPF; /* Total in-store promo fc*/
  PW0RW01.PW0RMWPR = PW0RW00.PW0RMWPR; /* Total in-store promo rp*/
   /* TT# 3670 change begins*/
  PW0RW01.PW0RMWER = PW0RW00.PW0RMWER; /* Total equipment units*/
   /* TT# 3670 change ends*/
  /* extra qty*/
  PW0RW01.PW0R-EX-NS-FC-WHSE = PW0RW00.PW0RW-EX-NS-FC-WHSE;
  PW0RW01.PW0R-EX-NS-RP-WHSE = PW0RW00.PW0RW-EX-NS-RP-WHSE;
  PW0RW01.PW0R-EX-SP-RP-WHSE = PW0RW00.PW0RW-EX-SP-RP-WHSE;

   /* -------- totals units ------------------*/
  PW0RW01.PW0RMTAO = PW0RW00.PW0RMTAO; /* total 'at once' units*/
  PW0RW01.PW0RMTPH = PW0RW00.PW0RMTPH; /* total pack&hold units*/
  PW0RW01.PW0RMTSO = PW0RW00.PW0RMTSO; /* total selected order units*/
  PW0RW01.PW0RMTDV = PW0RW00.PW0RMTDV; /* total units by div code*/
  PW0RW01.PW0RMTBR = PW0RW00.PW0RMTBR; /* total units by brand code*/
  PW0RW01.PW0RMTWH = PW0RW00.PW0RMTWH; /* total units by whse code*/


end // end PW0R130

// Accumulate whse totals
Function PW0R131()
   /* +------------------+*/
   /*  CALCULATE TOTALS */
   /*  for warehouse    */
   /* +------------------+*/

  if (PW0RW00.PK-SEL-TYP-CD == " 1" /* spcl hndl*/
   /* TT# 3670 change begins*/
   || PW0RW00.PK-SEL-TYP-CD == "22" /* new spcl hndl code*/
   || PW0RW00.PK-SEL-TYP-CD == "23" /* new spcl hndl code*/
   || PW0RW00.PK-SEL-TYP-CD == "24" /* new spcl hndl code*/
   || PW0RW00.PK-SEL-TYP-CD == "25" /* new spcl hndl code*/
   /* TT# 3670 change ends*/
   || PW0RW00.PK-SEL-TYP-CD == " 3" /* p & h spcl hndl*/
   || PW0RW00.PK-SEL-TYP-CD == " 5") /* sel'd by order spcl hndl*/

    PW0RW00.PW0RMWSR = PW0RW00.PW0RMWSR + PWMREC.PKHPVSFC;
    PW0RW00.PW0RMWSR = PW0RW00.PW0RMWSR + PWMREC.PKHPVSRP;
    PW0RW00.PW0RWWHW = PW0RW00.PW0RWWHW + PWMREC.PKHPVSMM; /* minutes*/

  else
    if (PW0RW00.PK-SEL-TYP-CD == " 2" /* regular*/
     || PW0RW00.PK-SEL-TYP-CD == " 4" /* p & h regular*/
     || PW0RW00.PK-SEL-TYP-CD == " 6") /* sel'd by order regular*/
      PW0RW00.PW0RMWRF = PW0RW00.PW0RMWRF + PWMREC.PKHPVSFC;
      PW0RW00.PW0RMWRR = PW0RW00.PW0RMWRR + PWMREC.PKHPVSRP;
      /* TT# 3670 change begins*/
    else
      if (PW0RW00.PK-SEL-TYP-CD == "30" /* new regular code*/
       || PW0RW00.PK-SEL-TYP-CD == "31") /* new regular code*/
        PW0RW00.PW0RMWRF = PW0RW00.PW0RMWRF + PWMREC.PKHPVSFC;
      else
        if (PW0RW00.PK-SEL-TYP-CD == "34" /* new regular code*/
         || PW0RW00.PK-SEL-TYP-CD == "35") /* new regular code*/
          PW0RW00.PW0RMWRR = PW0RW00.PW0RMWRR + PWMREC.PKHPVSRP;
      /* TT# 3670 change ends*/

        else
          if (PW0RW00.PK-SEL-TYP-CD == "10" /* b-grade spcl hndl*/
           || PW0RW00.PK-SEL-TYP-CD == "11" /* b-grade non-spcl hndl*/
           /* TT# 3670 change begins*/
           || PW0RW00.PK-SEL-TYP-CD == "40" /* new b-grade code*/
           || PW0RW00.PK-SEL-TYP-CD == "41") /* new b-grade code*/
        /* TT# 3670 change ends*/

            PW0RW00.PW0RMWBG = PW0RW00.PW0RMWBG + PWMREC.PKHPVSFC;
            PW0RW00.PW0RMWBG = PW0RW00.PW0RMWBG + PWMREC.PKHPVSRP;

          else
            if (PW0RW00.PK-SEL-TYP-CD == "12" /* closeouts spcl hndl*/
             || PW0RW00.PK-SEL-TYP-CD == "13" /* closeouts non-spcl hndl*/
             /* TT# 3670 change begins*/
             || PW0RW00.PK-SEL-TYP-CD == "28" /* new closeouts code*/
             || PW0RW00.PK-SEL-TYP-CD == "29") /* new closeouts code*/
          /* TT# 3670 change ends*/

              PW0RW00.PW0RMWCO = PW0RW00.PW0RMWCO + PWMREC.PKHPVSFC;
              PW0RW00.PW0RMWCO = PW0RW00.PW0RMWCO + PWMREC.PKHPVSRP;

            else
              if (PW0RW00.PK-SEL-TYP-CD == "14" /* in-store promo spcl hndl*/
               || PW0RW00.PK-SEL-TYP-CD == "15") /* in-store promo non-spcl*/

                PW0RW00.PW0RMWPF = PW0RW00.PW0RMWPF + PWMREC.PKHPVSFC;
                PW0RW00.PW0RMWPR = PW0RW00.PW0RMWPR + PWMREC.PKHPVSRP;

              else
                if (PW0RW00.PK-SEL-TYP-CD == "16") /* extra special handling*/

                  PW0RW00.PW0RW-EX-SP-RP-WHSE = PW0RW00.PW0RW-EX-SP-RP-WHSE               + PWMREC.PKHPVSRP;

                else
                  if (PW0RW00.PK-SEL-TYP-CD == "17") /* extra non-spcl handling*/

                    PW0RW00.PW0RW-EX-NS-FC-WHSE = PW0RW00.PW0RW-EX-NS-FC-WHSE                 + PWMREC.PKHPVSFC;
                    PW0RW00.PW0RW-EX-NS-RP-WHSE = PW0RW00.PW0RW-EX-NS-RP-WHSE                 + PWMREC.PKHPVSRP;

                  end
                end
              end
            end
          end
        end
      end
    end
  end

   /* TT# 3670 change begins*/
   /* ----------------------------------------------*/
   /* Ware house total accumulation for Equipment*/
   /* ----------------------------------------------*/
  if (PW0RW00.PK-SEL-TYP-CD == "26" /* equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "27" /* equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "36" /* equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "37" /* equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "38" /* equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "39" /* equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "42" /* equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "43") /* equipment code*/

    PW0RW00.PW0RMWER = PW0RW00.PW0RMWER + PWMREC.PKHPVSFC;
    PW0RW00.PW0RMWER = PW0RW00.PW0RMWER + PWMREC.PKHPVSRP;
  end
   /* TT# 3670 change ends*/

end // end PW0R131

// Accumulate whse totals
Function PW0R132()
   /* +------------------+*/
   /*  CALCULATE TOTALS */
   /* +------------------+*/

  if (PKHREC.PK-SEL-TYP-CD == " 1" /* spcl hndl*/
   || PKHREC.PK-SEL-TYP-CD == " 3" /* p & h spcl hndl*/
   || PKHREC.PK-SEL-TYP-CD == " 5" /* sel'd by order spcl hndl*/
   /* TT# 3670 change begins*/
   || PKHREC.PK-SEL-TYP-CD == "22" /* new sel'd by ord spl hndl*/
   || PKHREC.PK-SEL-TYP-CD == "23" /* new sel'd by ord spl hndl*/
   || PKHREC.PK-SEL-TYP-CD == "24" /* new sel'd by ord spl hndl*/
   || PKHREC.PK-SEL-TYP-CD == "25") /* new sel'd by ord spl hndl*/
  /* TT# 3670 change ends*/

    if (PK1NORID == 0) /* ; stock xfer*/
      PW0RW00.PW0RMWXF = PW0RW00.PW0RMWXF + PKHREC.PKHPVSFC;
      PW0RW00.PW0RMWXR = PW0RW00.PW0RMWXR + PKHREC.PKHPVSRP;
    else
      PW0RW00.PW0RMWSR = PW0RW00.PW0RMWSR + PKHREC.PKHPVSFC;
      PW0RW00.PW0RMWSR = PW0RW00.PW0RMWSR + PKHREC.PKHPVSRP;
      PW0RW00.PW0RWWHW = PW0RW00.PW0RWWHW + PKHREC.PKHPVSMM; /* minutes*/
    end

  else
    if (PKHREC.PK-SEL-TYP-CD == " 2" /* regular*/
     || PKHREC.PK-SEL-TYP-CD == " 4" /* p & h regular*/
     || PKHREC.PK-SEL-TYP-CD == " 6" /* sel'd by order regular*/
    )                               
      if (PK1NORID == 0) /* ; stock xfer*/
        PW0RW00.PW0RMWXF = PW0RW00.PW0RMWXF + PKHREC.PKHPVSFC;
        PW0RW00.PW0RMWXR = PW0RW00.PW0RMWXR + PKHREC.PKHPVSRP;
      else
        PW0RW00.PW0RMWRF = PW0RW00.PW0RMWRF + PKHREC.PKHPVSFC;
        PW0RW00.PW0RMWRR = PW0RW00.PW0RMWRR + PKHREC.PKHPVSRP;

      end
  /* TT# 3670 change begins*/
    else
      if (PKHREC.PK-SEL-TYP-CD == "30" /* new sel'd by order reg*/
       || PKHREC.PK-SEL-TYP-CD == "31" /* new sel'd by order reg*/
      )                               
        if (PK1NORID == 0) /* ; stock xfer*/
          PW0RW00.PW0RMWXF = PW0RW00.PW0RMWXF + PKHREC.PKHPVSFC;
        else
          PW0RW00.PW0RMWRF = PW0RW00.PW0RMWRF + PKHREC.PKHPVSFC;
        end
      else
        if (PKHREC.PK-SEL-TYP-CD == "34" /* new sel'd by order reg*/
         || PKHREC.PK-SEL-TYP-CD == "35" /* new sel'd by order reg*/
        )                               
          if (PK1NORID == 0) /* ; stock xfer*/
            PW0RW00.PW0RMWXR = PW0RW00.PW0RMWXR + PKHREC.PKHPVSRP;
          else
            PW0RW00.PW0RMWRR = PW0RW00.PW0RMWRR + PKHREC.PKHPVSRP;
          end
  /* TT# 3670 change ends*/
        else
          if (PKHREC.PK-SEL-TYP-CD == "10" /* b-grade spcl hndl*/
           || PKHREC.PK-SEL-TYP-CD == "11" /* b-grade non-spcl hndl*/
           /* TT# 3670 change begins*/
           || PKHREC.PK-SEL-TYP-CD == "40" /* b-grade hndl code*/
           || PKHREC.PK-SEL-TYP-CD == "41") /* b-grade hndl code*/
  /* TT# 3670 change ends*/

            if (PK1NORID == 0) /* ; stock xfer*/
              PW0RW00.PW0RMWXF = PW0RW00.PW0RMWXF + PKHREC.PKHPVSFC;
              PW0RW00.PW0RMWXR = PW0RW00.PW0RMWXR + PKHREC.PKHPVSRP;
            else
              PW0RW00.PW0RMWBG = PW0RW00.PW0RMWBG + PKHREC.PKHPVSFC;
              PW0RW00.PW0RMWBG = PW0RW00.PW0RMWBG + PKHREC.PKHPVSRP;

            end
          else
            if (PKHREC.PK-SEL-TYP-CD == 12   /* closeouts spcl hndl*/
             || PKHREC.PK-SEL-TYP-CD == "13" /* closeouts non-spcl hndl*/
             /* TT# 3670 change begins*/
             || PKHREC.PK-SEL-TYP-CD == "28" /* new closeouts code*/
             || PKHREC.PK-SEL-TYP-CD == "29") /* new closeouts code*/
  /* TT# 3670 change ends*/

              if (PK1NORID == 0) /* ; stock xfer*/
                PW0RW00.PW0RMWXF = PW0RW00.PW0RMWXF + PKHREC.PKHPVSFC;
                PW0RW00.PW0RMWXR = PW0RW00.PW0RMWXR + PKHREC.PKHPVSRP;
              else
                PW0RW00.PW0RMWCO = PW0RW00.PW0RMWCO + PKHREC.PKHPVSFC;
                PW0RW00.PW0RMWCO = PW0RW00.PW0RMWCO + PKHREC.PKHPVSRP;

              end
            else
              if (PKHREC.PK-SEL-TYP-CD == "14" /* in-store promo spcl hndl*/
               || PKHREC.PK-SEL-TYP-CD == "15") /* in-store promo non-spcl hndl*/

                if (PK1NORID == 0) /* ; stock xfer*/
                  PW0RW00.PW0RMWXF = PW0RW00.PW0RMWXF + PKHREC.PKHPVSFC;
                  PW0RW00.PW0RMWXR = PW0RW00.PW0RMWXR + PKHREC.PKHPVSRP;
                else
                  PW0RW00.PW0RMWPF = PW0RW00.PW0RMWPF + PKHREC.PKHPVSFC;
                  PW0RW00.PW0RMWPR = PW0RW00.PW0RMWPR + PKHREC.PKHPVSRP;

                end
  /* TT# 3670 change begins*/
              else
                if (PKHREC.PK-SEL-TYP-CD == "32" /* new stock xfer*/
                 || PKHREC.PK-SEL-TYP-CD == "33") /* new stock xfer*/

                  if (PK1NORID == 0) /* ; stock xfer*/
                    PW0RW00.PW0RMWXF = PW0RW00.PW0RMWXF + PKHREC.PKHPVSFC;
                  end
                end
              end
  /* TT# 3670 change ends*/
            end
          end
        end
      end
    end
  end

  /* TT# 3670 change begins*/
   /* ---------------------------------------------*/
   /* Ware house total accumulation for equipment*/
   /* ---------------------------------------------*/
  if (PKHREC.PK-SEL-TYP-CD == "26" /* equipment code*/
   || PKHREC.PK-SEL-TYP-CD == "27" /* equipment code*/
   || PKHREC.PK-SEL-TYP-CD == "36" /* equipment code*/
   || PKHREC.PK-SEL-TYP-CD == "37" /* equipment code*/
   || PKHREC.PK-SEL-TYP-CD == "38" /* equipment code*/
   || PKHREC.PK-SEL-TYP-CD == "39" /* equipment code*/
   || PKHREC.PK-SEL-TYP-CD == "42" /* equipment code*/
   || PKHREC.PK-SEL-TYP-CD == "43") /* equipment code*/

    if (PK1NORID == 0) /* ; stock xfer*/
      PW0RW00.PW0RMWXF = PW0RW00.PW0RMWXF + PKHREC.PKHPVSFC;
      PW0RW00.PW0RMWXR = PW0RW00.PW0RMWXR + PKHREC.PKHPVSRP;
    else
      PW0RW00.PW0RMWER = PW0RW00.PW0RMWER + PKHREC.PKHPVSFC;
      PW0RW00.PW0RMWER = PW0RW00.PW0RMWER + PKHREC.PKHPVSRP;
    end
  end
  /* TT# 3670 change ends*/

end // end PW0R132

// CALL IO1890 DPICK.VPKCTL01
Function PW0R133()
   /* ------------------------------------------------------------*/
   /* Fetch the next row from DPICK.VPKCTL01.*/
   /* ------------------------------------------------------------*/

  set PKDREC empty;
  PKDREC.XWHCD = PKWREC.XWHCD;
  try
    call "IO1890" ("S ", SQLCA, PKDREC) {isNoRefresh = yes, isExternal = yes};
  end /* GET PK CNTL RECORD*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/
      return; /* Return to previous process*/
    end
  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(28); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(29); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    /* SET PW0RM001 PAGE;             /* Clear screen before display ?*/

  end

  PW0RW01.XXXMODID = "133"; /* module id*/
  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "GET PICKING CONTROL RECORD";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = "133"; /* Program number*/
  TA1REC.TA1DBASE = "DPICK   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VPKCTL01"; /* Table view name*/
  TA1REC.TA1TBLKE = PKDREC.XWHCD; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/

end // end PW0R133

// Add div totals (selqt)
Function PW0R134()
   /* +------------------------------+*/
   /*  CALCULATE DIVISION CD TOTALS */
   /* +------------------------------+*/

  if (PW0RW00.PK-SEL-TYP-CD == " 1" /* -spcl hndl*/
   /* TT# 3670 change begins*/
   || PW0RW00.PK-SEL-TYP-CD == "22" /* -new spcl hndl code*/
   || PW0RW00.PK-SEL-TYP-CD == "23" /* -new spcl hndl code*/
   || PW0RW00.PK-SEL-TYP-CD == "24" /* -new spcl hndl code*/
   || PW0RW00.PK-SEL-TYP-CD == "25" /* -new spcl hndl code*/
   /* TT# 3670 change ends*/
   || PW0RW00.PK-SEL-TYP-CD == " 3" /* -p & h spcl hndl*/
   || PW0RW00.PK-SEL-TYP-CD == " 5") /* -sel'd by order spcl hndl*/

    PW0RW00.PW0RMDSR = PW0RW00.PW0RMDSR + PWMREC.PKHPVSFC;
    PW0RW00.PW0RMDSR = PW0RW00.PW0RMDSR + PWMREC.PKHPVSRP;
    PW0RW00.PW0RWDHW = PW0RW00.PW0RWDHW + PWMREC.PKHPVSMM; /* minutes*/

  else
    if (PW0RW00.PK-SEL-TYP-CD == " 2" /* -regular*/
     || PW0RW00.PK-SEL-TYP-CD == " 4" /* -p & h regular*/
     || PW0RW00.PK-SEL-TYP-CD == " 6") /* -sel'd by order regular*/
      PW0RW00.PW0RMDRF = PW0RW00.PW0RMDRF + PWMREC.PKHPVSFC;
      PW0RW00.PW0RMDRR = PW0RW00.PW0RMDRR + PWMREC.PKHPVSRP;
      /* TT# 3670 change begins*/
    else
      if (PW0RW00.PK-SEL-TYP-CD == "30" /* -new regular code*/
       || PW0RW00.PK-SEL-TYP-CD == "31") /* -new regular code*/
        PW0RW00.PW0RMDRF = PW0RW00.PW0RMDRF + PWMREC.PKHPVSFC;
      else
        if (PW0RW00.PK-SEL-TYP-CD == "34" /* -new regular code*/
         || PW0RW00.PK-SEL-TYP-CD == "35") /* -new regular code*/
          PW0RW00.PW0RMDRR = PW0RW00.PW0RMDRR + PWMREC.PKHPVSRP;
      /* TT# 3670 change ends*/

        else
          if (PW0RW00.PK-SEL-TYP-CD == "10" /* -b-grade spcl hndl*/
           || PW0RW00.PK-SEL-TYP-CD == "11" /* -b-grade non-spcl hndl*/
           /* TT# 3670 change begins*/
           || PW0RW00.PK-SEL-TYP-CD == "40" /* -new b-grade code*/
           || PW0RW00.PK-SEL-TYP-CD == "41") /* -new b-grade code*/
        /* TT# 3670 change ends*/

            PW0RW00.PW0RMDBG = PW0RW00.PW0RMDBG + PWMREC.PKHPVSFC;
            PW0RW00.PW0RMDBG = PW0RW00.PW0RMDBG + PWMREC.PKHPVSRP;

          else
            if (PW0RW00.PK-SEL-TYP-CD == "12" /* -closeouts spcl hndl*/
             || PW0RW00.PK-SEL-TYP-CD == "13" /* -closeouts non-spcl hndl*/
             /* TT# 3670 change begins*/
             || PW0RW00.PK-SEL-TYP-CD == "28" /* -new closeouts code*/
             || PW0RW00.PK-SEL-TYP-CD == "29") /* -new closeouts code*/
          /* TT# 3670 change ends*/

              PW0RW00.PW0RMDCO = PW0RW00.PW0RMDCO + PWMREC.PKHPVSFC;
              PW0RW00.PW0RMDCO = PW0RW00.PW0RMDCO + PWMREC.PKHPVSRP;

            else
              if (PW0RW00.PK-SEL-TYP-CD == "14" /* -in-store promo spcl hndl*/
               || PW0RW00.PK-SEL-TYP-CD == "15") /* -in-store promo non-spcl*/

                PW0RW00.PW0RMDPF = PW0RW00.PW0RMDPF + PWMREC.PKHPVSFC;
                PW0RW00.PW0RMDPR = PW0RW00.PW0RMDPR + PWMREC.PKHPVSRP;

              else
                if (PW0RW00.PK-SEL-TYP-CD == "16" /* extra special hand*/
                )                                
                  PW0RW00.PW0RW-EX-SP-RP-DIV = PW0RW00.PW0RW-EX-SP-RP-DIV +               PWMREC.PKHPVSRP;

                else
                  if (PW0RW00.PK-SEL-TYP-CD == "17" /* extra non special hand*/
                  )                                
                    PW0RW00.PW0RW-EX-NS-FC-DIV = PW0RW00.PW0RW-EX-NS-FC-DIV +                 PWMREC.PKHPVSFC;
                    PW0RW00.PW0RW-EX-NS-RP-DIV = PW0RW00.PW0RW-EX-NS-RP-DIV +                 PWMREC.PKHPVSRP;

                  end
                end
              end
            end
          end
        end
      end
    end
  end

   /* TT# 3670 change begins*/
   /* -----------------------------*/
   /* Add div totals for Equipment*/
   /* -----------------------------*/
  if (PW0RW00.PK-SEL-TYP-CD == "26" /* -equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "27" /* -equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "36" /* -equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "37" /* -equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "38" /* -equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "39" /* -equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "42" /* -equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "43") /* -equipment code*/

    PW0RW00.PW0RMDER = PW0RW00.PW0RMDER + PWMREC.PKHPVSFC;
    PW0RW00.PW0RMDER = PW0RW00.PW0RMDER + PWMREC.PKHPVSRP;
  end
   /* TT# 3670 change ends*/

end // end PW0R134

// Add div totals (selor)
Function PW0R135()
   /* +--------------------------------+*/
   /*  CALCULATE DIVISION CODE TOTALS */
   /* +--------------------------------+*/

  if (PKHREC.PK-SEL-TYP-CD == " 1" /* spcl hndl*/
   || PKHREC.PK-SEL-TYP-CD == " 3" /* p & h spcl hndl*/
   || PKHREC.PK-SEL-TYP-CD == " 5" /* sel'd by order spcl hndl*/
   /* TT# 3670 change begins*/
   || PKHREC.PK-SEL-TYP-CD == "22" /* new sel'd by order spcl hndl*/
   || PKHREC.PK-SEL-TYP-CD == "23" /* new sel'd by order spcl hndl*/
   || PKHREC.PK-SEL-TYP-CD == "24" /* new sel'd by order spcl hndl*/
   || PKHREC.PK-SEL-TYP-CD == "25" /* new sel'd by order spcl hndl*/
   /* TT# 3670 change ends*/
  )                               
    if (PK1NORID == 0) /* ; stock xfer*/
      PW0RW00.PW0RMDXF = PW0RW00.PW0RMDXF + PKHREC.PKHPVSFC;
      PW0RW00.PW0RMDXR = PW0RW00.PW0RMDXR + PKHREC.PKHPVSRP;
    else
      PW0RW00.PW0RMDSR = PW0RW00.PW0RMDSR + PKHREC.PKHPVSFC;
      PW0RW00.PW0RMDSR = PW0RW00.PW0RMDSR + PKHREC.PKHPVSRP;
      PW0RW00.PW0RWDHW = PW0RW00.PW0RWDHW + PKHREC.PKHPVSMM; /* minutes*/
    end

  else
    if (PKHREC.PK-SEL-TYP-CD == " 2" /* regular*/
     || PKHREC.PK-SEL-TYP-CD == " 4" /* p & h regular*/
     || PKHREC.PK-SEL-TYP-CD == " 6" /* sel'd by order regular*/
    )                               
      if (PK1NORID == 0) /* ; stock xfer*/
        PW0RW00.PW0RMDXF = PW0RW00.PW0RMDXF + PKHREC.PKHPVSFC;
        PW0RW00.PW0RMDXR = PW0RW00.PW0RMDXR + PKHREC.PKHPVSRP;
      else
        PW0RW00.PW0RMDRF = PW0RW00.PW0RMDRF + PKHREC.PKHPVSFC;
        PW0RW00.PW0RMDRR = PW0RW00.PW0RMDRR + PKHREC.PKHPVSRP;

      end
    /* TT# 3670 change begins*/
    else
      if (PKHREC.PK-SEL-TYP-CD == "30" /* new regular*/
       || PKHREC.PK-SEL-TYP-CD == "31") /* new regular*/
        if (PK1NORID == 0) /* stock xfer*/
          PW0RW00.PW0RMDXF = PW0RW00.PW0RMDXF + PKHREC.PKHPVSFC;
        else
          PW0RW00.PW0RMDRF = PW0RW00.PW0RMDRF + PKHREC.PKHPVSFC;
        end
      else
        if (PKHREC.PK-SEL-TYP-CD == "34" /* new regular*/
         || PKHREC.PK-SEL-TYP-CD == "35") /* new regular*/
          if (PK1NORID == 0) /* stock xfer*/
            PW0RW00.PW0RMDXR = PW0RW00.PW0RMDXR + PKHREC.PKHPVSRP;
          else
            PW0RW00.PW0RMDRR = PW0RW00.PW0RMDRR + PKHREC.PKHPVSRP;
          end
    /* TT# 3670 change ends*/
        else
          if (PKHREC.PK-SEL-TYP-CD == "10" /* b-grade spcl hndl*/
           || PKHREC.PK-SEL-TYP-CD == "11" /* b-grade non-spcl hndl*/
           /* TT# 3670 change begins*/
           || PKHREC.PK-SEL-TYP-CD == "40" /* b-grade code*/
           || PKHREC.PK-SEL-TYP-CD == "41" /* b-grade code*/
           /* TT# 3670 change ends*/
          )                               
            if (PK1NORID == 0) /* ; stock xfer*/
              PW0RW00.PW0RMDXF = PW0RW00.PW0RMDXF + PKHREC.PKHPVSFC;
              PW0RW00.PW0RMDXR = PW0RW00.PW0RMDXR + PKHREC.PKHPVSRP;
            else
              PW0RW00.PW0RMDBG = PW0RW00.PW0RMDBG + PKHREC.PKHPVSFC;
              PW0RW00.PW0RMDBG = PW0RW00.PW0RMDBG + PKHREC.PKHPVSRP;

            end
          else
            if (PKHREC.PK-SEL-TYP-CD == 12   /* closeouts spcl hndl*/
             || PKHREC.PK-SEL-TYP-CD == "13" /* closeouts non-spcl hndl*/
             /* TT# 3670 change begins*/
             || PKHREC.PK-SEL-TYP-CD == "28" /* new closeouts code*/
             || PKHREC.PK-SEL-TYP-CD == "29" /* new closeouts code*/
             /* TT# 3670 change ends*/
            )                               
              if (PK1NORID == 0) /* ; stock xfer*/
                PW0RW00.PW0RMDXF = PW0RW00.PW0RMDXF + PKHREC.PKHPVSFC;
                PW0RW00.PW0RMDXR = PW0RW00.PW0RMDXR + PKHREC.PKHPVSRP;
              else
                PW0RW00.PW0RMDCO = PW0RW00.PW0RMDCO + PKHREC.PKHPVSFC;
                PW0RW00.PW0RMDCO = PW0RW00.PW0RMDCO + PKHREC.PKHPVSRP;

              end
            else
              if (PKHREC.PK-SEL-TYP-CD == 14   /* in-store promo spcl hndl*/
               || PKHREC.PK-SEL-TYP-CD == "15" /* in-store promo non-spcl hndl*/
              )                               
                if (PK1NORID == 0) /* ; stock xfer*/
                  PW0RW00.PW0RMDXF = PW0RW00.PW0RMDXF + PKHREC.PKHPVSFC;
                  PW0RW00.PW0RMDXR = PW0RW00.PW0RMDXR + PKHREC.PKHPVSRP;
                else
                  PW0RW00.PW0RMDPF = PW0RW00.PW0RMDPF + PKHREC.PKHPVSFC;
                  PW0RW00.PW0RMDPR = PW0RW00.PW0RMDPR + PKHREC.PKHPVSRP;

                end
    /* TT# 3670 change begins*/
              else
                if (PKHREC.PK-SEL-TYP-CD == "32" /* stock xfer*/
                 || PKHREC.PK-SEL-TYP-CD == "33") /* stock xfer*/
                  if (PK1NORID == 0) /* ; stock xfer*/
                    PW0RW00.PW0RMDXF = PW0RW00.PW0RMDXF + PKHREC.PKHPVSFC;
                  end
                end
              end
            end
  /* TT# 3670 change ends*/

          end
        end
      end
    end
  end

   /* TT# 3670 change begins*/
   /* ------------------------------*/
   /* Accumulate Equipment div total*/
   /* ------------------------------*/

  if (PKHREC.PK-SEL-TYP-CD == "26" /* Equipment*/
   || PKHREC.PK-SEL-TYP-CD == "27" /* Equipment*/
   || PKHREC.PK-SEL-TYP-CD == "36" /* Equipment*/
   || PKHREC.PK-SEL-TYP-CD == "37" /* Equipment*/
   || PKHREC.PK-SEL-TYP-CD == "38" /* Equipment*/
   || PKHREC.PK-SEL-TYP-CD == "39" /* Equipment*/
   || PKHREC.PK-SEL-TYP-CD == "42" /* Equipment*/
   || PKHREC.PK-SEL-TYP-CD == "43") /* Equipment*/
    if (PK1NORID == 0) /* ; stock xfer*/
      PW0RW00.PW0RMDXF = PW0RW00.PW0RMDXF + PKHREC.PKHPVSFC;
      PW0RW00.PW0RMDXR = PW0RW00.PW0RMDXR + PKHREC.PKHPVSRP;
    else
      PW0RW00.PW0RMDER = PW0RW00.PW0RMDER + PKHREC.PKHPVSFC;
      PW0RW00.PW0RMDER = PW0RW00.PW0RMDER + PKHREC.PKHPVSRP;

    end
  end
   /* TT# 3670 change ends*/

end // end PW0R135

// Add brand totals (selqt)
Function PW0R136()
   /* +-----------------------------+*/
   /*  CALCULATE BRAND CODE TOTALS */
   /* +-----------------------------+*/

  if (PW0RW00.PK-SEL-TYP-CD == " 1" /* spcl hndl*/
   /* TT# 3670 change begins*/
   || PW0RW00.PK-SEL-TYP-CD == "22" /* new spcl hndl code*/
   || PW0RW00.PK-SEL-TYP-CD == "23" /* new spcl hndl code*/
   || PW0RW00.PK-SEL-TYP-CD == "24" /* new spcl hndl code*/
   || PW0RW00.PK-SEL-TYP-CD == "25" /* new spcl hndl code*/
   /* TT# 3670 change ends*/
   || PW0RW00.PK-SEL-TYP-CD == " 3" /* p & h spcl hndl*/
   || PW0RW00.PK-SEL-TYP-CD == " 5") /* sel'd by order spcl hndl*/

    PW0RW00.PW0RMBSR = PW0RW00.PW0RMBSR + PWMREC.PKHPVSFC;
    PW0RW00.PW0RMBSR = PW0RW00.PW0RMBSR + PWMREC.PKHPVSRP;
    PW0RW00.PW0RWBHW = PW0RW00.PW0RWBHW + PWMREC.PKHPVSMM; /* minutes*/

  else
    if (PW0RW00.PK-SEL-TYP-CD == " 2" /* regular*/
     || PW0RW00.PK-SEL-TYP-CD == " 4" /* p & h regular*/
     || PW0RW00.PK-SEL-TYP-CD == " 6") /* sel'd by order regular*/
      PW0RW00.PW0RMBRF = PW0RW00.PW0RMBRF + PWMREC.PKHPVSFC;
      PW0RW00.PW0RMBRR = PW0RW00.PW0RMBRR + PWMREC.PKHPVSRP;
      /* TT# 3670 change begins*/
    else
      if (PW0RW00.PK-SEL-TYP-CD == "30" /* new regular full cs*/
       || PW0RW00.PK-SEL-TYP-CD == "31") /* new regular full cs*/
        PW0RW00.PW0RMBRF = PW0RW00.PW0RMBRF + PWMREC.PKHPVSFC;
      else
        if (PW0RW00.PK-SEL-TYP-CD == "34" /* new regular repack*/
         || PW0RW00.PK-SEL-TYP-CD == "35") /* new regular repack*/
          PW0RW00.PW0RMBRR = PW0RW00.PW0RMBRR + PWMREC.PKHPVSRP;
      /* TT# 3670 change ends*/

        else
          if (PW0RW00.PK-SEL-TYP-CD == "10" /* b-grade spcl hndl*/
           || PW0RW00.PK-SEL-TYP-CD == "11" /* b-grade non-spcl hndl*/
           /* TT# 3670 change begins*/
           || PW0RW00.PK-SEL-TYP-CD == "40" /* new b-grade code*/
           || PW0RW00.PK-SEL-TYP-CD == "41") /* new b-grade code*/
        /* TT# 3670 change ends*/

            PW0RW00.PW0RMBBG = PW0RW00.PW0RMBBG + PWMREC.PKHPVSFC;
            PW0RW00.PW0RMBBG = PW0RW00.PW0RMBBG + PWMREC.PKHPVSRP;

          else
            if (PW0RW00.PK-SEL-TYP-CD == "12" /* closeouts spcl hndl*/
             || PW0RW00.PK-SEL-TYP-CD == "13" /* closeouts non-spcl hndl*/
             /* TT# 3670 change begins*/
             || PW0RW00.PK-SEL-TYP-CD == "28" /* new closeouts code*/
             || PW0RW00.PK-SEL-TYP-CD == "29") /* new closeouts code*/
          /* TT# 3670 change ends*/

              PW0RW00.PW0RMBCO = PW0RW00.PW0RMBCO + PWMREC.PKHPVSFC;
              PW0RW00.PW0RMBCO = PW0RW00.PW0RMBCO + PWMREC.PKHPVSRP;

            else
              if (PW0RW00.PK-SEL-TYP-CD == "14" /* in-store promo spcl hndl*/
               || PW0RW00.PK-SEL-TYP-CD == "15") /* in-store promo non-spcl*/

                PW0RW00.PW0RMBPF = PW0RW00.PW0RMBPF + PWMREC.PKHPVSFC;
                PW0RW00.PW0RMBPR = PW0RW00.PW0RMBPR + PWMREC.PKHPVSRP;

              else
                if (PW0RW00.PK-SEL-TYP-CD == "16" /* extra special handling*/
                )                                
                  PW0RW00.PW0RW-EX-SP-RP-BRAND = PW0RW00.PW0RW-EX-SP-RP-BRAND               + PWMREC.PKHPVSRP;

                else
                  if (PW0RW00.PK-SEL-TYP-CD == "17" /* extra non-special hand.*/
                  )                                
                    PW0RW00.PW0RW-EX-NS-FC-BRAND = PW0RW00.PW0RW-EX-NS-FC-BRAND                 + PWMREC.PKHPVSFC;
                    PW0RW00.PW0RW-EX-NS-RP-BRAND = PW0RW00.PW0RW-EX-NS-RP-BRAND                 + PWMREC.PKHPVSRP;

                  end
                end
              end
            end
          end
        end
      end
    end
  end

   /* TT# 3670 change begins*/
   /* -----------------------------*/
   /* Add brand total for Equipment*/
   /* -----------------------------*/
  if (PW0RW00.PK-SEL-TYP-CD == "26" /* equipment code*/
   || PW0RW00.PK-SEL-TYP-CD == "27" /* equipmet code*/
   || PW0RW00.PK-SEL-TYP-CD == "36" /* equipmet code*/
   || PW0RW00.PK-SEL-TYP-CD == "37" /* equipmet code*/
   || PW0RW00.PK-SEL-TYP-CD == "38" /* equipmet code*/
   || PW0RW00.PK-SEL-TYP-CD == "39" /* equipmet code*/
   || PW0RW00.PK-SEL-TYP-CD == "42" /* equipmet code*/
   || PW0RW00.PK-SEL-TYP-CD == "43") /* equipmet code*/

    PW0RW00.PW0RMBER = PW0RW00.PW0RMBER + PWMREC.PKHPVSFC;
    PW0RW00.PW0RMBER = PW0RW00.PW0RMBER + PWMREC.PKHPVSRP;

  end
   /* TT# 3670 change ends*/


end // end PW0R136

// Add brand totals (selor)
Function PW0R137()
   /* +-----------------------------+*/
   /*  CALCULATE BRAND CODE TOTALS */
   /* +-----------------------------+*/

  if (PKHREC.PK-SEL-TYP-CD == " 1" /* spcl hndl*/
   || PKHREC.PK-SEL-TYP-CD == " 3" /* p & h spcl hndl*/
   || PKHREC.PK-SEL-TYP-CD == " 5" /* sel'd by order spcl hndl*/
   /* TT# 3670 change begins*/
   || PKHREC.PK-SEL-TYP-CD == "22" /* sel'd by order spcl hndl*/
   || PKHREC.PK-SEL-TYP-CD == "23" /* sel'd by order spcl hndl*/
   || PKHREC.PK-SEL-TYP-CD == "24" /* sel'd by order spcl hndl*/
   || PKHREC.PK-SEL-TYP-CD == "25") /* sel'd by order spcl hndl*/
  /* TT# 3670 change ends*/

    if (PK1NORID == 0) /* ; stock xfer*/
      PW0RW00.PW0RMBXF = PW0RW00.PW0RMBXF + PKHREC.PKHPVSFC;
      PW0RW00.PW0RMBXR = PW0RW00.PW0RMBXR + PKHREC.PKHPVSRP;
    else
      PW0RW00.PW0RMBSR = PW0RW00.PW0RMBSR + PKHREC.PKHPVSFC;
      PW0RW00.PW0RMBSR = PW0RW00.PW0RMBSR + PKHREC.PKHPVSRP;
      PW0RW00.PW0RWBHW = PW0RW00.PW0RWBHW + PKHREC.PKHPVSMM; /* minutes*/
    end

  else
    if (PKHREC.PK-SEL-TYP-CD == " 2" /* regular*/
     || PKHREC.PK-SEL-TYP-CD == " 4" /* p & h regular*/
     || PKHREC.PK-SEL-TYP-CD == " 6" /* sel'd by order regular*/
    )                               
      if (PK1NORID == 0) /* ; stock xfer*/
        PW0RW00.PW0RMBXF = PW0RW00.PW0RMBXF + PKHREC.PKHPVSFC;
        PW0RW00.PW0RMBXR = PW0RW00.PW0RMBXR + PKHREC.PKHPVSRP;
      else
        PW0RW00.PW0RMBRF = PW0RW00.PW0RMBRF + PKHREC.PKHPVSFC;
        PW0RW00.PW0RMBRR = PW0RW00.PW0RMBRR + PKHREC.PKHPVSRP;

      end
  /* TT# 3670 change begins*/
    else
      if (PKHREC.PK-SEL-TYP-CD == "30" /* new sel'd by order reg*/
       || PKHREC.PK-SEL-TYP-CD == "31" /* new sel'd by order reg*/
      )                               
        if (PK1NORID == 0) /* ; stock xfer*/
          PW0RW00.PW0RMBXF = PW0RW00.PW0RMBXF + PKHREC.PKHPVSFC;
        else
          PW0RW00.PW0RMBRF = PW0RW00.PW0RMBRF + PKHREC.PKHPVSFC;

        end
      else
        if (PKHREC.PK-SEL-TYP-CD == "34" /* new sel'd by order reg*/
         || PKHREC.PK-SEL-TYP-CD == "35" /* new sel'd by order reg*/
        )                               
          if (PK1NORID == 0) /* ; stock xfer*/
            PW0RW00.PW0RMBXR = PW0RW00.PW0RMBXR + PKHREC.PKHPVSRP;
          else
            PW0RW00.PW0RMBRR = PW0RW00.PW0RMBRR + PKHREC.PKHPVSRP;

          end
  /* TT# 3670 change ends*/
        else
          if (PKHREC.PK-SEL-TYP-CD == "10" /* b-grade spcl hndl*/
           || PKHREC.PK-SEL-TYP-CD == "11" /* b-grade non-spcl hndl*/
           /* TT# 3670 change begins*/
           || PKHREC.PK-SEL-TYP-CD == "40" /* new b-grade code*/
           || PKHREC.PK-SEL-TYP-CD == "41") /* new b-grade code*/
  /* TT# 3670 change ends*/

            if (PK1NORID == 0) /* ; stock xfer*/
              PW0RW00.PW0RMBXF = PW0RW00.PW0RMBXF + PKHREC.PKHPVSFC;
              PW0RW00.PW0RMBXR = PW0RW00.PW0RMBXR + PKHREC.PKHPVSRP;
            else
              PW0RW00.PW0RMBBG = PW0RW00.PW0RMBBG + PKHREC.PKHPVSFC;
              PW0RW00.PW0RMBBG = PW0RW00.PW0RMBBG + PKHREC.PKHPVSRP;

            end
          else
            if (PKHREC.PK-SEL-TYP-CD == 12   /* closeouts spcl hndl*/
             || PKHREC.PK-SEL-TYP-CD == "13" /* closeouts non-spcl hndl*/
             /* TT# 3670 change begins*/
             || PKHREC.PK-SEL-TYP-CD == "28" /* new closeouts code*/
             || PKHREC.PK-SEL-TYP-CD == "29") /* new closeouts code*/
  /* TT# 3670 change ends*/

              if (PK1NORID == 0) /* ; stock xfer*/
                PW0RW00.PW0RMBXF = PW0RW00.PW0RMBXF + PKHREC.PKHPVSFC;
                PW0RW00.PW0RMBXR = PW0RW00.PW0RMBXR + PKHREC.PKHPVSRP;
              else
                PW0RW00.PW0RMBCO = PW0RW00.PW0RMBCO + PKHREC.PKHPVSFC;
                PW0RW00.PW0RMBCO = PW0RW00.PW0RMBCO + PKHREC.PKHPVSRP;

              end
            else
              if (PKHREC.PK-SEL-TYP-CD == 14 /* in-store promo spcl hndl*/
               || PKHREC.PK-SEL-TYP-CD == "15") /* in-store promo non-spcl hndl*/

                if (PK1NORID == 0) /* ; stock xfer*/
                  PW0RW00.PW0RMBXF = PW0RW00.PW0RMBXF + PKHREC.PKHPVSFC;
                  PW0RW00.PW0RMBXR = PW0RW00.PW0RMBXR + PKHREC.PKHPVSRP;
                else
                  PW0RW00.PW0RMBPF = PW0RW00.PW0RMBPF + PKHREC.PKHPVSFC;
                  PW0RW00.PW0RMBPR = PW0RW00.PW0RMBPR + PKHREC.PKHPVSRP;
                end

  /* TT# 3670 change begins*/
              else
                if (PKHREC.PK-SEL-TYP-CD == "32" /* new sel'd by order reg*/
                 || PKHREC.PK-SEL-TYP-CD == "33") /* new sel'd by order reg*/
                  if (PK1NORID == 0) /* ; stock xfer*/
                    PW0RW00.PW0RMBXF = PW0RW00.PW0RMBXF + PKHREC.PKHPVSFC;
                  end
                end
              end
  /* TT# 3670 change ends*/
            end
          end
        end
      end
    end
  end

  /* TT# 3670 change begins*/
   /* ------------------------------*/
   /* Add brand totals for Equipment*/
   /* ------------------------------*/
  if (PKHREC.PK-SEL-TYP-CD == "26" /* equipment*/
   || PKHREC.PK-SEL-TYP-CD == "27" /* equipment*/
   || PKHREC.PK-SEL-TYP-CD == "36" /* equipment*/
   || PKHREC.PK-SEL-TYP-CD == "37" /* equipment*/
   || PKHREC.PK-SEL-TYP-CD == "38" /* equipment*/
   || PKHREC.PK-SEL-TYP-CD == "39" /* equipment*/
   || PKHREC.PK-SEL-TYP-CD == "42" /* equipment*/
   || PKHREC.PK-SEL-TYP-CD == "43") /* equipment*/

    if (PK1NORID == 0) /* ; stock xfer*/
      PW0RW00.PW0RMBXF = PW0RW00.PW0RMBXF + PKHREC.PKHPVSFC;
      PW0RW00.PW0RMBXR = PW0RW00.PW0RMBXR + PKHREC.PKHPVSRP;
    else
      PW0RW00.PW0RMBER = PW0RW00.PW0RMBER + PKHREC.PKHPVSFC;
      PW0RW00.PW0RMBER = PW0RW00.PW0RMBER + PKHREC.PKHPVSRP;
    end
  end
  /* TT# 3670 change ends*/

end // end PW0R137

// Get sel'd order units
Function PW0R140()
   /* ============================================================*/
   /* GET ALL UNITS*/
   /* ============================================================*/

   /* ------------------------------------------------------------*/
   /* Select all Units from DPICK.VSELOR01*/
   /* ------------------------------------------------------------*/

  PW0RW00.PK-SEL-TYP-CD = "*"; /* Set indicator to 'wildcard'*/

  PW0R111(); /* Open cursor in DPICK.VSELOR01*/

  PW0RW00.PW0RWCSR = "N"; /* end of cursor switch*/

  while (PW0RW00.PW0RWCSR == "N") /* until eof*/

    PW0R112(); /* Fetch row in DPICK.VSELOR01*/

    if (PW0RW00.PW0RWCSR == "N") /* if not end*/

      /* ------------------------------------------------------------*/
      /* Accumulate totals for either wildcard or specific values.*/
      /* ------------------------------------------------------------*/
      if (PW0RW01.XDVCD == "*") /* division code NE to wildcard*/

        PW0R135(); /* Add selected orders division*/
        if (PW0RW01.XBCCD == "*") /* brand code NE to wildcard*/
          if (PKHREC.XBCCD != "08") /* NE ColeHaan*/
            PW0R141(); /* Add selected orders*/
            PW0R137(); /* Add selected orders brand*/
          end
        else
          if (PW0RW01.XBCCD == PKHREC.XBCCD)
            PW0R141(); /* Add selected orders*/
            PW0R137(); /* Add selected orders brand*/
          end
        end

      else

        if (PW0RW01.XBCCD == "*")
          if (PKHREC.XBCCD != "08") /* NE ColeHaan*/
            PW0R137(); /* Add selected orders brand*/
            if (PW0RW01.XDVCD == PKHREC.XDVCD)
              PW0R141(); /* Add selected orders*/
              PW0R135(); /* Add selected orders division*/
            end
          else
            if (PW0RW01.XDVCD == PKHREC.XDVCD)
              PW0R135(); /* Add selected orders division*/
            end
          end
        else
          if (PW0RW01.XBCCD == PKHREC.XBCCD)

            PW0R137(); /* Add selected orders brand*/
            if (PW0RW01.XDVCD == PKHREC.XDVCD)
              PW0R141(); /* Add selected orders*/
              PW0R135(); /* Add selected orders division*/
            end
          else
            if (PW0RW01.XDVCD == PKHREC.XDVCD)
              PW0R135(); /* Add selected orders division*/
            end
          end
        end

      end

      PW0R132(); /* Add totals for warehouse*/
    end
  end

  PW0R114(); /* close cursor in DPICK.VSELOR01*/


end // end PW0R140

// Add Totals For Display Storage
Function PW0R141()
   /* ------------------------------------------------------------*/
   /* Accumulate Totals.*/
   /* ------------------------------------------------------------*/

  if (PKHREC.PK-SEL-TYP-CD == " 5" /* special handling*/
   /* TT# 3670 change begins*/
   || PKHREC.PK-SEL-TYP-CD == "22" /* new special handling*/
   || PKHREC.PK-SEL-TYP-CD == "23" /* new special handling*/
   || PKHREC.PK-SEL-TYP-CD == "24" /* new special handling*/
   || PKHREC.PK-SEL-TYP-CD == "25" /* new special handling*/
   /* TT# 3670 change ends*/
  )                               
    /* ---------------------------------------------------------*/
     /* calculate all units in selected order file.*/
    /* ---------------------------------------------------------*/

    if (PKHREC.PK1NORID == 0) /* stock xfer units*/

      PW0RW00.PW0RMOXF = PW0RW00.PW0RMOXF + PKHREC.PKHPVSFC;
      PW0RW00.PW0RMOXR = PW0RW00.PW0RMOXR + PKHREC.PKHPVSRP;
      PW0RW00.PKHPVSMM = PW0RW00.PKHPVSMM + PKHREC.PKHPVSMM; /* minutes*/
      PW0RW00.PW0RWOHW = PW0RW00.PW0RWOHW + PKHREC.PKHPVSMM;

    else

      PW0RW00.PW0RMOSR = PW0RW00.PW0RMOSR + PKHREC.PKHPVSFC; /* full cs*/
      PW0RW00.PW0RMOSR = PW0RW00.PW0RMOSR + PKHREC.PKHPVSRP; /* repack*/
      PW0RW00.PKHPVSMM = PW0RW00.PKHPVSMM + PKHREC.PKHPVSMM; /* minutes*/
      PW0RW00.PW0RWOHW = PW0RW00.PW0RWOHW + PKHREC.PKHPVSMM;

    end
  end

   /* ------------------------------------------------------------*/
   /* Accumulate Totals. (type = 6)*/
   /* ------------------------------------------------------------*/

  if (PKHREC.PK-SEL-TYP-CD == " 6" /* regular handling*/
  )                               
    /* ---------------------------------------------------------*/
     /* calculate selected order units.*/
    /* ---------------------------------------------------------*/

    if (PKHREC.PK1NORID == 0) /* stock xfer units*/

      PW0RW00.PW0RMOXF = PW0RW00.PW0RMOXF + PKHREC.PKHPVSFC; /* full cs*/
      PW0RW00.PW0RMOXR = PW0RW00.PW0RMOXR + PKHREC.PKHPVSRP; /* repack*/

    else

      PW0RW00.PW0RMORF = PW0RW00.PW0RMORF + PKHREC.PKHPVSFC; /* full cs*/
      PW0RW00.PW0RMORR = PW0RW00.PW0RMORR + PKHREC.PKHPVSRP; /* repack*/

    end
  end
  /* TT# 3670 change begins*/
   /* ------------------------------------------------------------*/
   /* Accumulate Totals. (type = 30,31,34 & 35)*/
   /* ------------------------------------------------------------*/

  if (PKHREC.PK-SEL-TYP-CD == "30" /* new regular handling full cs*/
   || PKHREC.PK-SEL-TYP-CD == "31" /* new regular handling full cs*/
  )                               
    /* ---------------------------------------------------------*/
     /* calculate selected order units.*/
    /* ---------------------------------------------------------*/

    if (PKHREC.PK1NORID == 0) /* stock xfer units*/

      PW0RW00.PW0RMOXF = PW0RW00.PW0RMOXF + PKHREC.PKHPVSFC; /* full cs*/

    else

      PW0RW00.PW0RMORF = PW0RW00.PW0RMORF + PKHREC.PKHPVSFC; /* full cs*/

    end
  end

  if (PKHREC.PK-SEL-TYP-CD == "34" /* new regular handling repack*/
   || PKHREC.PK-SEL-TYP-CD == "35" /* new regular handling repack*/
  )                               
    /* ---------------------------------------------------------*/
     /* calculate selected order units.*/
    /* ---------------------------------------------------------*/

    if (PKHREC.PK1NORID == 0) /* stock xfer units*/

      PW0RW00.PW0RMOXR = PW0RW00.PW0RMOXR + PKHREC.PKHPVSRP; /* repack*/

    else

      PW0RW00.PW0RMORR = PW0RW00.PW0RMORR + PKHREC.PKHPVSRP; /* repack*/

    end
  end
  /* TT# 3670 change ends*/


   /* ------------------------------------------------------------*/
   /* Accumulate Totals. (type = 10 or 11 or 40 or 41)*/
   /* ------------------------------------------------------------*/

  if (PKHREC.PK-SEL-TYP-CD == "10" /* b-grade spcl hndl*/
   || PKHREC.PK-SEL-TYP-CD == "11" /* b-grade non-spcl hndl*/
   /* TT# 3670 change begins*/
   || PKHREC.PK-SEL-TYP-CD == "40" /* new b-grade code*/
   || PKHREC.PK-SEL-TYP-CD == "41" /* new b-grade code*/
   /* TT# 3670 change ends*/
  )                               
    /* ---------------------------------------------------------*/
     /* calculate selected order units.*/
    /* ---------------------------------------------------------*/

    if (PKHREC.PK1NORID == 0) /* stock xfer units*/

      PW0RW00.PW0RMOXF = PW0RW00.PW0RMOXF + PKHREC.PKHPVSFC; /* full cs*/
      PW0RW00.PW0RMOXR = PW0RW00.PW0RMOXR + PKHREC.PKHPVSRP; /* repack*/

    else

      PW0RW00.PW0RMOBG = PW0RW00.PW0RMOBG + PKHREC.PKHPVSFC; /* full cs*/
      PW0RW00.PW0RMOBG = PW0RW00.PW0RMOBG + PKHREC.PKHPVSRP; /* repack*/

    end
  end


   /* ------------------------------------------------------------*/
   /* Accumulate Totals. (type = 12 or 13 or 28 or 29)*/
   /* ------------------------------------------------------------*/

  if (PKHREC.PK-SEL-TYP-CD == "12" /* closeouts spcl hndl*/
   || PKHREC.PK-SEL-TYP-CD == "13" /* closeouts non-spcl hnld*/
   /* TT# 3670 change begins*/
   || PKHREC.PK-SEL-TYP-CD == "28" /* new closeouts*/
   || PKHREC.PK-SEL-TYP-CD == "29" /* new closeouts*/
   /* TT# 3670 change ends*/
  )                               
    /* ---------------------------------------------------------*/
     /* calculate selected order units.*/
    /* ---------------------------------------------------------*/

    if (PKHREC.PK1NORID == 0) /* stock xfer units*/

      PW0RW00.PW0RMOXF = PW0RW00.PW0RMOXF + PKHREC.PKHPVSFC; /* full cs*/
      PW0RW00.PW0RMOXR = PW0RW00.PW0RMOXR + PKHREC.PKHPVSRP; /* repack*/

    else

      PW0RW00.PW0RMOCO = PW0RW00.PW0RMOCO + PKHREC.PKHPVSFC; /* full cs*/
      PW0RW00.PW0RMOCO = PW0RW00.PW0RMOCO + PKHREC.PKHPVSRP; /* repack*/

    end
  end


   /* ------------------------------------------------------------*/
   /* Accumulate Totals. (type = 14 or 15)*/
   /* ------------------------------------------------------------*/

  if (PKHREC.PK-SEL-TYP-CD == "14" /* in-store promo spcl hndl*/
   || PKHREC.PK-SEL-TYP-CD == "15" /* in-store promo non-spcl hnld*/
  )                               
    /* ---------------------------------------------------------*/
    /* calculate selected order units.*/
    /* ---------------------------------------------------------*/

    if (PKHREC.PK1NORID == 0) /* stock xfer units*/

      PW0RW00.PW0RMOXF = PW0RW00.PW0RMOXF + PKHREC.PKHPVSFC; /* full cs*/
      PW0RW00.PW0RMOXR = PW0RW00.PW0RMOXR + PKHREC.PKHPVSRP; /* repack*/

    else

      PW0RW00.PW0RMOPF = PW0RW00.PW0RMOPF + PKHREC.PKHPVSFC; /* full cs*/
      PW0RW00.PW0RMOPR = PW0RW00.PW0RMOPR + PKHREC.PKHPVSRP; /* repack*/

    end
  end

  /* TT# 3670 change begins*/
   /* ---------------------------------------------------*/
   /* Accumulate Totals for stock xfer (Type = 32 or 33)*/
   /* ---------------------------------------------------*/

  if (PKHREC.PK-SEL-TYP-CD == "32" /* stock xfer*/
   || PKHREC.PK-SEL-TYP-CD == "33" /* stock xfer*/
                                   
  )                               
    /* ------------------------------------------*/
    /* calculate all units in selected order file.*/
    /* -------------------------------------------*/

    if (PKHREC.PK1NORID == 0) /* stock xfer units*/

      PW0RW00.PW0RMOXF = PW0RW00.PW0RMOXF + PKHREC.PKHPVSFC;

    end
  end

   /* ------------------------------------------*/
   /* Accumulate Totals for Equipment quantities*/
   /* ------------------------------------------*/

  if (PKHREC.PK-SEL-TYP-CD == "26" /* Equipment*/
   || PKHREC.PK-SEL-TYP-CD == "27" /* Equipment*/
   || PKHREC.PK-SEL-TYP-CD == "36" /* Equipment*/
   || PKHREC.PK-SEL-TYP-CD == "37" /* Equipment*/
   || PKHREC.PK-SEL-TYP-CD == "38" /* Equipment*/
   || PKHREC.PK-SEL-TYP-CD == "39" /* Equipment*/
   || PKHREC.PK-SEL-TYP-CD == "42" /* Equipment*/
   || PKHREC.PK-SEL-TYP-CD == "43" /* Equipment*/
  )                               
    if (PKHREC.PK1NORID == 0) /* stock xfer units*/

      PW0RW00.PW0RMOXF = PW0RW00.PW0RMOXF + PKHREC.PKHPVSFC;
      PW0RW00.PW0RMOXR = PW0RW00.PW0RMOXR + PKHREC.PKHPVSRP;

    else

      PW0RW00.PW0RMOER = PW0RW00.PW0RMOER + PKHREC.PKHPVSFC; /* full cs*/
      PW0RW00.PW0RMOER = PW0RW00.PW0RMOER + PKHREC.PKHPVSRP; /* repack*/

    end
  end
  /* TT# 3670 change ends*/

end // end PW0R141

// Get B-Grade spcl hndl units
Function PW0R150()
   /* ============================================================*/
   /* GET B-GRADE UNITS*/
   /* ============================================================*/

   /* ------------------------------------------------------------*/
   /* Select Units from DPICK.VSELQT01*/
   /* ------------------------------------------------------------*/

   /* TT# 3670 change begins*/
  PW0RW00.PW0RW-PK-SEL-TYP-CNT = 11; /* Set count to 11*/

  while (PW0RW00.PW0RW-PK-SEL-TYP-CNT <= 13) /* while count le 13*/

   /* MOVE '10' TO PW0RW00.PK-SEL-TYP-CD; /* Set indicator to B-Grade*/


    PW0RW00.PK-SEL-TYP-CD = PW0RW00.PW0RW-PK-SEL-TYP-CDS[PW0RW-PK-SEL-TYP-CNT];
                                /* Set indicator to B-grade*/
   /* TT# 3670 change ends*/

    PW0R115(); /* Open cursor in DPICK.VSELQT01*/

    PW0RW00.PW0RWCSR = "N"; /* end of cursor switch*/

    while (PW0RW00.PW0RWCSR == "N") /* until eof*/

      PW0R116(); /* fetch row in DPICK.VSELQT01*/

      if (PW0RW00.PW0RWCSR == "N") /* not end of file*/

      /* ------------------------------------------------------------*/
      /* Accumulate totals for either wildcard or specific values.*/
      /* ------------------------------------------------------------*/
        if (PW0RW01.XDVCD == "*") /* division code NE to wildcard*/

          PW0R134(); /* Add special handling division*/
          if (PW0RW01.XBCCD == "*") /* brand code NE to wildcard*/
            if (PWMREC.XBCCD != "08") /* NE ColeHaan*/
              PW0R117(); /* Add special handling*/
              PW0R136(); /* Add special handling brand*/
            end
          else
            if (PW0RW01.XBCCD == PWMREC.XBCCD)
              PW0R117(); /* Add special handling*/
              PW0R136(); /* Add special handling brand*/
            end
          end

        else

          if (PW0RW01.XBCCD == "*")
            if (PWMREC.XBCCD != "08") /* NE ColeHaan*/
              PW0R136(); /* Add special handling brand*/
              if (PW0RW01.XDVCD == PWMREC.XDVCD)
                PW0R117(); /* Add special handling*/
                PW0R134(); /* Add special handling division*/
              end
            else
              if (PW0RW01.XDVCD == PWMREC.XDVCD)
                PW0R134(); /* Add special handling division*/
              end
            end
          else

            if (PW0RW01.XBCCD == PWMREC.XBCCD)
              PW0R136(); /* Add special handling brand*/
              if (PW0RW01.XDVCD == PWMREC.XDVCD)
                PW0R117(); /* Add special handling*/
                PW0R134(); /* Add special handling division*/
              end
            else
              if (PW0RW01.XDVCD == PWMREC.XDVCD)
                PW0R134(); /* Add special handling division*/
              end
            end
          end

        end

        PW0R131(); /* Add totals for warehouse*/
      end
    end

    PW0R118(); /* close cursor in DPICK.VSELQT01*/

   /* TT# 3670 change begins*/

    PW0RW00.PW0RW-PK-SEL-TYP-CNT = PW0RW00.PW0RW-PK-SEL-TYP-CNT + 1;
                                                 /* Increment counter*/
  end

   /* TT# 3670 change ends*/
end // end PW0R150

// Get B-Grade non-spcl hndl unit
Function PW0R155()
   /* ============================================================*/
   /* GET B-GRADE UNITS*/
   /* ============================================================*/

   /* ------------------------------------------------------------*/
   /* Select Units from DPICK.VSELQT01*/
   /* ------------------------------------------------------------*/

  PW0RW00.PK-SEL-TYP-CD = "11"; /* Set indicator to B-Grade*/

  PW0R115(); /* Open cursor in DPICK.VSELQT01*/

  PW0RW00.PW0RWCSR = "N"; /* end of cursor switch*/

  while (PW0RW00.PW0RWCSR == "N") /* until eof*/

    PW0R116(); /* fetch row in DPICK.VSELQT01*/

    if (PW0RW00.PW0RWCSR == "N") /* not end of file*/

      /* ------------------------------------------------------------*/
      /* Accumulate totals for either wildcard or specific values.*/
      /* ------------------------------------------------------------*/
      if (PW0RW01.XDVCD == "*") /* division code NE to wildcard*/

        PW0R134(); /* Add special handling division*/
        if (PW0RW01.XBCCD == "*") /* brand code NE to wildcard*/
          if (PWMREC.XBCCD != "08") /* NE ColeHaan*/
            PW0R117(); /* Add special handling*/
            PW0R136(); /* Add special handling brand*/
          end
        else
          if (PW0RW01.XBCCD == PWMREC.XBCCD)
            PW0R117(); /* Add special handling*/
            PW0R136(); /* Add special handling brand*/
          end
        end

      else

        if (PW0RW01.XBCCD == "*")
          if (PWMREC.XBCCD != "08") /* NE ColeHaan*/
            PW0R136(); /* Add special handling brand*/
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R117(); /* Add special handling*/
              PW0R134(); /* Add special handling division*/
            end
          else
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R134(); /* Add special handling division*/
            end
          end
        else
          if (PW0RW01.XBCCD == PWMREC.XBCCD)
            PW0R136(); /* Add special handling brand*/
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R117(); /* Add special handling*/
              PW0R134(); /* Add special handling division*/
            end
          else
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R134(); /* Add special handling division*/
            end
          end
        end

      end

      PW0R131(); /* Add totals for warehouse*/
    end
  end

  PW0R118(); /* close cursor in DPICK.VSELQT01*/


end // end PW0R155

// Get Closeout spcl hndl units
Function PW0R160()
   /* ============================================================*/
   /* GET CLOSEOUT UNITS*/
   /* ============================================================*/

   /* ------------------------------------------------------------*/
   /* Select Units from DPICK.VSELQT01*/
   /* ------------------------------------------------------------*/

   /* TT# 3670 change begins*/
  PW0RW00.PW0RW-PK-SEL-TYP-CNT = 14; /* Set count to 14*/

  while (PW0RW00.PW0RW-PK-SEL-TYP-CNT <= 16) /* while count le 16*/

   /* MOVE '12' TO PW0RW00.PK-SEL-TYP-CD; /* Set indicator to Closeouts*/
    PW0RW00.PK-SEL-TYP-CD = PW0RW00.PW0RW-PK-SEL-TYP-CDS[PW0RW-PK-SEL-TYP-CNT];
                                /* Set indicator to closeouts*/
   /* TT# 3670 change ends*/

    PW0R115(); /* Open cursor in DPICK.VSELQT01*/

    PW0RW00.PW0RWCSR = "N"; /* end of cursor switch*/

    while (PW0RW00.PW0RWCSR == "N") /* until eof*/

      PW0R116(); /* fetch row in DPICK.VSELQT01*/

      if (PW0RW00.PW0RWCSR == "N") /* not end of file*/

      /* ------------------------------------------------------------*/
      /* Accumulate totals for either wildcard or specific values.*/
      /* ------------------------------------------------------------*/
        if (PW0RW01.XDVCD == "*") /* division code NE to wildcard*/

          PW0R134(); /* Add special handling division*/
          if (PW0RW01.XBCCD == "*") /* brand code NE to wildcard*/
            if (PWMREC.XBCCD != "08") /* NE ColeHaan*/
              PW0R117(); /* Add special handling*/
              PW0R136(); /* Add special handling brand*/
            end
          else
            if (PW0RW01.XBCCD == PWMREC.XBCCD)
              PW0R117(); /* Add special handling*/
              PW0R136(); /* Add special handling brand*/
            end
          end

        else

          if (PW0RW01.XBCCD == "*")
            if (PWMREC.XBCCD != "08") /* NE ColeHaan*/
              PW0R136(); /* Add special handling brand*/
              if (PW0RW01.XDVCD == PWMREC.XDVCD)
                PW0R117(); /* Add special handling*/
                PW0R134(); /* Add special handling division*/
              end
            else
              if (PW0RW01.XDVCD == PWMREC.XDVCD)
                PW0R134(); /* Add special handling division*/
              end
            end
          else
            if (PW0RW01.XBCCD == PWMREC.XBCCD)
              PW0R136(); /* Add special handling brand*/
              if (PW0RW01.XDVCD == PWMREC.XDVCD)
                PW0R117(); /* Add special handling*/
                PW0R134(); /* Add special handling division*/
              end
            else
              if (PW0RW01.XDVCD == PWMREC.XDVCD)
                PW0R134(); /* Add special handling division*/
              end
            end
          end

        end

        PW0R131(); /* Add totals for warehouse*/
      end
    end

    PW0R118(); /* close cursor in DPICK.VSELQT01*/

   /* TT# 3670 change begins*/

    PW0RW00.PW0RW-PK-SEL-TYP-CNT = PW0RW00.PW0RW-PK-SEL-TYP-CNT + 1;
                                    /* Increment count*/

  end
   /* TT# 3670 change ends*/
end // end PW0R160

// Get Closeout non-spcl hndl
Function PW0R165()
   /* ============================================================*/
   /* GET CLOSEOUT UNITS*/
   /* ============================================================*/

   /* ------------------------------------------------------------*/
   /* Select Units from DPICK.VSELQT01*/
   /* ------------------------------------------------------------*/

  PW0RW00.PK-SEL-TYP-CD = "13"; /* Set indicator to Closeouts*/

  PW0R115(); /* Open cursor in DPICK.VSELQT01*/

  PW0RW00.PW0RWCSR = "N"; /* end of cursor switch*/

  while (PW0RW00.PW0RWCSR == "N") /* until eof*/

    PW0R116(); /* fetch row in DPICK.VSELQT01*/

    if (PW0RW00.PW0RWCSR == "N") /* not end of file*/

      /* ------------------------------------------------------------*/
      /* Accumulate totals for either wildcard or specific values.*/
      /* ------------------------------------------------------------*/
      if (PW0RW01.XDVCD == "*") /* division code NE to wildcard*/

        PW0R134(); /* Add special handling division*/
        if (PW0RW01.XBCCD == "*") /* brand code NE to wildcard*/
          if (PWMREC.XBCCD != "08") /* NE ColeHaan*/
            PW0R117(); /* Add special handling*/
            PW0R136(); /* Add special handling brand*/
          end
        else
          if (PW0RW01.XBCCD == PWMREC.XBCCD)
            PW0R117(); /* Add special handling*/
            PW0R136(); /* Add special handling brand*/
          end
        end

      else

        if (PW0RW01.XBCCD == "*")
          if (PWMREC.XBCCD != "08") /* NE ColeHaan*/
            PW0R136(); /* Add special handling brand*/
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R117(); /* Add special handling*/
              PW0R134(); /* Add special handling division*/
            end
          else
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R134(); /* Add special handling division*/
            end
          end
        else

          if (PW0RW01.XBCCD == PWMREC.XBCCD)
            PW0R136(); /* Add special handling brand*/
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R117(); /* Add special handling*/
              PW0R134(); /* Add special handling division*/
            end
          else
            if (PW0RW01.XDVCD == PWMREC.XDVCD)
              PW0R134(); /* Add special handling division*/
            end
          end

        end
      end

      PW0R131(); /* Add totals for warehouse*/
    end
  end

  PW0R118(); /* close cursor in DPICK.VSELQT01*/


end // end PW0R165

// Get Equipment units
Function PW0R170()
   /* ----------------------------------------------------*/
   /* This is a new proc added to handle new equipment row*/
   /* TT# 3670*/
   /* ----------------------------------------------------*/

   /* ============================================================*/
   /* GET EQUIPMENT UNITS*/
   /* ============================================================*/

   /* ------------------------------------------------------------*/
   /* Select Equipment (at once) Units from DPICK.VSELQT01*/
   /* ------------------------------------------------------------*/

  PW0RW00.PW0RW-PK-SEL-TYP-CNT = 17; /* Set count to 17*/

  while (PW0RW00.PW0RW-PK-SEL-TYP-CNT <= 24) /* while count le 24*/

    PW0RW00.PK-SEL-TYP-CD = PW0RW00.PW0RW-PK-SEL-TYP-CDS[PW0RW-PK-SEL-TYP-CNT];
                                  /* Set indicator to equipment*/

    PW0R115(); /* Open cursor in DPICK.VSELQT01*/

    PW0RW00.PW0RWCSR = "N"; /* end of cursor switch*/

    while (PW0RW00.PW0RWCSR == "N") /* until eof*/

      PW0R116(); /* fetch row in DPICK.VSELQT01*/

      if (PW0RW00.PW0RWCSR == "N") /* not end of file*/

        /* ------------------------------------------------------------*/
        /* Accumulate totals for either wildcard or specific values.*/
        /* ------------------------------------------------------------*/
        if (PW0RW01.XDVCD == "*") /* division code NE to wildcard*/

          PW0R134(); /* Add equipment division*/
          if (PW0RW01.XBCCD == "*") /* brand code NE to wildcard*/
            if (PWMREC.XBCCD != "08") /* NE to ColeHaan*/
              PW0R117(); /* Add equipment display units*/
              PW0R136(); /* Add equipment brand*/
            end
          else
            if (PW0RW01.XBCCD == PWMREC.XBCCD)
              PW0R117(); /* Add equipment display units*/
              PW0R136(); /* Add equipment brand*/
            end
          end

        else

          if (PW0RW01.XBCCD == "*")
            if (PWMREC.XBCCD != "08") /* NE to ColeHaan*/
              PW0R136(); /* Add equipment brand*/
              if (PW0RW01.XDVCD == PWMREC.XDVCD)
                PW0R117(); /* Add equipment display units*/
                PW0R134(); /* Add equipment division*/
              end
            else
              if (PW0RW01.XDVCD == PWMREC.XDVCD)
                PW0R134(); /* Add equipment division*/
              end
            end
          else
            if (PW0RW01.XBCCD == PWMREC.XBCCD)
              PW0R136(); /* Add equipment brand*/
              if (PW0RW01.XDVCD == PWMREC.XDVCD)
                PW0R117(); /* Add equipment display units*/
                PW0R134(); /* Add equipment division*/
              end
            else
              if (PW0RW01.XDVCD == PWMREC.XDVCD)
                PW0R134(); /* Add equipment division*/
              end
            end
          end

        end

        PW0R131(); /* Add totals for warehouse*/
      end
    end

    PW0R118(); /* close cursor in DPICK.VSELQT01*/

    PW0RW00.PW0RW-PK-SEL-TYP-CNT = PW0RW00.PW0RW-PK-SEL-TYP-CNT + 1;
                                   /* Increment count*/

  end


end // end PW0R170

// Format and Converse the Map
Function PW0R200()
   /* ------------------------------------------------------------*/
   /* If an error was found, save the error message number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    PW0RW00.XXXMSGNO = converseVar.validationMsgNum; /* Message number*/
  end

   /* ------------------------------------------------------------*/
   /* If obtain data failed or no error, format data to display.*/
   /* ------------------------------------------------------------*/

  if (PW0RW00.PW0RWSWR == "Y" /* Obtain data failed*/
   || converseVar.validationMsgNum == 0) /* or no error found*/

    if (PW0RW00.PW0RWSWF == "Y") /* Map must be formatted*/
      PW0R210(); /* Format the data on the map*/
    end

  end

   /* ------------------------------------------------------------*/
   /* Format the current date and any FAST PATH information.*/
   /* ------------------------------------------------------------*/

  PW0RM001.XXXCURDT = VGVar.currentShortGregorianDate; /* Current date*/

  PW0RM001.CATOAP = COMMAREA.CATOAP; /* TO application*/
  PW0RM001.CAITEM = COMMAREA.CAITEM; /* Application data*/

   /* ------------------------------------------------------------*/
   /* If a message to display, indicate sound audible alarm.*/
   /* ------------------------------------------------------------*/

  if (PW0RW00.XXXMSGNO != 0 /* Message to display*/
   || COMMAREA.CAMSG != " ") /* or message text*/

    if (PW0RW00.XXXMSGNO != 0) /* Message to display*/

      if (PW0RW00.XXXMSGNO == 9999)
        converseLib.validationFailed();
      else
        converseLib.validationFailed(PW0RW00.XXXMSGNO);
      end /* Message number*/
    else
      PW0RM001.VAGen_EZEMSG = COMMAREA.CAMSG; /* Message text*/

    end

    PW0RM001.XXXMODID = PW0RW00.XXXMODID; /* Module identification*/

    set PW0RM001 alarm; /* Indicate sound alarm*/
    set PW0RM002 alarm; /* Indicate sound alarm*/

  end

  if (PKWREC.PKWSELSW == "PK") /* \* picking*/
    PW0R-20002();
  else
    PW0R-20001(); /* \* pick planning*/
  end


end // end PW0R200

// Format the Display Data
Function PW0R210()
   /* ------------------------------------------------------------*/
   /* Clear the fields in the map storage area to be formatted.*/
   /* ------------------------------------------------------------*/

  set PW0RM001 initial; /* M001 input/output area*/
  set PW0RM002 initial; /* M002 input/output area*/

  PW0RW00.PW0RWSWF = "N"; /* Format the map switch*/

   /* ------------------------------------------------------------*/
   /* format the data from display storage.*/
   /* ------------------------------------------------------------*/

   /* --------- HEADER FIELDS -----------------*/
  PW0RM001.XWHCD = PW0RW01.XWHCD; /* warehouse*/
  PW0RM001.XWHABRV = PW0RW01.XWHABRV; /* warehouse name*/
  PW0RM001.XDVCD = PW0RW01.XDVCD; /* division code*/
  PW0RM001.XDVDESC = PW0RW01.XDVDESC; /* division desc*/
  PW0RM001.XBCCD = PW0RW01.XBCCD; /* brand code*/
  PW0RM001.XBCABRV = PW0RW01.XBCABRV; /* brand abrv*/
   /* MOVE PW0RW01.PW0RMAPL TO PW0RM001.PW0RMAPL; /* map title*/

   /* --- DETAIL LINES - "at once" -------*/
  PW0RM001.PW0RMASR = PW0RW01.PW0RMASR; /* spec handl repack*/
  PW0RM001.PW0RMARF = PW0RW01.PW0RMARF; /* reg full case*/
  PW0RM001.PW0RMARR = PW0RW01.PW0RMARR; /* reg repack*/
  PW0RM001.PW0RMAXF = PW0RW01.PW0RMAXF; /* stock xfer full case*/
  PW0RM001.PW0RMAXR = PW0RW01.PW0RMAXR; /* stock xfer repack*/
  PW0RM001.PW0RMABG = PW0RW01.PW0RMABG; /* b-grade*/
  PW0RM001.PW0RMACO = PW0RW01.PW0RMACO; /* closeouts*/
  PW0RM001.PW0RMAPF = PW0RW01.PW0RMAPF; /* in-store promo fc*/
  PW0RM001.PW0RMAPR = PW0RW01.PW0RMAPR; /* in-store promo rp*/
   /* TT# 3670 change begins*/
  PW0RM001.PW0RMEAO = PW0RW01.PW0RMAER; /* Equipment Units*/
   /* TT# 3670 change ends*/
  PW0RM001.PW0RMTAO = PW0RW01.PW0RMTAO; /* total at once units*/
  /* extra quantites*/
  PW0RM001.PW0RM-EX-SP-RP-QTY = PW0RW01.PW0R-EX-SP-RP-QTY;
  PW0RM001.PW0RM-EX-NS-RP-QTY = PW0RW01.PW0R-EX-NS-RP-QTY;
  PW0RM001.PW0RM-EX-NS-FC-QTY = PW0RW01.PW0R-EX-NS-FC-QTY;

   /* --- DETAIL LINES - " P & H " -------*/
  PW0RM001.PW0RMPSR = PW0RW01.PW0RMPSR; /* p & h spec handl rep*/
  PW0RM001.PW0RMPRF = PW0RW01.PW0RMPRF; /* p & h reg full case*/
  PW0RM001.PW0RMPRR = PW0RW01.PW0RMPRR; /* p & h reg repack*/
  PW0RM001.PW0RMPXF = PW0RW01.PW0RMPXF; /* stock xfer full case*/
  PW0RM001.PW0RMPXR = PW0RW01.PW0RMPXR; /* stock xfer repack*/
  PW0RM001.PW0RMPBG = PW0RW01.PW0RMPBG; /* b-grade*/
  PW0RM001.PW0RMPCO = PW0RW01.PW0RMPCO; /* closeouts*/
  PW0RM001.PW0RMPPF = PW0RW01.PW0RMPPF; /* in-store promo fc*/
  PW0RM001.PW0RMPPR = PW0RW01.PW0RMPPR; /* in-store promo rp*/
  PW0RM001.PW0RMTPH = PW0RW01.PW0RMTPH; /* p & h total units*/

   /* --- DETAIL LINES - " sel'd by order" ----*/
  PW0RM001.PW0RMOSR = PW0RW01.PW0RMOSR; /* order spec handl rep*/
  PW0RM001.PW0RMORF = PW0RW01.PW0RMORF; /* order reg full case*/
  PW0RM001.PW0RMORR = PW0RW01.PW0RMORR; /* order reg repack*/
  PW0RM001.PW0RMOXF = PW0RW01.PW0RMOXF; /* stock xfer full case*/
  PW0RM001.PW0RMOXR = PW0RW01.PW0RMOXR; /* stock xfer repack*/
  PW0RM001.PW0RMOBG = PW0RW01.PW0RMOBG; /* b-grade*/
  PW0RM001.PW0RMOCO = PW0RW01.PW0RMOCO; /* closeouts*/
  PW0RM001.PW0RMOPF = PW0RW01.PW0RMOPF; /* in-store promo fc*/
  PW0RM001.PW0RMOPR = PW0RW01.PW0RMOPR; /* in-store promo rp*/
   /* TT# 3670 change begins*/
  PW0RM001.PW0RMESO = PW0RW01.PW0RMOER; /* equipment*/
   /* TT# 3670 change ends*/
  PW0RM001.PW0RMTSO = PW0RW01.PW0RMTSO; /* selected order total units*/

   /* --- DETAIL LINES - " by division code" --*/
  PW0RM001.PW0RMDSR = PW0RW01.PW0RMDSR; /* spcl hndl by div. code*/
  PW0RM001.PW0RMDRF = PW0RW01.PW0RMDRF; /* reg full case by div. code*/
  PW0RM001.PW0RMDRR = PW0RW01.PW0RMDRR; /* reg repack by div. code*/
  PW0RM001.PW0RMDXF = PW0RW01.PW0RMDXF; /* xfer full case by div code*/
  PW0RM001.PW0RMDXR = PW0RW01.PW0RMDXR; /* xfer repack by div. code*/
  PW0RM001.PW0RMDBG = PW0RW01.PW0RMDBG; /* b-grade by div. code*/
  PW0RM001.PW0RMDCO = PW0RW01.PW0RMDCO; /* closeouts by div. code*/
  PW0RM001.PW0RMDPF = PW0RW01.PW0RMDPF; /* in-store promo fc*/
  PW0RM001.PW0RMDPR = PW0RW01.PW0RMDPR; /* in-store promo rp*/
   /* TT# 3670 change begins*/
  PW0RM001.PW0RMEDV = PW0RW01.PW0RMDER; /* Equipment by div. code*/
   /* TT# 3670 change ends*/
  PW0RM001.PW0RMTDV = PW0RW01.PW0RMTDV; /* tot closeouts by div cd*/
  PW0RM001.PW0RM-EX-SP-RP-DIV = PW0RW01.PW0R-EX-SP-RP-DIV;
  PW0RM001.PW0RM-EX-NS-RP-DIV = PW0RW01.PW0R-EX-NS-RP-DIV;
  PW0RM001.PW0RM-EX-NS-FC-DIV = PW0RW01.PW0R-EX-NS-FC-DIV;

   /* --- DETAIL LINES - " by brand code" -----*/
  PW0RM001.PW0RMBSR = PW0RW01.PW0RMBSR; /* spcl hndl by brand cd*/
  PW0RM001.PW0RMBRF = PW0RW01.PW0RMBRF; /* reg full case by brand cd*/
  PW0RM001.PW0RMBRR = PW0RW01.PW0RMBRR; /* reg repack by brand cd*/
  PW0RM001.PW0RMBXF = PW0RW01.PW0RMBXF; /* xfer full case by brand cd*/
  PW0RM001.PW0RMBXR = PW0RW01.PW0RMBXR; /* xfer repack by brand cd*/
  PW0RM001.PW0RMBBG = PW0RW01.PW0RMBBG; /* b-grade by brand cd*/
  PW0RM001.PW0RMBCO = PW0RW01.PW0RMBCO; /* closeouts by brand cd*/
  PW0RM001.PW0RMBPF = PW0RW01.PW0RMBPF; /* in-store promo fc*/
  PW0RM001.PW0RMBPR = PW0RW01.PW0RMBPR; /* in-store promo rp*/
   /* TT# 3670 change begins*/
  PW0RM001.PW0RMEBR = PW0RW01.PW0RMBER; /* equipment by brand cd*/
   /* TT# 3670 change ends*/
  PW0RM001.PW0RMTBR = PW0RW01.PW0RMTBR; /* tot closeouts by brand cd*/
  PW0RM001.PW0RM-EX-SP-RP-BRAND = PW0RW01.PW0R-EX-SP-RP-BRAND;
  PW0RM001.PW0RM-EX-NS-RP-BRAND = PW0RW01.PW0R-EX-NS-RP-BRAND;
  PW0RM001.PW0RM-EX-NS-FC-BRAND = PW0RW01.PW0R-EX-NS-FC-BRAND;

   /* --- DETAIL LINES - " by whse code" ------*/
  PW0RM001.PW0RMWSR = PW0RW01.PW0RMWSR; /* spcl hndl by whse code*/
  PW0RM001.PW0RMWRF = PW0RW01.PW0RMWRF; /* reg full case by whse code*/
  PW0RM001.PW0RMWRR = PW0RW01.PW0RMWRR; /* reg repack by whse code*/
  PW0RM001.PW0RMWXF = PW0RW01.PW0RMWXF; /* xfer full case by whse cd*/
  PW0RM001.PW0RMWXR = PW0RW01.PW0RMWXR; /* xfer repack by whse code*/
  PW0RM001.PW0RMWBG = PW0RW01.PW0RMWBG; /* b-grade by whse code*/
  PW0RM001.PW0RMWCO = PW0RW01.PW0RMWCO; /* closeouts by whse code*/
  PW0RM001.PW0RMWPF = PW0RW01.PW0RMWPF; /* in-store promo fc*/
  PW0RM001.PW0RMWPR = PW0RW01.PW0RMWPR; /* in-store promo rp*/
   /* TT# 3670 change begins*/
  PW0RM001.PW0RMEWH = PW0RW01.PW0RMWER; /* equipment by whse code*/
   /* TT# 3670 change ends*/
  PW0RM001.PW0RMTWH = PW0RW01.PW0RMTWH; /* tot closeouts by whse cd*/
  PW0RM001.PW0RM-EX-SP-RP-WHSE = PW0RW01.PW0R-EX-SP-RP-WHSE;
  PW0RM001.PW0RM-EX-NS-RP-WHSE = PW0RW01.PW0R-EX-NS-RP-WHSE;
  PW0RM001.PW0RM-EX-NS-FC-WHSE = PW0RW01.PW0R-EX-NS-FC-WHSE;

   /* --- DETAIL LINES - " hours of work" -----*/
  PW0RM001.PW0RWAHW = PW0RW01.PW0RMAHW; /* tot at once hrs*/
  PW0RM001.PW0RWPHW = PW0RW01.PW0RMPHW; /* tot p & h hrs*/
  PW0RM001.PW0RWOHW = PW0RW01.PW0RMOHW; /* tot sel'd by ord hrs*/
  PW0RM001.PW0RWDHW = PW0RW01.PW0RMDHW; /* tot hrs by div code*/
  PW0RM001.PW0RWBHW = PW0RW01.PW0RMBHW; /* tot hrs by brand cd*/
  PW0RM001.PW0RWWHW = PW0RW01.PW0RMWHW; /* tot hrs by whse code*/

   /* --- DETAIL LINES - " pick time " -----*/
  PW0RM001.PW0RMRPT = PW0RW01.PW0RMRPT; /* picking time for repack*/
  PW0RM001.PW0RMFPT = PW0RW01.PW0RMFPT; /* picking time for fullcase*/


end // end PW0R210

// Check Attention Identifier
Function PW0R300()
   /* ------------------------------------------------------------*/
   /* If CANCEL was requested, clear the map fields and exit.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pa2) /* PA2 was pressed*/

    if (PW0RW00.PW0RWSWR == "Y") /* request for data pending*/
      set PW0RW01 empty; /* M001 display storage*/
    end

    PW0RW00.PW0RWSWF = "Y"; /* format the map switch*/
    PW0RW00.PW0RWSWR = "N"; /* request for data switch*/

    COMMAREA.CATOAP = " "; /* TO application*/
    COMMAREA.CAITEM = " "; /* application data*/

    exit stack; /* exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* If FAST PATH was requested, transfer to the application.*/
   /* ------------------------------------------------------------*/

  if (PW0RM001.CATOAP > " ") /* FAST PATH was requested*/

    if (converseVar.eventKey is enter) /* ENTER was pressed*/

      if (PW0RM001.CATOAP == "PW0R") /* itself*/

        PW0RW00.XXXMODID = "300"; /* module identification*/
        converseLib.validationFailed(1); /* invalid fast path option*/
        set PW0RM001.CATOAP cursor, bold; /* highlight*/

        exit stack;

      else

        XSPKS01(); /* exit to another application*/

        set PW0RM001.CATOAP cursor, bold; /* highlight*/

      end
    else

      PW0RW00.XXXMODID = "300"; /* module identification*/
      converseLib.validationFailed(13); /* PA2/PF key may not be used*/

    end

    exit stack; /* exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Determine PFKey and Exit to the Requested Application*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf1  /* PF1 was pressed*/
   || converseVar.eventKey is pf3  /* or PF3 was pressed*/
   || converseVar.eventKey is pf4  /* or PF4 was pressed*/
   || converseVar.eventKey is pf6  /* or PF6 was pressed*/
   || converseVar.eventKey is pf13 /* or PF13 was pressed*/
   || converseVar.eventKey is pf16 /* or PF16 was pressed*/
   || converseVar.eventKey is pf17 /* or PF17 was pressed*/
   || converseVar.eventKey is pf18 /* or PF18 was pressed*/
   || converseVar.eventKey is pf19) /* or PF19 was pressed*/

    if (converseVar.eventKey is pf1) /* PF1 was pressed*/
      COMMAREA.CAITEM = "PW0RM001"; /* application find code*/
      COMMAREA.CATOAP = "GD00"; /* exit to help gd00*/
    end

    if (converseVar.eventKey is pf4) /* PF4 was pressed*/
      COMMAREA.CATOAP = "MN0M"; /* exit to master menu mn0m*/
    end

    if (converseVar.eventKey is pf3) /* PF3 was pressed*/
      COMMAREA.CAUSERA = PKWREC.PKWGRPLV;
      if (PKWREC.PKWSELSW == "PK")
        COMMAREA.CATOAP = "PW0V"; /* TO application*/
      else
        if (PKWREC.PKWSELSW == "PP")
          COMMAREA.CATOAP = "PW0W"; /* TO application*/
        end
      end
    end

    if (converseVar.eventKey is pf6) /* PF6 was pressed*/
      COMMAREA.CATOAP = "PW0S"; /* transfer to PW0S*/
    end

    if (converseVar.eventKey is pf13) /* PF13 was pressed*/
      COMMAREA.CATOAP = "PW0J"; /* transfer to pw0j*/
    end

    if (converseVar.eventKey is pf16) /* PF16 was pressed*/
      COMMAREA.CATOAP = "PW0M"; /* transfer to PW0M*/
    end

    if (converseVar.eventKey is pf17) /* PF17 was pressed*/
      COMMAREA.CATOAP = "PW0P"; /* transfer to PW0P*/
    end

    if (converseVar.eventKey is pf18) /* PF18 was pressed*/
      COMMAREA.CATOAP = "PW0X"; /* transfer to Pw0x*/
    end

    if (converseVar.eventKey is pf19) /* PF19 was pressed*/
      COMMAREA.CATOAP = "PW06"; /* transfer to Pw06*/
    end

    XSPKS01(); /* transfer to another application*/

    exit stack; /* exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Determine whether a valid attention identifier was used to*/
   /* invoke the transaction.  Display an error message to the*/
   /* user if the PF key used is not supported.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey not enter) /* ENTER was not pressed*/

    PW0RW00.XXXMODID = "300"; /* module identification*/
    converseLib.validationFailed(12); /* set error message to invalid key*/

    if (converseVar.eventKey is pakey) /* PA key was pressed*/
      converseLib.clearScreen();
       /* clear screen before display*/
    end

    exit stack; /* exit to another application*/

  end


end // end PW0R300

// Reset Highlighted Fields
Function PW0R400()
   /* ------------------------------------------------------------*/
   /* Reset Field Attributes To Normal Intensity*/
   /* ------------------------------------------------------------*/

   /* ------ HEADER FIELDS --------*/
  set PW0RM001.XWHCD initialAttributes; /* warehouse code*/
  set PW0RM001.XDVCD initialAttributes; /* division code*/
  set PW0RM001.XDVDESC initialAttributes; /* division desc*/
  set PW0RM001.XBCCD initialAttributes; /* brand code*/
  set PW0RM001.XBCABRV initialAttributes; /* brand abrv*/

   /* -DETAIL LINES- at once ------*/
  set PW0RM001.PW0RMASR initialAttributes; /* at once spec handling units*/
  set PW0RM001.PW0RMARF initialAttributes; /* at once reg handling full cs*/
  set PW0RM001.PW0RMARR initialAttributes; /* at once reg handling repack*/
  set PW0RM001.PW0RMAXF initialAttributes; /* at once stock xfer full cs*/
  set PW0RM001.PW0RMAXR initialAttributes; /* at once stock xfer repack*/
  set PW0RM001.PW0RMABG initialAttributes; /* at once b-grade*/
  set PW0RM001.PW0RMACO initialAttributes; /* at once closeouts*/
  set PW0RM001.PW0RMAPF initialAttributes; /* at once in-store promo fc*/
  set PW0RM001.PW0RMAPR initialAttributes; /* at once in-store promo rp*/
  set PW0RM001.PW0RMTAO initialAttributes; /* at once total units*/

   /* -DETAIL LINES- p & h --------*/
  set PW0RM001.PW0RMPSR initialAttributes; /* p & h spec handling units*/
  set PW0RM001.PW0RMPRF initialAttributes; /* p & h reg handling full cs*/
  set PW0RM001.PW0RMPRR initialAttributes; /* p & h reg handling repack*/
  set PW0RM001.PW0RMPXF initialAttributes; /* p & h stock xfer full cs*/
  set PW0RM001.PW0RMPXR initialAttributes; /* p & h stock xfer repack*/
  set PW0RM001.PW0RMPBG initialAttributes; /* p & h b-grade*/
  set PW0RM001.PW0RMPCO initialAttributes; /* p & h closeouts*/
  set PW0RM001.PW0RMPPF initialAttributes; /* at once in-store promo fc*/
  set PW0RM001.PW0RMPPR initialAttributes; /* at once in-store promo rp*/
  set PW0RM001.PW0RMTPH initialAttributes; /* p & h total units*/

   /* -DETAIL LINES- sel'd by ord -*/
  set PW0RM001.PW0RMOSR initialAttributes; /* order spec handling units*/
  set PW0RM001.PW0RMORF initialAttributes; /* order reg handling full cs*/
  set PW0RM001.PW0RMORR initialAttributes; /* order reg handling repack*/
  set PW0RM001.PW0RMOXF initialAttributes; /* order stock xfer full cs*/
  set PW0RM001.PW0RMOXR initialAttributes; /* order stock xfer repack*/
  set PW0RM001.PW0RMOBG initialAttributes; /* order b-grade*/
  set PW0RM001.PW0RMOCO initialAttributes; /* order closeouts*/
  set PW0RM001.PW0RMOPF initialAttributes; /* at once in-store promo fc*/
  set PW0RM001.PW0RMOPR initialAttributes; /* at once in-store promo rp*/
  set PW0RM001.PW0RMTSO initialAttributes; /* order total units*/

   /* -DETAIL LINES- by div cd ----*/
  set PW0RM001.PW0RMDSR initialAttributes; /* spec handling units by div cd*/
  set PW0RM001.PW0RMDRF initialAttributes; /* reg handling full cs by div cd*/
  set PW0RM001.PW0RMDRR initialAttributes; /* reg handling repack by div cd*/
  set PW0RM001.PW0RMDXF initialAttributes; /* stock xfer full cs by div cd*/
  set PW0RM001.PW0RMDXR initialAttributes; /* stock xfer repack by div cd*/
  set PW0RM001.PW0RMDBG initialAttributes; /* b-grade by div cd*/
  set PW0RM001.PW0RMDCO initialAttributes; /* closeouts by div cd*/
  set PW0RM001.PW0RMDPF initialAttributes; /* at once in-store promo fc*/
  set PW0RM001.PW0RMDPR initialAttributes; /* at once in-store promo rp*/
  set PW0RM001.PW0RMTDV initialAttributes; /* total units by div cd*/

   /* -DETAIL LINES- by brand cd --*/
  set PW0RM001.PW0RMBSR initialAttributes; /* spec handling units by brand cd*/
  set PW0RM001.PW0RMBRF initialAttributes; /* reg handling full cs by brand cd*/
  set PW0RM001.PW0RMBRR initialAttributes; /* reg handling repack by brand cd*/
  set PW0RM001.PW0RMBXF initialAttributes; /* stock xfer full cs by brand cd*/
  set PW0RM001.PW0RMBXR initialAttributes; /* stock xfer repack by brand cd*/
  set PW0RM001.PW0RMBBG initialAttributes; /* b-grade by brand cd*/
  set PW0RM001.PW0RMBCO initialAttributes; /* closeouts by brand cd*/
  set PW0RM001.PW0RMBPF initialAttributes; /* at once in-store promo fc*/
  set PW0RM001.PW0RMBPR initialAttributes; /* at once in-store promo rp*/
  set PW0RM001.PW0RMTBR initialAttributes; /* total units by brand cd*/

   /* -DETAIL LINES- by whse cd ---*/
  set PW0RM001.PW0RMWSR initialAttributes; /* spec handling units by whse cd*/
  set PW0RM001.PW0RMWRF initialAttributes; /* reg handling full cs by whse cd*/
  set PW0RM001.PW0RMWRR initialAttributes; /* reg handling repack by whse cd*/
  set PW0RM001.PW0RMWXF initialAttributes; /* stock xfer full cs by whse cd*/
  set PW0RM001.PW0RMWXR initialAttributes; /* stock xfer repack by whse cd*/
  set PW0RM001.PW0RMWBG initialAttributes; /* b-grade by whse cd*/
  set PW0RM001.PW0RMWCO initialAttributes; /* closeouts by whse cd*/
  set PW0RM001.PW0RMWPF initialAttributes; /* at once in-store promo fc*/
  set PW0RM001.PW0RMWPR initialAttributes; /* at once in-store promo rp*/
  set PW0RM001.PW0RMTWH initialAttributes; /* total units by whse cd*/

   /* -DETAIL LINES- hrs work -----*/
  set PW0RM001.PW0RWAHW initialAttributes; /* total hours/min - spcl hndl*/
  set PW0RM001.PW0RWPHW initialAttributes; /* total hours/min - p & h*/
  set PW0RM001.PW0RWOHW initialAttributes; /* total hours/min - sel'd by order*/
  set PW0RM001.PW0RWDHW initialAttributes; /* total hours/min - by div code*/
  set PW0RM001.PW0RWBHW initialAttributes; /* total hours/min - by brand cd*/
  set PW0RM001.PW0RWWHW initialAttributes; /* total hours/min - by whse code*/


end // end PW0R400

// Verify Data That Was Entered
Function PW0R500()
   /* ------------------------------------------------------------*/
   /* Highlight Any Application Data That Was Entered.*/
   /* ------------------------------------------------------------*/

  if (COMMAREA.CAITEM > " ") /* application data was entered*/

    PW0RW00.XXXMODID = "500"; /* module identification*/
    set PW0RM001.CAITEM cursor, bold; /* highlight*/
    converseLib.validationFailed(15); /* set error msg to invalid fastpath*/

  end

   /* ------------------------------------------------------------*/
   /* If warehouse code changed, verify warehouse.*/
   /* ------------------------------------------------------------*/

  if (PW0RM001.XWHCD != PW0RW01.XWHCD) /* warehouse code changed*/

    PW0R510(); /* verify warehouse*/

  end

   /* ------------------------------------------------------------*/
   /* If division code changed, verify division code.*/
   /* ------------------------------------------------------------*/

  if (PW0RM001.XDVCD != PW0RW01.XDVCD) /* division code changed*/

    PW0RW00.PW0RWSWR = "Y"; /* Request data switch*/
    PW0R515(); /* verify division code*/

  end

   /* ------------------------------------------------------------*/
   /* If brand code changed, verify brand code.*/
   /* ------------------------------------------------------------*/

  if (PW0RM001.XBCCD != PW0RW01.XBCCD) /* brand code*/

    PW0RW00.PW0RWSWR = "Y"; /* Request data switch*/
    PW0R520(); /* verify brand code*/

  end

   /* ------------------------------------------------------------*/
   /* If any error was found, exit to display map*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* error was found*/
    exit stack; /* exit to display map*/
  end


end // end PW0R500

// Verify warehouse
Function PW0R510()
   /* ------------------------------------------------------------*/
   /* Verify warehouse was entered*/
   /* ------------------------------------------------------------*/

  if (PW0RM001.XWHCD == "  ") /* no warehouse entered*/

    PW0RW00.XXXMODID = "510"; /* module identification*/
    set PW0RM001.XWHCD cursor, bold; /* highlight field in error*/
    converseLib.validationFailed(4);

  end

  if (PW0RM001.XWHCD in XWHTBL.XWHCD /* code in table*/
   && XWHTBL.XXXSTAT[sysVar.arrayIndex] == "A") /* and active status*/

     /* next sentence*/

  else

    /* ------------------------------------------------------------*/
     /* If not found or inactive, indicate missing or invalid.*/
    /* ------------------------------------------------------------*/

    PW0RW00.XXXMODID = "510"; /* module identification*/
    set PW0RM001.XWHCD cursor, bold; /* highlight field in error*/
    converseLib.validationFailed(2); /* set err msg to invalid whse*/

  end


end // end PW0R510

// Verify division entered
Function PW0R515()
   /* ------------------------------------------------------------*/
   /* If division code changed, verify division code.*/
   /* ------------------------------------------------------------*/

  if (PW0RM001.XDVCD == " ") /* division code blank*/
    converseLib.validationFailed(393);
    set PW0RM001.XDVCD cursor, bold;
    PW0RW00.XXXMODID = "515";
    exit stack;
  end

  PKWREC.XDVCD[1] = PW0RM001.XDVCD;

  if (PKWREC.XDVCD[1] != "*")
    XPPK004(); /* verify division code*/

    if (converseVar.validationMsgNum == 0) /* if no errors, move div cd & abrv*/
      PW0RW01.XDVCD = PKWREC.XDVCD[1];
      PW0RW01.XDVDESC = XDVTBL.XDVDESC[sysVar.arrayIndex];
    else
      converseLib.validationFailed(393);
      set PW0RM001.XDVCD cursor, bold;
      PW0RW00.XXXMODID = "515";
      exit stack;
    end
  else
    PW0RW01.XDVDESC = "ALL DIVISIONS";
    PW0RW01.XDVCD = PKWREC.XDVCD[1];
  end


end // end PW0R515

// Verify brand that was entered
Function PW0R520()
   /* ------------------------------------------------------------*/
   /* If brand code changed, verify brand code.*/
   /* ------------------------------------------------------------*/

  if (PW0RM001.XBCCD == " ") /* brand code blank*/
    converseLib.validationFailed(413); /* INVALID BRAND CODE*/
    set PW0RM001.XBCCD cursor, bold;
    PW0RW00.XXXMODID = "520";
    exit stack;
  end

  PKWREC.XBCCD[1] = PW0RM001.XBCCD;

  if (PKWREC.XBCCD[1] != "*")
    if (PKWREC.XBCCD[1] in XBCTBL.XBCCD)
      if (XBCTBL.XXXSTAT[sysVar.arrayIndex] != "A")
        converseLib.validationFailed(414); /* INACTIVE BRAND CODE*/
        set PW0RM001.XBCCD cursor, bold;
        PW0RW00.XXXMODID = "520";
        exit stack;
      else
        PW0RW01.XBCCD = PKWREC.XBCCD[1];
        PW0RW01.XBCABRV = XBCTBL.XBCABRV[sysVar.arrayIndex];
      end
    else
      converseLib.validationFailed(413); /* INVALID BRAND CODE*/
      set PW0RM001.XBCCD cursor, bold;
      PW0RW00.XXXMODID = "520";
      exit stack;
    end
  else
    PW0RW00.XXXMSGNO = 421;
    PW0RW01.XBCABRV = " ";
    PW0RW01.XBCCD = PKWREC.XBCCD[1];
  end


end // end PW0R520

// Process Valid Input Request
Function PW0R600()
   /* ------------------------------------------------------------*/
   /* Indicate map must be formatted before display.*/
   /* ------------------------------------------------------------*/

  PW0RW00.PW0RWSWF = "Y"; /* format the map switch*/

   /* ------------------------------------------------------------*/
   /* Update modifiable data in the commarea*/
   /* ------------------------------------------------------------*/

  COMMAREA.XWHCD = PW0RM001.XWHCD; /* warehouse code*/

   /* ------------------------------------------------------------*/
   /* If the key fields changed, request the data to display*/
   /* ------------------------------------------------------------*/

  if (PW0RM001.XWHCD != PW0RW01.XWHCD) /* warehouse code changed*/

    PW0RW00.PW0RWSWR = "Y"; /* request for data switch*/

    return; /* return to previous process*/

  end


end // end PW0R600

//*** RECORD=PW0RW00 ****
// ---------------------------
// Application Working Storage
// ---------------------------
// -------   --------  ------  --------------------------------
// CONTROL     DATE     NAME   DESCRIPTION OF CHANGE
// -------   --------  ------  --------------------------------
// TT#3670   09/25/00  JSUNDA  New variables PW0RMAER,PW0RMBER
//                             PW0RMDER,PW0RMWER and PW0RMOER
//                             are added to store equipment
//                             quantities.
//                             Also PW0RW-PK-SEL-TYP-ARR and
//                             PW0RW-PK-SEL-TYP-CDS are added
//                             to store selection type codes
//                             and PW0RW-PK-SEL-TYP-CNT is
//                             added to count no of sel typ cds
// ***********************
Record PW0RW00 type basicRecord
  10 * char(821) ; 
    15 XWHCD XWHCD ; 
    15 PW0RWSWF PW0RWSWF ; 
    15 PW0RWSWR PW0RWSWR ; 
    15 PW0RWCSR PW0RWCSR ; 
    15 XXXMODID XXXMODID ; 
    15 XXXMSGNO XXXMSGNO ; 
    15 PW0RWEDT PW0RWEDT ; 
      20 PW0RWECC PW0RWECC ; 
      20 PW0RWEYY PW0RWEYY ; 
      20 PW0RWEMM PW0RWEMM ; 
      20 PW0RWEDD PW0RWEDD ; 
    15 PW0RWMPH PW0RWMPH ; 
      20 PW0RWPCC PW0RWPCC ; 
      20 PW0RWPYY PW0RWPYY ; 
      20 PW0RWPMM PW0RWPMM ; 
      20 PW0RWPDD PW0RWPDD ; 
    15 PK4SLIND PK4SLIND ; 
    15 PKURUNMD PKURUNMD ; 
    15 PKHPVSMM PKHPVSMM ; 
    15 PK-SEL-TYP-CD PK-SEL-TYP-CD ; 
    15 PW0RWWHM PW0RWWHM ; 
    15 PW0RWWHH PW0RWWHH ; 
    15 PW0RWWMM PW0RWWMM ; 
    15 PW0RWAHW PW0RWAHW ; 
    15 PW0RWPHW PW0RWPHW ; 
    15 PW0RWOHW PW0RWOHW ; 
    15 PW0RWDHW PW0RWDHW ; 
    15 PW0RWBHW PW0RWBHW ; 
    15 PW0RWWHW PW0RWWHW ; 
    15 PW0RMASR PW0RMASR ; 
    15 PW0RMARF PW0RMARF ; 
    15 PW0RMARR PW0RMARR ; 
    15 PW0RMAXF PW0RMAXF ; 
    15 PW0RMAXR PW0RMAXR ; 
    15 PW0RMABG PW0RMABG ; 
    15 PW0RMACO PW0RMACO ; 
    15 PW0RMAPF PW0RMAPF ; 
    15 PW0RMAPR PW0RMAPR ; 
    15 PW0RMTAO PW0RMTAO ; 
    15 PW0RMTXR PW0RMTXR ; 
    15 PW0RMTXF PW0RMTXF ; 
    15 PW0RMPSR PW0RMPSR ; 
    15 PW0RMPRF PW0RMPRF ; 
    15 PW0RMPRR PW0RMPRR ; 
    15 PW0RMPXF PW0RMPXF ; 
    15 PW0RMPXR PW0RMPXR ; 
    15 PW0RMPBG PW0RMPBG ; 
    15 PW0RMPCO PW0RMPCO ; 
    15 PW0RMPPF PW0RMPPF ; 
    15 PW0RMPPR PW0RMPPR ; 
    15 PW0RMTPH PW0RMTPH ; 
    15 PW0RMOSR PW0RMOSR ; 
    15 PW0RMORF PW0RMORF ; 
    15 PW0RMORR PW0RMORR ; 
    15 PW0RMOXF PW0RMOXF ; 
    15 PW0RMOXR PW0RMOXR ; 
    15 PW0RMOBG PW0RMOBG ; 
    15 PW0RMOCO PW0RMOCO ; 
    15 PW0RMOPF PW0RMOPF ; 
    15 PW0RMOPR PW0RMOPR ; 
    15 PW0RMTSO PW0RMTSO ; 
    15 PW0RMDSR PW0RMDSR ; 
    15 PW0RMDRF PW0RMDRF ; 
    15 PW0RMDRR PW0RMDRR ; 
    15 PW0RMDXF PW0RMDXF ; 
    15 PW0RMDXR PW0RMDXR ; 
    15 PW0RMDBG PW0RMDBG ; 
    15 PW0RMDCO PW0RMDCO ; 
    15 PW0RMDPF PW0RMDPF ; 
    15 PW0RMDPR PW0RMDPR ; 
    15 PW0RMTDV PW0RMTDV ; 
    15 PW0RMBSR PW0RMBSR ; 
    15 PW0RMBRF PW0RMBRF ; 
    15 PW0RMBRR PW0RMBRR ; 
    15 PW0RMBXF PW0RMBXF ; 
    15 PW0RMBXR PW0RMBXR ; 
    15 PW0RMBBG PW0RMBBG ; 
    15 PW0RMBCO PW0RMBCO ; 
    15 PW0RMBPF PW0RMBPF ; 
    15 PW0RMBPR PW0RMBPR ; 
    15 PW0RMTBR PW0RMTBR ; 
    15 PW0RMWSR PW0RMWSR ; 
    15 PW0RMWRF PW0RMWRF ; 
    15 PW0RMWRR PW0RMWRR ; 
    15 PW0RMWXF PW0RMWXF ; 
    15 PW0RMWXR PW0RMWXR ; 
    15 PW0RMWBG PW0RMWBG ; 
    15 PW0RMWCO PW0RMWCO ; 
    15 PW0RMWPF PW0RMWPF ; 
    15 PW0RMWPR PW0RMWPR ; 
    15 PW0RMTWH PW0RMTWH ; 
    15 PW0RMTSR PW0RMTSR ; 
    15 PW0RMTRR PW0RMTRR ; 
    15 PW0RMTRF PW0RMTRF ; 
    15 PW0RMTWF PW0RMTWF ; 
    15 PW0RMTWR PW0RMTWR ; 
    15 PW0RMAER PW0RMAER ; 
    15 PW0RMBER PW0RMBER ; 
    15 PW0RMDER PW0RMDER ; 
    15 PW0RMWER PW0RMWER ; 
    15 PW0RMOER PW0RMOER ; 
    15 PW0RW-EX-NS-FC-QTY PW0RW-EX-NS-FC-QTY ; 
    15 PW0RW-EX-NS-FC-DIV PW0RW-EX-NS-FC-DIV ; 
    15 PW0RW-EX-NS-FC-BRAND PW0RW-EX-NS-FC-BRAND ; 
    15 PW0RW-EX-NS-FC-WHSE PW0RW-EX-NS-FC-WHSE ; 
    15 PW0RW-EX-NS-RP-QTY PW0RW-EX-NS-RP-QTY ; 
    15 PW0RW-EX-NS-RP-DIV PW0RW-EX-NS-RP-DIV ; 
    15 PW0RW-EX-NS-RP-BRAND PW0RW-EX-NS-RP-BRAND ; 
    15 PW0RW-EX-NS-RP-WHSE PW0RW-EX-NS-RP-WHSE ; 
    15 PW0RW-EX-SP-RP-QTY PW0RW-EX-SP-RP-QTY ; 
    15 PW0RW-EX-SP-RP-DIV PW0RW-EX-SP-RP-DIV ; 
    15 PW0RW-EX-SP-RP-BRAND PW0RW-EX-SP-RP-BRAND ; 
    15 PW0RW-EX-SP-RP-WHSE PW0RW-EX-SP-RP-WHSE ; 
    15 PW0RMTHW PW0RMTHW ; 
  10 PW0RWRMM PW0RWRMM ; 
  10 PW0RW-PK-SEL-TYP-ARR PW0RW-PK-SEL-TYP-ARR ; 
    15 PW0RW-PK-SEL-TYP-CDS PW0RW-PK-SEL-TYP-CDS [24] ; 
  10 PW0RW-PK-SEL-TYP-CNT PW0RW-PK-SEL-TYP-CNT ; 
end // end PW0RW00

//*** RECORD=PW0RW01 ****
// -----------------------
// Map 001 Display Storage
// -----------------------
// --------------------------------
//  CONTROL     DATE     NAME   DESCRIPTION OF CHANGE
//  -------   --------  ------
// --------------------------------
//  TT#3670   09/25/00  JSUNDA  New variables PW0RMAER,PW0RMBER
//                              PW0RMDER,PW0RMWER and PW0RMOER
//                              are added to display equipment
//                              quantities.
// ***********************
Record PW0RW01 type basicRecord
  10 CACHGFL CACHGFL ; 
  10 XXXMODID XXXMODID ; 
  10 XXXCURDT XXXCURDT ; 
  10 PW0RMAPL PW0RMAPL ; 
  10 XWHCD XWHCD ; 
  10 XWHABRV XWHABRV ; 
  10 XDVCD XDVCD ; 
  10 XDVDESC XDVDESC ; 
  10 XBCCD XBCCD ; 
  10 XBCABRV XBCABRV ; 
  10 PW0RMASR PW0RMASR ; 
  10 PW0RMARF PW0RMARF ; 
  10 PW0RMARR PW0RMARR ; 
  10 PW0RMAXF PW0RMAXF ; 
  10 PW0RMAXR PW0RMAXR ; 
  10 PW0RMABG PW0RMABG ; 
  10 PW0RMACO PW0RMACO ; 
  10 PW0RMAPF PW0RMAPF ; 
  10 PW0RMAPR PW0RMAPR ; 
  10 PW0RMTAO PW0RMTAO ; 
  10 PW0RMAHW PW0RMAHW ; 
    15 PW0RMAHH PW0RMAHH ; 
    15 PW0RMACL PW0RMACL ; 
    15 PW0RMAMM PW0RMAMM ; 
  10 PW0RMPSR PW0RMPSR ; 
  10 PW0RMPRF PW0RMPRF ; 
  10 PW0RMPRR PW0RMPRR ; 
  10 PW0RMPXF PW0RMPXF ; 
  10 PW0RMPXR PW0RMPXR ; 
  10 PW0RMPBG PW0RMPBG ; 
  10 PW0RMPCO PW0RMPCO ; 
  10 PW0RMPPF PW0RMPPF ; 
  10 PW0RMPPR PW0RMPPR ; 
  10 PW0RMTPH PW0RMTPH ; 
  10 PW0RMPHW PW0RMPHW ; 
    15 PW0RMPHH PW0RMPHH ; 
    15 PW0RMPCL PW0RMPCL ; 
    15 PW0RMPMM PW0RMPMM ; 
  10 PW0RMOSR PW0RMOSR ; 
  10 PW0RMORF PW0RMORF ; 
  10 PW0RMORR PW0RMORR ; 
  10 PW0RMOXF PW0RMOXF ; 
  10 PW0RMOXR PW0RMOXR ; 
  10 PW0RMOBG PW0RMOBG ; 
  10 PW0RMOCO PW0RMOCO ; 
  10 PW0RMOPF PW0RMOPF ; 
  10 PW0RMOPR PW0RMOPR ; 
  10 PW0RMTSO PW0RMTSO ; 
  10 PW0RMAER PW0RMAER ; 
  10 PW0RMBER PW0RMBER ; 
  10 PW0RMDER PW0RMDER ; 
  10 PW0RMWER PW0RMWER ; 
  10 PW0RMOER PW0RMOER ; 
  10 PW0R-EX-NS-RP-QTY PW0R-EX-NS-RP-QTY ; 
  10 PW0R-EX-NS-RP-DIV PW0R-EX-NS-RP-DIV ; 
  10 PW0R-EX-NS-RP-BRAND PW0R-EX-NS-RP-BRAND ; 
  10 PW0R-EX-NS-RP-WHSE PW0R-EX-NS-RP-WHSE ; 
  10 PW0R-EX-SP-RP-QTY PW0R-EX-SP-RP-QTY ; 
  10 PW0R-EX-SP-RP-DIV PW0R-EX-SP-RP-DIV ; 
  10 PW0R-EX-SP-RP-BRAND PW0R-EX-SP-RP-BRAND ; 
  10 PW0R-EX-SP-RP-WHSE PW0R-EX-SP-RP-WHSE ; 
  10 PW0R-EX-NS-FC-QTY PW0R-EX-NS-FC-QTY ; 
  10 PW0R-EX-NS-FC-DIV PW0R-EX-NS-FC-DIV ; 
  10 PW0R-EX-NS-FC-BRAND PW0R-EX-NS-FC-BRAND ; 
  10 PW0R-EX-NS-FC-WHSE PW0R-EX-NS-FC-WHSE ; 
  10 PW0RMOHW PW0RMOHW ; 
    15 PW0RMOHH PW0RMOHH ; 
    15 PW0RMOCL PW0RMOCL ; 
    15 PW0RMOMM PW0RMOMM ; 
  10 PW0RMDSR PW0RMDSR ; 
  10 PW0RMDRF PW0RMDRF ; 
  10 PW0RMDRR PW0RMDRR ; 
  10 PW0RMDXF PW0RMDXF ; 
  10 PW0RMDXR PW0RMDXR ; 
  10 PW0RMDBG PW0RMDBG ; 
  10 PW0RMDCO PW0RMDCO ; 
  10 PW0RMDPF PW0RMDPF ; 
  10 PW0RMDPR PW0RMDPR ; 
  10 PW0RMTDV PW0RMTDV ; 
  10 PW0RMDHW PW0RMDHW ; 
    15 PW0RMDHH PW0RMDHH ; 
    15 PW0RMDCL PW0RMDCL ; 
    15 PW0RMDMM PW0RMDMM ; 
  10 PW0RMBSR PW0RMBSR ; 
  10 PW0RMBRF PW0RMBRF ; 
  10 PW0RMBRR PW0RMBRR ; 
  10 PW0RMBXF PW0RMBXF ; 
  10 PW0RMBXR PW0RMBXR ; 
  10 PW0RMBBG PW0RMBBG ; 
  10 PW0RMBCO PW0RMBCO ; 
  10 PW0RMBPF PW0RMBPF ; 
  10 PW0RMBPR PW0RMBPR ; 
  10 PW0RMTBR PW0RMTBR ; 
  10 PW0RMBHW PW0RMBHW ; 
    15 PW0RMBHH PW0RMBHH ; 
    15 PW0RMBCL PW0RMBCL ; 
    15 PW0RMBMM PW0RMBMM ; 
  10 PW0RMWSR PW0RMWSR ; 
  10 PW0RMWRF PW0RMWRF ; 
  10 PW0RMWRR PW0RMWRR ; 
  10 PW0RMWXF PW0RMWXF ; 
  10 PW0RMWXR PW0RMWXR ; 
  10 PW0RMWBG PW0RMWBG ; 
  10 PW0RMWCO PW0RMWCO ; 
  10 PW0RMWPF PW0RMWPF ; 
  10 PW0RMWPR PW0RMWPR ; 
  10 PW0RMTWH PW0RMTWH ; 
  10 PW0RMWHW PW0RMWHW ; 
    15 PW0RMWHH PW0RMWHH ; 
    15 PW0RMWCL PW0RMWCL ; 
    15 PW0RMWMM PW0RMWMM ; 
  10 PW0RMTSR PW0RMTSR ; 
  10 PW0RMTRF PW0RMTRF ; 
  10 PW0RMTRR PW0RMTRR ; 
  10 PW0RMTXF PW0RMTXF ; 
  10 PW0RMTXR PW0RMTXR ; 
  10 PW0RMTWF PW0RMTWF ; 
  10 PW0RMTWR PW0RMTWR ; 
  10 PW0RMTHW PW0RMTHW ; 
    15 PW0RMTHH PW0RMTHH ; 
    15 PW0RMTCL PW0RMTCL ; 
    15 PW0RMTMM PW0RMTMM ; 
  10 PW0RMRPT PW0RMRPT ; 
    15 PW0RMRHH PW0RMRHH ; 
    15 PW0RMRCL PW0RMRCL ; 
    15 PW0RMRMM PW0RMRMM ; 
  10 PW0RMFPT PW0RMFPT ; 
    15 PW0RMFHH PW0RMFHH ; 
    15 PW0RMFCL PW0RMFCL ; 
    15 PW0RMFMM PW0RMFMM ; 
end // end PW0RW01

// total selected order units
DataItem PW0R-EX-NS-FC-BRAND num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total selected order units
DataItem PW0R-EX-NS-FC-DIV num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total selected order units
DataItem PW0R-EX-NS-FC-QTY num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total selected order units
DataItem PW0R-EX-NS-FC-WHSE num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total selected order units
DataItem PW0R-EX-NS-RP-BRAND num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total selected order units
DataItem PW0R-EX-NS-RP-DIV num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total selected order units
DataItem PW0R-EX-NS-RP-QTY num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total selected order units
DataItem PW0R-EX-NS-RP-WHSE num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total selected order units
DataItem PW0R-EX-SP-RP-BRAND num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total selected order units
DataItem PW0R-EX-SP-RP-DIV num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total selected order units
DataItem PW0R-EX-SP-RP-QTY num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total selected order units
DataItem PW0R-EX-SP-RP-WHSE num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// at once b-grade
DataItem PW0RMABG num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// colon
DataItem PW0RMACL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// at once closeouts
DataItem PW0RMACO num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// Equipment at once
DataItem PW0RMAER num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// at once hours
DataItem PW0RMAHH num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// at once total hours/min
DataItem PW0RMAHW char(7)  {
  align = right, fillCharacter = nullFill, inputRequired = no
}
end

// at once minutes
DataItem PW0RMAMM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// at once in-store promo fc
DataItem PW0RMAPF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// useage, picking or pk planning
DataItem PW0RMAPL char(13)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// at once in-store promo repk
DataItem PW0RMAPR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// at once regular full case
DataItem PW0RMARF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// at once regular repack
DataItem PW0RMARR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// at once spcl hndl repack
DataItem PW0RMASR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// stock xfer full case
DataItem PW0RMAXF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// stock xfer repack
DataItem PW0RMAXR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// b-grade by brand cd
DataItem PW0RMBBG num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// colon
DataItem PW0RMBCL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// closeout by brand cd
DataItem PW0RMBCO num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// Equipment B-grade
DataItem PW0RMBER num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// hours by brand code
DataItem PW0RMBHH num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// total hours/min by brand cd
DataItem PW0RMBHW char(7)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// minutes by brand cd
DataItem PW0RMBMM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// in-store promo fc by brand cd
DataItem PW0RMBPF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// in-store promo repck by brand
DataItem PW0RMBPR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// regular full case by brand cd
DataItem PW0RMBRF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// regular repack by brand cd
DataItem PW0RMBRR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// spcl hndl by brand cd
DataItem PW0RMBSR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// stock xfer full case by brand
DataItem PW0RMBXF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// stock xfer repack by brand cd
DataItem PW0RMBXR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// b-grade by div code
DataItem PW0RMDBG num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// colon
DataItem PW0RMDCL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// closeout by div code
DataItem PW0RMDCO num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// Equipment division total
DataItem PW0RMDER num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// hours by div code
DataItem PW0RMDHH num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// total hours/min by div code
DataItem PW0RMDHW char(7)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// minutes by div code
DataItem PW0RMDMM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// in-store promo fc by division
DataItem PW0RMDPF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// in-store promo repck by div
DataItem PW0RMDPR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// regular full case by div code
DataItem PW0RMDRF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// regular repack by div code
DataItem PW0RMDRR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// spcl hndl by div code
DataItem PW0RMDSR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// stock xfer full case by div.
DataItem PW0RMDXF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// stock xfer repack by div code
DataItem PW0RMDXR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// colon
DataItem PW0RMFCL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// full case hours
DataItem PW0RMFHH num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// full case minutes
DataItem PW0RMFMM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem PW0RMFPT char(7)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// order b-grade
DataItem PW0RMOBG num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// colon
DataItem PW0RMOCL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// order closeouts
DataItem PW0RMOCO num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// Equipment sel by order
DataItem PW0RMOER num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// order hours
DataItem PW0RMOHH num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// order total hrs/min
DataItem PW0RMOHW char(7)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// order minutes
DataItem PW0RMOMM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// order in-store promo fc
DataItem PW0RMOPF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// order in-store promo rp
DataItem PW0RMOPR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// order regular-full case units
DataItem PW0RMORF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// order regular-repack units
DataItem PW0RMORR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// order spec hdl units
DataItem PW0RMOSR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// order stock xfer-full case unt
DataItem PW0RMOXF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// order stock xfer-repack units
DataItem PW0RMOXR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// pack & hold b-grade
DataItem PW0RMPBG num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// colon
DataItem PW0RMPCL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// pack & hold closeouts
DataItem PW0RMPCO num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// pack & hold hours
DataItem PW0RMPHH num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// pack & hold total hours/min
DataItem PW0RMPHW char(7)  {
  align = right, fillCharacter = nullFill, inputRequired = no
}
end

// pack & hold minutes
DataItem PW0RMPMM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// pack & hold in-store promo fc
DataItem PW0RMPPF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// pack & hold in-store promo rp
DataItem PW0RMPPR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// pack  & hold regular full case
DataItem PW0RMPRF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// pack & hold regular repack
DataItem PW0RMPRR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// pack & hold spcl hndl repack
DataItem PW0RMPSR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// pack & hold stock xfer full ca
DataItem PW0RMPXF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// pack a hold stock xfer repack
DataItem PW0RMPXR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// colon
DataItem PW0RMRCL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// repack hours
DataItem PW0RMRHH num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// repack minutes
DataItem PW0RMRMM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// repack time (HHHH:MM)
DataItem PW0RMRPT char(7)  {
  align = right, fillCharacter = nullFill, inputRequired = no
}
end

// total 'at once' units
DataItem PW0RMTAO num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total by brand code
DataItem PW0RMTBR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// colon
DataItem PW0RMTCL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// total by division code
DataItem PW0RMTDV num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total & hold hours
DataItem PW0RMTHH num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// total hours of work
DataItem PW0RMTHW char(7)  {
  align = right, fillCharacter = nullFill, inputRequired = no
}
end

// pack & hold minutes
DataItem PW0RMTMM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// total 'pack & hold' units
DataItem PW0RMTPH num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total regular full case
DataItem PW0RMTRF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total regular repack
DataItem PW0RMTRR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total selected order units
DataItem PW0RMTSO num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total spcl hndl
DataItem PW0RMTSR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total work fullcase (in units)
DataItem PW0RMTWF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total by warehouse code
DataItem PW0RMTWH num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total work repack (in units)
DataItem PW0RMTWR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total stock xfer full case
DataItem PW0RMTXF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total stock xfer repack
DataItem PW0RMTXR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// b-grade by whse code
DataItem PW0RMWBG num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// closeouts by whse code
DataItem PW0RMWCL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// closeouts by whse cd
DataItem PW0RMWCO num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// Equipment Ware house total
DataItem PW0RMWER num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// hours by warehouse code
DataItem PW0RMWHH num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// hours/min by warehouse code
DataItem PW0RMWHW char(7)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// minutes by warehouse code
DataItem PW0RMWMM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// in-store promo fc by whse
DataItem PW0RMWPF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// in-store promo repk by whse
DataItem PW0RMWPR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// regular full case by whse code
DataItem PW0RMWRF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// regular repack by whse code
DataItem PW0RMWRR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// spcl hndl by whse code
DataItem PW0RMWSR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// stock xfer full case by whse
DataItem PW0RMWXF num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// stock xfer repack by whse code
DataItem PW0RMWXR num(9)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total work repack (in units)
DataItem PW0RW-EX-NS-FC-BRAND num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total work repack (in units)
DataItem PW0RW-EX-NS-FC-DIV num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total work repack (in units)
DataItem PW0RW-EX-NS-FC-QTY num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total work repack (in units)
DataItem PW0RW-EX-NS-FC-WHSE num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total work repack (in units)
DataItem PW0RW-EX-NS-RP-BRAND num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total work repack (in units)
DataItem PW0RW-EX-NS-RP-DIV num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total work repack (in units)
DataItem PW0RW-EX-NS-RP-QTY num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total work repack (in units)
DataItem PW0RW-EX-NS-RP-WHSE num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total work repack (in units)
DataItem PW0RW-EX-SP-RP-BRAND num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total work repack (in units)
DataItem PW0RW-EX-SP-RP-DIV num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total work repack (in units)
DataItem PW0RW-EX-SP-RP-QTY num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// total work repack (in units)
DataItem PW0RW-EX-SP-RP-WHSE num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// Array to store all sel typ cde
DataItem PW0RW-PK-SEL-TYP-ARR char(48)  {
  align = right, fillCharacter = nullFill, inputRequired = no
}
end

// Holds sel type codes 1 thru 42
DataItem PW0RW-PK-SEL-TYP-CDS char(2)  {
  align = right, fillCharacter = nullFill, inputRequired = no
}
end

// Count to select sel typ codes
DataItem PW0RW-PK-SEL-TYP-CNT num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// work at once mm
DataItem PW0RWAHW smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// work mm by brand code
DataItem PW0RWBHW smallint {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// end of cursor switch
DataItem PW0RWCSR char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// work mm by division code
DataItem PW0RWDHW smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// year
DataItem PW0RWECC num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// day
DataItem PW0RWEDD num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// eze date
DataItem PW0RWEDT num(8)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// month
DataItem PW0RWEMM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// year
DataItem PW0RWEYY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// minum p&hdate
DataItem PW0RWMPH num(8)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// work order mm
DataItem PW0RWOHW smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// century
DataItem PW0RWPCC num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// day
DataItem PW0RWPDD num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// work p & h mm
DataItem PW0RWPHW smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// month
DataItem PW0RWPMM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// year
DataItem PW0RWPYY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// interim mins for hours
DataItem PW0RWRMM num(7)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// FORMAT THE MAP SWITCH
DataItem PW0RWSWF char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// REQUEST FOR DATA SWITCH
DataItem PW0RWSWR char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// work hours
DataItem PW0RWWHH num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// work  hours/min
DataItem PW0RWWHM num(6,2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// work mm by warehouse code
DataItem PW0RWWHW smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// work minutes
DataItem PW0RWWMM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

