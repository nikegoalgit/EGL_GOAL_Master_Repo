package pw0t;
import corpcom1.*;
import corpcom2.*;
import corpcom3.*;
import corpcom4.*;
import corpcom5.*;
import corpcom6.*;
import corpcom7.*;
import corpx1.*;
import corpx2.*;
import corpz3.*;
import in1.common.*;
import pk.common.*;
import pw.common.*;
import ta.common.*;
import tf.common.*;
import ts.common.*;
import vv.common.*;
//*** PROGRAM=PW0T ****
//   This online CSP application  provides the users with the
// ability to assign shipping spurs and carrier availability to
// carriers.
//   This program allows changes to the header, except for
// number of spurs and reject spurs which must remain the same
// to match the movers system, all fields in the header default
// default from DPICK.VWVCTL01.
//   The user can add, change, or delete a line on the detail
// rows which represent a row from DPICK.VCARRA01, by putting
// an 'A', 'C' or 'D' on the action column. Spur number,carrier
// code, carrier name, trailer number, trailer type, schedule
// from and to all default from the DPICK.VCARRA01 but may be
// changed. The fields destination code range, rush flag, pack
// and hold flag and date are all optional and must pass
// certain edits as do all modifiable fields.
//   This application uses the standard PF keys, for help, exit
// and scrolling and PA2 to reset the screen, also the user
// can transfer out of this application by entering fast path
// information, and updates will not be allowed while scrolling
// 
// -------    --------  ------   ------------------------------
// CONTROL      DATE     NAME    DESCRIPTION OF CHANGE
// -------    --------  ------   ------------------------------
// NEW        01/21/91  BGOFF    New Application
// pkxxxx     05/13/91  bgoff    Change P&H date validation to
//                               validate for any day and not
//                               just a 6 day work week.
// PKXXXX     05/15/91  BGOFF    CHECK EZETST FOR 0
// PKXXXX     07/31/91  SHENDE   Fixed 'total sched for day'
//                               bug so that it doesn't allow
//                               'sched to/from range to be
//                               greater than it.
// PKXXXX     08/01/91  SHENDE   Added condition where 'total
//                               sched for day' cannot be
//                               greater than 16.
// PKXXXX     05/12/92  sjohns   allow same carrier, diff trlr,
//                               same sched on diff spur.
// PKXXXX     05/18/92  mwalto   Do not allow whse '04' to
//                               enter spur nbrs 8027, 8028 &
//                               8029. They are pack list spurs
// PKXXXX     06/12/92  shende   Do not allow whse 04 to enter
//                               spur number < 8001 and > 8999.
// PKXXXX     09/04/92  smacmi   Added edit for same spur/carr/
//                               schedule.
// PKXXXX     09/24/92  gray     Added more edits for spur and
//                               schedule.
// PK0216     10/23/92  JCAMPB   Change map for rush-sched-fr
//                               and thru to num (right just)
// PK410      07/07/92  OVAZQU   Edit "total schedules" against
//                               all pages, not only the
//                               current page.
// Canada     10/27/95  Pstroe   Pick-up new version of XPPK003
//            06/19/96  Dgerlt   Allow 50 normal schedules.
// dcsplit    07/29/96  OENFIE   Allow 30 schedules for whsecd
//                               51 (apparel),04 (ftwr) & 07
//                               (Wilsonville).  Also changed
//                               edit msg # 503 to say cannot
//                               be > 30.
// dcsplit    12/10/96  esmit2   fix map and c/o sched edits
// dcsplit    03/12/97  PSHARM   C/O SCHED EDITS  PW0T550
// Shipping   05/20/97  dgerlt   Increased the number of spurs
//  increase                     for whse 51 from 100 to 200.
// ===========================================================
// y2kproj    02/10/98  NGANGO   Y2K Modifications - Map
//                               PW0TM001 modified 2 remove
//                               leading zero suppressions, and
//                               also Process PW0T530, PW0T620,
//                               PW0T630 modified.
// ===========================================================
// *********************
Program PW0T type textUIProgram //VAGen Info - main text program
  {
  includeReferencedFunctions = yes, allowUnqualifiedItemReferences = yes, 
  throwNrfEofExceptions = yes, handleHardIOErrors = no, V60ExceptionCompatibility = yes, 
  I4GLItemsNullable = no, textLiteralDefaultIsString = no, localSQLScope = yes, 
  msgTablePrefix = "PK00", inputRecord = COMMAREA, segmented = yes
  }

  // Data Declarations
  COMMAREA COMMAREA ; // record
  ERRSQLCA ERRSQLCA; // record
  PKWREC PKWREC; // record
  PW0TW00 PW0TW00; // record
  PW0TW01 PW0TW01; // record
  PW0TW02 PW0TW02; // record
  PWCREC PWCREC; // record
  PWDREC PWDREC; // record
  SQLCA SQLCA; // record
  TA1REC TA1REC; // record
  TA4REC TA4REC; // record
  TA5REC TA5REC; // record
  TAEREC TAEREC; // record
  TF1REC TF1REC; // record
  TF2REC TF2REC; // record
  VCARRA02 VCARRA02; // record
  VWVCTL02 VWVCTL02; // record
  XX0XW01 XX0XW01; // record

  // VAGen Info - items needed for migration
  VAGen_EZESYS char(8);
  VAGen_EZEREPLY num(1);
  VAGen_EZE_WAIT_TIME bin(9,2);
  VAGen_EZE_ITEMLEN int;

  // Use Declarations
  use XTRTBL {deleteAfterUse = yes}; // table
  use XWHTBL {deleteAfterUse = yes}; // table
  use PW0TM.PW0TM001 // form
   {
    pfKeyEquate = no
  };

  function main()
    // VAGen Info - initialization needed for migration
    VAGen_EZESYS = VGLib.getVAGSysType();
    XPPK001: XPPK001();
     /* -------------------------------------------------------*/
     /* Initialize working storage and display storage areas.*/
     /* -------------------------------------------------------*/
    set PW0TM001 initial; /* m001 input/output*/
    set PW0TW00 empty; /* working storage*/
    set PW0TW01 empty; /* display storage/hdr*/
    set PW0TW02 empty; /* display storage/detail*/
    set SQLCA empty; /* sql communitcation area*/
    set TAEREC empty; /* error diagnosis information*/
    set TA1REC empty; /* error diagnosis parameters*/
    set TA5REC empty; /* temporary storage parameters*/
    set TA4REC empty; /* working day parameters*/
    set XX0XW01 empty; /* date/time subroutine parameters*/

    PW0TW00.PW0TWSWF = "Y"; /* Format the map switch*/
    PW0TW00.PW0TWSWR = "N"; /* request for data switch*/

     /* ---------------------------------------------------*/
     /* validate warehouse entered.*/
     /* ---------------------------------------------------*/

    goto PW0T000; /* validate warehouse*/


    PW0T000: PW0T000();
     /* ------------------------------------------------------------*/
     /* converse main process.*/
     /* ------------------------------------------------------------*/

    goto PW0T001; /* converse main process*/


    PW0T001: PW0T001();
    goto PW0T001; /* Converse the main process*/
  end // end main
end // end PW0T

// Validate warehouse
Function PW0T000()
   /* ------------------------------------------------------------*/
   /* execute xppk003 to validate warehouse.*/
   /* if not valid it will return user to where they came from.*/
   /* ------------------------------------------------------------*/

  XPPK003();

  PW0TM001.XWHCD = PKWREC.XWHCD; /* warehouse*/
  PW0TM001.XWHABRV = PKWREC.XWHABRV; /* warehouse name*/
  PW0TW00.PW0TWSWR = "Y"; /* request for data*/

   /* ------------------------------------------------------------*/
   /* get current date*/
   /* ------------------------------------------------------------*/

  XX0XS01(); /* current date routine*/

   /* ------------------------------------------------------------*/
   /* get minimum pack and hold date for edits.*/
   /* ------------------------------------------------------------*/

  set TA4REC empty; /* clear record*/
  TA4REC.TA2DTOPT = "GREGGREG"; /* option*/
  TA4REC.TA2GRTYP = "G"; /* type*/
  TA4REC.TA2DYAOD = 3; /* days to add*/
  PW0TW00.PW0TWPCC = XX0XW01.XX0XW19; /* cent*/
  PW0TW00.PW0TWPYY = XX0XW01.XX0XWYY; /* year*/
  PW0TW00.PW0TWPMM = XX0XW01.XX0XWMM; /* month*/
  PW0TW00.PW0TWPDD = XX0XW01.XX0XWDD; /* day*/
  TA4REC.TA2GRGGN = PW0TW00.PW0TWMPH; /* date*/

  call "TA0040" (TA4REC) {isNoRefresh = yes, isExternal = yes}; /* call subroutine*/

  if (TA4REC.TA2RTNCD != 0) /* if not valid date*/

    TA1REC.TA1PGMNO = "000"; /* module id*/
    converseLib.validationFailed(29); /* unexpected error has occured*/
    PW0TW00.PW0TWSWR = "N"; /* request for data switch*/

  else

    PW0TW00.PW0TWMPH = TA4REC.TA2GRGGN; /* day*/

  end


end // end PW0T000

// Main process to display a map
Function PW0T001()
   /* ------------------------------------------------------------*/
   /* This is the main process used to display a map.  Processing*/
   /* always returns to the top of this process and falls through*/
   /* subordinate processes until an error is found or a valid*/
   /* request is processed.  Processing sequence is as follows:*/

   /* 1) Obtain the data to display.*/
   /* 2) Format the map output area and display the map.*/
   /* 3) Check the attention identifier used to respond.*/
   /* 4) Reset highlighted fields to normal intensity.*/
   /* 5) Verify the data that was entered.*/
   /* 6) Process a valid input request.*/

   /* In all subordinate processes, "EZEFLO" is used to exit to*/
   /* redisplay the map when an error is found.  This is done to*/
   /* minimize the coding effort required to skip subsequent*/
   /* processing under error conditions.*/
   /* ------------------------------------------------------------*/

  PW0T100(); /* Obtain the data to display*/

  PW0T200(); /* Format and display the map*/

  PW0T300(); /* Check attention identifier*/

  PW0T400(); /* Reset fields to normal intensity*/

  PW0T500(); /* Verify the data that was entered*/

  PW0T600(); /* Process valid input request*/


end // end PW0T001

// Obtain the data to display
Function PW0T100()
   /* ------------------------------------------------------------*/
   /* If data was not requested or an error was found, return to*/
   /* the previous process.*/
   /* ------------------------------------------------------------*/

  if (PW0TW00.PW0TWSWR != "Y" /* Data was not requested*/
   || converseVar.validationMsgNum != 0) /* or an error was found*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Establish the temporary storage queue page length.*/
   /* ------------------------------------------------------------*/

  PW0TW00.XXXTSLEN = 490;

   /* ------------------------------------------------------------*/
   /* If no message to display, reset the page number to display.*/
   /* ------------------------------------------------------------*/

  if (PW0TW00.PW0TWMSG == 0) /* No message to display*/
    PW0TW00.XXXTSPAG = 1; /* Page number to display*/
  end

   /* ------------------------------------------------------------*/
   /* Purge any pages from temporary storage and save key fields.*/
   /* ------------------------------------------------------------*/

  PW0T110(); /* Purge any temporary storage*/

  PW0TW01.XWHCD = PW0TM001.XWHCD; /* Warehouse code*/
  PW0TW01.XWHABRV = PW0TM001.XWHABRV; /* warehouse name*/

   /* ------------------------------------------------------------*/
   /* Select the information to display in the map heading.*/
   /* ------------------------------------------------------------*/

  PW0T120(); /* Select from DPICK.VWVCTL02*/

   /* ------------------------------------------------------------*/
   /* Select and open the cursor for the set to be formatted.*/
   /* ------------------------------------------------------------*/

  PW0T130(); /* Open cursor in DPICK.VCARRA02*/

   /* ------------------------------------------------------------*/
   /* Fetch and format the data into pages until end of cursor.*/
   /* ------------------------------------------------------------*/

  PW0TW00.PW0TWIXM = 1; /* Display line index*/
  PW0TW00.PW0TWSC1 = "N"; /* End of cursor switch*/

  while (PW0TW00.PW0TWSC1 == "N") /* Until end of cursor*/

    PW0T140(); /* Fetch row from DPICK.VCARRA02*/

    /* ------------------------------------------------------------*/
     /* If not end of cursor, select carrier name and save data.*/
    /* ------------------------------------------------------------*/

    if (PW0TW00.PW0TWSC1 == "N") /* Not end of cursor*/
      PW0T150(); /* Select from DPICK.VCARR001*/
      PW0T160(); /* Save data in display storage*/
    end

    /* ------------------------------------------------------------*/
     /* If the page is full, add the page to the storage queue.*/
    /* ------------------------------------------------------------*/

    if (PW0TW00.PW0TWIXM > 10) /* Page is full*/

      PW0T170(); /* Add page to temporary storage*/

      PW0TW00.PW0TWIXM = 1; /* Display line index*/

    end

  end

   /* ------------------------------------------------------------*/
   /* Add any partially formatted last page to the queue.*/
   /* ------------------------------------------------------------*/

  if (PW0TW00.PW0TWIXM > 1) /* Page was formatted*/
    PW0T170(); /* Add page to temporary storage*/
  end

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  PW0T180(); /* Close cursor in DPICK.VCARRA02*/

   /* ------------------------------------------------------------*/
   /* If no pages were formatted, indicate no data to display.*/
   /* ------------------------------------------------------------*/

  if (PW0TW00.TA5TSQIX == 0 /* No pages formatted*/
   && PW0TW00.PW0TWNHD == "N") /* and no header formatted*/

    TA1REC.TA1PGMNO = "100"; /* Module identification*/
    PW0TW00.PW0TWMSG = 8; /* No data was found to display*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  PW0TW00.PW0TWSWR = "N"; /* Request for data switch*/


end // end PW0T100

// Purge temporary storage
Function PW0T110()
   /* ------------------------------------------------------------*/
   /* Initialize the storage areas and indicators to be used.*/
   /* ------------------------------------------------------------*/

  set PW0TW01 empty; /* M001 display storage/hdr*/
  set PW0TW02 empty; /* M001 display storage/dtl*/

  PW0TW00.PW0TWSWU = "N"; /* Storage update switch*/

  TA5REC.TA5TSQIX = 0; /* Current page number*/
  PW0TW00.TA5TSQIX = 0; /* Highest page number*/

   /* ------------------------------------------------------------*/
   /* Purge any temporary storage for this application.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5APPID = COMMAREA.CACURRAP; /* Application identification*/
  TA5REC.TA5FNCCD = "P"; /* Function code*/

  try
    call "TA0050" (PW0TW02, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Temporary storage*/

   /* ------------------------------------------------------------*/
   /* If successful, return to previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA5REC.TA5RTNCD == 0)          /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TAEREC.TAEDESC1 = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC2 = TA5REC.TA5DATA; /* Subroutine parameters*/

  converseLib.validationFailed(29); /* Unexpected error occurred*/

  TA1REC.TA1FUNC = "RETN"; /* Termination function*/
  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1LOC = "PURGE ANY TEMPORARY STORAGE";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = "110"; /* Program number*/
  TA1REC.TA1MAPAP = COMMAREA.CACURRAP; /* Map application*/
  TA1REC.TA1MAPNO = "M001"; /* Map number*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end PW0T110

// Select from DPICK.VWVCTL02
Function PW0T120()
   /* ------------------------------------------------------------*/
   /* Select from DPICK.VWVCTL02.*/
   /* ------------------------------------------------------------*/

  set VWVCTL02 empty; /* Clear row storage area*/

  VWVCTL02.XWHCD = PW0TW01.XWHCD; /* Warehouse code*/
  VWVCTL02.PKURUNMD = "P"; /* pre-assignment*/

  try
    call "VWVCTL02" ("S ", SQLCA, VWVCTL02) {isNoRefresh = yes, isExternal = yes};
  end /* Sel table row*/

   /* ------------------------------------------------------------*/
   /* If successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0 /* Normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* Row not found*/

      if (SQLCA.VAGen_SQLCODE == 100)
        PW0TW00.PW0TWNHD = "N"; /* hdr found switch*/
      end

      if (SQLCA.VAGen_SQLCODE == 0)
        PW0TW00.PW0TWNHD = "Y"; /* hdr found switch*/
        PW0T121(); /* save header in display storage*/
      end

      return; /* Return to previous process*/

    end
  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(28); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(29); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "SELECT UNIQUE ROW";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = "120"; /* Program number*/
  TA1REC.TA1DBASE = "DPICK   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VWVCTL02"; /* Table view name*/
  TA1REC.TA1TBLKE = VWVCTL02.VWVCTL02-GROUP; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end PW0T120

// Save header in display storage
Function PW0T121()
   /* ------------------------------------------------------------*/
   /* save header in display storage.*/
   /* ------------------------------------------------------------*/

  PW0TW01.XWHCD = VWVCTL02.XWHCD; /* warehouse code*/
  PW0TW01.PWDNBRSS = VWVCTL02.PWDNBRSS; /* nbr ship spurs*/
  PW0TW01.PWDDFPHS = VWVCTL02.PWDDFPHS; /* default p & h spur*/
  PW0TW01.PWDRJTSS = VWVCTL02.PWDRJTSS; /* reject spurs*/
  PW0TW01.PWDNBRSH = VWVCTL02.PWDNBRSH; /* number of spurs*/
  PW0TW01.PWDSCHFR = VWVCTL02.PWDSCHFR; /* schedule from*/
  PW0TW01.PWDSCHTH = VWVCTL02.PWDSCHTH; /* schedule thru*/
  PW0TW01.PWDMIPSH = VWVCTL02.PWDMIPSH; /* minutes/schedule*/
  PW0TW01.PWDCOVSC = VWVCTL02.PWDCOVSC; /* carryover schedule*/


end // end PW0T121

// Open cursor in DPICK.VCARRA02
Function PW0T130()
   /* ------------------------------------------------------------*/
   /* Open cursor in DPICK.VCARRA02.*/
   /* ------------------------------------------------------------*/

  set VCARRA02 empty; /* Clear row storage area*/

  VCARRA02.XWHCD = PW0TW01.XWHCD; /* Warehouse code*/
  VCARRA02.PKURUNMD = "P"; /* pre-assignment*/

  try
    call "VCARRA02" ("S1", SQLCA, VCARRA02) {isNoRefresh = yes, isExternal = yes};
  end /* Sel table set*/

   /* ------------------------------------------------------------*/
   /* If successful, initialize the line index and cursor switch.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(28); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(29); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "SELECT SET OF TABLE ROWS";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = "130"; /* Program number*/
  TA1REC.TA1DBASE = "DPICK   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VCARRA02"; /* Table view name*/
  TA1REC.TA1TBLKE = VCARRA02.VCARRA02-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end PW0T130

// Fetch row in DPICK.VCARRA02
Function PW0T140()
   /* ------------------------------------------------------------*/
   /* Fetch the next row from DPICK.VCARRA02.*/
   /* ------------------------------------------------------------*/

  try
    call "VCARRA02" ("N1", SQLCA, VCARRA02) {isNoRefresh = yes, isExternal = yes};
  end /* Fetch next row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/
      return; /* Return to previous process*/
    end

    /* ------------------------------------------------------------*/
     /* If end of the selected set, indicate end of cursor.*/
    /* ------------------------------------------------------------*/

    if (SQLCA.VAGen_SQLCODE == 100) /* End of selected set*/

      PW0TW00.PW0TWSC1 = "Y"; /* Indicate end of cursor*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(28); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(29); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "FETCH NEXT TABLE ROW";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = "140"; /* Program number*/
  TA1REC.TA1DBASE = "DPICK   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VCARRA02"; /* Table view name*/
  TA1REC.TA1TBLKE = VCARRA02.VCARRA02-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end PW0T140

// Select from DPICK.VCARR002
Function PW0T150()
   /* ------------------------------------------------------------*/
   /* Select from DPICK.VCARR001.*/
   /* ------------------------------------------------------------*/

  set TF1REC empty; /* Clear row storage area*/

  TF1REC.TF1CARCD = VCARRA02.TF1CARCD; /* carrier code*/

  try
    call "IO0860" ("S ", SQLCA, TF1REC) {isNoRefresh = yes, isExternal = yes};
  end /* Select table row*/

   /* ------------------------------------------------------------*/
   /* If successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/
      return; /* Return to previous process*/
    end

    if (SQLCA.VAGen_SQLCODE == 100) /* row not found*/

      TF1REC.TF1ABRV = " NOT FOUND "; /* carrier name*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(28); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(29); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "SELECT CARRIER NAME ";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = "150"; /* Program number*/
  TA1REC.TA1DBASE = "DPICK   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VCARR001"; /* Table view name*/
  TA1REC.TA1TBLKE = TF1REC.TF1KEYS; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end PW0T150

// Save data in display storage
Function PW0T160()
   /* ------------------------------------------------------------*/
   /* Save the data from the table row in display storage.*/
   /* ------------------------------------------------------------*/

  PW0TW02.PKVSSPNB[PW0TWIXM] = VCARRA02.PKVSSPNB; /* spur*/
  PW0TW02.TF1CARCD[PW0TWIXM] = TF1REC.TF1CARCD; /* carrier code*/
  PW0TW02.TF1ABRV[PW0TWIXM] = TF1REC.TF1ABRV; /* carrier name*/
  PW0TW02.PWCTLNBR[PW0TWIXM] = VCARRA02.PWCTLNBR; /* trailer nbr*/
  PW0TW02.XTRCD[PW0TWIXM] = VCARRA02.XTRCD; /* trailer type*/
  PW0TW02.PWCCAVFR[PW0TWIXM] = VCARRA02.PWCCAVFR; /* schedule fr*/
  PW0TW02.PWCCAVTR[PW0TWIXM] = VCARRA02.PWCCAVTR; /* schedule to*/
  PW0TW02.PWCDSTFR[PW0TWIXM] = VCARRA02.PWCDSTFR; /* dest from*/
  PW0TW02.PWCDSTTH[PW0TWIXM] = VCARRA02.PWCDSTTH; /* dest thr*/
  PW0TW02.PWCRSHFL[PW0TWIXM] = VCARRA02.PWCRSHFL; /* rush flag*/
  PW0TW02.PWCHLDFL[PW0TWIXM] = VCARRA02.PWCHLDFL; /* p & h flag*/
  PW0TW00.PW0TMDAT = VCARRA02.PWCPHDSB; /* split up p & h date*/
  PW0TW02.PW0TMPMM[PW0TWIXM] = PW0TW00.PW0TMPMM; /* p & h month*/
  PW0TW02.PW0TMPDD[PW0TWIXM] = PW0TW00.PW0TMPDD; /* p & h day*/
  PW0TW02.PW0TMPYY[PW0TWIXM] = PW0TW00.PW0TMPYY; /* p & h year*/
  PW0TW02.PWCCOVFT[PW0TWIXM] = VCARRA02.PWCCOVFT; /* carryover cubic*/

  PW0TW00.PW0TWIXM = PW0TW00.PW0TWIXM + 1; /* Increment line index*/


end // end PW0T160

// Add page to temporary storage
Function PW0T170()
   /* ------------------------------------------------------------*/
   /* Add the next page to temporary storage.*/
   /* ------------------------------------------------------------*/

  PW0TW02.XXXTSLEN = PW0TW00.XXXTSLEN; /* Temporary storage length*/

  TA5REC.TA5APPID = COMMAREA.CACURRAP; /* Application identification*/
  TA5REC.TA5FNCCD = "A"; /* Function code*/

  try
    call "TA0050" (PW0TW02, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Temporary storage*/

   /* ------------------------------------------------------------*/
   /* If successful, initialize the storage area and indicators*/
   /* to be used.  Return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA5REC.TA5RTNCD == 0)          /* and normal return code*/

    set PW0TW02 empty; /* M001 display storage*/

    PW0TW00.TA5TSQIX = TA5REC.TA5TSQIX; /* Highest page number*/
    TA5REC.TA5TSQIX = 0; /* Current page number*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TAEREC.TAEDESC1 = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC2 = TA5REC.TA5DATA; /* Subroutine parameters*/

  converseLib.validationFailed(29); /* Unexpected error occurred*/

  TA1REC.TA1FUNC = "RETN"; /* Termination function*/
  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1LOC = "ADD PAGE TO TEMPORARY STORAGE";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = "170"; /* Program number*/
  TA1REC.TA1MAPAP = COMMAREA.CACURRAP; /* Map application*/
  TA1REC.TA1MAPNO = "M001"; /* Map number*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end PW0T170

// Close cursor in DPICK.VCARRA02
Function PW0T180()
   /* ------------------------------------------------------------*/
   /* Close the selected set of table rows.*/
   /* ------------------------------------------------------------*/

  try
    call "VCARRA02" ("C1", SQLCA, VCARRA02) {isNoRefresh = yes, isExternal = yes};
  end /* Close tbL set*/

   /* ------------------------------------------------------------*/
   /* If successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  converseLib.validationFailed(29); /* Unexpected error occurred*/

  TA1REC.TA1FUNC = "RETN"; /* Termination function*/
  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "CLOSE SELECTED SET OF TABLE ROWS";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = "180"; /* Program number*/
  TA1REC.TA1DBASE = "DPICK   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VCARRA02"; /* Table view name*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end PW0T180

// Format and converse the map
Function PW0T200()
   /* ------------------------------------------------------------*/
   /* If an error was found, save the error message number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    PW0TW00.PW0TWMSG = converseVar.validationMsgNum; /* Message number*/
  end

   /* ------------------------------------------------------------*/
   /* If obtain data failed or no error, format data to display.*/
   /* ------------------------------------------------------------*/

  if (PW0TW00.PW0TWSWR == "Y" /* Obtain data failed*/
   || converseVar.validationMsgNum == 0) /* or no error found*/

    if (PW0TW00.PW0TWSWF == "Y") /* Map must be formatted*/
      PW0T210(); /* Format the data on the map*/
    end

  end

   /* ------------------------------------------------------------*/
   /* Format the current date and any FAST PATH information.*/
   /* ------------------------------------------------------------*/

  PW0TM001.XXXCURDT = VGVar.currentShortGregorianDate; /* Current date*/

  PW0TM001.CATOAP = COMMAREA.CATOAP; /* TO application*/
  PW0TM001.CAITEM = COMMAREA.CAITEM; /* Application data*/

   /* ------------------------------------------------------------*/
   /* If a message to display, indicate sound audible alarm.*/
   /* ------------------------------------------------------------*/

  if (PW0TW00.PW0TWMSG != 0 /* Message to display*/
   || COMMAREA.CAMSG != " ") /* or message text*/

    if (PW0TW00.PW0TWMSG != 0) /* Message to display*/

      if (PW0TW00.PW0TWMSG == 9999)
        converseLib.validationFailed();
      else
        converseLib.validationFailed(PW0TW00.PW0TWMSG);
      end /* Message number*/
    else
      PW0TM001.VAGen_EZEMSG = COMMAREA.CAMSG; /* Message text*/

    end

    PW0TM001.XXXMODID = TA1REC.TA1PGMNO; /* Module identification*/

    set PW0TM001 alarm; /* Indicate sound alarm*/

  end

  converse PW0TM001 ;

   /* ------------------------------------------------------------*/
   /* Clear the message fields and save FAST PATH information.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1PGMNO = " "; /* Module identification*/
  PW0TW00.PW0TWMSG = 0; /* Message number*/
  COMMAREA.CAMSG = " "; /* Message text*/

  COMMAREA.CATOAP = PW0TM001.CATOAP; /* TO application*/
  COMMAREA.CAITEM = PW0TM001.CAITEM; /* Application data*/


end // end PW0T200

// Format the display data
Function PW0T210()
   /* ------------------------------------------------------------*/
   /* Clear the fields in the map storage area to be formatted.*/
   /* ------------------------------------------------------------*/

  set PW0TM001 initial; /* M001 input/output area*/

  PW0TW00.PW0TWSWF = "N"; /* Format the map switch*/

   /* ------------------------------------------------------------*/
   /* If the page in storage is not the page to be displayed,*/
   /* obtain the desired page from temporary storage.*/
   /* ------------------------------------------------------------*/

  if (PW0TW00.TA5TSQIX > 0) /* Pages were formatted*/

    if (PW0TW00.XXXTSPAG != TA5REC.TA5TSQIX) /* Desired page not current*/

      /* ------------------------------------------------------------*/
       /* If the desired page number is greater than the highest page*/
       /* in storage, default to the highest page number.*/
      /* ------------------------------------------------------------*/

      if (PW0TW00.XXXTSPAG > PW0TW00.TA5TSQIX) /* Desired greater highest*/
        PW0TW00.XXXTSPAG = PW0TW00.TA5TSQIX; /* Default to highest*/
      end

      PW0TS02(); /* Obtain temporary storage page*/

    end

    /* ------------------------------------------------------------*/
     /* Display the page information on the screen.*/
    /* ------------------------------------------------------------*/

    set PW0TM001.XXXLITPG skip; /* "PAGE" literal*/
    PW0TM001.XXXTSPAG = PW0TW00.XXXTSPAG; /* Current page*/
    set PW0TM001.XXXLITOF skip; /* "OF" literal*/
    PW0TM001.TA5TSQIX = PW0TW00.TA5TSQIX; /* Highest page*/

  end

   /* ------------------------------------------------------------*/
   /* Format the data in the map from the display storage.*/
   /* ------------------------------------------------------------*/

  PW0TM001.XWHCD = PW0TW01.XWHCD; /* warehouse code*/
  PW0TM001.XWHABRV = PW0TW01.XWHABRV; /* warehouse name*/
  PW0TM001.PWDNBRSS = PW0TW01.PWDNBRSS; /* spur nbr*/
  PW0TM001.PWDDFPHS = PW0TW01.PWDDFPHS; /* default spur*/
  PW0TM001.PWDNBRSH = PW0TW01.PWDNBRSH; /* schedule*/
  PW0TM001.PWDRJTSS = PW0TW01.PWDRJTSS; /* reject spur*/
  PW0TM001.PWDSCHFR = PW0TW01.PWDSCHFR; /* schedule from*/
  PW0TM001.PWDSCHTH = PW0TW01.PWDSCHTH; /* schedule thru*/
  PW0TM001.PWDMIPSH = PW0TW01.PWDMIPSH; /* minutes/schedule*/
  PW0TM001.PWDCOVSC = PW0TW01.PWDCOVSC; /* carryover schedule*/

  if (PW0TM001.XWHCD == "04" /* Memphis footwear*/
   || PW0TM001.XWHCD == "07" /* Wilsonville*/
   || PW0TM001.XWHCD == "51") /* Memphis Apparel*/
    set PW0TM001.PW0TMCOV initialAttributes;
    set PW0TM001.PWDCOVSC initialAttributes; /* carryover schedule (unprotect)*/
  else
    set PW0TM001.PW0TMCOV skip, invisible;
    set PW0TM001.PWDCOVSC skip, invisible;
  end

  PW0TW00.PW0TWIXM = 1; /* Initialize line index*/

  while (PW0TW00.PW0TWIXM <= 10 /* Until screen is full*/
   && PW0TW02.PKVSSPNB[PW0TWIXM] > 0) /* or end of data*/

    if (PW0TW00.PW0TWIXM == 1) /* First select field*/

      set PW0TM001.PW0TMACT[PW0TWIXM] cursor, normal; /* Position cursor*/
    else
      set PW0TM001.PW0TMACT[PW0TWIXM] normal; /* Unprotect*/

    end

    PW0TM001.PW0TMACT[PW0TWIXM] = PW0TW02.PW0TMACT[PW0TWIXM];
    PW0TM001.PKVSSPNB[PW0TWIXM] = PW0TW02.PKVSSPNB[PW0TWIXM];
    PW0TM001.TF1CARCD[PW0TWIXM] = PW0TW02.TF1CARCD[PW0TWIXM];
    PW0TM001.TF1ABRV[PW0TWIXM] = PW0TW02.TF1ABRV[PW0TWIXM];
    PW0TM001.PWCTLNBR[PW0TWIXM] = PW0TW02.PWCTLNBR[PW0TWIXM];
    PW0TM001.XTRCD[PW0TWIXM] = PW0TW02.XTRCD[PW0TWIXM];
    PW0TM001.PWCCAVFR[PW0TWIXM] = PW0TW02.PWCCAVFR[PW0TWIXM];
    PW0TM001.PWCCAVTR[PW0TWIXM] = PW0TW02.PWCCAVTR[PW0TWIXM];
    PW0TM001.PWCDSTFR[PW0TWIXM] = PW0TW02.PWCDSTFR[PW0TWIXM];
    PW0TM001.PWCDSTTH[PW0TWIXM] = PW0TW02.PWCDSTTH[PW0TWIXM];
    PW0TM001.PWCRSHFL[PW0TWIXM] = PW0TW02.PWCRSHFL[PW0TWIXM];
    PW0TM001.PWCHLDFL[PW0TWIXM] = PW0TW02.PWCHLDFL[PW0TWIXM];
    PW0TM001.PW0TMPMM[PW0TWIXM] = PW0TW02.PW0TMPMM[PW0TWIXM];
    PW0TM001.PW0TMPDD[PW0TWIXM] = PW0TW02.PW0TMPDD[PW0TWIXM];
    PW0TM001.PW0TMPYY[PW0TWIXM] = PW0TW02.PW0TMPYY[PW0TWIXM];

    PW0TW00.PW0TWIXM = PW0TW00.PW0TWIXM + 1; /* Increment line index*/

  end


end // end PW0T210

// Check attention identifier
Function PW0T300()
   /* ------------------------------------------------------------*/
   /* If CANCEL was requested, clear the map fields and exit.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pa2) /* PA2 was pressed*/

    if (PW0TW00.PW0TWSWR == "Y") /* Request for data*/
      set PW0TW01 empty; /* M001 display storage/hdr*/
      set PW0TW02 empty; /* M001 display storage/dtl*/
    end

    PW0TW00.PW0TWSWF = "Y"; /* Format the map switch*/
    PW0TW00.PW0TWSWR = "N"; /* Request for data switch*/

    COMMAREA.CATOAP = " "; /* TO application*/
    COMMAREA.CAITEM = " "; /* Application data*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* If FAST PATH was requested, transfer to the application.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.CATOAP > " ") /* FAST PATH was requested*/

    if (converseVar.eventKey is enter) /* ENTER was pressed*/

      PW0T110(); /* Purge temporary storage*/

      XSPKS01(); /* Exit to another application*/

      set PW0TM001.CATOAP cursor, bold; /* Highlight*/

    else

      TA1REC.TA1PGMNO = "300"; /* Module identification*/
      converseLib.validationFailed(13); /* PA/PF key may not be used*/

    end

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* If HELP, exit to the previous level or exit to the Master*/
   /* Menu was requested, exit to another application.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf1 /* PF1 was pressed*/
   || converseVar.eventKey is pf3 /* or PF3 was pressed*/
   || converseVar.eventKey is pf4) /* or PF4 was pressed*/

    if (converseVar.eventKey is pf1) /* PF1 was pressed*/
      COMMAREA.CAITEM = "PW0TM001"; /* Application find code*/
    end

    if (converseVar.eventKey is pf3) /* PF3 was pressed*/
      COMMAREA.CATOAP = "PW0W"; /* TO application*/
    end

    if (converseVar.eventKey is pf4) /* PF3 was pressed*/
      COMMAREA.CATOAP = "MN0M"; /* TO application*/
    end

    PW0T110(); /* Purge temporary storage*/

    XSPKS01(); /* Exit to another application*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Determine whether a valid attention identifier was used to*/
   /* invoke the transaction.  Display an error message to the*/
   /* user if the PF key used is not supported.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey not enter /* ENTER was not pressed*/
   && converseVar.eventKey not pf7   /* and PF7 was not pressed*/
   && converseVar.eventKey not pf8)  /* and PF8 was not pressed*/

    TA1REC.TA1PGMNO = "300"; /* Module identification*/
    converseLib.validationFailed(12); /* PA/PF key pressed is not valid*/

    if (converseVar.eventKey is pakey) /* PA key was pressed*/
      converseLib.clearScreen();
       /* Clear screen before display*/
    end

    exit stack; /* Exit to display map*/

  end


end // end PW0T300

// Reset highlighted fields
Function PW0T400()
   /* ------------------------------------------------------------*/
   /* Reset all modifiable field attributes to normal intensity.*/
   /* ------------------------------------------------------------*/

  set PW0TM001.XWHCD initialAttributes; /* Warehouse code*/
  set PW0TM001.PWDNBRSS initialAttributes; /* number of spurs*/
  set PW0TM001.PWDDFPHS initialAttributes; /* default spurs*/
  set PW0TM001.PWDRJTSS initialAttributes; /* reject spurs*/
  set PW0TM001.PWDNBRSH initialAttributes; /* total schedule*/
  set PW0TM001.PWDSCHFR initialAttributes; /* schedule from*/
  set PW0TM001.PWDSCHTH initialAttributes; /* schedule thru*/
  set PW0TM001.PWDMIPSH initialAttributes; /* minutes/schedule*/
  if (PW0TM001.XWHCD == "04" /* Memphis Footwear*/
   || PW0TM001.XWHCD == "07" /* Wilsonville*/
   || PW0TM001.XWHCD == "51") /* Memphis Apparel*/
    set PW0TM001.PW0TMCOV initialAttributes;
    set PW0TM001.PWDCOVSC initialAttributes; /* carryover schedule (unprotect)*/
  else
    set PW0TM001.PW0TMCOV skip, invisible;
    set PW0TM001.PWDCOVSC skip, invisible;
  end

  PW0TW00.PW0TWIXM = 1; /* Initialize line index*/

  while (PW0TW00.PW0TWIXM <= 10 /* Until end of lines*/
   && PW0TM001.PKVSSPNB[PW0TWIXM] > 0) /* or end of display*/

    set PW0TM001.PW0TMACT[PW0TWIXM] normal; /* Reset select flag*/
    set PW0TM001.PKVSSPNB[PW0TWIXM] initialAttributes; /* spur number*/
    set PW0TM001.TF1CARCD[PW0TWIXM] initialAttributes; /* carrier code*/
    set PW0TM001.TF1ABRV[PW0TWIXM] initialAttributes; /* carrier name*/
    set PW0TM001.PWCTLNBR[PW0TWIXM] initialAttributes; /* trailer number*/
    set PW0TM001.XTRCD[PW0TWIXM] initialAttributes; /* trailer type*/
    set PW0TM001.PWCCAVFR[PW0TWIXM] initialAttributes; /* schedule from*/
    set PW0TM001.PWCCAVTR[PW0TWIXM] initialAttributes; /* schedule thru*/
    set PW0TM001.PWCDSTFR[PW0TWIXM] initialAttributes; /* range from*/
    set PW0TM001.PWCDSTTH[PW0TWIXM] initialAttributes; /* range thru*/
    set PW0TM001.PWCRSHFL[PW0TWIXM] initialAttributes; /* rush flag*/
    set PW0TM001.PWCHLDFL[PW0TWIXM] initialAttributes; /* p & h flag*/
    set PW0TM001.PW0TMPMM[PW0TWIXM] initialAttributes; /* month*/
    set PW0TM001.PW0TMPDD[PW0TWIXM] initialAttributes; /* day*/
    set PW0TM001.PW0TMPYY[PW0TWIXM] initialAttributes; /* year*/

    PW0TW00.PW0TWIXM = PW0TW00.PW0TWIXM + 1; /* Increment line index*/

  end

  set PW0TM001.CATOAP initialAttributes; /* TO application*/
  set PW0TM001.CAITEM initialAttributes; /* Application data*/


end // end PW0T400

// Verify data that was entered
Function PW0T500()
   /* ------------------------------------------------------------*/
   /* Highlight any application data that was entered.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.CAITEM > " ") /* Application data was entered*/

    TA1REC.TA1PGMNO = "500"; /* Module identification*/
    set PW0TM001.CAITEM cursor, bold; /* Highlight*/
    converseLib.validationFailed(15); /* Enter only with FAST PATH*/

  end

   /* ------------------------------------------------------------*/
   /* Determine whether a valid request to scroll was entered.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf7 /* Scroll back request*/
   || converseVar.eventKey is pf8) /* or scroll forward request*/

    PW0T510(); /* Verify scroll request*/

    if (converseVar.validationMsgNum != 0) /* if errors found*/
      exit stack; /* exit to display map*/
    else
      return; /* exit to calling process*/
    end
  end

   /* ------------------------------------------------------------*/
   /* determine the first and last carryover schedules*/
   /* ------------------------------------------------------------*/
  if (PW0TM001.PWDCOVSC > 0) /* carryover schedules exists*/
          /* first carryover sched = (total sched - carryover sched) + 1*/
    PW0TW00.PW0TWFCO = (PW0TM001.PWDNBRSH - PW0TM001.PWDCOVSC) + 1;
          /* last carryover sched =  total sched*/
    PW0TW00.PW0TWLCO = PW0TM001.PWDNBRSH; /* last carryover*/
  else
    PW0TW00.PW0TWFCO = 0; /* first carryover*/
    PW0TW00.PW0TWLCO = 0; /* last carryover*/
  end

   /* ------------------------------------------------------------*/
   /* verify data entered on the map.*/
   /* ------------------------------------------------------------*/

  if (PW0TW00.TA5TSQIX > 0) /* Page was formatted*/

    PW0TW00.PW0TWIXM = 10; /* Initialize line index*/

    while (PW0TW00.PW0TWIXM > 0) /* Until end of lines*/

      PW0T520(); /* Verify action codes*/

      if (PW0TM001.PW0TMACT[PW0TWIXM] == "C" /* change*/
       || PW0TM001.PW0TMACT[PW0TWIXM] == "A") /* add*/

        PW0T530(); /* Verify data in the line*/

      end

      if (PW0TM001.PW0TMACT[PW0TWIXM] == " ") /* no action*/

        PW0T540(); /* verify no changes if no action*/

      end

      PW0T550(); /* verify header*/

      PW0TW00.PW0TWIXM = PW0TW00.PW0TWIXM - 1; /* Decrement line number*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If any errors were found, exit to display the map.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Errors were found*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* check for schedule and destination overlaps.*/
   /* ------------------------------------------------------------*/

  PW0TW00.PW0TWIXM = 10; /* Initialize line index*/

  while (PW0TW00.PW0TWIXM > 0) /* Until end of lines*/

    if (PW0TM001.PW0TMACT[PW0TWIXM] == "C" /* change*/
     || PW0TM001.PW0TMACT[PW0TWIXM] == "A") /* add*/

      PW0T560(); /* verify overlaps*/

    end

    PW0TW00.PW0TWIXM = PW0TW00.PW0TWIXM - 1; /* Decrement line number*/

  end

   /* -----------------------------------------------------------*/
   /* Edit total schedules against all pages.*/
   /* -----------------------------------------------------------*/

  if (converseVar.validationMsgNum == 0 /* No errors so far*/
   && PW0TW00.TA5TSQIX > 0)             /* Page was formatted*/

    if (PW0TW01.PWDNBRSH != PW0TM001.PWDNBRSH /* total sched for day change*/
     || PW0TW01.PWDCOVSC != PW0TM001.PWDCOVSC /* carryover scheds change*/
     || PW0TM001.PWDSCHFR != PW0TW01.PWDSCHFR /* rush schedule from*/
     || PW0TM001.PWDSCHTH != PW0TW01.PWDSCHTH) /* rush schedule thru*/
      PW0TW00.PW0TW-HDR-CHG-FL = "Y"; /* header data changed flag*/
    end

    PW0T570(); /* Edit total schedules on all pages*/

  end

   /* -----------------------------------------------------------*/
   /* If any errors were found, exit to display the map.*/
   /* -----------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Errors were found*/
    exit stack; /* Exit to display map*/
  end


end // end PW0T500

// Verify scroll request
Function PW0T510()
   /* ------------------------------------------------------------*/
   /* If scroll back was requested, ensure that pages exist.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf7 /* Scroll back request*/
   && PW0TW00.XXXTSPAG < 2)       /* and no previous pages*/

    TA1REC.TA1PGMNO = "510"; /* Module identification*/
    converseLib.validationFailed(37); /* No previous page to display*/

  end

   /* ------------------------------------------------------------*/
   /* If scroll forward was requested, ensure that pages exist.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf8 /* Scroll forward request*/
   && PW0TW00.XXXTSPAG >= PW0TW00.TA5TSQIX) /* and no more pages*/

    TA1REC.TA1PGMNO = "510"; /* Module identification*/
    converseLib.validationFailed(38); /* No more pages to display*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate an error for any data that was modified.*/
   /* ------------------------------------------------------------*/

  PW0TW00.PW0TWIXM = 10; /* Initialize line index*/

  while (PW0TW00.PW0TWIXM > 0) /* Until end of lines*/

    if (PW0TM001.PW0TMACT[PW0TWIXM] != PW0TW02.PW0TMACT[PW0TWIXM])
      set PW0TM001.PW0TMACT[PW0TWIXM] cursor, bold; /* Highlight*/
      TA1REC.TA1PGMNO = "510"; /* Module identification*/
      converseLib.validationFailed(39); /* Field may not change*/
    end

    PW0TW00.PW0TWIXM = PW0TW00.PW0TWIXM - 1; /* Decrement line number*/

  end

  if (PW0TM001.PWDMIPSH != PW0TW01.PWDMIPSH) /* minutes/schedule changed*/

    TA1REC.TA1PGMNO = "510"; /* Module identification*/
    set PW0TM001.PWDMIPSH cursor, bold; /* Highlight*/
    converseLib.validationFailed(39); /* Field may not change*/

  end

  if (PW0TM001.PWDCOVSC != PW0TW01.PWDCOVSC)

    TA1REC.TA1PGMNO = "510"; /* Module identification*/
    set PW0TM001.PWDCOVSC cursor, bold; /* Highlight*/
    converseLib.validationFailed(39); /* Field may not change*/

  end

  if (PW0TM001.PWDSCHTH != PW0TW01.PWDSCHTH)

    TA1REC.TA1PGMNO = "510"; /* Module identification*/
    set PW0TM001.PWDSCHTH cursor, bold; /* Highlight*/
    converseLib.validationFailed(39); /* Field may not change*/

  end

  if (PW0TM001.PWDSCHFR != PW0TW01.PWDSCHFR)

    TA1REC.TA1PGMNO = "510"; /* Module identification*/
    set PW0TM001.PWDSCHFR cursor, bold; /* Highlight*/
    converseLib.validationFailed(39); /* Field may not change*/

  end

  if (PW0TM001.PWDDFPHS != PW0TW01.PWDDFPHS)

    TA1REC.TA1PGMNO = "510"; /* Module identification*/
    set PW0TM001.PWDDFPHS cursor, bold; /* Highlight*/
    converseLib.validationFailed(39); /* Field may not change*/

  end

  if (PW0TM001.PWDNBRSH != PW0TW01.PWDNBRSH)

    TA1REC.TA1PGMNO = "510"; /* Module identification*/
    set PW0TM001.PWDNBRSH cursor, bold; /* Highlight*/
    converseLib.validationFailed(39); /* Field may not change*/

  end


end // end PW0T510

// Verify action code
Function PW0T520()
   /* ------------------------------------------------------------*/
   /* If action was entered and is not an 'A', 'C' or 'D'*/
    /* indicate invalid action entered.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PW0TMACT[PW0TWIXM] != PW0TW02.PW0TMACT[PW0TWIXM])
    if (PW0TM001.PW0TMACT[PW0TWIXM] == "A" /* 'A'dd or*/
     || PW0TM001.PW0TMACT[PW0TWIXM] == "C" /* 'C'hange or*/
     || PW0TM001.PW0TMACT[PW0TWIXM] == "D") /* 'D'elete*/

       /* next sentence*/

    else

      TA1REC.TA1PGMNO = "520"; /* Module identification*/
      set PW0TM001.PW0TMACT[PW0TWIXM] cursor, bold; /* Highlight*/
      converseLib.validationFailed(35); /* invalid action code*/

    end
  end


end // end PW0T520

// Verify data in detail line
Function PW0T530()
   /* ------------------------------------------------------------*/
   /* verify P & H date.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PWCHLDFL[PW0TWIXM] == "Y") /* p & h flag*/
    /*  */
    /* --------------- y2k out begin ------------------*/
    /*  */
    /* IF PW0TM001.PW0TMPYY(PW0TWIXM) EQ 0 /* year*/
    /*  */
    /* --------------- y2k out end --------------------*/
    /*  */
    if (PW0TM001.PW0TMPDD[PW0TWIXM] == 0 /* day*/
     || PW0TM001.PW0TMPMM[PW0TWIXM] == 0) /* month*/

      /*  */
      /* --------------- y2k out begin ------------------*/
      /*  */
      /* IF PW0TM001.PW0TMPYY(PW0TWIXM) EQ 0;/* year*/
      /* MOVE 158 TO EZEMNO;        /* invalid date*/
      /* MOVE '530' TO TA1REC.TA1PGMNO;/* module id*/
                                  /* SET PW0TM001.PW0TMPYY(PW0TWIXM)*/
      /* /* CURSOR,BRIGHT;/* highlight field*/
      /* END;*/
      /*  */
      /* --------------- y2k out end --------------------*/
      /*  */

      if (PW0TM001.PW0TMPDD[PW0TWIXM] == 0) /* year*/
        converseLib.validationFailed(158); /* invalid date*/
        TA1REC.TA1PGMNO = "530"; /* module id*/
        set PW0TM001.PW0TMPDD[PW0TWIXM] cursor, bold; /* highlight field*/
      end

      if (PW0TM001.PW0TMPMM[PW0TWIXM] == 0) /* year*/
        converseLib.validationFailed(158); /* invalid date*/
        TA1REC.TA1PGMNO = "530"; /* module id*/
        set PW0TM001.PW0TMPMM[PW0TWIXM] cursor, bold; /* highlight field*/
      end

    else

      /*  */
      /* -------------- y2k out begin ---------------*/
      /*  */
      /* MOVE XX0XW01.XX0XW19 TO PW0TW00.PW0TMPCC;*/
      /*  */
      /* -------------- y2k out end -----------------*/
      /*  */
      PW0TW00.PW0TMPYY = PW0TM001.PW0TMPYY[PW0TWIXM];
      PW0TW00.PW0TMPMM = PW0TM001.PW0TMPMM[PW0TWIXM];
      PW0TW00.PW0TMPDD = PW0TM001.PW0TMPDD[PW0TWIXM];
      /*  */
      /* -------------- y2k in begin ----------------*/
      /*  */
      if (PW0TM001.PW0TMPYY[PW0TWIXM] > 60)
        PW0TW00.PW0TMPCC = 19;
      else
        PW0TW00.PW0TMPCC = 20;
      end
      /*  */
      /* -------------- y2k in end ------------------*/
      /*  */

      if (PW0TW00.PW0TMDAT < PW0TW00.PW0TWMPH) /* min p&h date*/

        TA1REC.TA1PGMNO = "530"; /* mod id*/
        converseLib.validationFailed(332); /* P & H date must be > 3 days*/
        set PW0TM001.PW0TMPYY[PW0TWIXM] bold; /* highlight*/
        set PW0TM001.PW0TMPDD[PW0TWIXM] bold; /* highlight*/
        set PW0TM001.PW0TMPMM[PW0TWIXM] cursor, bold; /* highlight*/

      else

        set TA4REC empty;
        TA4REC.TA2DTOPT = "GREGGREG";
        TA4REC.TA2GRTYP = "G";
        TA4REC.TA2GRGGN = PW0TW00.PW0TMDAT;

        call "TA0040" (TA4REC) {isNoRefresh = yes, isExternal = yes};

        if (TA4REC.TA2RTNCD != 0) /* bad return*/

          converseLib.validationFailed(158); /* invalid date*/
          TA1REC.TA1PGMNO = "530"; /* module id*/
          set PW0TM001.PW0TMPYY[PW0TWIXM] bold; /* highlight*/
          set PW0TM001.PW0TMPDD[PW0TWIXM] bold; /* highlight*/
          set PW0TM001.PW0TMPMM[PW0TWIXM] cursor, bold; /* highlight*/
        end
      end
    end

  else
      /*  */
      /* -------------- Y2K OUT BEGIN----------------*/
      /*  */
    /* IF PW0TM001.PW0TMPYY(PW0TWIXM) GT 0/* date entered*/
      /*  */
      /* -------------- Y2K OUT END -----------------*/
      /*  */
    if (PW0TM001.PW0TMPDD[PW0TWIXM] > 0
     || PW0TM001.PW0TMPMM[PW0TWIXM] > 0)

      converseLib.validationFailed(333); /* p & h flag must be 'y' to enter date*/
      TA1REC.TA1PGMNO = "530"; /* module id*/
      set PW0TM001.PW0TMPYY[PW0TWIXM] bold; /* highlight*/
      set PW0TM001.PW0TMPDD[PW0TWIXM] bold; /* highlight*/
      set PW0TM001.PW0TMPMM[PW0TWIXM] cursor, bold; /* highlight field*/

    end
  end

   /* ------------------------------------------------------------*/
   /* verify P & H flag.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PWCHLDFL[PW0TWIXM] > " ") /* if entered*/
    if (PW0TM001.PWCHLDFL[PW0TWIXM] == "Y" /* if 'Y'*/
     || PW0TM001.PWCHLDFL[PW0TWIXM] == "N") /* or 'N'*/

      if (PW0TM001.PWCHLDFL[PW0TWIXM] == "Y" /* P & H flag*/
       && PW0TM001.PWCRSHFL[PW0TWIXM] == "Y") /* rush flag*/

        converseLib.validationFailed(354);
                                   /* p & h cannot = 'y' if rush flag = 'y'*/
        TA1REC.TA1PGMNO = "530"; /* module id*/
        set PW0TM001.PWCHLDFL[PW0TWIXM] cursor, bold; /* highlight field*/

      end
    else

      converseLib.validationFailed(235); /* 'y' or 'n' only*/
      TA1REC.TA1PGMNO = "530"; /* module id*/
      set PW0TM001.PWCHLDFL[PW0TWIXM] cursor, bold; /* highlight field*/

    end
  end

   /* ------------------------------------------------------------*/
   /* verify rush flag.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PWCRSHFL[PW0TWIXM] > " ") /* if entered*/
    if (PW0TM001.PWCRSHFL[PW0TWIXM] == "Y" /* if 'Y'*/
     || PW0TM001.PWCRSHFL[PW0TWIXM] == "N") /* or 'N'*/

      if (PW0TM001.PWCRSHFL[PW0TWIXM] == "Y" /* P & H flag*/
       && PW0TM001.PWCHLDFL[PW0TWIXM] == "Y") /* rush flag*/

        converseLib.validationFailed(354);
                                   /* p & h cannot = 'y' if rush flag = 'y'*/
        TA1REC.TA1PGMNO = "530"; /* module id*/
        set PW0TM001.PWCRSHFL[PW0TWIXM] cursor, bold; /* highlight field*/

      end

    else

      converseLib.validationFailed(235); /* 'y' or 'n' only*/
      TA1REC.TA1PGMNO = "530"; /* module id*/
      set PW0TM001.PWCRSHFL[PW0TWIXM] cursor, bold; /* highlight field*/

    end
  end

   /* ------------------------------------------------------------*/
   /* verify destination range.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PWCDSTTH[PW0TWIXM] == " " /* not entered*/
   && PW0TM001.PWCDSTFR[PW0TWIXM] > " ") /* entered*/

    converseLib.validationFailed(335);
                                   /* thru range must be entered if from is*/
    TA1REC.TA1PGMNO = "530"; /* module id*/
    set PW0TM001.PWCDSTTH[PW0TWIXM] cursor, bold; /* highlight field*/

  end

  if (PW0TM001.PWCDSTFR[PW0TWIXM] == " " /* not entered*/
   && PW0TM001.PWCDSTTH[PW0TWIXM] > " ") /* entered*/

    converseLib.validationFailed(336);
                                   /* from range must be entered if thru is*/
    TA1REC.TA1PGMNO = "530"; /* module id*/
    set PW0TM001.PWCDSTFR[PW0TWIXM] cursor, bold; /* highlight field*/

  end

  if (PW0TM001.PWCDSTFR[PW0TWIXM] > " " /* if entered*/
   && PW0TM001.PWCDSTTH[PW0TWIXM] > " ")

    if (PW0TM001.PWCDSTTH[PW0TWIXM] < PW0TM001.PWCDSTFR[PW0TWIXM])

      converseLib.validationFailed(334); /* from must be less than to*/
      TA1REC.TA1PGMNO = "530"; /* module id*/
      set PW0TM001.PWCDSTTH[PW0TWIXM] bold; /* highlight field*/
      set PW0TM001.PWCDSTFR[PW0TWIXM] cursor, bold; /* highlight field*/

    else

      PW0T531(); /* verify dest thru in DPICK.VDESTN01*/
      PW0T532(); /* verify dest from in DPICK.VDESTN01*/

    end
  end

   /* ------------------------------------------------------------*/
   /* verify schedule.*/
   /* valid:    Fr & To Sched nbr can both be 0's*/
   /* invalid:  if Fr Sched is = 0 and To Sched is > 0*/
   /* if To Sched is = 0 and From Sched is > 0*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PWCCAVFR[PW0TWIXM] == 0
   && PW0TM001.PWCCAVTR[PW0TWIXM] == 0)
     /* okay*/
  else

    if (PW0TM001.PWCCAVFR[PW0TWIXM] > 0 /* fr > 0*/
     && PW0TM001.PWCCAVTR[PW0TWIXM] == 0) /* to = 0*/
      converseLib.validationFailed(337); /* to is a required field*/
      TA1REC.TA1PGMNO = "530"; /* module id*/
      set PW0TM001.PWCCAVTR[PW0TWIXM] cursor, bold; /* highlight field*/
    else

      if (PW0TM001.PWCCAVFR[PW0TWIXM] == 0
       && PW0TM001.PWCCAVTR[PW0TWIXM] > 0)
        converseLib.validationFailed(132); /* from is a required field*/
        TA1REC.TA1PGMNO = "530"; /* module id*/
        set PW0TM001.PWCCAVTR[PW0TWIXM] cursor, bold; /* highlight field*/
      end

    end
  end

  if (PW0TM001.PWCCAVFR[PW0TWIXM] > 0 /* if entered*/
   && PW0TM001.PWCCAVTR[PW0TWIXM] > 0)

    if (PW0TM001.PWCRSHFL[PW0TWIXM] == "Y") /* if rush schedule*/

      PW0TW00.PW0TWSTH = PW0TM001.PWDSCHTH; /* sched hold*/
      PW0TW00.PW0TWSFR = PW0TM001.PWDSCHFR; /* sched hold*/

      if (PW0TM001.PWCCAVTR[PW0TWIXM] > PW0TW00.PW0TWSTH)

        converseLib.validationFailed(343); /* rush schedule cannot exceed range*/
        TA1REC.TA1PGMNO = "530"; /* module id*/
        set PW0TM001.PWCCAVTR[PW0TWIXM] cursor, bold; /* highlight field*/

      end

      if (PW0TM001.PWCCAVFR[PW0TWIXM] < PW0TW00.PW0TWSFR)

        converseLib.validationFailed(343); /* rush schedule cannot exceed range*/
        TA1REC.TA1PGMNO = "530"; /* module id*/
        set PW0TM001.PWCCAVFR[PW0TWIXM] cursor, bold; /* highlight field*/

      end
    end

    if (PW0TM001.PWCCAVTR[PW0TWIXM] < PW0TM001.PWCCAVFR[PW0TWIXM])

      converseLib.validationFailed(133); /* from must be less than to*/
      TA1REC.TA1PGMNO = "530"; /* module id*/
      set PW0TM001.PWCCAVTR[PW0TWIXM] bold; /* highlight field*/
      set PW0TM001.PWCCAVFR[PW0TWIXM] cursor, bold; /* highlight field*/

    end

    if (PW0TM001.PWCCAVTR[PW0TWIXM] > PW0TM001.PWDNBRSH)

      converseLib.validationFailed(349); /* thru cannot be > total schedules*/
      TA1REC.TA1PGMNO = "530"; /* mod id*/
      set PW0TM001.PWCCAVTR[PW0TWIXM] bold; /* highlight field*/
      set PW0TM001.PWCCAVFR[PW0TWIXM] cursor, bold; /* highlight field*/

    end
  end

   /* ------------------------------------------------------------*/
   /* verify trailer type.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.XTRCD[PW0TWIXM] > " ") /* trailer type entered*/

    if (PW0TM001.XTRCD[PW0TWIXM] in XTRTBL.XTRCD /* code in table*/
     && XTRTBL.XXXSTAT[sysVar.arrayIndex] == "A") /* and active status*/

       /* next sentence*/

    else
      converseLib.validationFailed(340); /* invalid field*/
      TA1REC.TA1PGMNO = "530"; /* module id*/
      set PW0TM001.XTRCD[PW0TWIXM] cursor, bold; /* highlight field*/
    end

  else
    converseLib.validationFailed(341); /* required field*/
    TA1REC.TA1PGMNO = "530"; /* module id*/
    set PW0TM001.XTRCD[PW0TWIXM] cursor, bold; /* highlight field*/
  end

   /* ------------------------------------------------------------*/
   /* verify trailer number.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PWCTLNBR[PW0TWIXM] > " ") /* if entered*/
     /* next sentence*/
  else
    converseLib.validationFailed(341); /* required field*/
    TA1REC.TA1PGMNO = "530"; /* module id*/
    set PW0TM001.PWCTLNBR[PW0TWIXM] cursor, bold; /* highlight field*/
  end

   /* ------------------------------------------------------------*/
   /* verify carrier code.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.TF1CARCD[PW0TWIXM] > " ") /* entered*/
    PW0T533(); /* verify carrier code in dpick.vcarr001*/
  else
    converseLib.validationFailed(341); /* required field*/
    TA1REC.TA1PGMNO = "530"; /* module id*/
    set PW0TM001.TF1CARCD[PW0TWIXM] cursor, bold; /* highlight field*/
  end

   /* ------------------------------------------------------------*/
   /* verify spur number.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PKVSSPNB[PW0TWIXM] > 0) /* spur entered*/

    PW0TW00.PW0TWSPR = PW0TM001.PKVSSPNB[PW0TWIXM]; /* spur hold*/

    if (PW0TW00.PW0TWSPR == PW0TM001.PWDRJTSS) /* reject*/
      converseLib.validationFailed(368); /* reject spur cannot be assigned to*/
                                   /* carrier*/
      TA1REC.TA1PGMNO = "530"; /* module id*/
      set PW0TM001.PKVSSPNB[PW0TWIXM] cursor, bold; /* highlight field*/
    else
    end

    if (PW0TM001.XWHCD == "04") /* memphis footwear*/
      /* ------ valid spur number -----------------------------*/
      if (PW0TW00.PW0TWSPR > 8000
       && PW0TW00.PW0TWSPR < 8100
       && PW0TW00.PW0TWSP2 <= PW0TM001.PWDNBRSS) /* spur# to big ?*/

        if (PW0TW00.PW0TWSPR != 8027
         && PW0TW00.PW0TWSPR != 8028
         && PW0TW00.PW0TWSPR != 8029)
           /* next sentence*/
        else
          converseLib.validationFailed(250); /* invalid spur number*/
          TA1REC.TA1PGMNO = "530"; /* module id*/
          set PW0TM001.PKVSSPNB[PW0TWIXM] cursor, bold;
        end
      else
        converseLib.validationFailed(250); /* invalid spur number*/
        TA1REC.TA1PGMNO = "530"; /* module id*/
        set PW0TM001.PKVSSPNB[PW0TWIXM] cursor, bold;
      end
    else
      if (PW0TM001.XWHCD == "51") /* memphis apparel*/
        if (PW0TW00.PW0TWSPR > 5000
         && PW0TW00.PW0TWSPR < 5200
         && PW0TW00.PW0TWSP2 <= PW0TM001.PWDNBRSS) /* spur# to big ?*/
        else
          converseLib.validationFailed(250); /* invalid spur number*/
          TA1REC.TA1PGMNO = "530"; /* module id*/
          set PW0TM001.PKVSSPNB[PW0TWIXM] cursor, bold;
        end
      else
           /* Non warehouse dependent code*/
        if (PW0TW00.PW0TWSP2 > PW0TM001.PWDNBRSS /* spur# to big ?*/
         || PW0TW00.PW0TWSPR > 99)              
          converseLib.validationFailed(344); /* spur cannot exceed spur available*/
          TA1REC.TA1PGMNO = "530"; /* module id*/
          set PW0TM001.PKVSSPNB[PW0TWIXM] cursor, bold; /* highlight field*/
        else
        end
      end
    end

  else
    converseLib.validationFailed(341); /* required field*/
    TA1REC.TA1PGMNO = "530"; /* module id*/
    set PW0TM001.PKVSSPNB[PW0TWIXM] cursor, bold; /* highlight field*/
  end


end // end PW0T530

// Select from DPICK.VDESTN01
Function PW0T531()
   /* ------------------------------------------------------------*/
   /* Select from DPICK.VDESTN01.*/
   /* ------------------------------------------------------------*/

  set TF2REC empty; /* Clear row storage area*/

  TF2REC.TF2DSTCD = PW0TM001.PWCDSTTH[PW0TWIXM]; /* dest code*/

  try
    call "IO1210" ("S ", SQLCA, TF2REC) {isNoRefresh = yes, isExternal = yes};
  end /* Select table row*/

   /* ------------------------------------------------------------*/
   /* If successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/
      return;
    end

    if (SQLCA.VAGen_SQLCODE == 100) /* row not found*/

      TA1REC.TA1PGMNO = "531"; /* module id*/
      converseLib.validationFailed(351); /* invalid dest code*/
      set PW0TM001.PWCDSTTH[PW0TWIXM] cursor, bold; /* highlight*/

      return; /* Return to previous process*/
    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(28); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(29); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "VERIFY DESTINATION";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = "531"; /* Program number*/
  TA1REC.TA1DBASE = "DPICK   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VDESTN01"; /* Table view name*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end PW0T531

// Select from DPICK.VDESTN01
Function PW0T532()
   /* ------------------------------------------------------------*/
   /* Select from DPICK.VDESTN01.*/
   /* ------------------------------------------------------------*/

  set TF2REC empty; /* Clear row storage area*/

  TF2REC.TF2DSTCD = PW0TM001.PWCDSTFR[PW0TWIXM]; /* dest code*/

  try
    call "IO1210" ("S ", SQLCA, TF2REC) {isNoRefresh = yes, isExternal = yes};
  end /* Select table row*/

   /* ------------------------------------------------------------*/
   /* If successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/
      return;
    end

    if (SQLCA.VAGen_SQLCODE == 100) /* row not found*/

      TA1REC.TA1PGMNO = "532"; /* module id*/
      converseLib.validationFailed(351); /* invalid dest code*/
      set PW0TM001.PWCDSTFR[PW0TWIXM] cursor, bold; /* highlight*/

      return; /* Return to previous process*/
    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(28); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(29); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "VERIFY DESTINATION";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = "532"; /* Program number*/
  TA1REC.TA1DBASE = "DPICK   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VDESTN01"; /* Table view name*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end PW0T532

// Select from DPICK.VCARR001
Function PW0T533()
   /* ------------------------------------------------------------*/
   /* Select from DPICK.VCARR001.*/
   /* ------------------------------------------------------------*/

  set TF1REC empty; /* Clear row storage area*/

  TF1REC.TF1CARCD = PW0TM001.TF1CARCD[PW0TWIXM]; /* carrier code*/

  try
    call "IO0860" ("S ", SQLCA, TF1REC) {isNoRefresh = yes, isExternal = yes};
  end /* Select table row*/

   /* ------------------------------------------------------------*/
   /* If successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/
      PW0TW02.TF1ABRV[PW0TWIXM] = TF1REC.TF1ABRV;
      return;
    end

    if (SQLCA.VAGen_SQLCODE == 100) /* row not found*/

      TA1REC.TA1PGMNO = "533"; /* module id*/
      converseLib.validationFailed(77); /* invalid carrier code*/
      set PW0TM001.TF1CARCD[PW0TWIXM] cursor, bold; /* highlight*/

      return; /* Return to previous process*/
    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(28); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    converseLib.validationFailed(29); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "SELECT UNIQUE ROW";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = "533"; /* Program number*/
  TA1REC.TA1DBASE = "DPICK   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VCARR001"; /* Table view name*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end PW0T533

// Verify data no action
Function PW0T540()
   /* ------------------------------------------------------------*/
   /* If data changed and no action entered send error msg.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PW0TMPYY[PW0TWIXM] != PW0TW02.PW0TMPYY[PW0TWIXM])
    set PW0TM001.PW0TMPYY[PW0TWIXM] cursor, bold; /* Highlight*/
    TA1REC.TA1PGMNO = "540"; /* Module identification*/
    converseLib.validationFailed(43); /* Field may not change*/
  end

  if (PW0TM001.PW0TMPDD[PW0TWIXM] != PW0TW02.PW0TMPDD[PW0TWIXM])
    set PW0TM001.PW0TMPDD[PW0TWIXM] cursor, bold; /* Highlight*/
    TA1REC.TA1PGMNO = "540"; /* Module identification*/
    converseLib.validationFailed(43); /* Field may not change*/
  end

  if (PW0TM001.PW0TMPMM[PW0TWIXM] != PW0TW02.PW0TMPMM[PW0TWIXM])
    set PW0TM001.PW0TMPMM[PW0TWIXM] cursor, bold; /* Highlight*/
    TA1REC.TA1PGMNO = "540"; /* Module identification*/
    converseLib.validationFailed(43); /* Field may not change*/
  end

  if (PW0TM001.PWCHLDFL[PW0TWIXM] != PW0TW02.PWCHLDFL[PW0TWIXM])
    set PW0TM001.PWCHLDFL[PW0TWIXM] cursor, bold; /* Highlight*/
    TA1REC.TA1PGMNO = "540"; /* Module identification*/
    converseLib.validationFailed(43); /* Field may not change*/
  end

  if (PW0TM001.PWCRSHFL[PW0TWIXM] != PW0TW02.PWCRSHFL[PW0TWIXM])
    set PW0TM001.PWCRSHFL[PW0TWIXM] cursor, bold; /* Highlight*/
    TA1REC.TA1PGMNO = "540"; /* Module identification*/
    converseLib.validationFailed(43); /* Field may not change*/
  end

  if (PW0TM001.PWCDSTTH[PW0TWIXM] != PW0TW02.PWCDSTTH[PW0TWIXM])
    set PW0TM001.PWCDSTTH[PW0TWIXM] cursor, bold; /* Highlight*/
    TA1REC.TA1PGMNO = "540"; /* Module identification*/
    converseLib.validationFailed(43); /* Field may not change*/
  end

  if (PW0TM001.PWCDSTFR[PW0TWIXM] != PW0TW02.PWCDSTFR[PW0TWIXM])
    set PW0TM001.PWCDSTFR[PW0TWIXM] cursor, bold; /* Highlight*/
    TA1REC.TA1PGMNO = "540"; /* Module identification*/
    converseLib.validationFailed(43); /* Field may not change*/
  end

  if (PW0TM001.PWCCAVTR[PW0TWIXM] != PW0TW02.PWCCAVTR[PW0TWIXM])
    set PW0TM001.PWCCAVTR[PW0TWIXM] cursor, bold; /* Highlight*/
    TA1REC.TA1PGMNO = "540"; /* Module identification*/
    converseLib.validationFailed(43); /* Field may not change*/
  end

  if (PW0TM001.PWCCAVFR[PW0TWIXM] != PW0TW02.PWCCAVFR[PW0TWIXM])
    set PW0TM001.PWCCAVFR[PW0TWIXM] cursor, bold; /* Highlight*/
    TA1REC.TA1PGMNO = "540"; /* Module identification*/
    converseLib.validationFailed(43); /* Field may not change*/
  end

  if (PW0TM001.XTRCD[PW0TWIXM] != PW0TW02.XTRCD[PW0TWIXM])
    set PW0TM001.XTRCD[PW0TWIXM] cursor, bold; /* Highlight*/
    TA1REC.TA1PGMNO = "540"; /* Module identification*/
    converseLib.validationFailed(43); /* Field may not change*/
  end

  if (PW0TM001.PWCTLNBR[PW0TWIXM] != PW0TW02.PWCTLNBR[PW0TWIXM])
    set PW0TM001.PWCTLNBR[PW0TWIXM] cursor, bold; /* Highlight*/
    TA1REC.TA1PGMNO = "540"; /* Module identification*/
    converseLib.validationFailed(43); /* Field may not change*/
  end

  if (PW0TM001.TF1CARCD[PW0TWIXM] != PW0TW02.TF1CARCD[PW0TWIXM])
    set PW0TM001.TF1CARCD[PW0TWIXM] cursor, bold; /* Highlight*/
    TA1REC.TA1PGMNO = "540"; /* Module identification*/
    converseLib.validationFailed(43); /* Field may not change*/
  end

  if (PW0TM001.PKVSSPNB[PW0TWIXM] != PW0TW02.PKVSSPNB[PW0TWIXM])
    set PW0TM001.PKVSSPNB[PW0TWIXM] cursor, bold; /* Highlight*/
    TA1REC.TA1PGMNO = "540"; /* Module identification*/
    converseLib.validationFailed(43); /* Field may not change*/
  end


end // end PW0T540

// Validate header
Function PW0T550()
   /* ------------------------------------------------------------*/
   /* Verify data in the header.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PWDNBRSH > PW0TM001.PWDCOVSC)
    /* very total time within 24 hours*/
    PW0TW00.PWDMIPSH = 1440 / (PW0TM001.PWDNBRSH - PW0TM001.PWDCOVSC);
  else
    converseLib.validationFailed(251); /* number of schedules is invalid*/
    TA1REC.TA1PGMNO = "550"; /* mod id*/
    set PW0TM001.PWDNBRSH cursor, bold; /* highlight field*/
  end

   /* ------------------------------------------------------------*/
   /* verify minutes per schedule.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PWDMIPSH > 0) /* must be > 0*/
    if (PW0TM001.PWDMIPSH > PW0TW00.PWDMIPSH) /* min/schedule*/

      converseLib.validationFailed(345); /* minutes per schedule exceeds allowed*/
                                   /* amount*/
      TA1REC.TA1PGMNO = "550"; /* mod id*/
      set PW0TM001.PWDMIPSH cursor, bold; /* highlight field*/
    else
    end
  else
    converseLib.validationFailed(341); /* required, please enter*/
    TA1REC.TA1PGMNO = "550"; /* mod id*/
    set PW0TM001.PWDMIPSH cursor, bold; /* highlight field*/
  end

   /* ------------------------------------------------------------*/
   /* verify carryover schedule limit*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PWDCOVSC > 0)
    if (PW0TM001.PWDCOVSC > 6)
      converseLib.validationFailed(505); /* carryover sched cannot be > 6*/
      TA1REC.TA1PGMNO = "550"; /* mod id*/
      set PW0TM001.PWDCOVSC cursor, bold; /* highlight field*/
    end
  end

   /* ------------------------------------------------------------*/
   /* verify rush schedules from and to.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PWDSCHFR > 0) /* must be > 0*/
    if (PW0TM001.PWDSCHFR > PW0TM001.PWDSCHTH)
      converseLib.validationFailed(339); /* from cannot be > to*/
      TA1REC.TA1PGMNO = "550"; /* mod id*/
      set PW0TM001.PWDSCHFR cursor, bold; /* highlight field*/
    else
    end
  else
    converseLib.validationFailed(341); /* required field please enter.*/
    TA1REC.TA1PGMNO = "550"; /* mod id*/
    set PW0TM001.PWDSCHFR cursor, bold; /* highlight field*/
  end

  PW0TW00.PW0TWSFR = PW0TM001.PWDSCHTH; /* sch number*/
  if (PW0TW00.PW0TWSFR > 0)
    if (PW0TW00.PW0TWSFR > PW0TM001.PWDNBRSH)
      converseLib.validationFailed(347); /* from cannot be > total schedules*/
      TA1REC.TA1PGMNO = "550"; /* mod id*/
      set PW0TM001.PWDSCHTH cursor, bold; /* highlight field*/
    else
    end
  else
    converseLib.validationFailed(341); /* required field please enter.*/
    TA1REC.TA1PGMNO = "550"; /* mod id*/
    set PW0TM001.PWDSCHTH cursor, bold; /* highlight field*/
  end

   /* ------------------------------------------------------------*/
   /* verify P & h spur number.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.XWHCD == PW0TW01.XWHCD) /* if key hasnt chantged*/
    PW0TW00.PW0TWSPR = PW0TM001.PWDDFPHS; /* spur hold*/
    if (PW0TM001.PWDDFPHS == PW0TM001.PWDRJTSS)
      PW0TW00.PW0TWMSG = 348; /* p & h spur number = reject spur*/
      TA1REC.TA1PGMNO = "550"; /* mod id*/
    end

    if (PW0TM001.XWHCD == "04")
      if (PW0TM001.PWDDFPHS > 8000
       && PW0TM001.PWDDFPHS < 8100
       && PW0TW00.PW0TWSP2 <= PW0TM001.PWDNBRSS) /* p&h LE # of spurs?*/
        /* next sentence*/
      else
        converseLib.validationFailed(250);
        TA1REC.TA1PGMNO = "550";
        set PW0TM001.PWDDFPHS cursor, bold;
      end
    else
      if (PW0TM001.XWHCD == "51")
        if (PW0TM001.PWDDFPHS > 5000
         && PW0TM001.PWDDFPHS < 5200
         && PW0TW00.PW0TWSP2 <= PW0TM001.PWDNBRSS) /* p&h LE # of spurs?*/
          /* next sentence*/
        else
          converseLib.validationFailed(250);
          TA1REC.TA1PGMNO = "550";
          set PW0TM001.PWDDFPHS cursor, bold;
        end
      else
          /* non warehouse dependent code.*/
        if (PW0TW00.PW0TWSPR < 100
         && PW0TW00.PW0TWSP2 <= PW0TM001.PWDNBRSS)
        else /* ok, next sentence.*/
          converseLib.validationFailed(250); /* this is an error.*/
          TA1REC.TA1PGMNO = "550";
          set PW0TM001.PWDDFPHS cursor, bold;
        end
      end
    end
  end

   /* ------------------------------------------------------------*/
   /* verify warehouse code.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.XWHCD > " ") /* if entered*/
    if (PW0TM001.XWHCD in XWHTBL.XWHCD /* in table*/
     && XWHTBL.XXXSTAT[sysVar.arrayIndex] == "A") /* active status*/
    else

      converseLib.validationFailed(340); /* invalid code or inactive status*/
      TA1REC.TA1PGMNO = "550"; /* mod id*/
      set PW0TM001.XWHCD cursor, bold; /* highlight field*/

    end
  else

    converseLib.validationFailed(341); /* required field, please enter*/
    TA1REC.TA1PGMNO = "550"; /* mod id*/
    set PW0TM001.XWHCD cursor, bold; /* highlight field*/

  end

   /* ------------------------------------------------------------*/
   /* verify total schedule for day.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PWDNBRSH < PW0TM001.PWCCAVTR[PW0TWIXM])
                                   /* tot sched < sched to*/

    converseLib.validationFailed(349); /* total schedules for day cannot be less than*/
                            /* schedule range in details*/
    TA1REC.TA1PGMNO = "550"; /* mod id*/
    set PW0TM001.PWDNBRSH cursor, bold; /* highlight field*/

  end

  if (PW0TM001.XWHCD == "51" /* Memphis apparel warehouse*/
   || PW0TM001.XWHCD == "04" /* Memphis footwear warehouse*/
   || PW0TM001.XWHCD == "07") /* Wilsonville warehouse*/
    if (PW0TM001.PWDNBRSH > 30) /* total sched for day > 30*/

      converseLib.validationFailed(503); /* total schedules for day cannot be > 50*/
      TA1REC.TA1PGMNO = "550"; /* mod id*/
      set PW0TM001.PWDNBRSH cursor, bold; /* highlight field*/

    end
  else
    if (PW0TM001.PWDNBRSH > 16) /* total sched for day > 16*/

      converseLib.validationFailed(392); /* total schedules for day cannot be > 16*/
      TA1REC.TA1PGMNO = "550"; /* mod id*/
      set PW0TM001.PWDNBRSH cursor, bold; /* highlight field*/

    end
  end
end // end PW0T550

// Verify no overlaps
Function PW0T560()
   /* ------------------------------------------------------------*/
   /* verify entered data against map.*/
   /* ------------------------------------------------------------*/

  PW0TW00.PW0TWIXD = 10; /* index for detail edits*/

  while (PW0TW00.PW0TWIXD > 0) /* until no more lines*/

    if (PW0TW00.PW0TWIXM != PW0TW00.PW0TWIXD)
                                   /* don't compare against itself*/
      if (PW0TM001.PW0TMACT[PW0TWIXD] != "D") /* or against future delete*/

        PW0T561(); /* verify no overlaps on current page*/

      end

    else

      /* ------------------------------------------------------------*/
       /* if lines equal, compare to display storage if 'A'dd.*/
      /* ------------------------------------------------------------*/

      if (PW0TM001.PW0TMACT[PW0TWIXM] == "A" /* if 'A'dd*/
       && PW0TW02.PKVSSPNB[PW0TWIXD] != 0)   /* and data in the line*/

        PW0T563(); /* verify no overlaps on same record*/

      end
    end

    PW0TW00.PW0TWIXD = PW0TW00.PW0TWIXD - 1; /* decrement line*/

  end

   /* ------------------------------------------------------------*/
   /* verify entered data against temporary storage.*/
   /* ------------------------------------------------------------*/

  PW0TW00.PW0TWIXT = 1; /* index for tsq pages*/

  while (PW0TW00.PW0TWIXT <= PW0TW00.TA5TSQIX) /* until no more tsq pages*/

    if (PW0TW00.PW0TWIXT != PW0TM001.XXXTSPAG) /* current page edited*/

      PW0TW00.XXXTSPAG = PW0TW00.PW0TWIXT; /* temporary page nbr*/

      PW0TS02(); /* read temporary storage page*/

      PW0TW00.PW0TWIXD = 1; /* index for dtl lines*/

      while (PW0TW00.PW0TWIXD <= 10) /* until end of line*/

        PW0T563(); /* verify no overlaps against page*/

        PW0TW00.PW0TWIXD = PW0TW00.PW0TWIXD + 1; /* increment line index*/

      end

    end

    PW0TW00.PW0TWIXT = PW0TW00.PW0TWIXT + 1; /* increment tsq page index*/

  end

  PW0TW00.XXXTSPAG = PW0TM001.XXXTSPAG; /* reset page nbr*/

   /* ------------------------------------------------------------*/
   /* read temporary storage with current page number to get*/
   /* current data in display storage.*/
   /* ------------------------------------------------------------*/

  if (PW0TW00.TA5TSQIX > 0) /* pages formatted*/

    PW0TS02(); /* read temporary storage*/

  end


end // end PW0T560

// Verify for overlaps on map
Function PW0T561()
   /* ------------------------------------------------------------*/
   /* verify destination range.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PWCDSTFR[PW0TWIXM] > " " /* if entered*/
   && PW0TM001.PWCDSTTH[PW0TWIXM] > " ") /* if entered*/

    if (PW0TM001.PKVSSPNB[PW0TWIXM] == PW0TM001.PKVSSPNB[PW0TWIXD])
      if (PW0TM001.TF1CARCD[PW0TWIXM] == PW0TM001.TF1CARCD[PW0TWIXD])

        PW0TS05(); /* verify dest range*/

      end
    else
      if (PW0TM001.TF1CARCD[PW0TWIXM] == PW0TM001.TF1CARCD[PW0TWIXD])

        PW0TS05(); /* verify dest range*/

      end
    end
  end
   /* ------------------------------------------------------------*/
   /* verify schedule range.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PWCCAVFR[PW0TWIXM] > 0 /* if entered*/
   && PW0TM001.PWCCAVTR[PW0TWIXM] > 0) /* if entered*/

    if (PW0TM001.PKVSSPNB[PW0TWIXM] == PW0TM001.PKVSSPNB[PW0TWIXD])

      /* next sentence*/

    else

      if (PW0TM001.TF1CARCD[PW0TWIXM] == PW0TM001.TF1CARCD[PW0TWIXD])

        PW0TS06(); /* verify schedule ranges*/

      end
    end
  end

   /* ------------------------------------------------------------*/
   /* check trailer number.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.TF1CARCD[PW0TWIXM] == PW0TM001.TF1CARCD[PW0TWIXD])
    if (PW0TM001.PKVSSPNB[PW0TWIXM] == PW0TM001.PKVSSPNB[PW0TWIXD])
      if (PW0TM001.PWCTLNBR[PW0TWIXM] == PW0TM001.PWCTLNBR[PW0TWIXD]
       && PW0TM001.PWCHLDFL[PW0TWIXM] != "Y")

        TA1REC.TA1PGMNO = "561"; /* mod id*/
        converseLib.validationFailed(338); /* trailer # must be unique*/
        set PW0TM001.PWCTLNBR[PW0TWIXM] cursor, bold; /* hightlight*/

      end
    end
  end

   /* ------------------------------------------------------------*/
   /* check for duplicates*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PKVSSPNB[PW0TWIXM] == PW0TM001.PKVSSPNB[PW0TWIXD]
   && PW0TM001.TF1CARCD[PW0TWIXM] == PW0TM001.TF1CARCD[PW0TWIXD]
   && PW0TM001.PWCCAVFR[PW0TWIXM] == PW0TM001.PWCCAVFR[PW0TWIXD]
   && PW0TM001.PWCCAVTR[PW0TWIXM] == PW0TM001.PWCCAVTR[PW0TWIXD])

    TA1REC.TA1PGMNO = "561"; /* mod id*/
    converseLib.validationFailed(282); /* duplicate record*/
    set PW0TM001.PKVSSPNB[PW0TWIXM] cursor, bold; /* hightlight*/
    set PW0TM001.TF1CARCD[PW0TWIXM] bold; /* hightlight*/
    set PW0TM001.PWCCAVFR[PW0TWIXM] bold; /* hightlight*/
    set PW0TM001.PWCCAVTR[PW0TWIXM] bold; /* hightlight*/

  end


   /* ------------------------------------------------------------*/
   /* last check for duplicates.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PKVSSPNB[PW0TWIXM] == PW0TM001.PKVSSPNB[PW0TWIXD]
   && PW0TM001.TF1CARCD[PW0TWIXM] == PW0TM001.TF1CARCD[PW0TWIXD]
   && PW0TM001.PWCTLNBR[PW0TWIXM] == PW0TM001.PWCTLNBR[PW0TWIXD]
   && PW0TM001.PWCCAVFR[PW0TWIXM] == PW0TM001.PWCCAVFR[PW0TWIXD]
   && PW0TM001.PWCCAVTR[PW0TWIXM] == PW0TM001.PWCCAVTR[PW0TWIXD]
   && PW0TM001.PWCDSTTH[PW0TWIXM] == PW0TM001.PWCDSTTH[PW0TWIXD]
   && PW0TM001.PWCDSTFR[PW0TWIXM] == PW0TM001.PWCDSTFR[PW0TWIXD]
   && PW0TM001.PWCHLDFL[PW0TWIXM] == PW0TM001.PWCHLDFL[PW0TWIXD])
    if (PW0TM001.PWCHLDFL[PW0TWIXM] == "Y")
      if (PW0TM001.PW0TMPYY[PW0TWIXM] == PW0TM001.PW0TMPYY[PW0TWIXD]
       && PW0TM001.PW0TMPDD[PW0TWIXM] == PW0TM001.PW0TMPDD[PW0TWIXD]
       && PW0TM001.PW0TMPMM[PW0TWIXM] == PW0TM001.PW0TMPMM[PW0TWIXD])

        TA1REC.TA1PGMNO = "561"; /* mod id*/
        converseLib.validationFailed(282); /* duplicate record*/
        PW0TS07(); /* highlight whole line*/

      end
    else

      TA1REC.TA1PGMNO = "561"; /* mod id*/
      converseLib.validationFailed(282); /* duplicate record*/
      PW0TS07(); /* highlight whole line*/

    end
  end


end // end PW0T561

// Verify overlaps on TSQ page
Function PW0T563()
   /* ------------------------------------------------------------*/
   /* verify destination range.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PWCDSTFR[PW0TWIXM] > " " /* if entered*/
   && PW0TM001.PWCDSTTH[PW0TWIXM] > " ") /* if entered*/

    if (PW0TM001.PKVSSPNB[PW0TWIXM] == PW0TW02.PKVSSPNB[PW0TWIXD])
      if (PW0TM001.TF1CARCD[PW0TWIXM] == PW0TW02.TF1CARCD[PW0TWIXD])

        PW0TS09(); /* verify dest range*/

      end
    else
      if (PW0TM001.TF1CARCD[PW0TWIXM] == PW0TW02.TF1CARCD[PW0TWIXD])

        PW0TS09(); /* verify dest range*/

      end
    end
  end
   /* ------------------------------------------------------------*/
   /* verify schedule range.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PWCCAVFR[PW0TWIXM] > 0 /* if entered*/
   && PW0TM001.PWCCAVTR[PW0TWIXM] > 0) /* if entered*/

    if (PW0TM001.PKVSSPNB[PW0TWIXM] == PW0TW02.PKVSSPNB[PW0TWIXD])

       /* next sentence*/

    else
      if (PW0TM001.TF1CARCD[PW0TWIXM] == PW0TW02.TF1CARCD[PW0TWIXD])

        PW0TS10(); /* verify schedule ranges*/

      end
    end
  end

   /* ------------------------------------------------------------*/
   /* check trailer number.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.TF1CARCD[PW0TWIXM] == PW0TW02.TF1CARCD[PW0TWIXD])
    if (PW0TM001.PKVSSPNB[PW0TWIXM] == PW0TW02.PKVSSPNB[PW0TWIXD])
      if (PW0TM001.PWCTLNBR[PW0TWIXM] == PW0TW02.PWCTLNBR[PW0TWIXD]
       && PW0TM001.PWCHLDFL[PW0TWIXM] != "Y"
       && PW0TW02.PWCHLDFL[PW0TWIXD] != "Y")

        TA1REC.TA1PGMNO = "563"; /* mod id*/
        converseLib.validationFailed(338); /* trailer # must be unique*/
        set PW0TM001.PWCTLNBR[PW0TWIXM] cursor, bold; /* hightlight*/

      end
    end
  end

   /* ------------------------------------------------------------*/
   /* check for duplicates*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PKVSSPNB[PW0TWIXM] == PW0TW02.PKVSSPNB[PW0TWIXD]
   && PW0TM001.TF1CARCD[PW0TWIXM] == PW0TW02.TF1CARCD[PW0TWIXD]
   && PW0TM001.PWCCAVFR[PW0TWIXM] == PW0TW02.PWCCAVFR[PW0TWIXD]
   && PW0TM001.PWCCAVTR[PW0TWIXM] == PW0TW02.PWCCAVTR[PW0TWIXD])

    TA1REC.TA1PGMNO = "563"; /* mod id*/
    converseLib.validationFailed(282); /* duplicate record*/
    set PW0TM001.PKVSSPNB[PW0TWIXM] cursor, bold; /* hightlight*/
    set PW0TM001.TF1CARCD[PW0TWIXM] bold; /* hightlight*/
    set PW0TM001.PWCCAVFR[PW0TWIXM] bold; /* hightlight*/
    set PW0TM001.PWCCAVTR[PW0TWIXM] bold; /* hightlight*/

  end



   /* ------------------------------------------------------------*/
   /* last check for duplicates.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PKVSSPNB[PW0TWIXM] == PW0TW02.PKVSSPNB[PW0TWIXD]
   && PW0TM001.TF1CARCD[PW0TWIXM] == PW0TW02.TF1CARCD[PW0TWIXD]
   && PW0TM001.PWCTLNBR[PW0TWIXM] == PW0TW02.PWCTLNBR[PW0TWIXD]
   && PW0TM001.PWCCAVFR[PW0TWIXM] == PW0TW02.PWCCAVFR[PW0TWIXD]
   && PW0TM001.PWCCAVTR[PW0TWIXM] == PW0TW02.PWCCAVTR[PW0TWIXD]
   && PW0TM001.PWCDSTTH[PW0TWIXM] == PW0TW02.PWCDSTTH[PW0TWIXD]
   && PW0TM001.PWCDSTFR[PW0TWIXM] == PW0TW02.PWCDSTFR[PW0TWIXD]
   && PW0TM001.PWCHLDFL[PW0TWIXM] == PW0TW02.PWCHLDFL[PW0TWIXD])
    if (PW0TM001.PWCHLDFL[PW0TWIXM] == "Y")
      if (PW0TM001.PW0TMPYY[PW0TWIXM] == PW0TW02.PW0TMPYY[PW0TWIXD]
       && PW0TM001.PW0TMPDD[PW0TWIXM] == PW0TW02.PW0TMPDD[PW0TWIXD]
       && PW0TM001.PW0TMPMM[PW0TWIXM] == PW0TW02.PW0TMPMM[PW0TWIXD])

        TA1REC.TA1PGMNO = "563"; /* mod id*/
        converseLib.validationFailed(282); /* duplicate record*/
        PW0TS07(); /* highlight whole line*/

      end
    else

      TA1REC.TA1PGMNO = "563"; /* mod id*/
      converseLib.validationFailed(282); /* duplicate record*/
      PW0TS07(); /* highlight whole line*/

    end
  end


end // end PW0T563

// Verify tot scheds on all pages
Function PW0T570()
   /* ------------------------------------------------------------*/
   /* verify entered data against temporary storage.*/
   /* ------------------------------------------------------------*/

  PW0TW00.PW0TWIXT = 1; /* index for tsq pages*/

  while (PW0TW00.PW0TWIXT <= PW0TW00.TA5TSQIX /* until no more tsq pages*/
   && converseVar.validationMsgNum == 0) /* and no errors found yet*/

    if (PW0TW00.PW0TWIXT != PW0TM001.XXXTSPAG) /* current page edited (skip)*/

      PW0TW00.XXXTSPAG = PW0TW00.PW0TWIXT; /* temporary page nbr*/

      PW0TS02(); /* read temporary storage page*/

      PW0TW00.PW0TWIXD = 1; /* index for dtl lines*/

      while (PW0TW00.PW0TWIXD <= 10 /* until end of line*/
       && converseVar.validationMsgNum == 0) /* and no errors found yet*/

        if (PW0TW02.TF1CARCD[PW0TWIXD] > " ") /* data on line*/

          if (PW0TM001.PWDNBRSH < PW0TW02.PWCCAVTR[PW0TWIXD])
                                   /* tot sched < sched to*/
            converseLib.validationFailed(463); /* invalid tot sched on other page*/
            TA1REC.TA1PGMNO = "570"; /* mod id*/
            set PW0TM001.PWDNBRSH cursor, bold; /* highlight field*/
          end

          if (PW0TW00.PW0TW-HDR-CHG-FL == "Y") /* Tot Sched for Day changed*/
                                               /* Carryover Scheds changed*/
                                               /* Rush Fr/To Sched changed*/
            PW0T571(); /* edit the from and thru sched*/
                                  /* against the header fields.*/
          end

        end

        PW0TW00.PW0TWIXD = PW0TW00.PW0TWIXD + 1; /* increment line index*/

      end

    end

    PW0TW00.PW0TWIXT = PW0TW00.PW0TWIXT + 1; /* increment tsq page index*/

  end

   /* -----------------------------------------------------------*/
   /* restore the original page to current data in display storage.*/
   /* -----------------------------------------------------------*/

  PW0TW00.XXXTSPAG = PW0TM001.XXXTSPAG; /* reset page nbr*/

  PW0TS02(); /* read temporary storage*/


end // end PW0T570

// Re-edit Sched Fr/To
Function PW0T571()
   /* ------------------------------------------------------------------*/
   /* re-edit the Schedule From and To range to make sure that*/
   /* with the change in Total Schedule for Day or Carryover*/
   /* Scheds or Rush Fr/To Scheds, this range is still valid.*/
   /* ------------------------------------------------------------------*/
  if (PW0TM001.PWCCAVFR[PW0TWIXD] > 0 /* if entered*/
   && PW0TM001.PWCCAVTR[PW0TWIXD] > 0)

    if (PW0TM001.PWCRSHFL[PW0TWIXD] == "Y") /* if rush schedule*/

      PW0TW00.PW0TWSTH = PW0TM001.PWDSCHTH; /* sched hold*/
      PW0TW00.PW0TWSFR = PW0TM001.PWDSCHFR; /* sched hold*/

      if (PW0TM001.PWCCAVTR[PW0TWIXD] > PW0TW00.PW0TWSTH)

        converseLib.validationFailed(343); /* rush schedule cannot exceed range*/
        TA1REC.TA1PGMNO = "530"; /* module id*/
        set PW0TM001.PWCCAVTR[PW0TWIXD] cursor, bold; /* highlight field*/

      end

      if (PW0TM001.PWCCAVFR[PW0TWIXD] < PW0TW00.PW0TWSFR)

        converseLib.validationFailed(343); /* rush schedule cannot exceed range*/
        TA1REC.TA1PGMNO = "530"; /* module id*/
        set PW0TM001.PWCCAVFR[PW0TWIXD] cursor, bold; /* highlight field*/

      end
    end

    if (PW0TM001.PWCCAVTR[PW0TWIXD] < PW0TM001.PWCCAVFR[PW0TWIXD])

      converseLib.validationFailed(133); /* from must be less than to*/
      TA1REC.TA1PGMNO = "530"; /* module id*/
      set PW0TM001.PWCCAVTR[PW0TWIXD] bold; /* highlight field*/
      set PW0TM001.PWCCAVFR[PW0TWIXD] cursor, bold; /* highlight field*/

    end

    if (PW0TM001.PWCCAVTR[PW0TWIXD] > PW0TM001.PWDNBRSH)

      converseLib.validationFailed(349); /* thru cannot be > total schedules*/
      TA1REC.TA1PGMNO = "530"; /* mod id*/
      set PW0TM001.PWCCAVTR[PW0TWIXD] bold; /* highlight field*/
      set PW0TM001.PWCCAVFR[PW0TWIXD] cursor, bold; /* highlight field*/

    end
  end
   /* ----------------------------------------------------------------*/
   /* for rush flag = 'Y' and the carryover scheds is > 0, check to*/
   /* make sure that the Sched Fr/To range is not crossing over to*/
   /* the carryover schedules*/
   /* ----------------------------------------------------------------*/
  if (PW0TM001.PWCRSHFL[PW0TWIXD] == "Y" /* rush flag*/
   && PW0TM001.PWDCOVSC > 0)            

    if (PW0TM001.PWCCAVFR[PW0TWIXD] != 0)

      if (PW0TM001.PWCCAVFR[PW0TWIXD] > 
      PW0TW00.PW0TWFCO) /* first carryover*/
        converseLib.validationFailed(506); /* sched range cannot cross over caovr*/
        TA1REC.TA1PGMNO = "530";
        set PW0TM001.PWCCAVFR[PW0TWIXD] bold;
      end

    end

    if (PW0TM001.PWCCAVTR[PW0TWIXD] >= PW0TW00.PW0TWFCO /* first caovr*/
     && PW0TM001.PWCCAVTR[PW0TWIXD] <= PW0TW00.PW0TWLCO) /* last caovr*/
      converseLib.validationFailed(506);
      TA1REC.TA1PGMNO = "530";
      set PW0TM001.PWCCAVFR[PW0TWIXD] bold;
    end

  end

end // end PW0T571

// Process valid request
Function PW0T600()
   /* ------------------------------------------------------------*/
   /* Indicate that the map must be formatted before display.*/
   /* ------------------------------------------------------------*/

  PW0TW00.PW0TWSWF = "Y"; /* Format the map switch*/

   /* ------------------------------------------------------------*/
   /* Update the modifiable data in the COMMAREA.*/
   /* ------------------------------------------------------------*/

  COMMAREA.XWHCD = PW0TM001.XWHCD; /* warehouse*/

   /* ------------------------------------------------------------*/
   /* If the search key was changed, save the search information.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.XWHCD != PW0TW01.XWHCD) /* warehouse changed*/

    /* ------------------------------------------------------------*/
     /* If a search key was entered, request the data to display.*/
     /* Otherwise, purge any existing pages from temporary storage.*/
    /* ------------------------------------------------------------*/

    if (PW0TM001.XWHCD > " ") /* warehouse was entered*/

      PW0TW00.PW0TWSWR = "Y"; /* Request for data switch*/

    else

      PW0TW00.PW0TWSWR = "N"; /* Request for data switch*/

      PW0T110(); /* Purge any temporary storage*/

    end

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If a scroll backward was requested, decrement the page*/
   /* number and return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf7) /* Scroll back requested*/

    PW0TW00.XXXTSPAG = PW0TW00.XXXTSPAG - 1; /* Decrement page number*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If a scroll forward was requested, increment the page*/
   /* number and return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf8) /* Scroll forward requested*/

    PW0TW00.XXXTSPAG = PW0TW00.XXXTSPAG + 1; /* Increment page number*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If fields changed, set header update switch to 'Y'.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.XWHCD != PW0TW01.XWHCD       /* warehouse*/
   || PW0TM001.PWDNBRSS != PW0TW01.PWDNBRSS /* number of spurs*/
   || PW0TM001.PWDRJTSS != PW0TW01.PWDRJTSS /* reject spur*/
   || PW0TM001.PWDDFPHS != PW0TW01.PWDDFPHS /* p & h spur*/
   || PW0TM001.PWDNBRSH != PW0TW01.PWDNBRSH /* number of schedule*/
   || PW0TM001.PWDMIPSH != PW0TW01.PWDMIPSH /* minutes/schedule*/
   || PW0TM001.PWDSCHFR != PW0TW01.PWDSCHFR /* rush schedule from*/
   || PW0TM001.PWDSCHTH != PW0TW01.PWDSCHTH /* rush schedule thru*/
   || PW0TM001.PWDCOVSC != PW0TW01.PWDCOVSC) /* carryover schedule*/

    PW0TS03(); /* Format map items to display storage*/

    PW0TW00.PW0TWHDU = "Y"; /* Header update switch*/

  end

  PW0TW00.PW0TWIXM = 1; /* Initialize line index*/

   /* ------------------------------------------------------------*/
   /* check authorization.*/
   /* ------------------------------------------------------------*/

  PW0TS08(); /* check change,delete,authorization*/

   /* ------------------------------------------------------------*/
   /* Obtain the current date and time.*/
   /* ------------------------------------------------------------*/

  XX0XS01(); /* Obtain date and time*/

  PW0TW00.PW0TMPCC = XX0XW01.XX0XW19; /* century*/

   /* ------------------------------------------------------------*/
   /* Update row in DPICK.VWVCTL02.*/
   /* ------------------------------------------------------------*/

  if (PW0TW00.PW0TWHDU == "Y") /* header update switch*/

    PW0T610(); /* Update DPICK.VWVCTL02*/
    PW0TW00.PW0TWHDU = "N"; /* header update switch*/

  end

   /* ------------------------------------------------------------*/
   /* Update, insert or delete row in DPICK.VCARRA02.*/
   /* ------------------------------------------------------------*/

  PW0TW00.PW0TWIXM = 1; /* map index*/

  while (PW0TW00.PW0TWIXM <= 10) /* until page processed*/

    if (PW0TM001.PW0TMACT[PW0TWIXM] == "A") /* add row in table*/

      PW0T620(); /* insert in DPICK.VCARRA02*/
      PW0TS04(); /* Format map items to display storage*/
                                   /* for updates*/
      PW0TW00.PW0TWSWR = "Y"; /* Request for data switch*/

    end

    if (PW0TM001.PW0TMACT[PW0TWIXM] == "D") /* delete row in table*/

      PW0T630(); /* delete record in DPICK.VCARRA02*/
      PW0TS04(); /* Format map items to display storage*/
                                   /* for updates*/
      PW0TW00.PW0TWSWR = "Y"; /* Request for data switch*/

    end

    if (PW0TM001.PW0TMACT[PW0TWIXM] == "C") /* update table*/

      PW0T630(); /* delete row in DPICK.VCARRA02*/
      PW0T620(); /* insert row in DPICK.VCARRA02*/
      PW0TS04(); /* Format map items to display storage*/
                                   /* for updates*/
      PW0TW00.PW0TWSWR = "Y"; /* Request for data switch*/

    end

    PW0TW00.PW0TWIXM = PW0TW00.PW0TWIXM + 1; /* Increment line index*/

  end


   /* ------------------------------------------------------------*/
   /* Commit all changes made to protected resources.*/
   /* ------------------------------------------------------------*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.commit(); /* Commit all changes*/


end // end PW0T600

// Update DPICK.VWVCTL01
Function PW0T610()
   /* ------------------------------------------------------------*/
   /* Format the data from the map in the table row.*/
   /* ------------------------------------------------------------*/

  VWVCTL02.XWHCD = PW0TW01.XWHCD; /* warehouse code*/
  VWVCTL02.PKURUNMD = "P"; /* run mode*/
  VWVCTL02.PWDNBRSS = PW0TW01.PWDNBRSS; /* nbr spur*/
  VWVCTL02.PWDDFPHS = PW0TW01.PWDDFPHS; /* default spur*/
  VWVCTL02.PWDRJTSS = PW0TW01.PWDRJTSS; /* reject spur*/
  VWVCTL02.PWDNBRSH = PW0TW01.PWDNBRSH; /* total schedule*/
  VWVCTL02.PWDSCHFR = PW0TW01.PWDSCHFR; /* schedule from*/
  VWVCTL02.PWDSCHTH = PW0TW01.PWDSCHTH; /* schedule thru*/
  VWVCTL02.PWDMIPSH = PW0TW01.PWDMIPSH; /* minutes/schedule*/
  VWVCTL02.PWDCOVSC = PW0TW01.PWDCOVSC; /* carryover schedule*/
  VWVCTL02.ZZZCHGDT = XX0XW01.XX0XWDAT; /* Change date*/
  VWVCTL02.ZZZCHGTM = XX0XW01.XX0XWTIM; /* Change time*/

   /* ------------------------------------------------------------*/
   /* Update the changed row in the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VWVCTL02" ("U ", SQLCA, VWVCTL02) {isNoRefresh = yes, isExternal = yes};
  end /* Update row*/

   /* ------------------------------------------------------------*/
   /* If successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/

      PW0TW00.PW0TWMSG = 32; /* update successful*/
      TA1REC.TA1PGMNO = "610"; /* module id*/
      return; /* Return to previous process*/

    end

    /* ------------------------------------------------------------*/
     /* If row not found, indicate the data was updated by another.*/
    /* ------------------------------------------------------------*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Row not found*/

      VGVar.handleSysLibraryErrors = 0;
      sysLib.rollback(); /* Roll back all changes*/

      PW0TW00.PW0TWSWF = "N"; /* format the map switch*/

      TA1REC.TA1PGMNO = "610"; /* Module identification*/
      converseLib.validationFailed(263); /* Data was updated by another*/

      exit stack; /* Exit to display map*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(28); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(29); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "UPDATE THE TABLE ROW";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = "610"; /* Program number*/
  TA1REC.TA1DBASE = "DPICK   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VWVCTL02"; /* Table view name*/
  TA1REC.TA1TBLKE = VWVCTL02.VWVCTL02-GROUP; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end PW0T610

// Insert row in DPICK.VCARRA02
Function PW0T620()
   /* ------------------------------------------------------------*/
   /* Format the data from the map in the table row.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PWCHLDFL[PW0TWIXM] == " ") /* no flag entered*/
    PW0TM001.PWCHLDFL[PW0TWIXM] = "N"; /* default to 'N'*/
  end
  if (PW0TM001.PWCRSHFL[PW0TWIXM] == " ") /* no flag entered*/
    PW0TM001.PWCRSHFL[PW0TWIXM] = "N"; /* default to 'N'*/
  end

  VCARRA02.XWHCD = PW0TW01.XWHCD; /* warehouse code*/
  VCARRA02.PKURUNMD = "P"; /* pk run mode*/
  VCARRA02.PKVSSPNB = PW0TM001.PKVSSPNB[PW0TWIXM]; /* spur number*/
  VCARRA02.TF1CARCD = PW0TM001.TF1CARCD[PW0TWIXM]; /* carrier code*/
  VCARRA02.PWCHLDFL = PW0TM001.PWCHLDFL[PW0TWIXM]; /* p & h flag*/
  VCARRA02.PWCRSHFL = PW0TM001.PWCRSHFL[PW0TWIXM]; /* rush flag*/
  VCARRA02.PWCCAVFR = PW0TM001.PWCCAVFR[PW0TWIXM]; /* schedule from*/
  VCARRA02.PWCCAVTR = PW0TM001.PWCCAVTR[PW0TWIXM]; /* schedule thru*/
  VCARRA02.PWCTLNBR = PW0TM001.PWCTLNBR[PW0TWIXM]; /* trailer number*/
  VCARRA02.XTRCD = PW0TM001.XTRCD[PW0TWIXM]; /* trailer type*/
  VCARRA02.PWCDSTFR = PW0TM001.PWCDSTFR[PW0TWIXM]; /* dest from*/
  VCARRA02.PWCDSTTH = PW0TM001.PWCDSTTH[PW0TWIXM]; /* dest thru*/
  VCARRA02.PWCCOVFT = 0; /* carryover cubic feet*/

  PW0TW00.PW0TMPMM = PW0TM001.PW0TMPMM[PW0TWIXM]; /* month*/
  PW0TW00.PW0TMPDD = PW0TM001.PW0TMPDD[PW0TWIXM]; /* day*/
  PW0TW00.PW0TMPYY = PW0TM001.PW0TMPYY[PW0TWIXM]; /* year*/
   /*  */
   /* ----------------- y2k out begin -------------------*/
   /*  */
   /* MOVE XX0XW01.XX0XW19 TO PW0TW00.PW0TMPCC;*/
   /*  */
   /* ----------------- y2k out end ---------------------*/
   /*  */
   /*  */
   /* ----------------- y2k in begin --------------------*/
   /*  */
  if (PW0TM001.PW0TMPYY[PW0TWIXM] > 60)
    PW0TW00.PW0TMPCC = 19;
  else
    PW0TW00.PW0TMPCC = 20;
  end
   /*  */
   /* ----------------- y2k in end  ---------------------*/
   /*  */

  if (PW0TM001.PWCHLDFL[PW0TWIXM] == "N")
    PW0TW00.PW0TMDAT = 0;
  end

  VCARRA02.PWCPHDSB = PW0TW00.PW0TMDAT; /* p & h date*/

  VCARRA02.ZZZCHGDT = XX0XW01.XX0XWDAT; /* Change date*/
  VCARRA02.ZZZCHGTM = XX0XW01.XX0XWTIM; /* Change time*/

   /* ------------------------------------------------------------*/
   /* Insert row in the table.*/
   /* ------------------------------------------------------------*/

  try
    call "VCARRA02" ("A ", SQLCA, VCARRA02) {isNoRefresh = yes, isExternal = yes};
  end /* insert row*/

   /* ------------------------------------------------------------*/
   /* If successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/

      PW0TW00.PW0TWMSG = 32; /* updates successful*/
      TA1REC.TA1PGMNO = "620"; /* mod id*/
      return; /* Return to previous process*/

    end

    /* ------------------------------------------------------------*/
     /* If row not found, indicate the data was updated by another.*/
    /* ------------------------------------------------------------*/

    if (SQLCA.VAGen_SQLCODE == -803) /* Row already exists*/

      VGVar.handleSysLibraryErrors = 0;
      sysLib.rollback(); /* Roll back all changes*/

      PW0TW00.PW0TWSWF = "N"; /* format the map switch*/

      TA1REC.TA1PGMNO = "620"; /* Module identification*/
      converseLib.validationFailed(263); /* Data was updated by another*/
      set PW0TM001.PW0TMACT[PW0TWIXM] cursor, bold; /* highlight*/

      exit stack; /* Exit to display map*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(28); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(29); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "INSERT THE TABLE ROW";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = "620"; /* Program number*/
  TA1REC.TA1DBASE = "DPICK   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VCARRA02"; /* Table view name*/
  TA1REC.TA1TBLKE = VCARRA02.VCARRA02-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end PW0T620

// Delete row in DPICK.VCARRA02
Function PW0T630()
   /* ------------------------------------------------------------*/
   /* Format the data from the map in the table row.*/
   /* ------------------------------------------------------------*/

  VCARRA02.XWHCD = PW0TW01.XWHCD; /* warehouse code*/
  VCARRA02.PKURUNMD = "P"; /* pk run mode*/
  VCARRA02.PKVSSPNB = PW0TW02.PKVSSPNB[PW0TWIXM]; /* spur number*/
  VCARRA02.TF1CARCD = PW0TW02.TF1CARCD[PW0TWIXM]; /* carrier code*/
  VCARRA02.PWCHLDFL = PW0TW02.PWCHLDFL[PW0TWIXM]; /* p & h flag*/
  VCARRA02.PWCCAVFR = PW0TW02.PWCCAVFR[PW0TWIXM]; /* schedule from*/
  VCARRA02.PWCCAVTR = PW0TW02.PWCCAVTR[PW0TWIXM]; /* schedule thru*/
  VCARRA02.PWCRSHFL = PW0TW02.PWCRSHFL[PW0TWIXM]; /* rush flag*/
  VCARRA02.PWCTLNBR = PW0TW02.PWCTLNBR[PW0TWIXM]; /* trailer number*/
  VCARRA02.PWCDSTFR = PW0TW02.PWCDSTFR[PW0TWIXM]; /* dest from*/
  VCARRA02.PWCDSTTH = PW0TW02.PWCDSTTH[PW0TWIXM]; /* dest thru*/
  PW0TW00.PW0TMPMM = PW0TW02.PW0TMPMM[PW0TWIXM];
  PW0TW00.PW0TMPDD = PW0TW02.PW0TMPDD[PW0TWIXM];
  PW0TW00.PW0TMPYY = PW0TW02.PW0TMPYY[PW0TWIXM];
   /*  */
   /* ------------- y2k out begin ---------------*/
   /*  */
   /* MOVE XX0XW01.XX0XW19 TO PW0TW00.PW0TMPCC;*/
   /*  */
   /* ------------- y2k out end -----------------*/
   /*  */
   /*  */
   /* ------------- y2k in begin ----------------*/
   /*  */
  if (PW0TW02.PW0TMPYY[PW0TWIXM] > 60)
    PW0TW00.PW0TMPCC = 19;
  else
    PW0TW00.PW0TMPCC = 20;
  end
   /*  */
   /* ------------- y2k in end  -----------------*/
   /*  */

  if (PW0TW02.PWCHLDFL[PW0TWIXM] == "N")
    PW0TW00.PW0TMDAT = 0;
  end

  VCARRA02.PWCPHDSB = PW0TW00.PW0TMDAT; /* date*/

  try
    call "VCARRA02" ("D ", SQLCA, VCARRA02) {isNoRefresh = yes, isExternal = yes};
  end /* delete row*/

   /* ------------------------------------------------------------*/
   /* If successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/

      PW0TW00.PW0TWMSG = 32; /* update successful*/
      TA1REC.TA1PGMNO = "630"; /* mod id*/
      return; /* Return to previous process*/

    end

    /* ------------------------------------------------------------*/
     /* If row not found, indicate the data was updated by another.*/
    /* ------------------------------------------------------------*/

    if (SQLCA.VAGen_SQLCODE == 100) /* Row already exists*/

      VGVar.handleSysLibraryErrors = 0;
      sysLib.rollback(); /* Roll back all changes*/

      PW0TW00.PW0TWSWF = "N"; /* format the map switch*/

      TA1REC.TA1PGMNO = "630"; /* Module identification*/
      converseLib.validationFailed(211); /* record not found for delete*/
      set PW0TM001.PW0TMACT[PW0TWIXM] cursor, bold; /* highlight*/

      exit stack; /* Exit to display map*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(28); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(29); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1LOC = "DELETE THE TABLE ROW";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = "630"; /* Program number*/
  TA1REC.TA1DBASE = "DPICK   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VCARRA02"; /* Table view name*/
  TA1REC.TA1TBLKE = VCARRA02.VCARRA02-KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end PW0T630

// Read temporary storage page
Function PW0TS02()
   /* ------------------------------------------------------------*/
   /* Obtain the next page of data to display.*/
   /* ------------------------------------------------------------*/

  PW0TW02.XXXTSLEN = PW0TW00.XXXTSLEN; /* Temporary storage length*/

  TA5REC.TA5APPID = COMMAREA.CACURRAP; /* Application identification*/
  TA5REC.TA5TSQIX = PW0TW00.XXXTSPAG; /* Page number*/
  TA5REC.TA5FNCCD = "R"; /* Function code*/

  try
    call "TA0050" (PW0TW02, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Temporary storage*/

   /* ------------------------------------------------------------*/
   /* If successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA5REC.TA5RTNCD == 0)          /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TAEREC.TAEDESC1 = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC2 = TA5REC.TA5DATA; /* Subroutine parameters*/

  converseLib.validationFailed(29); /* Unexpected error occurred*/

  TA1REC.TA1FUNC = "RETN"; /* Termination function*/
  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1LOC = "READ PAGE FROM TEMPORARY STORAGE";
  TA1REC.TA1PGMAP = COMMAREA.CACURRAP; /* Program application*/
  TA1REC.TA1PGMNO = "S02"; /* Program number*/
  TA1REC.TA1MAPAP = COMMAREA.CACURRAP; /* Map application*/
  TA1REC.TA1MAPNO = "M001"; /* Map number*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end PW0TS02

// Format header changes to D.S.
Function PW0TS03()
   /* ------------------------------------------------------------*/
   /* Format header changes in display storage for updates.*/
   /* ------------------------------------------------------------*/

  PW0TW01.XWHCD = PW0TM001.XWHCD; /* warehouse*/
  PW0TW01.PWDNBRSS = PW0TM001.PWDNBRSS; /* number of spurs*/
  PW0TW01.PWDRJTSS = PW0TM001.PWDRJTSS; /* reject spur*/
  PW0TW01.PWDDFPHS = PW0TM001.PWDDFPHS; /* p & h spur*/
  PW0TW01.PWDNBRSH = PW0TM001.PWDNBRSH; /* number of schedule*/
  PW0TW01.PWDMIPSH = PW0TM001.PWDMIPSH; /* minutes/schedule*/
  PW0TW01.PWDSCHFR = PW0TM001.PWDSCHFR; /* rush schedule from*/
  PW0TW01.PWDSCHTH = PW0TM001.PWDSCHTH; /* rush schedule thru*/
  PW0TW01.PWDCOVSC = PW0TM001.PWDCOVSC; /* carryover schedule*/


end // end PW0TS03

// Format detail changes to D.S.
Function PW0TS04()
   /* ------------------------------------------------------------*/
   /* Format detail changes to display storage for update in t.s.*/
   /* ------------------------------------------------------------*/

  PW0TW02.PW0TMACT[PW0TWIXM] = " ";
  PW0TW02.PKVSSPNB[PW0TWIXM] = PW0TM001.PKVSSPNB[PW0TWIXM];
  PW0TW02.TF1CARCD[PW0TWIXM] = PW0TM001.TF1CARCD[PW0TWIXM];
  PW0TW02.TF1ABRV[PW0TWIXM] = PW0TM001.TF1ABRV[PW0TWIXM];
  PW0TW02.PWCCAVFR[PW0TWIXM] = PW0TM001.PWCCAVFR[PW0TWIXM];
  PW0TW02.PWCCAVTR[PW0TWIXM] = PW0TM001.PWCCAVTR[PW0TWIXM];
  PW0TW02.PWCDSTFR[PW0TWIXM] = PW0TM001.PWCDSTFR[PW0TWIXM];
  PW0TW02.PWCDSTTH[PW0TWIXM] = PW0TM001.PWCDSTTH[PW0TWIXM];
  PW0TW02.PWCTLNBR[PW0TWIXM] = PW0TM001.PWCTLNBR[PW0TWIXM];
  PW0TW02.XTRCD[PW0TWIXM] = PW0TM001.XTRCD[PW0TWIXM];
  PW0TW02.PWCRSHFL[PW0TWIXM] = PW0TM001.PWCRSHFL[PW0TWIXM];
  PW0TW02.PWCHLDFL[PW0TWIXM] = PW0TM001.PWCHLDFL[PW0TWIXM];
  PW0TW02.PW0TMPMM[PW0TWIXM] = PW0TM001.PW0TMPMM[PW0TWIXM];
  PW0TW02.PW0TMPDD[PW0TWIXM] = PW0TM001.PW0TMPDD[PW0TWIXM];
  PW0TW02.PW0TMPYY[PW0TWIXM] = PW0TM001.PW0TMPYY[PW0TWIXM];


end // end PW0TS04

// Verify dest range on map
Function PW0TS05()
   /* ------------------------------------------------------------*/
   /* verify destination range.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PWCDSTTH[PW0TWIXD] == " " /* blank dest thru*/
   && PW0TM001.PWCDSTFR[PW0TWIXD] == " ") /* blank dest from*/

    return; /* return to calling process*/

  end

  if (PW0TM001.PWCDSTTH[PW0TWIXM] > PW0TM001.PWCDSTTH[PW0TWIXD]
   && PW0TM001.PWCDSTTH[PW0TWIXM] > PW0TM001.PWCDSTFR[PW0TWIXD])
     /* next sentence*/
  else
    if (PW0TM001.PWCDSTTH[PW0TWIXM] < PW0TM001.PWCDSTTH[PW0TWIXD]
     && PW0TM001.PWCDSTTH[PW0TWIXM] < PW0TM001.PWCDSTFR[PW0TWIXD])
       /* next sentence*/
    else

      TA1REC.TA1PGMNO = "S05"; /* module id*/
      converseLib.validationFailed(350); /* destination overlap*/
      set PW0TM001.PWCDSTTH[PW0TWIXM] cursor, bold; /* highlight*/

    end
  end

  if (PW0TM001.PWCDSTFR[PW0TWIXM] > PW0TM001.PWCDSTFR[PW0TWIXD]
   && PW0TM001.PWCDSTFR[PW0TWIXM] > PW0TM001.PWCDSTTH[PW0TWIXD])
     /* next sentence*/
  else
    if (PW0TM001.PWCDSTFR[PW0TWIXM] < PW0TM001.PWCDSTFR[PW0TWIXD]
     && PW0TM001.PWCDSTFR[PW0TWIXM] < PW0TM001.PWCDSTTH[PW0TWIXD])
       /* next sentence*/
    else

      TA1REC.TA1PGMNO = "S05"; /* module id*/
      converseLib.validationFailed(350); /* destination overlap*/
      set PW0TM001.PWCDSTFR[PW0TWIXM] cursor, bold; /* highlight*/

    end
  end

  if (PW0TM001.PWCDSTFR[PW0TWIXM] < PW0TM001.PWCDSTFR[PW0TWIXD]
   && PW0TM001.PWCDSTTH[PW0TWIXM] > PW0TM001.PWCDSTTH[PW0TWIXD])

    TA1REC.TA1PGMNO = "S05"; /* module id*/
    converseLib.validationFailed(350); /* destination overlap*/
    set PW0TM001.PWCDSTFR[PW0TWIXM] cursor, bold; /* highlight*/
    set PW0TM001.PWCDSTTH[PW0TWIXM] bold; /* highlight*/

  end


end // end PW0TS05

// Verify schedule range on map
Function PW0TS06()
   /* ------------------------------------------------------------*/
   /* verify schedule range.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PWCHLDFL[PW0TWIXM] == "Y"
   || PW0TM001.PWCHLDFL[PW0TWIXD] == "Y")
    return; /* return to calling process*/
  end

  if (PW0TM001.PWCCAVTR[PW0TWIXM] > PW0TM001.PWCCAVTR[PW0TWIXD]
   && PW0TM001.PWCCAVTR[PW0TWIXM] > PW0TM001.PWCCAVFR[PW0TWIXD])
     /* next sentence*/
  else
    if (PW0TM001.PWCCAVTR[PW0TWIXM] < PW0TM001.PWCCAVTR[PW0TWIXD]
     && PW0TM001.PWCCAVTR[PW0TWIXM] < PW0TM001.PWCCAVFR[PW0TWIXD])
       /* next sentence*/
    else
      if (PW0TM001.PKVSSPNB[PW0TWIXM] != PW0TM001.PKVSSPNB[PW0TWIXD]
       && PW0TM001.PWCTLNBR[PW0TWIXM] != PW0TM001.PWCTLNBR[PW0TWIXD])
        /* next sentence*/
      else

        TA1REC.TA1PGMNO = "S06"; /* module id*/
        converseLib.validationFailed(282); /* schedule overlap*/
        set PW0TM001.PWCCAVTR[PW0TWIXM] cursor, bold; /* highlight*/

      end
    end
  end

  if (PW0TM001.PWCCAVFR[PW0TWIXM] > PW0TM001.PWCCAVFR[PW0TWIXD]
   && PW0TM001.PWCCAVFR[PW0TWIXM] > PW0TM001.PWCCAVTR[PW0TWIXD])
     /* next sentence*/
  else
    if (PW0TM001.PWCCAVFR[PW0TWIXM] < PW0TM001.PWCCAVFR[PW0TWIXD]
     && PW0TM001.PWCCAVFR[PW0TWIXM] < PW0TM001.PWCCAVTR[PW0TWIXD])
    else
       /* next sentence*/
      if (PW0TM001.PKVSSPNB[PW0TWIXM] != PW0TM001.PKVSSPNB[PW0TWIXD]
       && PW0TM001.PWCTLNBR[PW0TWIXM] != PW0TM001.PWCTLNBR[PW0TWIXD])
        /* next sentence*/
      else

        TA1REC.TA1PGMNO = "S06"; /* module id*/
        converseLib.validationFailed(282); /* schedule overlap*/
        set PW0TM001.PWCCAVFR[PW0TWIXM] cursor, bold; /* highlight*/

      end
    end
  end

  if (PW0TM001.PWCCAVFR[PW0TWIXM] < PW0TM001.PWCCAVFR[PW0TWIXD]
   && PW0TM001.PWCCAVTR[PW0TWIXM] > PW0TM001.PWCCAVTR[PW0TWIXD])
    if (PW0TM001.PKVSSPNB[PW0TWIXM] != PW0TM001.PKVSSPNB[PW0TWIXD]
     && PW0TM001.PWCTLNBR[PW0TWIXM] != PW0TM001.PWCTLNBR[PW0TWIXD])
        /* next sentence*/
    end

    TA1REC.TA1PGMNO = "S06"; /* module id*/
    converseLib.validationFailed(282); /* schedule overlap*/
    set PW0TM001.PWCCAVFR[PW0TWIXM] cursor, bold; /* highlight*/
    set PW0TM001.PWCCAVTR[PW0TWIXM] bold; /* highlight*/

  end


end // end PW0TS06

// Highlight whole line
Function PW0TS07()
   /* ------------------------------------------------------------*/
   /* highlight whole line.*/
   /* ------------------------------------------------------------*/

  set PW0TM001.PW0TMACT[PW0TWIXM] cursor, bold; /* highlight*/
  set PW0TM001.PKVSSPNB[PW0TWIXM] bold;
  set PW0TM001.TF1CARCD[PW0TWIXM] bold;
  set PW0TM001.PWCTLNBR[PW0TWIXM] bold;
  set PW0TM001.PWCCAVFR[PW0TWIXM] bold;
  set PW0TM001.PWCCAVTR[PW0TWIXM] bold;
  set PW0TM001.PWCCAVTR[PW0TWIXM] bold;
  set PW0TM001.PWCDSTFR[PW0TWIXM] bold;
  set PW0TM001.PWCDSTTH[PW0TWIXM] bold;
  set PW0TM001.PWCRSHFL[PW0TWIXM] bold;
  set PW0TM001.PWCHLDFL[PW0TWIXM] bold;
  set PW0TM001.PW0TMPYY[PW0TWIXM] bold;
  set PW0TM001.PW0TMPDD[PW0TWIXM] bold;
  set PW0TM001.PW0TMPMM[PW0TWIXM] bold;


end // end PW0TS07

// Check authorization
Function PW0TS08()
   /* ------------------------------------------------------------*/
   /* check add authorization.*/
   /* ------------------------------------------------------------*/

  if (COMMAREA.CAADDFL != "Y" /* no add authorization*/
   && "A" in PW0TM001.PW0TMACT) /* and add requested*/

    converseLib.validationFailed(275); /* not authorized for add*/
    TA1REC.TA1PGMNO = "S08"; /* mod id*/
    PW0TW00.PW0TWSWF = "N"; /* format the map switch*/
    set PW0TM001.PW0TMACT[sysVar.arrayIndex] cursor, bold; /* highlight*/
    exit stack; /* exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* check change authorization.*/
   /* ------------------------------------------------------------*/

  if (COMMAREA.CACHGFL != "Y") /* no chg authorization*/
    if ("C" in PW0TM001.PW0TMACT /* if chg requested*/
     || PW0TW00.PW0TWHDU == "Y") /* header changed*/

      if ("C" in PW0TM001.PW0TMACT) /* if chg requested*/
        set PW0TM001.PW0TMACT[sysVar.arrayIndex] cursor, bold; /* highlight*/
      end

      converseLib.validationFailed(275); /* not authorized for change*/
      TA1REC.TA1PGMNO = "S08"; /* mod id*/
      PW0TW00.PW0TWSWF = "N"; /* format the map switch*/
      exit stack; /* exit to display map*/

    end
  end

   /* ------------------------------------------------------------*/
   /* check delete authorization.*/
   /* ------------------------------------------------------------*/

  if (COMMAREA.CADELFL != "Y" /* no delete authorization*/
   && "D" in PW0TM001.PW0TMACT) /* and delete requested*/

    converseLib.validationFailed(275); /* not authorized for delete*/
    TA1REC.TA1PGMNO = "S08"; /* mod id*/
    PW0TW00.PW0TWSWF = "N"; /* format the map switch*/
    set PW0TM001.PW0TMACT[sysVar.arrayIndex] cursor, bold; /* highlight*/
    exit stack; /* exit to display map*/

  end


end // end PW0TS08

// Verify dest range on TSQ page
Function PW0TS09()
   /* ------------------------------------------------------------*/
   /* verify destination range.*/
   /* ------------------------------------------------------------*/

  if (PW0TW02.PWCDSTTH[PW0TWIXD] == " " /* blank dest thru*/
   && PW0TW02.PWCDSTFR[PW0TWIXD] == " ") /* blank dest from*/

    return; /* return to calling process*/

  end

  if (PW0TM001.PWCDSTTH[PW0TWIXM] > PW0TW02.PWCDSTTH[PW0TWIXD]
   && PW0TM001.PWCDSTTH[PW0TWIXM] > PW0TW02.PWCDSTFR[PW0TWIXD])
     /* next sentence*/
  else
    if (PW0TM001.PWCDSTTH[PW0TWIXM] < PW0TW02.PWCDSTTH[PW0TWIXD]
     && PW0TM001.PWCDSTTH[PW0TWIXM] < PW0TW02.PWCDSTFR[PW0TWIXD])
       /* next sentence*/
    else

      TA1REC.TA1PGMNO = "S09"; /* module id*/
      converseLib.validationFailed(350); /* destination overlap*/
      set PW0TM001.PWCDSTTH[PW0TWIXM] cursor, bold; /* highlight*/

    end
  end

  if (PW0TM001.PWCDSTFR[PW0TWIXM] > PW0TW02.PWCDSTFR[PW0TWIXD]
   && PW0TM001.PWCDSTFR[PW0TWIXM] > PW0TW02.PWCDSTTH[PW0TWIXD])
     /* next sentence*/
  else
    if (PW0TM001.PWCDSTFR[PW0TWIXM] < PW0TW02.PWCDSTFR[PW0TWIXD]
     && PW0TM001.PWCDSTFR[PW0TWIXM] < PW0TW02.PWCDSTTH[PW0TWIXD])
       /* next sentence*/
    else

      TA1REC.TA1PGMNO = "S09"; /* module id*/
      converseLib.validationFailed(350); /* destination overlap*/
      set PW0TM001.PWCDSTFR[PW0TWIXM] cursor, bold; /* highlight*/

    end
  end

  if (PW0TM001.PWCDSTFR[PW0TWIXM] < PW0TW02.PWCDSTFR[PW0TWIXD]
   && PW0TM001.PWCDSTTH[PW0TWIXM] > PW0TW02.PWCDSTTH[PW0TWIXD])

    TA1REC.TA1PGMNO = "S09"; /* module id*/
    converseLib.validationFailed(350); /* destination overlap*/
    set PW0TM001.PWCDSTFR[PW0TWIXM] cursor, bold; /* highlight*/
    set PW0TM001.PWCDSTTH[PW0TWIXM] bold; /* highlight*/

  end


end // end PW0TS09

// Verify sched range on TSQ page
Function PW0TS10()
   /* ------------------------------------------------------------*/
   /* verify schedule range.*/
   /* ------------------------------------------------------------*/

  if (PW0TM001.PWCHLDFL[PW0TWIXM] == "Y"
   || PW0TW02.PWCHLDFL[PW0TWIXD] == "Y")
    return; /* return to calling process*/
  end

  if (PW0TM001.PWCCAVTR[PW0TWIXM] > PW0TW02.PWCCAVTR[PW0TWIXD]
   && PW0TM001.PWCCAVTR[PW0TWIXM] > PW0TW02.PWCCAVFR[PW0TWIXD])
     /* next sentence*/
  else
    if (PW0TM001.PWCCAVTR[PW0TWIXM] < PW0TW02.PWCCAVTR[PW0TWIXD]
     && PW0TM001.PWCCAVTR[PW0TWIXM] < PW0TW02.PWCCAVFR[PW0TWIXD])
    else
       /* next sentence*/
      if (PW0TM001.PWCTLNBR[PW0TWIXM] != PW0TW02.PWCTLNBR[PW0TWIXD]
       && PW0TM001.PKVSSPNB[PW0TWIXM] != PW0TW02.PKVSSPNB[PW0TWIXD])
        /* next sentence*/
      else

        TA1REC.TA1PGMNO = "S10"; /* module id*/
        converseLib.validationFailed(282); /* schedule overlap*/
        set PW0TM001.PWCCAVTR[PW0TWIXM] cursor, bold; /* highlight*/

      end
    end
  end

  if (PW0TM001.PWCCAVFR[PW0TWIXM] > PW0TW02.PWCCAVFR[PW0TWIXD]
   && PW0TM001.PWCCAVFR[PW0TWIXM] > PW0TW02.PWCCAVTR[PW0TWIXD])
     /* next sentence*/
  else
    if (PW0TM001.PWCCAVFR[PW0TWIXM] < PW0TW02.PWCCAVFR[PW0TWIXD]
     && PW0TM001.PWCCAVFR[PW0TWIXM] < PW0TW02.PWCCAVTR[PW0TWIXD])
       /* next sentence*/
    else
      if (PW0TM001.PWCTLNBR[PW0TWIXM] != PW0TW02.PWCTLNBR[PW0TWIXD]
       && PW0TM001.PKVSSPNB[PW0TWIXM] != PW0TW02.PKVSSPNB[PW0TWIXD])
        /* next sentence*/
      else

        TA1REC.TA1PGMNO = "S10"; /* module id*/
        converseLib.validationFailed(282); /* schedule overlap*/
        set PW0TM001.PWCCAVFR[PW0TWIXM] cursor, bold; /* highlight*/

      end
    end
  end

  if (PW0TM001.PWCCAVFR[PW0TWIXM] < PW0TW02.PWCCAVFR[PW0TWIXD]
   && PW0TM001.PWCCAVTR[PW0TWIXM] > PW0TW02.PWCCAVTR[PW0TWIXD])
    if (PW0TM001.PWCTLNBR[PW0TWIXM] != PW0TW02.PWCTLNBR[PW0TWIXD]
     && PW0TM001.PKVSSPNB[PW0TWIXM] != PW0TW02.PKVSSPNB[PW0TWIXD])
       /* next sentence*/
    end

    TA1REC.TA1PGMNO = "S10"; /* module id*/
    converseLib.validationFailed(282); /* schedule overlap*/
    set PW0TM001.PWCCAVFR[PW0TWIXM] cursor, bold; /* highlight*/
    set PW0TM001.PWCCAVTR[PW0TWIXM] bold; /* highlight*/

  end


end // end PW0TS10

//*** RECORD=PW0TW00 ****
// ----------------------------
// Application working storage.
// ----------------------------
// ***********************
Record PW0TW00 type basicRecord
  10 PW0TWIXM PW0TWIXM ; 
  10 PW0TWIXD PW0TWIXD ; 
  10 PW0TWIXT PW0TWIXT ; 
  10 PW0TWNHD PW0TWNHD ; 
  10 PW0TWSC1 PW0TWSC1 ; 
  10 PW0TWMSG PW0TWMSG ; 
  10 PW0TWSWF PW0TWSWF ; 
  10 PW0TWSWR PW0TWSWR ; 
  10 PW0TWSWU PW0TWSWU ; 
  10 PW0TWHDU PW0TWHDU ; 
  10 XXXTSLEN XXXTSLEN ; 
  10 XXXTSPAG XXXTSPAG ; 
  10 TA5TSQIX TA5TSQIX ; 
  10 PW0TWMPH PW0TWMPH ; 
    15 PW0TWPCC PW0TWPCC ; 
    15 PW0TWPYY PW0TWPYY ; 
    15 PW0TWPMM PW0TWPMM ; 
    15 PW0TWPDD PW0TWPDD ; 
  10 PW0TMDAT PW0TMDAT ; 
    15 PW0TMPCC PW0TMPCC ; 
    15 PW0TMPYY PW0TMPYY ; 
    15 PW0TMPMM PW0TMPMM ; 
    15 PW0TMPDD PW0TMPDD ; 
  10 PW0TWSCH PW0TWSCH ; 
  10 PWDMIPSH PWDMIPSH ; 
  10 PW0TWSTH PW0TWSTH ; 
  10 PW0TWSFR PW0TWSFR ; 
  10 PW0TWSPR PW0TWSPR ; 
    15 PW0TWSP1 PW0TWSP1 ; 
    15 PW0TWSP2 PW0TWSP2 ; 
  10 PW0TWLCO PW0TWLCO ; 
  10 PW0TWFCO PW0TWFCO ; 
  10 PW0TW-HDR-CHG-FL PW0TW-HDR-CHG-FL ; 
end // end PW0TW00

//*** RECORD=PW0TW01 ****
// ------------------------
// Map 001 display storage.
// ------------------------
// ***********************
Record PW0TW01 type basicRecord
  10 XWHCD XWHCD ; 
  10 XWHABRV XWHABRV ; 
  10 PWDNBRSS PWDNBRSS ; 
  10 PWDDFPHS PWDDFPHS ; 
  10 PWDRJTSS PWDRJTSS ; 
  10 PWDNBRSH PWDNBRSH ; 
  10 PWDSCHFR PWDSCHFR ; 
  10 PWDSCHTH PWDSCHTH ; 
  10 PWDMIPSH PWDMIPSH ; 
  10 PW0TWSPR PW0TWSPR ; 
    15 PW0TWSP1 PW0TWSP1 ; 
    15 PW0TWSP2 PW0TWSP2 ; 
  10 PWDCOVSC PWDCOVSC ; 
end // end PW0TW01

//*** RECORD=PW0TW02 ****
// ------------------------
// Map 001 display storage.
// ------------------------
// ***********************
Record PW0TW02 type basicRecord
  5 XXXTSLEN XXXTSLEN ; 
  5 * char(490) ; 
    10 PW0TMACT PW0TMACT [10] ; 
    10 PKVSSPNB PKVSSPNB [10] ; 
    10 TF1CARCD TF1CARCD [10] ; 
    10 TF1ABRV TF1ABRV [10] ; 
    10 PWCTLNBR PWCTLNBR [10] ; 
    10 XTRCD XTRCD [10] ; 
    10 PWCCAVFR PWCCAVFR [10] ; 
    10 PWCCAVTR PWCCAVTR [10] ; 
    10 PWCDSTFR PWCDSTFR [10] ; 
    10 PWCDSTTH PWCDSTTH [10] ; 
    10 PWCRSHFL PWCRSHFL [10] ; 
    10 PWCHLDFL PWCHLDFL [10] ; 
    10 PW0TMPMM PW0TMPMM [10] ; 
    10 PW0TMPDD PW0TMPDD [10] ; 
    10 PW0TMPYY PW0TMPYY [10] ; 
    10 PWCCOVFT PWCCOVFT [10] ; 
end // end PW0TW02

// action, add, chg, del, inquiry
DataItem PW0TMACT char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// map work date
DataItem PW0TMDAT num(8)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// century
DataItem PW0TMPCC num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// map date - day
DataItem PW0TMPDD num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// map date - month
DataItem PW0TMPMM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// map date - year
DataItem PW0TMPYY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = nullFill, inputRequired = no
}
end

// first time thru flag
DataItem PW0TW-HDR-CHG-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem PW0TWFCO num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// update header switch
DataItem PW0TWHDU char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// line index
DataItem PW0TWIXD smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// map index
DataItem PW0TWIXM smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// tsq index
DataItem PW0TWIXT num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

DataItem PW0TWLCO num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// p & h work date
DataItem PW0TWMPH num(8)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// msg number
DataItem PW0TWMSG smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// header found switch
DataItem PW0TWNHD char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// century
DataItem PW0TWPCC num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// day
DataItem PW0TWPDD num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// month
DataItem PW0TWPMM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// year
DataItem PW0TWPYY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// End of cursor switch
DataItem PW0TWSC1 char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// largest schedule
DataItem PW0TWSCH num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// hold for sched comp.
DataItem PW0TWSFR num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// '60'
DataItem PW0TWSP1 num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// spur #
DataItem PW0TWSP2 num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// hold for spur
DataItem PW0TWSPR num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// hold for sched comp.
DataItem PW0TWSTH num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// format the map switch
DataItem PW0TWSWF char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// request for data switch
DataItem PW0TWSWR char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// update t.s. switch
DataItem PW0TWSWU char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

