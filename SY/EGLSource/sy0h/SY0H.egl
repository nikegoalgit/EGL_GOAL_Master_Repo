package sy0h;
import corpcom1.*;
import corpcom2.*;
import corpcom3.*;
import corpcom4.*;
import corpcom5.*;
import corpcom6.*;
import corpcom7.*;
import corpx1.*;
import corpx2.*;
import corpy2.*;
import corpz3.*;
import fk.common.*;
import fy.common.*;
import mn.common.*;
import op.common.*;
import pc.common.*;
import pg.common.*;
import sy.common.*;
import ta.common.*;
import ty.common.*;
import vv.common.*;
import ww.common.*;
//*** PROGRAM=SY0H ****
// this application add price rows to the price table by
// color/dim information. the general flow of processes in
// the application is as follows:
//    sy0h010(execute) - general initialization
//    sy0h020(converse)- edit upper half of screen
//    sy0h030(execute) - obtain table for screen display
//    sy0h035(execute) - move data from working storage save
//                       area to the screen
//    sy0h040(converse)- edit lower half of screen
//    sy0h050(execute) - update each lower half detail line
// 
// 
// ************************************************************
// 
// maintenance:
// 
//  project
//  number           who         when             why
// ________     ____________  __________   ____________________
//                j.brady      06-13-86     created application
//                m.buhite     05-19-87     sy0hs11: increased
//                    size of syarec.syabfln & syarec.syaftln.
//                m.buhite     11-20-87     sy0hs11: increased
//                    size of syarec.syabfln & syarec.syaftln.
//                m.buhite     03-18-88     sy0hs11: increased
//                    size of syarec.syabfln & syarec.syaftln.
//  p090          m.buhite     01-13-89     sy0hs11 & sy0hs12:
//          increased size of syarec.syabfln & syarec.syaftln.
//                VCowan       04-17-89    added XSSEGTR logic
//  -spl-         jwood        04-17-89    added noncsp  logic
//         MHALST  05-16-89  Audit changes for VCOLOR01.
//         MHALST  09-25-89  Add code for NIL and correct eff.
//                           date on add record logic.
//         MHALST  10-10-89  Protect life cycle from NIL
//         MHALST  11-13-89  DB2 changes and add SYZTBL
//         MHALST  04-30-90  Correct Audit type code
//         MHALST  10-09-90  DB2 changes and SYAREC
//         MHALST  11-15-90  Correct hold area for SY1rec
//         MHALST  02-11-91  DB2 changes to SY5REC
// PF174   MHALST  09-16-91  Allow NIL to enter future Prices
//         JRAMOS  02-24-93  Bypass colors when the Nike Dept
//                           Id = 'EAO ' and the color product
//                           region code not = '02'
//         MHALST  04-26-93  Add S & E to Status Ind.
//         MBUHIT  09-14-93  Modify EAO price-type logic.
//         MBUHIT  09-21-93  Modify EAO price-type logic.
//         MHALST  03-02-94  Add XCT & ZFC
// SY0211  MBUHIT  04-20-94  Add marketing region logic.
// SY0211  MHALST  08-23-94  Supress region upd if inactive
//         MHALST  09-14-95  Add calls to XPSY008 & XPSY009
//         MHALST  04-02-97  Correct logic to stop creation of
//                           price rows with blank color id.
//         NGANGO  11-03-97  Y2K modifications. Modified W.S
//         SY0HW01, Process SY0H020, AND SY0H040 .
//         JNARAS  02-22-99  Changed the processes SY0H020 and
//                           SY0H040 to accept -1 and +1 for
//                           the SY0HMRND field.
//                           Also changed the message 046 in
//                           the error msg table accordingly.
//         JNARAS  10-22-99  Changed the statment group SY0H020
//                           & SY0H040 to accept 1 year less
//                           than the current date for currency
//                           code 'EUR' and introduced the
//                           field SY0HWDT1 in SY0HW01.
//                           Changed SY0HS04 to use (R roundi
//                           ng function when rounding factor
//                           is not given.
// SYEURO  MHALST  02-07-00  Allow program to maintain EUR
//                           row at same time as local row.
// NSC     MHALST  10-26-01  Require M in markdown indicator if
//                           life cycle is close out.
// ************************************************************
// 
// io modules used       table view name
// _______________       _______________
//     io0120            dprod.vstyle01
//     io0130            dprod.vcolor01
//     io6640            dprod.vsyreg01
//     io0380            dprod.vprice01
//     io0370            dprod.vprich01
//     io0530            dprod.vsyaud01
//     io0520            dprod.vsytag01
// 
// ************************************************************
// *********************
Program SY0H type textUIProgram //VAGen Info - main text program
  {
  includeReferencedFunctions = yes, allowUnqualifiedItemReferences = yes, 
  throwNrfEofExceptions = yes, handleHardIOErrors = no, V60ExceptionCompatibility = yes, 
  I4GLItemsNullable = no, textLiteralDefaultIsString = no, localSQLScope = yes, 
  msgTablePrefix = "SY00", inputRecord = COMMAREA, segmented = yes
  }

  // Data Declarations
  COMMAREA COMMAREA ; // record
  ERRSQLCA ERRSQLCA; // record
  MNVREC MNVREC; // record
  SQLCA SQLCA; // record
  SY0HW01 SY0HW01; // record
  SY1REC SY1REC; // record
  SY2REC SY2REC; // record
  SY5REC SY5REC; // record
  SY7REC SY7REC; // record
  SY9REC SY9REC; // record
  SYAREC SYAREC; // record
  SYWREC SYWREC; // record
  TA1REC TA1REC; // record
  TA2REC TA2REC; // record
  TAEREC TAEREC; // record
  VSYREG02 VSYREG02; // record
  VZFC0001 VZFC0001; // record
  WSY1550 WSY1550; // record
  XGPREC XGPREC; // record
  XLCREC XLCREC; // record
  XP0HW01 XP0HW01; // record
  XP0HW02 XP0HW02; // record
  XPYREC XPYREC; // record
  XUMREC XUMREC; // record
  XX0XW02 XX0XW02; // record
  ZFCWREC ZFCWREC; // record

  // VAGen Info - items needed for migration
  VAGen_EZESYS char(8);
  VAGen_EZEREPLY num(1);
  VAGen_EZE_WAIT_TIME bin(9,2);
  VAGen_EZE_ITEMLEN int;

  // Use Declarations
  use SYZTBL {deleteAfterUse = yes}; // table
  use SYRGTBL {deleteAfterUse = yes}; // table
  use SYEUTBL {deleteAfterUse = yes}; // table
  use XCTTBL {deleteAfterUse = yes}; // table
  use XGPTBL {deleteAfterUse = yes}; // table
  use XUMTBL {deleteAfterUse = yes}; // table
  use XLCTBL {deleteAfterUse = yes}; // table
  use XPYTBL {deleteAfterUse = yes}; // table
  use XDRTBL {deleteAfterUse = yes}; // table
  use SY0HM.SY0HM001,  // forms
      SY0HM.XP0HM001, 
      SY0HM.XX0XM001
   {
    pfKeyEquate = no
  };

  function main()
    // VAGen Info - initialization needed for migration
    VAGen_EZESYS = VGLib.getVAGSysType();
    SY0H010: SY0H010();


     /* ***********************************************/
     /* *  the flow for process sy0h010 starts here  **/
     /* ***********************************************/


    goto SY0H020;


     /* ***********************************************/
     /* *  the flow for process sy0h010 ends here    **/
     /* ***********************************************/
    SY0H020: SY0H020();


     /* ***********************************************************/
     /* *  this begins the flow processing for process sy0h020   **/
     /* ***********************************************************/


    if (converseVar.validationMsgNum != 0)
      goto SY0H020;
    else
      if (converseVar.eventKey is pf12
       || converseVar.eventKey is enter)
        goto SY0H030;
      else
        goto SY0H010;
      end
    end


     /* *********************************************************/
     /* *  this ends the flow processing for process sy0h020   **/
     /* *********************************************************/
    SY0H030: SY0H030();


     /* *****************************************************/
     /* *  this starts the flow stage of process sy0h030   **/
     /* *****************************************************/


    if (converseVar.validationMsgNum != 0)
      goto SY0H020;
    end

    SY0HWCT4 = 1;

    if (COMMAREA.XDVCD == "02") /* NIL user*/
      set SY0HM001.SY0HMN1P[1] cursor;
    else
      set SY0HM001.XLCCD[1] cursor;
    end

    goto SY0H035;


    SY0H035: SY0H035();


     /* ****************************************************/
     /* *  this begins the flow stage of process sy0h035  **/
     /* ****************************************************/


    goto SY0H040;


     /* **************************************************/
     /* *  this ends the flow stage of process sy0h035  **/
     /* **************************************************/
    SY0H040: SY0H040();

     /* *****************************************************/
     /* *  this starts the flow stage of process sy0h040   **/
     /* *****************************************************/

    if (converseVar.validationMsgNum != 0
     || converseVar.eventKey is pf12)
      SY0HWIDX = 1;
      while (SY0HWIDX <= 8)
        if (SY0HM001.SY0HMN1P[SY0HWIDX] is modified)
          set SY0HM001.SY0HMN1P[SY0HWIDX] modified;
        end
        if (SY0HM001.SY0HMN2P[SY0HWIDX] is modified)
          set SY0HM001.SY0HMN2P[SY0HWIDX] modified;
        end
        SY0HWIDX = SY0HWIDX + 1;
      end
      if (converseVar.eventKey is pf12
       && converseVar.validationMsgNum == 0)
        set SY0HM001.XLCCD cursor;
      end
      goto SY0H040;
    else
      if (converseVar.eventKey is enter)
        goto SY0H050;
      else
        goto SY0H010;
      end
    end


    SY0H050: SY0H050();


     /* *****************************************************/
     /* *  this starts the flow stage of process sy0h050   **/
     /* *****************************************************/

    if (converseVar.validationMsgNum == 0)
      if (SY0HW01.SY0HWSW1 == "Y")
        converseLib.validationFailed(11);
        SY0HW01.SY0HWSW1 = "N";
      end
      if (SY0HWCT4 <= SY0HWCT3)
        if (COMMAREA.XDVCD == "02") /* NIL user*/
          set SY0HM001.SY0HMN1P[1] cursor;
        else
          set SY0HM001.XLCCD[1] cursor;
        end
        goto SY0H035;
      else
        set SY0HM001.SY1STNBR cursor;
        set SY0HW01 empty;
        SY0HM001.SY0HMDPR = 0;
        SY0HM001.SY0HMDDT = 0;
        SY0HM001.SY1STNBR = " ";
        SY0HM001.SY1SSTNM = " ";
        goto SY0H020;
      end
    else
      goto SY0H040;
    end

     /* *****************************************************/
     /* *  this ends the flow stage of process sy0h050     **/
     /* *****************************************************/


  end // end main
end // end SY0H

// initialization
Function SY0H010()


   /* ********************************************************/
   /* *  processing in this option includes:                **/
   /* *    1) test security clearance for the application   **/
   /* *    2) initialize fields                             **/
   /* *    3) set up the map screen                         **/
   /* ********************************************************/


  XSENTRY(); /* security check*/

  XSSEGTR(); /* set segemented transaction id*/

  set SY0HM001 initial;
  set SY0HW01 empty;
  set SYWREC empty;
  set SY1REC empty;
  set SY2REC empty;
  set VSYREG02 empty;
  set SY5REC empty;
  set SY7REC empty;
  set SY9REC empty;
  set SYAREC empty;
  set VZFC0001 empty;
  set ZFCWREC empty;

  SY0HM001.SYMCURDT = VGVar.currentShortGregorianDate;
  SY0HM001.SYMRVNBR = "00";
  SY0HM001.SYMTTLNM = "PRODUCT PRICE BY COLOR/DIMENSION - ADD";

  TA2REC.TA2DTOPT = "GREGGREG";
  TA2REC.TA2GRTYP = "E";
  TA2REC.TA2GRGEN = VGVar.currentShortGregorianDate;
  call "TA0040" (TA2REC) {isNoRefresh = yes, isExternal = yes};

  if (TA2REC.TA2RTNCD == 0)
    SY0HM001.SY5PCEDT = TA2REC.TA2GRGAN;
    SY0HW01.SY0HWDTE = TA2REC.TA2GRGGN;
  else
    converseLib.validationFailed(42); /* internal date error - call systems*/
                                   /* development*/
    exit stack;
  end

   /* Now, find out what region user is and set-up table of*/
   /* valid country/currenties the user can enter.*/
  set WSY1550 empty;
  XPSY008(); /* Get users region*/
  if (SYWREC.SYW-REG-TBL-SIZE > 0)
    if (SYWREC.SYW-ALL-REGIONS-FL == "Y")
      SY0HM001.XCTCD = "USA";
      SY0HM001.ZFC-CRCY-CD = "USD";
    else
      XPSY009(); /* Get countries for region*/
      if (WSY1550-RETURN-CODE == 00
       && WSY1550-TABLE-SIZE == 1)
        SY0HM001.XCTCD = WSY1550.XCT-CTRY-CD[1];
        SY0HM001.ZFC-CRCY-CD = WSY1550.ZFC-CRCY-CD[1];
      end
    end
  else /* No region for user, tell them*/
    converseLib.validationFailed(124); /* User Id not authorized*/
  end
  if (SY0HM001.XCTCD != " ")
    if (SY0HM001.XCTCD in XCTTBL.XCTCD)
      SY0HM001.XCTDESC = XCTTBL.XCTDESC[sysVar.arrayIndex];
    end
    SY0HS-GET-ZFC();
  else
    set SY0HM001.XCTCD cursor;
  end

  SY0HM001.XGPCD = COMMAREA.XGPCD;
  if (SY0HM001.XGPCD == "02")
    if (COMMAREA.CAALVL[2] == "N")
      converseLib.validationFailed(35); /* not authorized to use this gpc*/
      set SY0HM001.XGPCD cursor, bold;
      exit stack;
    else
      if (SY0HM001.XGPCD in XGPTBL.XGPCD)
        SY0HM001.XGPABRV = XGPTBL.XGPABRV[sysVar.arrayIndex];
      end
      if (sysVar.arrayIndex == 0)
        converseLib.validationFailed(31); /* invalid gpc code entered*/
        set SY0HM001.XGPCD cursor, bold;
        exit stack;
      end
    end
  else
    if (SY0HM001.XGPCD == "03")
      if (COMMAREA.CAALVL[3] == "N")
        converseLib.validationFailed(35); /* not authorized to use this gpc*/
        set SY0HM001.XGPCD cursor, bold;
        exit stack;
      else
        if (SY0HM001.XGPCD in XGPTBL.XGPCD)
          SY0HM001.XGPABRV = XGPTBL.XGPABRV[sysVar.arrayIndex];
        end
        if (sysVar.arrayIndex == 0)
          converseLib.validationFailed(31); /* invalid gpc code entered*/
          set SY0HM001.XGPCD cursor, bold;
          exit stack;
        end
      end
    else
      if (SY0HM001.XGPCD in XGPTBL.XGPCD)
        SY0HM001.XGPABRV = XGPTBL.XGPABRV[sysVar.arrayIndex];
      end
      if (sysVar.arrayIndex == 0)
        converseLib.validationFailed(31); /* invalid gpc code entered*/
        set SY0HM001.XGPCD cursor, bold;
        exit stack;
      end
    end
  end


end // end SY0H010

// price by color/dimension
Function SY0H020()



   /* *******************************************************/
     /* processing in the 'before' stage includes:        **/
       /* 1) protect screen fields                        **/
       /* 2) calculate current date                       **/
       /* 3) move application title name to screen area   **/
   /* *******************************************************/


  SY0HWCT1 = 1;
  while (SY0HWCT1 <= 8)
    set SY0HM001.XLCCD[SY0HWCT1] protect;
    set SY0HM001.SY0HMN1P[SY0HWCT1] protect;
    set SY0HM001.SY0HMN2P[SY0HWCT1] protect;
    set SY0HM001.SY5PSIND[SY0HWCT1] protect;
    SY0HWCT1 = SY0HWCT1 + 1;
  end

  TA2REC.TA2DTOPT = "GREGGREG";
  TA2REC.TA2GRTYP = "E";
  TA2REC.TA2GRGEN = VGVar.currentShortGregorianDate;
  call "TA0040" (TA2REC) {isNoRefresh = yes, isExternal = yes};

  if (TA2REC.TA2RTNCD == 0)
    SY0HW01.SY0HWDTE = TA2REC.TA2GRGGN;
  else
    converseLib.validationFailed(42); /* internal date error - call sys.*/
                                   /* dvlpmnt*/
    exit stack;
  end

  SY0HM001.SYMPRONM = "SY0H020";
  SY0HM001.SYMRVNBR = "03"; /* program revision number!!!!!!!!›*/

  converseVar.segmentedMode = 1;


  converse SY0HM001 ;


   /* *******************************************************/
     /* processing in the 'after' stage includes:         **/
       /* 1) check for fast path option                   **/
       /* 2) check pfkeys                                 **/
       /* 3) reset screen attributes                      **/
       /* 4) perform screen edits                         **/
       /* 5)*/
   /* *******************************************************/


  SY0HS01(); /* check fast path option*/

  SY0HS02(); /* check pfkeys*/

  if (converseVar.validationMsgNum != 0
   || converseVar.eventKey is pa2)
    exit stack;
  else
    SY0HM001.SYMSCMSG = " ";
    set SY0HM001.XGPCD initialAttributes;
    set SY0HM001.XCTCD initialAttributes;
    set SY0HM001.ZFC-CRCY-CD initialAttributes;
    set SY0HM001.SY1STNBR initialAttributes;
    set SY0HM001.SY0HMLCY initialAttributes;
    set SY0HM001.XPYCD initialAttributes;
    set SY0HM001.SY5PCEDT initialAttributes;
    set SY0HM001.SY0HMCAL initialAttributes;
    set SY0HM001.SY0HMPCT initialAttributes;
    set SY0HM001.SY0HMCNT initialAttributes;
    set SY0HM001.SY0HMRND initialAttributes;
    SY0HWCT1 = 1;
    while (SY0HWCT1 <= 8)
      set SY0HM001.XLCCD[SY0HWCT1] initialAttributes;
      set SY0HM001.SY0HMN1P[SY0HWCT1] initialAttributes;
      set SY0HM001.SY0HMN2P[SY0HWCT1] initialAttributes;
      set SY0HM001.SY5PSIND[SY0HWCT1] initialAttributes;
      SY0HWCT1 = SY0HWCT1 + 1;
    end
  end

  if (SY0HM001.SY0HMRND != 0
   && SY0HM001.SY0HMRND != .25
   && SY0HM001.SY0HMRND != .50
   && SY0HM001.SY0HMRND != 1.00
   && SY0HM001.SY0HMRND != -.25
   && SY0HM001.SY0HMRND != -.50
   && SY0HM001.SY0HMRND != -1.00)
    converseLib.validationFailed(46); /* a rnding value must be*/
                                   /* '.25','.50','1','-.25','-.50','-1'*/
    set SY0HM001.SY0HMRND cursor, bold;
  end


  if (SY0HM001.SY0HMCAL == "Y")
    if (SY0HM001.SY0HMPCT == 0)
      converseLib.validationFailed(40); /* required field - please enter a valid*/
                                   /* value*/
      set SY0HM001.SY0HMPCT cursor, bold;
    end
  end


  if (SY0HM001.SY0HMCAL != "Y"
   && SY0HM001.SY0HMCAL != "N")
    converseLib.validationFailed(36); /* value must be 'y' or 'n'*/
    set SY0HM001.SY0HMCAL cursor, bold;
  end


  set TA2REC empty;
  TA2REC.TA2DTOPT = "GREGGREG";
  TA2REC.TA2GRTYP = "A";
  /*  */
  /* ---------------- y2k out begin ------------*/
  /*  */
  /* MOVE 19 TO TA2REC.TA2CENT;*/
  /*  */
  /* ---------------- y2k out end --------------*/
  /*  */
  /*  */
  /* ---------------- y2k in begin -------------*/
  /*  */
  SY0HW01.SY0HW-PCEDT-MMDDYY = SY0HM001.SY5PCEDT;
  if (SY0HW01.SY0HW-PCEDT-YY > 60)
    TA2REC.TA2CENT = 19;
  else
    TA2REC.TA2CENT = 20;
  end
  /*  */
  /* ---------------- y2k in end ---------------*/
  /*  */
  TA2REC.TA2GRGAN = SY0HM001.SY5PCEDT;
  call "TA0040" (TA2REC) {isNoRefresh = yes, isExternal = yes};

  if (TA2REC.TA2RTNCD != 0)
    converseLib.validationFailed(30); /* invalid date entered*/
    set SY0HM001.SY5PCEDT cursor, bold;
    exit stack;
  else
   /* TCS CHANGE BEGINS 10/22/99*/
    if (SY0HM001.ZFC-CRCY-CD == "EUR")
      SY0HW01.SY0HWDT1 = SY0HW01.SY0HWDTE - 10000;
      if (TA2REC.TA2GRGGN < SY0HW01.SY0HWDT1)
        converseLib.validationFailed(30); /* invalid date entered*/
        set SY0HM001.SY5PCEDT cursor, bold;
      end
    else
   /* TCS CHANGE ENDS   10/22/99*/
      if (TA2REC.TA2GRGGN < SY0HW01.SY0HWDTE)
        converseLib.validationFailed(30); /* invalid date entered*/
        set SY0HM001.SY5PCEDT cursor, bold;
      end
    end
  end


  if (SY0HM001.XPYCD in XPYTBL.XPYCD)
    SY0HM001.XPYDESC = XPYTBL.XPYDESC[sysVar.arrayIndex];
    if (XPYTBL.XXXSTAT[sysVar.arrayIndex] != "A")
      converseLib.validationFailed(33); /* status is not active*/
      set SY0HM001.XPYCD cursor, bold;
    else
      if (COMMAREA.XDVCD == "02" /* NIL user*/
       && XPYTBL.XDVCD[sysVar.arrayIndex] != COMMAREA.XDVCD)
        converseLib.validationFailed(3); /* invalid code*/
        set SY0HM001.XPYCD cursor, bold;
      end
    end
  else
    converseLib.validationFailed(3); /* invalid code*/
    set SY0HM001.XPYCD cursor, bold;
  end

  if (SY0HM001.SY1STNBR == "  ")
    converseLib.validationFailed(32); /* please enter style number*/
    set SY0HM001.SY1STNBR cursor, bold;
  end

  SY0HS-POPUPS(); /* Check pop-ups*/

  SY0HS-GET-ZFC(); /* Validate currency*/

  SY0HM001.XCTDESC = " ";
  if (SY0HM001.XCTCD in XCTTBL.XCTCD)
    SY0HM001.XCTDESC = XCTTBL.XCTDESC[sysVar.arrayIndex];
    if (XCTTBL.XXXSTAT[sysVar.arrayIndex] != "A")
      converseLib.validationFailed(33); /* status is not active*/
      set SY0HM001.XCTCD cursor, bold;
    end
  else
    converseLib.validationFailed(3); /* invalid code*/
    set SY0HM001.XCTCD cursor, bold;
  end

   /* Now check that country/currency is valid for region*/
  if (converseVar.validationMsgNum == 0 /* If no errors*/
   && SYWREC.SYW-ALL-REGIONS-FL == "N")
    WSY1550-IDX = 1;
    SYWREC.SYW-XCT-ZFC-FL = "N";
    while (WSY1550-IDX <= WSY1550-TABLE-SIZE
     && SYWREC.SYW-XCT-ZFC-FL == "N")
      if (SY0HM001.XCTCD == WSY1550.XCT-CTRY-CD[WSY1550-IDX]
       && SY0HM001.ZFC-CRCY-CD == WSY1550.ZFC-CRCY-CD[WSY1550-IDX])
        SYWREC.SYW-XCT-ZFC-FL = "Y";
      else
        WSY1550-IDX = WSY1550-IDX + 1;
      end
    end
    if (SYWREC.SYW-XCT-ZFC-FL == "N") /* Not found in table*/
      converseLib.validationFailed(127); /* so not allowed to use*/
      set SY0HM001.XCTCD cursor, bold;
      set SY0HM001.ZFC-CRCY-CD bold;
    end
  end

  if (SY0HM001.XGPCD == "02")
    if (COMMAREA.CAALVL[2] == "N")
      converseLib.validationFailed(35); /* not authorized*/
      set SY0HM001.XGPCD cursor, bold;
    else
      if (SY0HM001.XGPCD in XGPTBL.XGPCD)
        SY0HM001.XGPABRV = XGPTBL.XGPABRV[sysVar.arrayIndex];
      end
      if (sysVar.arrayIndex == 0)
        converseLib.validationFailed(31); /* invalid gpc code entered*/
        set SY0HM001.XGPCD cursor, bold;
      end
    end
  else
    if (SY0HM001.XGPCD == "03")
      if (COMMAREA.CAALVL[3] == "N")
        converseLib.validationFailed(35); /* not authorized*/
        set SY0HM001.XGPCD cursor, bold;
      end
    else
      if (SY0HM001.XGPCD in XGPTBL.XGPCD)
        SY0HM001.XGPABRV = XGPTBL.XGPABRV[sysVar.arrayIndex];
      end
      if (sysVar.arrayIndex == 0)
        converseLib.validationFailed(31); /* invalid gpc code entered*/
        set SY0HM001.XGPCD cursor, bold;
      end
    end
  end


end // end SY0H020

// price by color/dimension
Function SY0H030()


   /* **********************************************************/
   /* *  this process obtains the data necessary for screen   **/
   /* *  display.                                             **/
   /* **********************************************************/

   /* ***********************/
   /* obtain gpc abbreviation*/
   /* ***********************/

  if (SY0HM001.XGPCD in XGPTBL.XGPCD)
    SY0HM001.XGPABRV = XGPTBL.XGPABRV[sysVar.arrayIndex];
  end
  if (sysVar.arrayIndex == 0)
    converseLib.validationFailed(31); /* invalid gpc code entered*/
    set SY0HM001.XGPCD cursor, bold;
    exit stack;
  end

   /* ***********************/
   /* obtain life cycle data*/
   /* ***********************/

  if (SY0HM001.SY0HMLCY != "  ")
    if (SY0HM001.SY0HMLCY in XLCTBL.XLCCD)
      XLCREC.XLCDESC = XLCTBL.XLCDESC[sysVar.arrayIndex];
    end
    if (sysVar.arrayIndex == 0)
      converseLib.validationFailed(3); /* invalid code*/
      set SY0HM001.SY0HMLCY cursor, bold;
      exit stack;
    else
      SY0HM001.XLCDESC = XLCREC.XLCDESC;
    end
  end

   /* ***********************/
   /* obtain price type data*/
   /* ***********************/

  if (SY0HM001.XPYCD in XPYTBL.XPYCD)
    XPYREC.XPYDESC = XPYTBL.XPYDESC[sysVar.arrayIndex];
  end

  if (sysVar.arrayIndex == 0)
    converseLib.validationFailed(3); /* invalid code*/
    set SY0HM001.XPYCD cursor, bold;
    exit stack;
  else
    SY0HM001.XPYDESC = XPYREC.XPYDESC;
  end

   /* *******************************/
   /* obtain style name and uom code*/
   /* *******************************/

  SY1REC.XGPCD = SY0HM001.XGPCD;
  SY1REC.SY1STNBR = SY0HM001.SY1STNBR;
  call "IO0120" ("S ", SQLCA, SY1REC) {isNoRefresh = yes, isExternal = yes};
  if (SQLCA.VAGen_SQLCODE == +100)
    converseLib.validationFailed(5); /* style record does not exist*/
    set SY0HM001.SY1STNBR cursor, bold;
    exit stack;
  else
    if (SQLCA.VAGen_SQLCODE != 0)
      converseLib.validationFailed(20); /* style table error - contact systems*/
                                   /* development*/
      SY0HM001.SYMSCMSG = "PRESS PA2 TO START A NEW TRANSACTION";
      set SY0HM001.SY1STNBR cursor, bold;
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "SY0H   ";
      TA1REC.TA1LOCAT[1] = "S        ";
      TA1REC.TA1LOCAT[2] = "SY0H030  ";
      TA1REC.TA1LOCAT[3] = "IO0120   ";
      TA1REC.TA1LOCAT[4] = " ";
      TA1REC.TA1MAP = "SY0HM001";
      TA1REC.TA1DBASE = "SY1REC";
      TA1REC.TA1TBLVU = "DPROD.VSTYLE01";
      TA1TBLKE = SY1REC.SY1KEY;
      move SQLCA to ERRSQLCA withV60Compat;
      VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
      VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
      sysLib.rollback();
      VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
      
      call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
      exit stack;
    else
      SY0HM001.SY1SSTNM = SY1REC.SY1SSTNM;
      SY0HW01.SY1DATA = SY1REC.SY1DATA;
    end
  end

   /* ***********************/
   /* obtain uom description*/
   /* ***********************/

  if (SY1REC.XUMCD in XUMTBL.XUMCD)
    XUMREC.XUMDESC = XUMTBL.XUMDESC[sysVar.arrayIndex];
  end

  if (sysVar.arrayIndex == 0)
    SY0HM001.XUMDESC = " ";
  else
    SY0HM001.XUMDESC = XUMREC.XUMDESC;
  end

   /* ************************/
   /* obtain style color rows*/
   /* ************************/

   /* Clear out working storage arrays*/
  SY0HW01.SY0HWCT1 = 1;
  while (SY0HW01.SY0HWCT1 <= 200)
    SY0HW01.SY2CLRID[SY0HWCT1] = " ";
    SY0HW01.XDMCD[SY0HWCT1] = " ";
    SY0HW01.XLCCD[SY0HWCT1] = " ";
    SY0HW01.SY0HWE1P[SY0HWCT1] = 000;
    SY0HW01.SY0HWEFF[SY0HWCT1] = 000;
    SY0HW01.SY0HWE2P[SY0HWCT1] = 000;
    SY0HW01.SY0HW-UPD-SY2[SY0HWCT1] = "N";
    SY0HW01.SY0HWCLR[SY0HWCT1] = " ";
    SY0HW01.SY0HWDIM[SY0HWCT1] = " ";
    SY0HW01.SY0HWLCY[SY0HWCT1] = " ";
    SY0HW01.SY0HWCT1 = SY0HW01.SY0HWCT1 + 1;
  end

  SY2REC.XGPCD = SY0HM001.XGPCD;
  SY2REC.SY1STNBR = SY0HM001.SY1STNBR;
  call "IO0130" ("SS", SQLCA, SY2REC) {isNoRefresh = yes, isExternal = yes};
  if (SQLCA.VAGen_SQLCODE != 0)
    set SY0HM001.SY1STNBR cursor, bold;
    converseLib.validationFailed(21); /* color table error - contact systems*/
                                   /* development*/
    SY0HM001.SYMSCMSG = "PRESS PA2 TO START A NEW TRANSACTION";
    TA1REC.TA1TYPE = "DB2 ";
    TA1REC.TA1FUNC = "RETN";
    TA1REC.TA1PGMNM = "SY0H   ";
    TA1REC.TA1LOCAT[1] = "SS       ";
    TA1REC.TA1LOCAT[2] = "SY0H030  ";
    TA1REC.TA1LOCAT[3] = "IO0130   ";
    TA1REC.TA1LOCAT[4] = " ";
    TA1REC.TA1MAP = "SY0HM001";
    TA1REC.TA1DBASE = "SY2REC";
    TA1REC.TA1TBLVU = "DPROD.VCOLOR01";
    TA1TBLKE = SY2REC.SY2KEY;
    move SQLCA to ERRSQLCA withV60Compat;
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
    exit stack;
  else
    SY0HWCT1 = 1;
    while (SQLCA.VAGen_SQLCODE == 0
     && converseVar.validationMsgNum == 0)
      SY0HS03(); /* obtain style color rows*/
    end
  end

  if (SY0HWCT1 == 1)
    converseLib.validationFailed(59);
    set SY0HM001.SY1STNBR cursor, bold;
  else
    SY0HWCT1 = SY0HWCT1 - 1;
  end

  if (SY0HWCT1 > 8)
    SY0HW01.SY0HWNUM = SY0HWCT1;
    SY0HW01.SY0HWRST = " COLORS SELECTED";
    SY0HM001.SYMSCMSG = SY0HW01.SY0HWMES;
  end

  call "IO0130" ("CS", SQLCA, SY2REC) {isNoRefresh = yes, isExternal = yes};

  if (SQLCA.VAGen_SQLCODE != 0)
    converseLib.validationFailed(21); /* color table error - contact systems*/
                                   /* development*/
    SY0HM001.SYMSCMSG = "PRESS PA2 TO START A NEW TRANSACTION";
    TA1REC.TA1TYPE = "DB2 ";
    TA1REC.TA1FUNC = "RETN";
    TA1REC.TA1PGMNM = "SY0H   ";
    TA1REC.TA1LOCAT[1] = "CS       ";
    TA1REC.TA1LOCAT[2] = "SY0H030  ";
    TA1REC.TA1LOCAT[3] = "IO0130   ";
    TA1REC.TA1LOCAT[4] = " ";
    TA1REC.TA1MAP = "SY0HM001";
    TA1REC.TA1DBASE = "SY2REC";
    TA1REC.TA1TBLVU = "DPROD.VCOLOR01";
    TA1TBLKE = SY2REC.SY2KEY;
    move SQLCA to ERRSQLCA withV60Compat;
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
    exit stack;
  end

  if (converseVar.validationMsgNum != 0)
    exit stack;
  end

   /* ******************************/
   /* obtain price by style default*/
   /* ******************************/

  SY5REC.XGPCD = SY0HM001.XGPCD;
  SY5REC.SY1STNBR = SY0HM001.SY1STNBR;
  SY5REC.SY2CLRID = "***";
  SY5REC.XDMCD = "**";
  SY5REC.SY5SZID = 0;
  SY5REC.XPYCD = SY0HM001.XPYCD;
  SY5REC.XQACD = "01";
  SY5REC.XCT-CTRY-CD = SY0HM001.XCTCD;
  SY5REC.ZFC-CRCY-CD = SY0HM001.ZFC-CRCY-CD;
  call "IO0380" ("S ", SQLCA, SY5REC) {isNoRefresh = yes, isExternal = yes};

  if (SQLCA.VAGen_SQLCODE == 0)
    SY0HWCT2 = 1;
    while (SY0HWCT2 <= 6
     && SY5REC.SY5PCEDT[SY0HWCT2] != 0)
      SY0HS05(); /* select date & price defaults*/
      if (converseVar.validationMsgNum != 0)
        exit stack;
      end
      SY0HWCT2 = SY0HWCT2 + 1;
    end
  else
    if (SQLCA.VAGen_SQLCODE != +100)
      converseLib.validationFailed(38); /* price table error*/
      SY0HM001.SYMSCMSG = "PRESS PA2 TO START A NEW TRANSACTION";
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "SY0H   ";
      TA1REC.TA1LOCAT[1] = "S        ";
      TA1REC.TA1LOCAT[2] = "SY0H030  ";
      TA1REC.TA1LOCAT[3] = "IO0380   ";
      TA1REC.TA1LOCAT[4] = " ";
      TA1REC.TA1MAP = "SY0HM001";
      TA1REC.TA1DBASE = "SY5REC";
      TA1REC.TA1TBLVU = "DPROD.VPRICE01";
      TA1TBLKE = SY5REC.SY5KEY;
      move SQLCA to ERRSQLCA withV60Compat;
      VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
      VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
      sysLib.rollback();
      VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
      
      call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
      exit stack;
    end
  end

   /* ************************************************/
   /* obtain price by style for 1st and 2nd qualities*/
   /* ************************************************/

  SY0HWCT3 = 1;
  SY0HWCT4 = 1;
  while (SY0HWCT4 <= SY0HWCT1
   && converseVar.validationMsgNum == 0)
    SY5REC.XQACD = "01";
    SY0HS08(); /* obtain price by style 1st quality*/
    if (converseVar.validationMsgNum == 0)
      SY5REC.XQACD = "02";
      SY0HS08(); /* obtain price by style 2nd quality*/
    end
    SY0HWCT3 = SY0HWCT3 + 1;
    SY0HWCT4 = SY0HWCT4 + 1;
  end

  move SY0HWCT1 to SY0HWCT3 withV60Compat;

   /* **********************************************************/
   /* *  Now check to see if this country/currency should     **/
   /* *  also update the matching EUR or Local row.           **/
   /* **********************************************************/
  SYWREC.SYWINDEX = 1;
  SY0HW01.SY0HW-SYEUTBL-FLAG = "N";
  while (SYEUTBL.XCT-CTRY-CD[SYWINDEX] != "9999"
   && SY0HW01.SY0HW-SYEUTBL-FLAG == "N")
    if (SY0HM001.XCTCD == SYEUTBL.XCT-CTRY-CD[SYWINDEX])
      if ((SYEUTBL.SY-PMRY-CRCY-IND[SYWINDEX] == "L"
       && SY0HM001.ZFC-CRCY-CD == SYEUTBL.ZFC-CRCY-CD[SYWINDEX])
       || (SYEUTBL.SY-PMRY-CRCY-IND[SYWINDEX] == "E"
       && SY0HM001.ZFC-CRCY-CD == "EUR"))
        SY0HW01.SY0HW-SYEUTBL-FLAG = "Y";
      else
        SY0HW01.SY0HW-SYEUTBL-FLAG = "E";
      end
    else
      SYWREC.SYWINDEX = SYWREC.SYWINDEX + 1;
    end
  end

   /* Now if the flag is E, we found the country but will not*/
   /* be updating a matching price row. We want to warn the*/
   /* user about this.*/
  if (SY0HW01.SY0HW-SYEUTBL-FLAG == "E")
    SY0HW01.SY0HW-SYEUTBL-FLAG = "N";
    if (SY0HM001.ZFC-CRCY-CD == "EUR")
      SY0HM001.SYMSCMSG = " Matching Local Price will NOT be Updated";
    else
      SY0HM001.SYMSCMSG = " Matching EUR Price will NOT be Updated";
    end
  end

end // end SY0H030

// next screen moves
Function SY0H035()


   /* ********************************************************/
   /* *  this process moves data from the working storage   **/
   /* *  save area to the screen                            **/
   /* ********************************************************/


  SY0HWCT2 = 1;
  while (SY0HWCT2 <= 8)
    if (SY0HWCT4 <= SY0HWCT3)
      SY0HM001.SY2CLRID[SY0HWCT2] = SY0HW01.SY2CLRID[SY0HWCT4];
      SY0HM001.XDMCD[SY0HWCT2] = SY0HW01.XDMCD[SY0HWCT4];
      SY0HM001.XLCCD[SY0HWCT2] = SY0HW01.XLCCD[SY0HWCT4];
      SY0HW01.SY0HWSLC[SY0HWCT2] = SY0HW01.XLCCD[SY0HWCT4];
      SY0HM001.SY0HME1P[SY0HWCT2] = SY0HW01.SY0HWE1P[SY0HWCT4];
      SY0HM001.SY0HMEDT[SY0HWCT2] = SY0HW01.SY0HWEFF[SY0HWCT4];
      SY0HM001.SY0HME2P[SY0HWCT2] = SY0HW01.SY0HWE2P[SY0HWCT4];
      if (SY0HW01.SY0HW-UPD-SY2[SY0HWCT4] == "Y")
        SY0HW01.SY0HW-PROT-XLC[SY0HWCT2] = "N";
      else
        SY0HW01.SY0HW-PROT-XLC[SY0HWCT2] = "Y";
      end
    else
      SY0HW01.SY0HWSLC[SY0HWCT2] = " ";
    end
    SY0HWCT2 = SY0HWCT2 + 1;
    SY0HWCT4 = SY0HWCT4 + 1;
  end

  SY0HW01.SY0HWARN[1] = "N";
  SY0HW01.SY0HWARN[2] = "N";
  SY0HW01.SY0HWARN[3] = "N";
  SY0HW01.SY0HWARN[4] = "N";
  SY0HW01.SY0HWARN[5] = "N";
  SY0HW01.SY0HWARN[6] = "N";
  SY0HW01.SY0HWARN[7] = "N";
  SY0HW01.SY0HWARN[8] = "N";
  SY0HW01.SY0HWARN[9] = "N";

end // end SY0H035

// process screen
Function SY0H040()


   /* ********************************************************/
   /* *  processing in the 'before' stage includes:         **/
   /* *    1) protect required fields                       **/
   /* *    2) obtain and format system time                 **/
   /* ********************************************************/


  SY0HWCT2 = 1;
  while (SY0HWCT2 <= 8)
    if (COMMAREA.XDVCD == "02" /* NIL user*/
     || SY0HW01.SY0HW-PROT-XLC[SY0HWCT2] == "Y")
      set SY0HM001.XLCCD[SY0HWCT2] skip; /* NIL can't change*/
    end
    if (SY0HM001.SY0HMCAL == "Y")
      set SY0HM001.SY0HMN2P[SY0HWCT2] protect;
    end
    if (SY0HW01.SY0HWARN[SY0HWCT2] == "Y")
      set SY0HM001.SY0HMN1P[SY0HWCT2] modified, bold;
    end
    if (SY0HM001.SY2CLRID[SY0HWCT2] == " ") /* No entry on this line*/
      set SY0HM001.XLCCD[SY0HWCT2] skip;
      set SY0HM001.SY5PSIND[SY0HWCT2] skip;
      set SY0HM001.SY0HMN1P[SY0HWCT2] skip;
      set SY0HM001.SY0HMN2P[SY0HWCT2] skip;
    end
    SY0HWCT2 = SY0HWCT2 + 1;
  end

  set SY0HM001.XGPCD protect;
  set SY0HM001.XCTCD protect;
  set SY0HM001.ZFC-CRCY-CD protect;
  set SY0HM001.SY1STNBR protect;
  set SY0HM001.SY0HMLCY protect;
  set SY0HM001.XPYCD protect;

  if (converseVar.validationMsgNum == 0 /* No errors*/
   && SY0HW01.SY0HW-PROT-XLC[1] == "Y") /* Life cycle prot*/
    set SY0HM001.SY0HMN1P[1] cursor;
  end

  SY0HS19(); /* convert system time*/

  SY0HM001.SYMPRONM = "SY0H040";
  SY0HM001.SYMRVNBR = "03"; /* program revision number!!!!*/

  converse SY0HM001 ;
   /* ********************************************************/
   /* *  processing in the 'after' stage includes:          **/
   /* *    1) check for fast path exit and pf keys          **/
   /* *    2) obtain and format system time                 **/
   /* *    3) reset attributes                              **/
   /* *    4) edit screen fields                            **/
   /* *    5) calculate 2nd quality if necessary            **/
   /* ********************************************************/


  SY0HS01(); /* check for fast path*/

  SY0HS02(); /* check pf keys*/

  if (converseVar.validationMsgNum != 0
   || converseVar.eventKey is pa2)
    exit stack;
  else
    SY0HM001.SYMSCMSG = " ";
    set SY0HM001.XGPCD initialAttributes;
    set SY0HM001.XCTCD initialAttributes;
    set SY0HM001.ZFC-CRCY-CD initialAttributes;
    set SY0HM001.SY1STNBR initialAttributes;
    set SY0HM001.SY0HMLCY initialAttributes;
    set SY0HM001.XPYCD initialAttributes;
    set SY0HM001.SY5PCEDT initialAttributes;
    set SY0HM001.SY0HMCAL initialAttributes;
    set SY0HM001.SY0HMPCT initialAttributes;
    set SY0HM001.SY0HMCNT initialAttributes;
    set SY0HM001.SY0HMRND initialAttributes;
    SY0HWCT2 = 1;
    while (SY0HWCT2 <= 8)
      set SY0HM001.SY2CLRID[SY0HWCT2] initialAttributes;
      set SY0HM001.XDMCD[SY0HWCT2] initialAttributes;
      set SY0HM001.XLCCD[SY0HWCT2] initialAttributes;
      set SY0HM001.SY5PSIND[SY0HWCT2] initialAttributes;
      set SY0HM001.SY0HMN1P[SY0HWCT2] initialAttributes;
      set SY0HM001.SY0HMN2P[SY0HWCT2] initialAttributes;
      SY0HWCT2 = SY0HWCT2 + 1;
    end
  end

  SY0HSSM(); /* set price modified flags*/

  SY0HWCT2 = 8;
  while (SY0HWCT2 >= 1)
    if (SY0HM001.XLCCD[SY0HWCT2] != "  ")
      if (SY0HM001.XLCCD[SY0HWCT2] != SY0HW01.SY0HWSLC[SY0HWCT2])
        if (SY0HW01.SY0HW1MD[SY0HWCT2] == "N")
          converseLib.validationFailed(40); /* required field please enter valid*/
                                   /* value*/
          set SY0HM001.SY0HMN1P[SY0HWCT2] cursor, bold;
        end
      end
    end
    if (SY0HM001.XLCCD[SY0HWCT2] != "  ")
      if (SY0HM001.XLCCD[SY0HWCT2] != SY0HW01.SY0HWSLC[SY0HWCT2])
        if (SY0HM001.XLCCD[SY0HWCT2] != "20"
         && SY0HM001.XLCCD[SY0HWCT2] != "10")
          converseLib.validationFailed(54); /* existing l/c must be '10' or '20'*/
          set SY0HM001.XLCCD[SY0HWCT2] cursor, bold;
        end
        if (SY0HW01.SY0HWSLC[SY0HWCT2] != "10"
         && SY0HW01.SY0HWSLC[SY0HWCT2] != "20")
          converseLib.validationFailed(60); /* new l/c must be '10' or '20'*/
          set SY0HM001.XLCCD[SY0HWCT2] cursor, bold;
        end
      end
    end
    if (SY0HM001.SY5PSIND[SY0HWCT2] == "O"
     || SY0HM001.SY5PSIND[SY0HWCT2] == "M"
     || SY0HM001.SY5PSIND[SY0HWCT2] == "S"
     || SY0HM001.SY5PSIND[SY0HWCT2] == "E"
     || SY0HM001.SY5PSIND[SY0HWCT2] == " ")
      if (SY0HM001.XGPCD == "02"            /* If foot/equip*/
       && SY0HM001.XCTCD == "USA "          /* and USA*/
       && SY0HM001.XPYCD == "01"            /* and price type 01*/
       && SY0HM001.XLCCD[SY0HWCT2] == "20"  /* and closeout*/
       && SY0HW01.SY0HW1MD[SY0HWCT2] == "Y" /* and have price*/
       && SY0HM001.SY5PSIND[SY0HWCT2] != "M") /* and flag not M*/
        converseLib.validationFailed(241); /* Markdown ind must be M*/
        set SY0HM001.SY5PSIND[SY0HWCT2] cursor, bold;
      end
    else
      converseLib.validationFailed(3); /* invalid code*/
      set SY0HM001.SY5PSIND[SY0HWCT2] cursor, bold;
    end
    if (SY0HM001.XLCCD[SY0HWCT2] != "  ")
      if (SY0HM001.XGPCD == "02"
       || SY0HM001.XGPCD == "03")
        if (SY0HW01.SY0HW1MD[SY0HWCT2] == "Y"
         && SY0HM001.SY0HMN1P[SY0HWCT2] == 0)
          converseLib.validationFailed(84); /* zero price invalid for gpc*/
          set SY0HM001.SY0HMN1P[SY0HWCT2] cursor, bold;
        end
        if (SY0HW01.SY0HW2MD[SY0HWCT2] == "Y"
         && SY0HM001.SY0HMN2P[SY0HWCT2] == 0)
          converseLib.validationFailed(84); /* zero price invalid for gpc*/
          set SY0HM001.SY0HMN2P[SY0HWCT2] cursor, bold;
        end
      end
    end
    SY0HWCT2 = SY0HWCT2 - 1;
  end

  if (SY0HM001.SY0HMRND != 0
   && SY0HM001.SY0HMRND != -.25
   && SY0HM001.SY0HMRND != -.50
   && SY0HM001.SY0HMRND != -1.00
   && SY0HM001.SY0HMRND != +.25
   && SY0HM001.SY0HMRND != +.50
   && SY0HM001.SY0HMRND != +1.00)
    converseLib.validationFailed(46); /* a rounding value must be*/
                                   /* .25,.50,1,.-25,-.50,-1 or 0*/
    set SY0HM001.SY0HMRND cursor, bold;
  end


  if (SY0HM001.SY0HMCAL == "Y")
    if (SY0HM001.SY0HMPCT == 0)
      converseLib.validationFailed(40); /* required field - please enter a valid*/
                                   /* value*/
      set SY0HM001.SY0HMPCT cursor, bold;
    end
  end


  if (SY0HM001.SY0HMCAL != "Y")
    if (SY0HM001.SY0HMCAL != "N")
      converseLib.validationFailed(36); /* value must be 'y' or 'n'*/
      set SY0HM001.SY0HMCAL cursor, bold;
    end
  end


  set TA2REC empty;
  TA2REC.TA2DTOPT = "GREGGREG";
  TA2REC.TA2GRTYP = "A";
  /*  */
  /* ---------------- y2k out begin ---------------*/
  /*  */
  /* MOVE 19 TO TA2REC.TA2CENT;*/
  /*  */
  /* ---------------- y2k out end -----------------*/
  /*  */
  /*  */
  /* ---------------- y2k in begin  -----------------*/
  /*  */
  SY0HW01.SY0HW-PCEDT-MMDDYY = SY0HM001.SY5PCEDT;
  if (SY0HW01.SY0HW-PCEDT-YY > 60)
    TA2REC.TA2CENT = 19;
  else
    TA2REC.TA2CENT = 20;
  end
  /*  */
  /* ---------------- y2k in end -----------------*/
  /*  */
  TA2REC.TA2GRGAN = SY0HM001.SY5PCEDT;
  call "TA0040" (TA2REC) {isNoRefresh = yes, isExternal = yes};

  if (TA2REC.TA2RTNCD != 0)
    converseLib.validationFailed(30); /* invalid date entered*/
    set SY0HM001.SY5PCEDT cursor, bold;
    exit stack;
  else
   /* TCS CHANGE BEGINS 10/22/99*/
    if (SY0HM001.ZFC-CRCY-CD == "EUR")
      SY0HW01.SY0HWDT1 = SY0HW01.SY0HWDTE - 10000;
      if (TA2REC.TA2GRGGN < SY0HW01.SY0HWDT1)
        converseLib.validationFailed(30); /* invalid date entered*/
        set SY0HM001.SY5PCEDT cursor, bold;
      end
    else
   /* TCS CHANGE ENDS   10/22/99*/
      if (TA2REC.TA2GRGGN < SY0HW01.SY0HWDTE)
        converseLib.validationFailed(30); /* invalid date entered*/
        set SY0HM001.SY5PCEDT cursor, bold;
      end
    end
  end

  if (converseVar.validationMsgNum != 0)
    exit stack;
  end

  if (SY0HM001.SY0HMCAL == "Y")
    SY0HWCT2 = 1;
    while (SY0HWCT2 <= 8)
      SY0HS04(); /* calculate 2nd quality*/
      SY0HWCT2 = SY0HWCT2 + 1;
    end
  end


end // end SY0H040

// update logic
Function SY0H050()


  /* if any lifecycle has been modified*/
  /* display region popup window*/


  if (SY0HM001.XLCCD[1] != SY0HW01.SY0HWSLC[1]
   || SY0HM001.XLCCD[2] != SY0HW01.SY0HWSLC[2]
   || SY0HM001.XLCCD[3] != SY0HW01.SY0HWSLC[3]
   || SY0HM001.XLCCD[4] != SY0HW01.SY0HWSLC[4]
   || SY0HM001.XLCCD[5] != SY0HW01.SY0HWSLC[5]
   || SY0HM001.XLCCD[6] != SY0HW01.SY0HWSLC[6]
   || SY0HM001.XLCCD[7] != SY0HW01.SY0HWSLC[7]
   || SY0HM001.XLCCD[8] != SY0HW01.SY0HWSLC[8])
    SY0HS-GET-XP0HM(); /* display region popup window*/
  end


   /* update price size table*/


  set TA2REC empty;
  TA2REC.TA2DTOPT = "GREGGREG";
  TA2REC.TA2GRTYP = "A";
  TA2REC.TA2GRGAN = SY0HM001.SY5PCEDT;
  call "TA0040" (TA2REC) {isNoRefresh = yes, isExternal = yes};
  if (TA2REC.TA2RTNCD == 0)
    SY0HW01.SY0HWEDT = TA2REC.TA2GRGGN;
  else
    converseLib.validationFailed(30); /* invalid date entered*/
    set SY0HM001.SY5PCEDT cursor, bold;
    exit stack;
  end

  SY0HWCT2 = 1;
  while (SY0HWCT2 <= 8
   && converseVar.validationMsgNum == 0)
    SY0HS15(); /* update each row on the screen*/
    if (converseVar.validationMsgNum == 0 /* If no errors*/
     && SY0HW01.SY0HW-SYEUTBL-FLAG == "Y") /* and create EUR*/
      SY0H100(); /* then go do it!*/
    end
    SY0HWCT2 = SY0HWCT2 + 1;
  end

   /* NOTE: SY0HWARN(09) is being used as a flag to indicate that*/
        /* the other flags have allready been looked at. There*/
        /* are NOT 9 lines of data on the screen, only 8.*/

  if (SY0HW01.SY0HWARN[9] == "N")
    if (SY0HW01.SY0HWARN[1] == "Y"
     || SY0HW01.SY0HWARN[2] == "Y"
     || SY0HW01.SY0HWARN[3] == "Y"
     || SY0HW01.SY0HWARN[4] == "Y"
     || SY0HW01.SY0HWARN[5] == "Y"
     || SY0HW01.SY0HWARN[6] == "Y"
     || SY0HW01.SY0HWARN[7] == "Y"
     || SY0HW01.SY0HWARN[8] == "Y")
      converseLib.validationFailed(150); /* cost eff. date override*/
      SY0HW01.SY0HWARN[9] = "Y";
      SY0HWIDX = 1;
      while (SY0HWIDX <= 8)
        if (SY0HM001.SY0HMN1P[SY0HWIDX] is modified)
          set SY0HM001.SY0HMN1P[SY0HWIDX] modified;
        end
        if (SY0HM001.SY0HMN2P[SY0HWIDX] is modified)
          set SY0HM001.SY0HMN2P[SY0HWIDX] modified;
        end
        SY0HWIDX = SY0HWIDX + 1;
      end
    end
  end

  if (converseVar.validationMsgNum == 0
   && SY1REC.SY1PRCZS == "S"
   && SY0HW01.SY0HWSW1 == "Y")
    SY0HS23(); /* update style table*/
  end

  if (converseVar.validationMsgNum == 0)
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.commit();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    SY0HM001.SYMSCMSG = " "; /* Clear message line*/
    set SY2REC empty;
    set SY5REC empty;
    set SY7REC empty;
    set SY9REC empty;
    set SYAREC empty;
    SY0HWCT2 = 1;
    while (SY0HWCT2 <= 8)
      SY0HW01.SY0HWARN[SY0HWCT2] = "N";
      SY0HM001.SY2CLRID[SY0HWCT2] = " ";
      SY0HM001.XDMCD[SY0HWCT2] = " ";
      SY0HM001.XLCCD[SY0HWCT2] = " ";
      SY0HM001.SY0HMN1P[SY0HWCT2] = 0;
      SY0HM001.SY0HMN2P[SY0HWCT2] = 0;
      SY0HM001.SY5PSIND[SY0HWCT2] = " ";
      SY0HM001.SY0HME1P[SY0HWCT2] = 0;
      SY0HM001.SY0HMEDT[SY0HWCT2] = " ";
      SY0HM001.SY0HME2P[SY0HWCT2] = 0;
      SY0HWCT2 = SY0HWCT2 + 1;
    end
    SY0HW01.SY0HWARN[9] = "N";
  else
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
  end


end // end SY0H050

// Check for EUR/Local upd
Function SY0H100()

   /* **********************************************************/
   /* *  this process will update the EUR/Local matching      **/
   /* *  price row.                                           **/
   /* **********************************************************/

   /* Do 1st quality price if entered*/
  if (SY0HW01.SY0HW1MD[SY0HWCT2] == "Y")
    set SY5REC empty;
    SY5REC.XGPCD = SY0HM001.XGPCD;
    SY5REC.SY1STNBR = SY0HM001.SY1STNBR;
    SY5REC.XPYCD = SY0HM001.XPYCD;
    SY5REC.SY5SZID = 0;
    SY5REC.XCT-CTRY-CD = SY0HM001.XCTCD;
    SY5REC.XQACD = "01";
    SY5REC.SY2CLRID = SY0HM001.SY2CLRID[SY0HWCT2];
    SY5REC.XDMCD = SY0HM001.XDMCD[SY0HWCT2];
    if (SYEUTBL.SY-PMRY-CRCY-IND[SYWINDEX] == "L")
      SY5REC.ZFC-CRCY-CD = "EUR";
      if (SY0HM001.SY0HMN1P == 0.01
       || (SY0HM001.SY0HMN1P == 1.00
       && SY0HM001.ZFC-CRCY-CD == "ITL"))
        SY0HW01.SY0HWPRC = 0.01;
      else
        SY0HW01.SY0HWPRC = mathLib.round(SY0HM001.SY0HMN1P[SY0HWCT2] /         SYEUTBL.TY-EURO-RATE-AMT[SYWINDEX], -mathLib.decimals(SY0HW01.SY0HWPRC));
      end
    else
      SY5REC.ZFC-CRCY-CD = SYEUTBL.ZFC-CRCY-CD[SYWINDEX];
      if (SY0HM001.SY0HMN1P == 0.01)
        if (SY0HM001.ZFC-CRCY-CD == "ITL")
          SY0HW01.SY0HWPRC = 1.00;
        else
          SY0HW01.SY0HWPRC = SY0HM001.SY0HMN1P;
        end
      else
        SY0HW01.SY0HWPRC = mathLib.round(SY0HM001.SY0HMN1P[SY0HWCT2] *         SYEUTBL.TY-EURO-RATE-AMT[SYWINDEX], -mathLib.decimals(SY0HW01.SY0HWPRC));
      end
    end
    SY0HS16(); /* update size price table*/
  end

  if (converseVar.validationMsgNum != 0)
    return;
  end

   /* Do 2nd quality price if entered*/
  if (SY0HW01.SY0HW2MD[SY0HWCT2] == "Y")
    set SY5REC empty;
    SY5REC.XGPCD = SY0HM001.XGPCD;
    SY5REC.SY1STNBR = SY0HM001.SY1STNBR;
    SY5REC.XPYCD = SY0HM001.XPYCD;
    SY5REC.SY5SZID = 0;
    SY5REC.XCT-CTRY-CD = SY0HM001.XCTCD;
    SY5REC.XQACD = "02";
    SY5REC.SY2CLRID = SY0HM001.SY2CLRID[SY0HWCT2];
    SY5REC.XDMCD = SY0HM001.XDMCD[SY0HWCT2];
    if (SYEUTBL.SY-PMRY-CRCY-IND[SYWINDEX] == "L")
      SY5REC.ZFC-CRCY-CD = "EUR";
      if (SY0HM001.SY0HMN2P == 0.01
       || (SY0HM001.SY0HMN2P == 1.00
       && SY0HM001.ZFC-CRCY-CD == "ITL"))
        SY0HW01.SY0HWPRC = 0.01;
      else
        SY0HW01.SY0HWPRC = mathLib.round(SY0HM001.SY0HMN2P[SY0HWCT2] /         SYEUTBL.TY-EURO-RATE-AMT[SYWINDEX], -mathLib.decimals(SY0HW01.SY0HWPRC));
      end
    else
      SY5REC.ZFC-CRCY-CD = SYEUTBL.ZFC-CRCY-CD[SYWINDEX];
      if (SY0HM001.SY0HMN2P == 0.01)
        if (SY0HM001.ZFC-CRCY-CD == "ITL")
          SY0HW01.SY0HWPRC = 1.00;
        else
          SY0HW01.SY0HWPRC = SY0HM001.SY0HMN2P;
        end
      else
        SY0HW01.SY0HWPRC = mathLib.round(SY0HM001.SY0HMN2P[SY0HWCT2] *         SYEUTBL.TY-EURO-RATE-AMT[SYWINDEX], -mathLib.decimals(SY0HW01.SY0HWPRC));
      end
    end
    SY0HS16(); /* update size price table*/
  end

end // end SY0H100

// Process SYREG regional Row
Function SY0HS-GET-SYREG()

   /* Process SYREG Regional row*/

  XP0HWIX1 = 1;

  while (XP0HWIX1 <= 25)
    if (XP0HW01.XP0HWSEL[XP0HWIX1] == "S" /* USER SELECTED REGION*/
     && XP0HW01.XDR-PROD-REG-CD[XP0HWIX1] 
     in SYWREC.XDR-PROD-REG-CD)          
      VSYREG02.XDR-PROD-REG-CD = XP0HW01.XDR-PROD-REG-CD[XP0HWIX1];
      TA1REC.TA1PGMNM = "SY0H";
      TA1REC.TA1MAP = "SY0HM001";
      XPSY003-VAL-SYREG(); /* validate syreg row*/

      if (SQLCA.VAGen_SQLCODE == 0
       && VSYREG02.XLC-LIFE-CYC-CD[1] <= "10")
        SYAREC.SYABFR = VSYREG02.VSYREG02-GROUP;
        VSYREG02.XLC-LIFE-CYC-CD[1] = SY2REC.XLCCD1;
        VSYREG02.XLC-LIFE-CYC-CD[2] = SY2REC.XLCCD2;
        VSYREG02.XLC-LIFE-CYC-CD[3] = SY2REC.XLCCD3;
        VSYREG02.XLC-LIFE-CYC-CD[4] = SY2REC.XLCCD4;
        VSYREG02.SY-LIFE-CYC-EDT[1] = SY2REC.SY2CEDT1;
        VSYREG02.SY-LIFE-CYC-EDT[2] = SY2REC.SY2CEDT2;
        VSYREG02.SY-LIFE-CYC-EDT[3] = SY2REC.SY2CEDT3;
        VSYREG02.SY-LIFE-CYC-EDT[4] = SY2REC.SY2CEDT4;
        VSYREG02.ZZ-CHNG-DT = SY0HW01.SY0HWDTE;
        VSYREG02.ZZ-CHNG-HHMM = SY0HW01.SY0HWWTM;
        XPSY004-UPD-SYREG(); /* update syreg row*/

        if (converseVar.validationMsgNum == 0)
          SYAREC.SYAUDTYP = "C";
          SYAREC.ZZZSDT = SY0HW01.SY0HWDTE;
          SYAREC.ZZZSTM = SY0HW01.SY0HWWTM;
          XPSY005-AUD-SYREG(); /* syreg audit insert*/

          SY9REC.SY9TGTYP = "C";
          SY9REC.ZZZSDT = SY0HW01.SY0HWDTE;
          SY9REC.ZZZSTM = SY0HW01.SY0HWWTM;
          XPSY006-TAG-SYREG(); /* syreg tag insert*/
        end
      end
    end
    XP0HWIX1 = XP0HWIX1 + 1;
  end


end // end SY0HS-GET-SYREG

// Validate XDR region
Function SY0HS-GET-XP0HM()

   /* Validate XDR Prod Region code*/

  XP0HW01.XP0HW-ONLY-SYREG-FL = "N";
  XP0HW01.XGPCD = SY0HM001.XGPCD;
  XP0HW01.SY1STNBR = SY0HM001.SY1STNBR;
  XP0HW01.SY2CLRID = " ";
  XP0HW01.XDMCD = " ";

  XP0H001(); /* so do it*/

  if (XP0HW02.XP0HWERR == "Y") /* we have an error*/
    if (XP0HW02.XP0HWENR == 0) /* Invalid function key*/
      converseLib.validationFailed(19);
    end
    if (XP0HW02.XP0HWENR == 1) /* No rows found*/
      converseLib.validationFailed(50);
    end
    if (XP0HW02.XP0HWENR == 2) /* Corp. Table Error*/
      converseLib.validationFailed(23);
    end
    return;
  else
    converseLib.clearScreen();
    
  end


end // end SY0HS-GET-XP0HM

Function SY0HS-GET-ZFC()


       /* ******************************************/
       /* *     GET CURRENCY DESCRIPTION          **/
       /* *                                       **/
       /* ******************************************/

  set SQLCA empty;
  SY0HM001.ZFC-CRCY-DESC = " ";

  VZFC0001.ZFC-CRCY-CD = SY0HM001.ZFC-CRCY-CD;

  call "DC0060" ("S ", SQLCA, VZFC0001) {isNoRefresh = yes, isExternal = yes};

  if (SQLCA.VAGen_SQLCODE == 0)
    SY0HM001.ZFC-CRCY-DESC = VZFC0001.ZFC-CRCY-DESC;
  else
    if (SQLCA.VAGen_SQLCODE == 100)
      SY0HM001.VAGen_EZEMSG = "INVALID CURRENCY CODE";
      set SY0HM001.ZFC-CRCY-CD cursor, bold;
      converseLib.validationFailed(3);
    else
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "SY0H   ";
      TA1REC.TA1LOCAT[1] = "SY0HS-   ";
      TA1REC.TA1LOCAT[2] = "GET-ZFC  ";
      TA1REC.TA1LOCAT[3] = "DC0060   ";
      TA1REC.TA1LOCAT[4] = " ";
      TA1REC.TA1MAP = "SY0HM001";
      TA1REC.TA1DBASE = "CORP";
      TA1REC.TA1TBLVU = "VZFC0001";
      TA1TBLKE = VZFC0001.ZFC-CRCY-CD;
      move SQLCA to ERRSQLCA withV60Compat;
      call "TA0020" (TA1REC, ERRSQLCA) {isNoRefresh = yes, isExternal = yes};
      converseLib.validationFailed(23); /* corp table error....*/
      set SY0HM001.ZFC-CRCY-CD cursor, bold;
    end
  end

end // end SY0HS-GET-ZFC

Function SY0HS-POPUPS()

   /* Examine screen and display any pop-up requests to user*/

  if (SY0HM001.XCTCD == "?") /* Show pop-up*/
    XPXX001(); /* init pop-up*/
    XX0XW02.XX0XWHDR = "    Country Codes";
    while (XX0XW02.XX0XWEND == "N")
      XPXCT01(); /* show the window*/
    end
    if (XX0XW02.XX0XWERR == "N" /* no errors*/
     && XX0XW02.XX0XWPIX > 0)   /* user selected something*/
      SY0HM001.XCTCD = XCTTBL.XCTCD[XX0XWPIX];
    end
  end

  if (SY0HM001.ZFC-CRCY-CD == "?") /* Show pop-up*/
    XPXX001(); /* init pop-up*/
    XX0XW02.XX0XWHDR = "    Currency Codes";
    while (XX0XW02.XX0XWEND == "N")
      XPZFC-POP(); /* show the window*/
    end
    if (XX0XW02.XX0XWERR == "N" /* no errors*/
     && XX0XW02.XX0XWPIX > 0)   /* user selected something*/
      SY0HM001.ZFC-CRCY-CD = ZFCWREC.ZFC-CRCY-CD[XX0XWPIX];
    end
  end

  converseLib.clearScreen();
   /* Refresh map*/

end // end SY0HS-POPUPS

// check for fast path exit
Function SY0HS01()

  SY0HM001.SYMSCMSG = " "; /* Clear message field*/

   /* *****************************************/
   /* *  let's check for fast path request   **/
   /* *****************************************/


  if (converseVar.eventKey is enter
   && SY0HM001.CATOAP != "  ")
    move SY0HM001 to COMMAREA withV60Compat;
    XSEXIT();
    SY0HM001.SYMSCMSG = COMMAREA.CAMSG;
    set SY0HM001 alarm;
    set SY0HM001.CATOAP cursor, bold;
    converseLib.validationFailed(1); /* reserved*/
  end

  return;


end // end SY0HS01

// pfkey check
Function SY0HS02()


   /* *****************************************************/
     /* let's check the pfkey entered by the operator   **/
   /* *****************************************************/


  if (converseVar.eventKey is pf1)
    XSPF1();
  else
    if (converseVar.eventKey is pf4)
      XSPF4();
    else
      if (converseVar.eventKey is pf3)
        COMMAREA.CATOAP = "SY0N";
        XSEXIT();
      else
        if (converseVar.eventKey is pf12
         || converseVar.eventKey is enter
         || converseVar.eventKey is pa2)
          return;
        else
          converseLib.validationFailed(19); /* invalid pf key*/
        end
      end
    end
  end


end // end SY0HS02

// obtain style color rows
Function SY0HS03()


   /* ***********************************************************/
   /* *  this routine obtains the color rows for a particular  **/
   /* *  style and moves color id and dimension data to a      **/
   /* *  work area.                                            **/
   /* ***********************************************************/
   /* **/
   /* 02-24-93 JRAMOS Bypass color if the Nike Dept ID  **/
   /* = 'EAO ' and the color product    **/
   /* region code not = '02'            **/
   /* 09-14-93 MBUHIT Above mod superceded by EAO code  **/
   /* added to SYOH020.                 **/
   /* ***********************************************************/


  call "IO0130" ("SN", SQLCA, SY2REC) {isNoRefresh = yes, isExternal = yes};

  if (SQLCA.VAGen_SQLCODE == +100)
    return;
  else
    if (SQLCA.VAGen_SQLCODE != 0)
      converseLib.validationFailed(21); /* color table error - contact systems*/
                                   /* development*/
      SY0HM001.SYMSCMSG = "PRESS PA2 TO START NEW TRANSACTION";
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "SY0H   ";
      TA1REC.TA1LOCAT[1] = "SN       ";
      TA1REC.TA1LOCAT[2] = "SY0HS03  ";
      TA1REC.TA1LOCAT[3] = "IO0130   ";
      TA1REC.TA1LOCAT[4] = " ";
      TA1REC.TA1MAP = "SY0HM001";
      TA1REC.TA1DBASE = "SY2REC";
      TA1REC.TA1TBLVU = "DPROD.VCOLOR01";
      TA1TBLKE = SY2REC.SY2KEY;
      move SQLCA to ERRSQLCA withV60Compat;
      VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
      VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
      sysLib.rollback();
      VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
      
      call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
      return;
    else
      if (SY0HWCT1 > 200)
        converseLib.validationFailed(43); /* color row count exceeded - contact*/
                                   /* sys. dvlpmnt*/
        return;
      end
    end
  end


  SY0HW01.SY0HWSFL = "Y"; /* OK, store color*/


  if (SY0HW01.SY0HWSFL == "Y") /* Color OK to store*/
    if (SY0HM001.SY0HMLCY != "  ")
      if (SY0HW01.SY0HWDTE >= SY2REC.SY2CEDT1)
        if (SY0HM001.SY0HMLCY == SY2REC.XLCCD1)
          SY0HW01.SY0HWCLR[SY0HWCT1] = SY2REC.SY2CLRID;
          SY0HW01.SY0HWDIM[SY0HWCT1] = SY2REC.XDMCD;
          SY0HW01.SY0HWLCY[SY0HWCT1] = SY2REC.XLCCD1;
        end
      else
        if (SY0HW01.SY0HWDTE >= SY2REC.SY2CEDT2)
          if (SY0HM001.SY0HMLCY == SY2REC.XLCCD2)
            SY0HW01.SY0HWCLR[SY0HWCT1] = SY2REC.SY2CLRID;
            SY0HW01.SY0HWDIM[SY0HWCT1] = SY2REC.XDMCD;
            SY0HW01.SY0HWLCY[SY0HWCT1] = SY2REC.XLCCD2;
          end
        else
          if (SY0HW01.SY0HWDTE >= SY2REC.SY2CEDT3)
            if (SY0HM001.SY0HMLCY == SY2REC.XLCCD3)
              SY0HW01.SY0HWCLR[SY0HWCT1] = SY2REC.SY2CLRID;
              SY0HW01.SY0HWDIM[SY0HWCT1] = SY2REC.XDMCD;
              SY0HW01.SY0HWLCY[SY0HWCT1] = SY2REC.XLCCD3;
            end
          else
            if (SY0HW01.SY0HWDTE >= SY2REC.SY2CEDT4)
              if (SY0HM001.SY0HMLCY == SY2REC.XLCCD4)
                SY0HW01.SY0HWCLR[SY0HWCT1] = SY2REC.SY2CLRID;
                SY0HW01.SY0HWDIM[SY0HWCT1] = SY2REC.XDMCD;
                SY0HW01.SY0HWLCY[SY0HWCT1] = SY2REC.XLCCD4;
              end
            end
          end
        end
      end
    else
      SY0HW01.SY0HWCLR[SY0HWCT1] = SY2REC.SY2CLRID;
      SY0HW01.SY0HWDIM[SY0HWCT1] = SY2REC.XDMCD;
      if (SY0HW01.SY0HWDTE >= SY2REC.SY2CEDT1)
        SY0HWLCY[SY0HWCT1] = SY2REC.XLCCD1;
      else
        if (SY0HW01.SY0HWDTE >= SY2REC.SY2CEDT2)
          SY0HWLCY[SY0HWCT1] = SY2REC.XLCCD2;
        else
          if (SY0HW01.SY0HWDTE >= SY2REC.SY2CEDT3)
            SY0HWLCY[SY0HWCT1] = SY2REC.XLCCD3;
          else
            if (SY0HW01.SY0HWDTE >= SY2REC.SY2CEDT4)
              SY0HWLCY[SY0HWCT1] = SY2REC.XLCCD4;
            end
          end
        end
      end
    end

    if (SY0HW01.SY0HWCLR[SY0HWCT1] != "   ")
      if (SYWREC.SYW-ALL-REGIONS-FL == "Y")
        SY0HW01.SY0HW-UPD-SY2[SY0HWCT1] = "Y";
      else
        if (SY2REC.XDR-PROD-REG-CD
         in SYWREC.XDR-PROD-REG-CD)
          SY0HW01.SY0HW-UPD-SY2[SY0HWCT1] = "Y";
        else
          SY0HW01.SY0HW-UPD-SY2[SY0HWCT1] = "N";
        end
      end
      SY0HW01.SY0HWCT1 = SY0HW01.SY0HWCT1 + 1;
    end

  end

end // end SY0HS03

Function SY0HS04()


   /* *************************************************************/
   /* *  this little routine calculates the 2nd quality prices.  **/
   /* *************************************************************/

  if (SY0HW01.SY0HW1MD[SY0HWCT2] == "Y") /* if 1st qual entered*/
    SY0HW01.SY0HW2MD[SY0HWCT2] = "Y"; /* set 2nd qual too*/
  end

  if (SY0HM001.SY0HMN1P[SY0HWCT2] == 0)
    SY0HM001.SY0HMN2P[SY0HWCT2] = 0;
    return;
  else
    SY0HW01.SY0HWAAA = SY0HM001.SY0HMN1P[SY0HWCT2];
  end


  if (SY0HM001.SY0HMRND != 0)
    SY0HW01.SY0HWAAA = SY0HW01.SY0HWAAA * SY0HM001.SY0HMPCT * .01;
    SY0HW01.SY0HWAAA = SY0HW01.SY0HWAAA + SY0HM001.SY0HMCNT;
    SY0HW01.SY0HWBBB = SY0HW01.SY0HWAAA / SY0HM001.SY0HMRND;
    SY0HW01.SY0HWDDD = SY0HW01.SY0HWBBB;
    if (SY0HW01.SY0HWDDD == 0)
      SY0HM001.SY0HMN2P[SY0HWCT2] = SY0HW01.SY0HWAAA;
    else
      while (SY0HW01.SY0HWDDD != 0)
        if (SY0HM001.SY0HMRND > 0)
          SY0HW01.SY0HWAAA = SY0HW01.SY0HWAAA + .01;
        else
          SY0HW01.SY0HWAAA = SY0HW01.SY0HWAAA - .01;
        end
        SY0HW01.SY0HWBBB = SY0HW01.SY0HWAAA / SY0HM001.SY0HMRND;
        SY0HW01.SY0HWDDD = SY0HW01.SY0HWBBB;
        if (SY0HW01.SY0HWDDD == 0)
          SY0HM001.SY0HMN2P[SY0HWCT2] = SY0HW01.SY0HWAAA;
        end
      end
    end
  else
   /* tcs changes begin 10/22/99*/
    SY0HW01.SY0HWAAA = mathLib.round(SY0HW01.SY0HWAAA * SY0HM001.SY0HMPCT * .01, -mathLib.decimals(SY0HW01.SY0HWAAA));
    SY0HW01.SY0HWAAA = SY0HW01.SY0HWAAA + SY0HM001.SY0HMCNT;
   /* tcs changes end   10/22/99*/
    SY0HM001.SY0HMN2P[SY0HWCT2] = SY0HW01.SY0HWAAA;
  end


  return;
end // end SY0HS04

// select date & price defaults
Function SY0HS05()


   /* ****************************************************/
   /* *  obtain default effective date from the price   **/
   /* *  style table                                    **/
   /* ****************************************************/


  if (SY0HW01.SY0HWDTE >= SY5REC.SY5PCEDT[SY0HWCT2])
    SY0HM001.SY0HMDPR = SY5REC.SY5PRCUN[SY0HWCT2];
    set TA2REC empty;
    TA2REC.TA2DTOPT = "GREGGREG";
    TA2REC.TA2GRTYP = "G";
    TA2REC.TA2GRGGN = SY5REC.SY5PCEDT[SY0HWCT2];
    call "TA0040" (TA2REC) {isNoRefresh = yes, isExternal = yes};
    if (TA2REC.TA2RTNCD == 0)
      SY0HM001.SY0HMDDT = TA2REC.TA2GRGEN;
    else
      converseLib.validationFailed(42); /* internal date error - call systems*/
                                   /* development*/
      return;
    end
    SY0HWCT2 = 7;
  end


end // end SY0HS05

// obtain effective date & price
Function SY0HS06()


   /* **********************************************************/
   /* *  obtain 1st and 2nd quality effective date from the   **/
   /* *  price style table                                    **/
   /* **********************************************************/


  if (SY0HW01.SY0HWDTE >= SY5REC.SY5PCEDT[SY0HWCT2])
    if (SY5REC.XQACD == "01")
      SY0HW01.SY0HWE1P[SY0HWCT3] = SY5REC.SY5PRCUN[SY0HWCT2];
      set TA2REC empty;
      TA2REC.TA2DTOPT = "GREGGREG";
      TA2REC.TA2GRTYP = "G";
      TA2REC.TA2GRGGN = SY5REC.SY5PCEDT[SY0HWCT2];
      call "TA0040" (TA2REC) {isNoRefresh = yes, isExternal = yes};
      if (TA2REC.TA2RTNCD == 0)
        SY0HW01.SY0HWEFF[SY0HWCT3] = TA2REC.TA2GRGEN;
      else
        converseLib.validationFailed(42); /* internal date error - call systems*/
                                   /* development*/
        return;
      end
      SY0HWCT2 = 7; /* to halt loop*/
    else
      SY0HW01.SY0HWE2P[SY0HWCT3] = SY5REC.SY5PRCUN[SY0HWCT2];
      SY0HWCT2 = 7; /* to halt loop*/
    end
  end


end // end SY0HS06

// obtain 1st quality price
Function SY0HS08()


   /* **********************************************/
   /* *  obtain price by style 1st quality        **/
   /* **********************************************/


  SY5REC.XGPCD = SY0HM001.XGPCD;
  SY5REC.SY1STNBR = SY0HM001.SY1STNBR;
  SY5REC.SY5SZID = 0;
  SY5REC.XPYCD = SY0HM001.XPYCD;
  SY5REC.XCT-CTRY-CD = SY0HM001.XCTCD;
  SY5REC.ZFC-CRCY-CD = SY0HM001.ZFC-CRCY-CD;
  SY5REC.XDMCD = SY0HW01.SY0HWDIM[SY0HWCT4];
  SY5REC.SY2CLRID = SY0HW01.SY0HWCLR[SY0HWCT4];
  SY0HW01.SY2CLRID[SY0HWCT3] = SY0HW01.SY0HWCLR[SY0HWCT4];
  SY0HW01.XDMCD[SY0HWCT3] = SY0HW01.SY0HWDIM[SY0HWCT4];
  SY0HW01.XLCCD[SY0HWCT3] = SY0HW01.SY0HWLCY[SY0HWCT4];
  call "IO0380" ("S ", SQLCA, SY5REC) {isNoRefresh = yes, isExternal = yes};
  if (SQLCA.VAGen_SQLCODE == 0)
    SY0HWCT2 = 1;
    while (SY0HWCT2 <= 6
     && SY5REC.SY5PCEDT[SY0HWCT2] != 0)
      SY0HS06(); /* obtain effective date and price*/
      SY0HWCT2 = SY0HWCT2 + 1;
    end
  else
    if (SQLCA.VAGen_SQLCODE != +100)
      converseLib.validationFailed(38); /* price table error*/
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "SY0H   ";
      TA1REC.TA1LOCAT[1] = "S        ";
      TA1REC.TA1LOCAT[2] = "SY0HS08  ";
      TA1REC.TA1LOCAT[3] = "IO0380   ";
      TA1REC.TA1LOCAT[4] = " ";
      TA1REC.TA1MAP = "SY0HM001";
      TA1REC.TA1DBASE = "SY5REC";
      TA1REC.TA1TBLVU = "DPROD.VPRICE01";
      TA1TBLKE = SY5REC.SY5KEY;
      move SQLCA to ERRSQLCA withV60Compat;
      VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
      VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
      sysLib.rollback();
      VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
      
      call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
      return;
    end
  end


end // end SY0HS08

// size/price audit processing
Function SY0HS10()


   /* *****************************************************/
   /* *  this statement group formats the audit record   **/
   /* *  and performs the add call to db2 for size/price **/
   /* *****************************************************/


  SYAREC.XXXTBLNM = "VPRICE01";
  if (SYAREC.XXXTBLNM in SYZTBL.XXXTBLNM)
    SYAREC.SYASRTSQ = SYZTBL.SYASRTSQ[sysVar.arrayIndex];
    SYAREC.SYABFLN = SYZTBL.SYZIMLEN[sysVar.arrayIndex];
    SYAREC.SYAFTLN = SYZTBL.SYZIMLEN[sysVar.arrayIndex];
  else
    TA1REC.TA1TYPE = "DB2 ";
    TA1REC.TA1FUNC = "RETN";
    TA1REC.TA1PGMNM = "SY0H   ";
    TA1REC.TA1LOCAT[1] = "SY0HS10  ";
    TA1REC.TA1LOCAT[2] = "SYZTBL   ";
    TA1REC.TA1LOCAT[3] = "VPRICE01 ";
    TA1REC.TA1MAP = "SY0HM001";
    TA1REC.TA1DBASE = "DPROD.";
    TA1REC.TA1TBLVU = "VSYAUD01";
    TA1TBLKE = "TABLE NOT FOUND";
    move SQLCA to ERRSQLCA withV60Compat;
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
    converseLib.validationFailed(44); /* audit table error....*/
    exit stack;
  end
  SYAREC.XNDCD = COMMAREA.XNDCD;
  SYAREC.XXXUSRID = COMMAREA.CAUSERID;
  SYAREC.XGPCD = SY5REC.XGPCD;
  SYAREC.SY1STNBR = SY5REC.SY1STNBR;
  SYAREC.SY2CLRID = SY5REC.SY2CLRID;
  SYAREC.XDMCD = SY5REC.XDMCD;
  SYAREC.SY5SZID = SY5REC.SY5SZID;
  SYAREC.SYATYPCD = SY5REC.XPYCD;
  SYAREC.XQACD = SY5REC.XQACD;

  SYAREC.ZZZSDT = SY0HW01.SY0HWDTE;
  SYAREC.ZZZSTM = SY0HW01.SY0HWWTM;

  call "IO0530" ("A ", SQLCA, SYAREC) {isNoRefresh = yes, isExternal = yes};

  if (SQLCA.VAGen_SQLCODE == -803)
    converseLib.validationFailed(37);
                                   /* unable to process update - try again*/
  else
    if (SQLCA.VAGen_SQLCODE != 0)
      converseLib.validationFailed(44); /* audit table error - call systems development*/
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "SY0H   ";
      TA1REC.TA1LOCAT[1] = "A        ";
      TA1REC.TA1LOCAT[2] = "SY0HS10  ";
      TA1REC.TA1LOCAT[3] = "IO0530   ";
      TA1REC.TA1LOCAT[4] = " ";
      TA1REC.TA1MAP = "SY0HM001";
      TA1REC.TA1DBASE = "SYAREC";
      TA1REC.TA1TBLVU = "DPROD.VSYAUD01";
      TA1TBLKE = SYAREC.SYAKEY;
      move SQLCA to ERRSQLCA withV60Compat;
      VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
      VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
      sysLib.rollback();
      VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
      
      call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
      return;
    end
  end


end // end SY0HS10

// style/color audit processing
Function SY0HS11()


   /* ****************************************************/
   /* *  this statement group formats the audit record  **/
   /* *  and performs the add call to db2 for the       **/
   /* *  style/color table.*/
   /* ****************************************************/


  SYAREC.XXXTBLNM = "VCOLOR01";
  if (SYAREC.XXXTBLNM in SYZTBL.XXXTBLNM)
    SYAREC.SYASRTSQ = SYZTBL.SYASRTSQ[sysVar.arrayIndex];
    SYAREC.SYABFLN = SYZTBL.SYZIMLEN[sysVar.arrayIndex];
    SYAREC.SYAFTLN = SYZTBL.SYZIMLEN[sysVar.arrayIndex];
  else
    TA1REC.TA1TYPE = "DB2 ";
    TA1REC.TA1FUNC = "RETN";
    TA1REC.TA1PGMNM = "SY0H   ";
    TA1REC.TA1LOCAT[1] = "SY0HS11  ";
    TA1REC.TA1LOCAT[2] = "SYZTBL   ";
    TA1REC.TA1LOCAT[3] = "VCOLOR01 ";
    TA1REC.TA1MAP = "SY0HM001";
    TA1REC.TA1DBASE = "DPROD.";
    TA1REC.TA1TBLVU = "VSYAUD01";
    TA1TBLKE = "TABLE NOT FOUND";
    move SQLCA to ERRSQLCA withV60Compat;
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
    converseLib.validationFailed(44); /* audit table error....*/
    exit stack;
  end
  SYAREC.XNDCD = COMMAREA.XNDCD;
  SYAREC.XXXUSRID = COMMAREA.CAUSERID;
  SYAREC.XGPCD = SY2REC.XGPCD;
  SYAREC.SY1STNBR = SY2REC.SY1STNBR;
  SYAREC.SY2CLRID = SY2REC.SY2CLRID;
  SYAREC.XDMCD = SY2REC.XDMCD;
  SYAREC.SY5SZID = 0;
  SYAREC.SYATYPCD = " ";
  SYAREC.XQACD = " ";

  SYAREC.ZZZSDT = SY0HW01.SY0HWDTE;
  SYAREC.ZZZSTM = SY0HW01.SY0HWWTM;

  call "IO0530" ("A ", SQLCA, SYAREC) {isNoRefresh = yes, isExternal = yes};

  if (SQLCA.VAGen_SQLCODE == -803)
    converseLib.validationFailed(37);
                                   /* unable to process update - try again*/
  else
    if (SQLCA.VAGen_SQLCODE != 0)
      converseLib.validationFailed(44); /* audit table error - call systems development*/
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "SY0H   ";
      TA1REC.TA1LOCAT[1] = "A        ";
      TA1REC.TA1LOCAT[2] = "SY0HS11  ";
      TA1REC.TA1LOCAT[3] = "IO0530   ";
      TA1REC.TA1LOCAT[4] = " ";
      TA1REC.TA1MAP = "SY0HM001";
      TA1REC.TA1DBASE = "SYAREC";
      TA1REC.TA1TBLVU = "DPROD.VSYAUD01";
      TA1TBLKE = SYAREC.SYAKEY;
      move SQLCA to ERRSQLCA withV60Compat;
      VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
      VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
      sysLib.rollback();
      VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
      
      call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
      return;
    end
  end


end // end SY0HS11

// style audit processing
Function SY0HS12()


   /* ****************************************************/
   /* *  this statement group formats the audit record  **/
   /* *  and performs the add call to db2 for the       **/
   /* *  style table.*/
   /* ****************************************************/


  SYAREC.XXXTBLNM = "VSTYLE01";
  if (SYAREC.XXXTBLNM in SYZTBL.XXXTBLNM)
    SYAREC.SYASRTSQ = SYZTBL.SYASRTSQ[sysVar.arrayIndex];
    SYAREC.SYABFLN = SYZTBL.SYZIMLEN[sysVar.arrayIndex];
    SYAREC.SYAFTLN = SYZTBL.SYZIMLEN[sysVar.arrayIndex];
  else
    TA1REC.TA1TYPE = "DB2 ";
    TA1REC.TA1FUNC = "RETN";
    TA1REC.TA1PGMNM = "SY0H   ";
    TA1REC.TA1LOCAT[1] = "SY0HS12  ";
    TA1REC.TA1LOCAT[2] = "SYZTBL   ";
    TA1REC.TA1LOCAT[3] = "VSTYLE01 ";
    TA1REC.TA1MAP = "SY0HM001";
    TA1REC.TA1DBASE = "DPROD.";
    TA1REC.TA1TBLVU = "VSYAUD01";
    TA1TBLKE = "TABLE NOT FOUND";
    move SQLCA to ERRSQLCA withV60Compat;
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
    converseLib.validationFailed(44); /* audit table error....*/
    exit stack;
  end
  SYAREC.XNDCD = COMMAREA.XNDCD;
  SYAREC.XXXUSRID = COMMAREA.CAUSERID;
  SYAREC.XGPCD = SY1REC.XGPCD;
  SYAREC.SY1STNBR = SY1REC.SY1STNBR;
  SYAREC.SY2CLRID = " ";
  SYAREC.XDMCD = " ";
  SYAREC.SY5SZID = 0;
  SYAREC.SYATYPCD = " ";
  SYAREC.XQACD = " ";

  SYAREC.ZZZSDT = SY0HW01.SY0HWDTE;
  SYAREC.ZZZSTM = SY0HW01.SY0HWWTM;

  call "IO0530" ("A ", SQLCA, SYAREC) {isNoRefresh = yes, isExternal = yes};

  if (SQLCA.VAGen_SQLCODE == -803)
    converseLib.validationFailed(37);
                                   /* unable to process update - try again*/
  else
    if (SQLCA.VAGen_SQLCODE != 0)
      converseLib.validationFailed(44); /* audit table error - call systems development*/
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "SY0H   ";
      TA1REC.TA1LOCAT[1] = "A        ";
      TA1REC.TA1LOCAT[2] = "SY0HS12  ";
      TA1REC.TA1LOCAT[3] = "IO0530   ";
      TA1REC.TA1LOCAT[4] = " ";
      TA1REC.TA1MAP = "SY0HM001";
      TA1REC.TA1DBASE = "SYAREC";
      TA1REC.TA1TBLVU = "DPROD.VSYAUD01";
      TA1TBLKE = SYAREC.SYAKEY;
      move SQLCA to ERRSQLCA withV60Compat;
      VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
      VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
      sysLib.rollback();
      VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
      
      call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
      return;
    end
  end


end // end SY0HS12

// update price and color tables
Function SY0HS15()


   /* **********************************************************/
   /* *  this module updates the size/price and style/color   **/
   /* *  tables.                                              **/
   /* **********************************************************/


  set SY5REC empty;
  SY5REC.XGPCD = SY0HM001.XGPCD;
  SY5REC.SY1STNBR = SY0HM001.SY1STNBR;
  SY5REC.XPYCD = SY0HM001.XPYCD;
  SY5REC.SY5SZID = 0;
  SY5REC.XCT-CTRY-CD = SY0HM001.XCTCD;
  SY5REC.ZFC-CRCY-CD = SY0HM001.ZFC-CRCY-CD;
  if (SY0HW01.SY0HW1MD[SY0HWCT2] == "N")
    if (SY0HW01.SY0HW2MD[SY0HWCT2] == "Y")
      SY5REC.XQACD = "02";
      SY5REC.SY2CLRID = SY0HM001.SY2CLRID[SY0HWCT2];
      SY5REC.XDMCD = SY0HM001.XDMCD[SY0HWCT2];
      SY0HW01.SY0HWPRC = SY0HM001.SY0HMN2P[SY0HWCT2];
      SY0HS16(); /* update size price table*/
    else
      /* next sentence*/
    end
  else
    if (SY0HW01.SY0HW2MD[SY0HWCT2] == "N")
      SY5REC.XQACD = "01";
      SY5REC.SY2CLRID = SY0HM001.SY2CLRID[SY0HWCT2];
      SY5REC.XDMCD = SY0HM001.XDMCD[SY0HWCT2];
      SY0HW01.SY0HWPRC = SY0HM001.SY0HMN1P[SY0HWCT2];
      SY0HS16(); /* update size price table*/
    else
      SY5REC.XQACD = "01";
      SY5REC.SY2CLRID = SY0HM001.SY2CLRID[SY0HWCT2];
      SY5REC.XDMCD = SY0HM001.XDMCD[SY0HWCT2];
      SY0HW01.SY0HWPRC = SY0HM001.SY0HMN1P[SY0HWCT2];
      SY0HS16(); /* update size price table*/
      if (converseVar.validationMsgNum != 0)
        return;
      else
        set SY5REC empty;
        SY5REC.XGPCD = SY0HM001.XGPCD;
        SY5REC.SY1STNBR = SY0HM001.SY1STNBR;
        SY5REC.XPYCD = SY0HM001.XPYCD;
        SY5REC.SY5SZID = 0;
        SY5REC.XCT-CTRY-CD = SY0HM001.XCTCD;
        SY5REC.ZFC-CRCY-CD = SY0HM001.ZFC-CRCY-CD;
        SY5REC.XQACD = "02";
        SY5REC.SY2CLRID = SY0HM001.SY2CLRID[SY0HWCT2];
        SY5REC.XDMCD = SY0HM001.XDMCD[SY0HWCT2];
        SY0HW01.SY0HWPRC = SY0HM001.SY0HMN2P[SY0HWCT2];
        SY0HS16(); /* update size price table*/
      end
    end
  end


   /* **********************************************************/
   /* *  If this is an EAO color, create price type 01 (whsl) **/
   /* *  1st and 2nd quality records with amount = 999.99     **/
   /* *  when either 1st or 2nd quality has been updated.     **/
   /* **********************************************************/

  if (SYWREC.XDR-PROD-REG-CD[SYWREGX] == "02") /* USER is EAO*/
    SY0HS26(); /* read color table*/
    if (SY2REC.XDR-PROD-REG-CD == "02") /* EAO color*/
      if (SY0HW01.SY0HW1MD[SY0HWCT2] == "Y"
       || SY0HW01.SY0HW2MD[SY0HWCT2] == "Y")
        set SY5REC empty;
        SY5REC.XGPCD = SY0HM001.XGPCD;
        SY5REC.SY1STNBR = SY0HM001.SY1STNBR;
        SY5REC.XPYCD = "01";
        SY5REC.SY5SZID = 0;
        SY5REC.XQACD = "01"; /* 1st quality*/
        SY5REC.XCT-CTRY-CD = "USA";
        SY5REC.ZFC-CRCY-CD = "USD";
        SY5REC.SY2CLRID = SY0HM001.SY2CLRID[SY0HWCT2];
        SY5REC.XDMCD = SY0HM001.XDMCD[SY0HWCT2];
        SY0HW01.SY0HWPRC = 999.99;
        SY0HS16(); /* update size price table*/
        if (converseVar.validationMsgNum != 0)
          return;
        else
          set SY5REC empty;
          SY5REC.XGPCD = SY0HM001.XGPCD;
          SY5REC.SY1STNBR = SY0HM001.SY1STNBR;
          SY5REC.XPYCD = "01";
          SY5REC.SY5SZID = 0;
          SY5REC.XQACD = "02"; /* 2nd quality*/
          SY5REC.XCT-CTRY-CD = "USA";
          SY5REC.ZFC-CRCY-CD = "USD";
          SY5REC.SY2CLRID = SY0HM001.SY2CLRID[SY0HWCT2];
          SY5REC.XDMCD = SY0HM001.XDMCD[SY0HWCT2];
          SY0HW01.SY0HWPRC = 999.99;
          SY0HS16(); /* update size price table*/
        end
      end
    end
  end


  if (converseVar.validationMsgNum == 0)
    if (SY0HM001.XLCCD[SY0HWCT2] != "  ") /* lifecycle changed?*/
      if (SY0HM001.XLCCD[SY0HWCT2] != SY0HW01.SY0HWSLC[SY0HWCT2])
        SY0HS24(); /* update style color table*/
      end
    end
  end

end // end SY0HS15

// replace/add decision for price
Function SY0HS16()


   /* ************************************************************/
   /* *  this is the statement group that actually makes        **/
   /* *  the call to the size price table and then decides if   **/
   /* *  this is going to be a replace or an add.               **/
   /* ************************************************************/


  SY0HW01.SY0HWSW1 = "Y";

  call "IO0380" ("S ", SQLCA, SY5REC) {isNoRefresh = yes, isExternal = yes};
  if (SQLCA.VAGen_SQLCODE == 0) /* row exists = replace*/
    if (SY0HW01.SY0HWPRC == 999.99 /* override amount*/
     && SY5REC.SY5PRCUN[1] != 0)  
      return; /* do not override existing amt*/
    else
      SYAREC.SYABFR = SY5REC.SY5DATA;
      SY0HS17(); /* replace a row*/
    end
  else
    if (SQLCA.VAGen_SQLCODE == +100)
      SY0HS18(); /* add a row*/
    else
      converseLib.validationFailed(38); /* price table error*/
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "SY0H   ";
      TA1REC.TA1LOCAT[1] = "S        ";
      TA1REC.TA1LOCAT[2] = "SY0HS16  ";
      TA1REC.TA1LOCAT[3] = "IO0380   ";
      TA1REC.TA1LOCAT[4] = " ";
      TA1REC.TA1MAP = "SY0HM001";
      TA1REC.TA1DBASE = "SY5REC";
      TA1REC.TA1TBLVU = "DPROD.VPRICE01";
      TA1TBLKE = SY5REC.SY5KEY;
      move SQLCA to ERRSQLCA withV60Compat;
      VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
      VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
      sysLib.rollback();
      VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
      
      call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
      return;
    end
  end

  return;


end // end SY0HS16

// replace price row
Function SY0HS17()


   /* *************************************************************/
   /* *  this statement group :                                  **/
   /* *   1) converts system date and time and moves audit data  **/
   /* *      to the output record area                           **/
   /* *   2) rolls the price data in the size price table and    **/
   /* *      does the actual replace                             **/
   /* *************************************************************/


  SY0HWCT5 = 1;

  while (SY0HWCT5 <= 6
   && SY5REC.SY5PCEDT[SY0HWCT5] != 0
   && converseVar.validationMsgNum == 0)
    SY0HS20();
                                   /* verify effective date and price loop*/
    SY0HWCT5 = SY0HWCT5 + 1;
  end

  if (converseVar.validationMsgNum != 0)
    return;
  end

  SY5REC.ZZZCHGDT = SY0HW01.SY0HWDTE;
  SY5REC.ZZZCHGTM = SY0HW01.SY0HWWTM;

  if (SY5REC.SY5PCEDT[1] != 0)
    if (SY5REC.SY5PCEDT[2] != 0)
      if (SY5REC.SY5PCEDT[3] != 0)
        if (SY5REC.SY5PCEDT[4] != 0)
          if (SY5REC.SY5PCEDT[5] != 0)
            if (SY5REC.SY5PCEDT[6] != 0)
              SY0HS21(); /* history table processing*/
              SY0HWCT5 = 5;
              SY0HWCT6 = 6;
              SY5REC.SY5HSTSW = "Y";
              while (SY0HWCT5 >= 1)
                SY0HS22(); /* moves for size price update*/
                SY0HWCT5 = SY0HWCT5 - 1;
                SY0HWCT6 = SY0HWCT6 - 1;
              end
            else
              SY0HWCT5 = 5;
              SY0HWCT6 = 6;
              while (SY0HWCT5 >= 1)
                SY0HS22(); /* moves for size price update*/
                SY0HWCT5 = SY0HWCT5 - 1;
                SY0HWCT6 = SY0HWCT6 - 1;
              end
            end
          else
            SY0HWCT5 = 4;
            SY0HWCT6 = 5;
            while (SY0HWCT5 >= 1)
              SY0HS22(); /* moves for size price update*/
              SY0HWCT5 = SY0HWCT5 - 1;
              SY0HWCT6 = SY0HWCT6 - 1;
            end
          end
        else
          SY0HWCT5 = 3;
          SY0HWCT6 = 4;
          while (SY0HWCT5 >= 1)
            SY0HS22(); /* moves for size price update*/
            SY0HWCT5 = SY0HWCT5 - 1;
            SY0HWCT6 = SY0HWCT6 - 1;
          end
        end
      else
        SY0HWCT5 = 2;
        SY0HWCT6 = 3;
        while (SY0HWCT5 >= 1)
          SY0HS22(); /* moves for size price update*/
          SY0HWCT5 = SY0HWCT5 - 1;
          SY0HWCT6 = SY0HWCT6 - 1;
        end
      end
    else
      SY0HWCT5 = 1;
      SY0HWCT6 = 2;
      while (SY0HWCT5 >= 1)
        SY0HS22(); /* moves for size price update*/
        SY0HWCT5 = SY0HWCT5 - 1;
        SY0HWCT6 = SY0HWCT6 - 1;
      end
    end
  else
    SY5REC.SY5PCEDT[1] = SY0HM001.SY5PCEDT;
    SY5REC.SY5PRCUN[1] = SY0HW01.SY0HWPRC;
    SY5REC.SY5PSIND[1] = SY0HM001.SY5PSIND[SY0HWCT2];
  end

  call "IO0380" ("U ", SQLCA, SY5REC) {isNoRefresh = yes, isExternal = yes};
  if (SQLCA.VAGen_SQLCODE == +100)
    converseLib.validationFailed(37);
                                   /* unable to process update - try again*/
  else
    if (SQLCA.VAGen_SQLCODE != 0)
      converseLib.validationFailed(38); /* price table error*/
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "SY0H   ";
      TA1REC.TA1LOCAT[1] = "U        ";
      TA1REC.TA1LOCAT[2] = "SY0HS17  ";
      TA1REC.TA1LOCAT[3] = "IO0380   ";
      TA1REC.TA1LOCAT[4] = " ";
      TA1REC.TA1MAP = "SY0HM001";
      TA1REC.TA1DBASE = "SY5REC";
      TA1REC.TA1TBLVU = "DPROD.VPRICE01";
      TA1TBLKE = SY5REC.SY5KEY;
      move SQLCA to ERRSQLCA withV60Compat;
      VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
      VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
      sysLib.rollback();
      VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
      
      call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
      return;
    else
      SYAREC.SYAUDTYP = "A";
      SYAREC.SYAAFT = SY5REC.SY5DATA;
      SY0HS10(); /* size/price table audit processing*/
      if (converseVar.validationMsgNum == 0)
        SY9REC.SY9TGTYP = "A";
        SY0HS30(); /* size/price table tag processing*/
      end
    end
  end

  return;


end // end SY0HS17

// add a row to price table
Function SY0HS18()


   /* ***********************************************************/
   /* *  this statement group :                                **/
   /* *   1) formats the output record area                    **/
   /* *   2) performs the call to the size price table to add  **/
   /* *      a row to the table                                **/
   /* ***********************************************************/


  SY5REC.ZZZSDT = SY0HW01.SY0HWDTE;
  SY5REC.ZZZCHGDT = SY0HW01.SY0HWDTE;
  SY5REC.ZZZCHGTM = SY0HW01.SY0HWWTM;
  SY5REC.ZZZCHGCT = 0;
  SY5REC.SY5HSTSW = "N";

  if (SY0HW01.SY0HWEDT > SY5REC.ZZZSDT
   && COMMAREA.XDVCD != "02") /* and not NIL user*/
    SY5REC.SY5PCEDT[1] = SY5REC.ZZZSDT;
    SY0HW01.SY0HWARN[SY0HWCT2] = "Y";
  else
    SY5REC.SY5PCEDT[1] = SY0HW01.SY0HWEDT;
  end

  SY5REC.SY5PRCUN[1] = SY0HW01.SY0HWPRC;
  if (SY5REC.XQACD == "01")
    SY5REC.SY5PSIND[1] = SY0HM001.SY5PSIND[SY0HWCT2];
  else
    SY5REC.SY5PSIND[1] = " ";
  end

  call "IO0380" ("A ", SQLCA, SY5REC) {isNoRefresh = yes, isExternal = yes};
  if (SQLCA.VAGen_SQLCODE == -803)
    converseLib.validationFailed(37);
                                   /* unable to process update - try again*/
  else
    if (SQLCA.VAGen_SQLCODE != 0)
      converseLib.validationFailed(38); /* price table error*/
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "SY0H   ";
      TA1REC.TA1LOCAT[1] = "A        ";
      TA1REC.TA1LOCAT[2] = "SY0HS18  ";
      TA1REC.TA1LOCAT[3] = "IO0380   ";
      TA1REC.TA1LOCAT[4] = " ";
      TA1REC.TA1MAP = "SY0HM001";
      TA1REC.TA1DBASE = "SY5REC";
      TA1REC.TA1TBLVU = "DPROD.VPRICE01";
      TA1TBLKE = SY5REC.SY5KEY;
      move SQLCA to ERRSQLCA withV60Compat;
      VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
      VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
      sysLib.rollback();
      VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
      
      call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
      return;
    else
      SYAREC.SYAUDTYP = "A";
      SYAREC.SYABFR = " ";
      SYAREC.SYAAFT = SY5REC.SY5DATA;
      SY0HS10(); /* size/price table audit processing*/
      if (converseVar.validationMsgNum == 0)
        SY9REC.SY9TGTYP = "C";
        SY0HS30(); /* size/price table tag processing*/
      end
    end
  end

  return;

end // end SY0HS18

// convert date and time
Function SY0HS19()


   /* *********************************************************/
   /* *  this routine converts ezetim to a number that       **/
   /* *  we can use to put out to the tables on an update    **/
   /* *********************************************************/


  SY0HW01.SY0HWZTM = VGVar.currentFormattedTime;
  SY0HW01.SY0HWWHR = SY0HW01.SY0HWZHR;
  SY0HW01.SY0HWWMN = SY0HW01.SY0HWZMN;


end // end SY0HS19

// verify eff. date and price
Function SY0HS20()


   /* **********************************************************/
   /* *  this statement group loops through the effective     **/
   /* *  dates and prices of the size price table,validating  **/
   /* *  user input.                                          **/
   /* **********************************************************/


  if (SY5REC.SY5PCEDT[SY0HWCT5] == SY0HW01.SY0HWEDT)
    converseLib.validationFailed(16); /* effective date already exists*/
    set SY0HM001.SY5PCEDT cursor, bold;
  end

  return;
end // end SY0HS20

// history table processing
Function SY0HS21()


   /* ***********************************************************/
     /* this statement group adds a row to the history table  **/
     /* after the size price table has at least 6 occurrences **/
     /* of data in the effective date and price fields.       **/
   /* ***********************************************************/


  set SY7REC empty;

  SY7REC.XGPCD = SY5REC.XGPCD;
  SY7REC.SY1STNBR = SY5REC.SY1STNBR;
  SY7REC.SY2CLRID = SY5REC.SY2CLRID;
  SY7REC.XDMCD = SY5REC.XDMCD;
  SY7REC.SY5SZID = SY5REC.SY5SZID;
  SY7REC.XPYCD = SY5REC.XPYCD;
  SY7REC.XQACD = SY5REC.XQACD;
  SY7REC.SY5PCEDT = SY5REC.SY5PCEDT[6];
  SY7REC.SY5PRCUN = SY5REC.SY5PRCUN[6];
  SY7REC.SY5PSIND = SY5REC.SY5PSIND[6];

  SY7REC.ZZZSDT = SY0HW01.SY0HWDTE;
  SY7REC.ZZZSTM = SY0HW01.SY0HWWTM;

  call "IO0370" ("A ", SQLCA, SY7REC) {isNoRefresh = yes, isExternal = yes};
  if (SQLCA.VAGen_SQLCODE == -803)
    converseLib.validationFailed(37);
                                   /* unable to process update - try again*/
  else
    if (SQLCA.VAGen_SQLCODE != 0)
      converseLib.validationFailed(39); /* history table error*/
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "SY0H   ";
      TA1REC.TA1LOCAT[1] = "A        ";
      TA1REC.TA1LOCAT[2] = "SY0HS21  ";
      TA1REC.TA1LOCAT[3] = "IO0370   ";
      TA1REC.TA1LOCAT[4] = " ";
      TA1REC.TA1MAP = "SY0HM001";
      TA1REC.TA1DBASE = "SY7REC";
      TA1REC.TA1TBLVU = "DPROD.VPRICH01";
      TA1TBLKE = SY7REC.SY7KEY;
      move SQLCA to ERRSQLCA withV60Compat;
      VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
      VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
      sysLib.rollback();
      VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
      
      call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
      return;
    end
  end

  return;


end // end SY0HS21

// moves for size price update
Function SY0HS22()


   /* *************************************************************/
   /* *  this statement group performs the moves necessary to    **/
   /* *  set up the size price record for an update.             **/
   /* *************************************************************/


  if (SY5REC.SY5PCEDT[SY0HWCT5] < SY0HW01.SY0HWEDT)
    SY5REC.SY5PCEDT[SY0HWCT6] = SY5REC.SY5PCEDT[SY0HWCT5];
    SY5REC.SY5PRCUN[SY0HWCT6] = SY5REC.SY5PRCUN[SY0HWCT5];
    SY5REC.SY5PSIND[SY0HWCT6] = SY5REC.SY5PSIND[SY0HWCT5];
    if (SY0HWCT5 == 1)
      SY5REC.SY5PCEDT[1] = SY0HW01.SY0HWEDT;
      SY5REC.SY5PRCUN[1] = SY0HW01.SY0HWPRC;
      if (SY5REC.XQACD == "01")
        SY5REC.SY5PSIND[1] = SY0HM001.SY5PSIND[SY0HWCT2];
      else
        SY5REC.SY5PSIND[1] = " ";
      end
    else
      return;
    end
  else
    SY5REC.SY5PCEDT[SY0HWCT6] = SY0HW01.SY0HWEDT;
    SY5REC.SY5PRCUN[SY0HWCT6] = SY0HW01.SY0HWPRC;
    if (SY5REC.XQACD == "01")
      SY5REC.SY5PSIND[SY0HWCT6] = SY0HM001.SY5PSIND[SY0HWCT2];
    else
      SY5REC.SY5PSIND[SY0HWCT6] = " ";
    end
    SY0HWCT5 = 1;
  end

end // end SY0HS22

// update style table
Function SY0HS23()


   /* **********************************/
   /* *  perform style table update   **/
   /* **********************************/


  SY1REC.ZZZCHGDT = SY0HW01.SY0HWDTE;
  SY1REC.ZZZCHGTM = SY0HW01.SY0HWWTM;

  SY1REC.SY1PRCZS = "C";
  call "IO0120" ("U ", SQLCA, SY1REC) {isNoRefresh = yes, isExternal = yes};
  if (SQLCA.VAGen_SQLCODE == +100)
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    converseLib.validationFailed(37);
                                   /* unable to process update - try again*/
    return;
  else
    if (SQLCA.VAGen_SQLCODE != 0)
      converseLib.validationFailed(20); /* style table error - contact systems development*/
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "SY0H   ";
      TA1REC.TA1LOCAT[1] = "U        ";
      TA1REC.TA1LOCAT[2] = "SY0HS23  ";
      TA1REC.TA1LOCAT[3] = "IO0120   ";
      TA1REC.TA1LOCAT[4] = " ";
      TA1REC.TA1MAP = "SY0HM001";
      TA1REC.TA1DBASE = "SY1REC";
      TA1REC.TA1TBLVU = "DPROD.VSTYLE01";
      TA1TBLKE = SY1REC.SY1KEY;
      move SQLCA to ERRSQLCA withV60Compat;
      VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
      VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
      sysLib.rollback();
      VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
      
      call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
      return;
    else
      SYAREC.SYAUDTYP = "C";
      SYAREC.SYABFR = SY0HW01.SY1DATA;
      SYAREC.SYAAFT = SY1REC.SY1DATA;
      SY0HS12(); /* style table audit processing*/
      if (converseVar.validationMsgNum == 0)
        SY9REC.SY9TGTYP = "C";
        SY0HS32(); /* style table tag processing*/
      end
    end
  end


end // end SY0HS23

// update style color table
Function SY0HS24()


   /* ***********************************************************/
   /* *  this statement group performs the actual updating of  **/
   /* *  a style color row for a particular style and color    **/
   /* ***********************************************************/


  SY2REC.XGPCD = SY0HM001.XGPCD;
  SY2REC.SY1STNBR = SY0HM001.SY1STNBR;
  SY2REC.SY2CLRID = SY0HM001.SY2CLRID[SY0HWCT2];
  SY2REC.XDMCD = SY0HM001.XDMCD[SY0HWCT2];

  call "IO0130" ("S ", SQLCA, SY2REC) {isNoRefresh = yes, isExternal = yes};
  if (SQLCA.VAGen_SQLCODE == +100)
    return;
  else
    if (SQLCA.VAGen_SQLCODE != 0)
      converseLib.validationFailed(21); /* color table error - contact systems*/
                                   /* development*/
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "SY0H   ";
      TA1REC.TA1LOCAT[1] = "S        ";
      TA1REC.TA1LOCAT[2] = "SY0HS24  ";
      TA1REC.TA1LOCAT[3] = "IO0130   ";
      TA1REC.TA1LOCAT[4] = " ";
      TA1REC.TA1MAP = "SY0HM001";
      TA1REC.TA1DBASE = "SY2REC";
      TA1REC.TA1TBLVU = "DPROD.VCOLOR01";
      TA1TBLKE = SY2REC.SY2KEY;
      move SQLCA to ERRSQLCA withV60Compat;
      VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
      VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
      sysLib.rollback();
      VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
      
      call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
      return;
    end
  end

  if (SY2REC.SY2CEDT1 == SY0HW01.SY0HWEDT
   || SY2REC.SY2CEDT2 == SY0HW01.SY0HWEDT
   || SY2REC.SY2CEDT3 == SY0HW01.SY0HWEDT
   || SY2REC.SY2CEDT4 == SY0HW01.SY0HWEDT)
    converseLib.validationFailed(34); /* effective date already exists for*/
                                   /* this cycle*/
    set SY0HM001.SY2CLRID[SY0HWCT2] cursor, bold;
    VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
    VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
    sysLib.rollback();
    VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
    
    return;
  end

  if (SY0HM001.XLCCD[SY0HWCT2] == "20")
    if (SY2REC.SY2CEDT1 <= SY0HW01.SY0HWDTE)
      if (SY2REC.XLCCD1 == "10")
        SY0HW01.SY0HWSW2 = "Y";
      end
    else
      if (SY2REC.SY2CEDT2 <= SY0HW01.SY0HWDTE)
        if (SY2REC.XLCCD2 == "10")
          SY0HW01.SY0HWSW2 = "Y";
        end
      else
        if (SY2REC.SY2CEDT3 <= SY0HW01.SY0HWDTE)
          if (SY2REC.XLCCD3 == "10")
            SY0HW01.SY0HWSW2 = "Y";
          end
        else
          if (SY2REC.SY2CEDT4 <= SY0HW01.SY0HWDTE)
            if (SY2REC.XLCCD4 == "10")
              SY0HW01.SY0HWSW2 = "Y";
            end
          end
        end
      end
    end
  else
    if (SY0HM001.XLCCD[SY0HWCT2] == "10")
      if (SY2REC.SY2CEDT1 <= SY0HW01.SY0HWDTE)
        if (SY2REC.XLCCD1 == "20")
          SY0HW01.SY0HWSW2 = "Y";
        end
      else
        if (SY2REC.SY2CEDT2 <= SY0HW01.SY0HWDTE)
          if (SY2REC.XLCCD2 == "20")
            SY0HW01.SY0HWSW2 = "Y";
          end
        else
          if (SY2REC.SY2CEDT3 <= SY0HW01.SY0HWDTE)
            if (SY2REC.XLCCD3 == "20")
              SY0HW01.SY0HWSW2 = "Y";
            end
          else
            if (SY2REC.SY2CEDT4 <= SY0HW01.SY0HWDTE)
              if (SY2REC.XLCCD4 == "20")
                SY0HW01.SY0HWSW2 = "Y";
              end
            end
          end
        end
      end
    end
  end

  if (SY0HW01.SY0HWSW2 == "Y")
    SYAREC.SYABFR = SY2REC.SY2DATA;
    SY2REC.SY2BOEDT = SY0HW01.SY0HWEDT;
    if (SY0HM001.XLCCD[SY0HWCT2] == "10")
      SY2REC.SY2BOSWI = "Y";
    else
      SY2REC.SY2BOSWI = "N";
    end
    if (SY2REC.SY2CEDT3 >= SY0HW01.SY0HWEDT)
      SY2REC.XLCCD4 = SY0HM001.XLCCD[SY0HWCT2];
      SY2REC.SY2CEDT4 = SY0HW01.SY0HWEDT;
    else
      if (SY2REC.SY2CEDT2 >= SY0HW01.SY0HWEDT)
        SY2REC.XLCCD4 = SY2REC.XLCCD3;
        SY2REC.SY2CEDT4 = SY2REC.SY2CEDT3;
        SY2REC.XLCCD3 = SY0HM001.XLCCD[SY0HWCT2];
        SY2REC.SY2CEDT3 = SY0HW01.SY0HWEDT;
      else
        if (SY2REC.SY2CEDT1 >= SY0HW01.SY0HWEDT)
          SY2REC.XLCCD4 = SY2REC.XLCCD3;
          SY2REC.SY2CEDT4 = SY2REC.SY2CEDT3;
          SY2REC.XLCCD3 = SY2REC.XLCCD2;
          SY2REC.SY2CEDT3 = SY2REC.SY2CEDT2;
          SY2REC.XLCCD2 = SY0HM001.XLCCD[SY0HWCT2];
          SY2REC.SY2CEDT2 = SY0HW01.SY0HWEDT;
        else
          SY2REC.XLCCD4 = SY2REC.XLCCD3;
          SY2REC.SY2CEDT4 = SY2REC.SY2CEDT3;
          SY2REC.XLCCD3 = SY2REC.XLCCD2;
          SY2REC.SY2CEDT3 = SY2REC.SY2CEDT2;
          SY2REC.XLCCD2 = SY2REC.XLCCD1;
          SY2REC.SY2CEDT2 = SY2REC.SY2CEDT1;
          SY2REC.XLCCD1 = SY0HM001.XLCCD[SY0HWCT2];
          SY2REC.SY2CEDT1 = SY0HW01.SY0HWEDT;
        end
      end
    end
    if (SY2REC.XGPCD != "03"  /* If NOT apparel*/
     && SY2REC.XLCCD1 == "20" /* close out life cycle*/
     && SY2REC.SY2CEDT1 < SY2REC.SY2POFXD
     && SY2REC.SY2CEDT1 >= SY2REC.SY2POFBD)
      SY2REC.SY2POFXD = SY2REC.SY2CEDT1;
    end
  end

  if (SY0HW01.SY0HWSW2 == "Y")
    SY2REC.ZZZCHGDT = SY0HW01.SY0HWDTE;
    SY2REC.ZZZCHGTM = SY0HW01.SY0HWWTM;
    call "IO0130" ("U ", SQLCA, SY2REC) {isNoRefresh = yes, isExternal = yes};
    if (SQLCA.VAGen_SQLCODE == +100)
      converseLib.validationFailed(37);
                                   /* unable to process update - try again*/
      return;
    else
      if (SQLCA.VAGen_SQLCODE != 0)
        converseLib.validationFailed(21); /* color table error - contact systems*/
                                   /* dvlpmnt*/
        TA1REC.TA1TYPE = "DB2 ";
        TA1REC.TA1FUNC = "RETN";
        TA1REC.TA1PGMNM = "SY0H   ";
        TA1REC.TA1LOCAT[1] = "U        ";
        TA1REC.TA1LOCAT[2] = "SY0HS24  ";
        TA1REC.TA1LOCAT[3] = "IO0130   ";
        TA1REC.TA1LOCAT[4] = " ";
        TA1REC.TA1MAP = "SY0HM001";
        TA1REC.TA1DBASE = "SY2REC";
        TA1REC.TA1TBLVU = "DPROD.VCOLOR01";
        TA1TBLKE = SY2REC.SY2KEY;
        move SQLCA to ERRSQLCA withV60Compat;
        VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
        VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
        sysLib.rollback();
        VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
        
        call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
        return;
      else
        SYAREC.SYAUDTYP = "C";
        SYAREC.SYAAFT = SY2REC.SY2DATA;
        SY0HS11(); /* style/color table audit processing*/
        if (converseVar.validationMsgNum == 0)
          SY9REC.SY9TGTYP = "C";
          SY0HS31(); /* style/color table tag processing*/
          SY0HS-GET-SYREG(); /* corresponding region table mods*/
        end
      end
    end
  end

  SY0HW01.SY0HWSW2 = " ";

end // end SY0HS24

// read style color table
Function SY0HS26()


   /* ***********************************************************/
   /* *  this statement group reads one row of the style color **/
   /* *  table.              MBUHIT 09/93                      **/
   /* ***********************************************************/


  SY2REC.XGPCD = SY0HM001.XGPCD;
  SY2REC.SY1STNBR = SY0HM001.SY1STNBR;
  SY2REC.SY2CLRID = SY0HM001.SY2CLRID[SY0HWCT2];
  SY2REC.XDMCD = SY0HM001.XDMCD[SY0HWCT2];

  call "IO0130" ("S ", SQLCA, SY2REC) {isNoRefresh = yes, isExternal = yes};
  if (SQLCA.VAGen_SQLCODE == +100)
    return;
  else
    if (SQLCA.VAGen_SQLCODE != 0)
      converseLib.validationFailed(21); /* color table error - contact systems*/
                                   /* development*/
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "SY0H   ";
      TA1REC.TA1LOCAT[1] = "S        ";
      TA1REC.TA1LOCAT[2] = "SY0HS26  ";
      TA1REC.TA1LOCAT[3] = "IO0130   ";
      TA1REC.TA1LOCAT[4] = " ";
      TA1REC.TA1MAP = "SY0HM001";
      TA1REC.TA1DBASE = "SY2REC";
      TA1REC.TA1TBLVU = "DPROD.VCOLOR01";
      TA1TBLKE = SY2REC.SY2KEY;
      move SQLCA to ERRSQLCA withV60Compat;
      VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
      VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
      sysLib.rollback();
      VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
      
      call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
      return;
    end
  end



end // end SY0HS26

// size/price tag processing
Function SY0HS30()


   /* ****************************************************/
   /* *  this statement group formats the tag record    **/
   /* *  and performs the add call to the db2 tag file  **/
   /* *  for size/price updates.                        **/
   /* ****************************************************/


  SY9REC.XGPCD = SY5REC.XGPCD;
  SY9REC.SY1STNBR = SY5REC.SY1STNBR;
  SY9REC.SY2CLRID = SY5REC.SY2CLRID;
  SY9REC.XDMCD = SY5REC.XDMCD;

  SY9REC.ZZZSDT = SY0HW01.SY0HWDTE;
  SY9REC.ZZZSTM = SY0HW01.SY0HWWTM;

  call "IO0520" ("A ", SQLCA, SY9REC) {isNoRefresh = yes, isExternal = yes};

  if (SQLCA.VAGen_SQLCODE == -803)
    converseLib.validationFailed(37);
                                   /* unable to process update - try again*/
  else
    if (SQLCA.VAGen_SQLCODE != 0)
      converseLib.validationFailed(45); /* tag table error - call systems development*/
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "SY0H   ";
      TA1REC.TA1LOCAT[1] = "A        ";
      TA1REC.TA1LOCAT[2] = "SY0HS30  ";
      TA1REC.TA1LOCAT[3] = "IO0520   ";
      TA1REC.TA1LOCAT[4] = " ";
      TA1REC.TA1MAP = "SY0HM001";
      TA1REC.TA1DBASE = "SY9REC";
      TA1REC.TA1TBLVU = "DPROD.VSYTAG01";
      TA1TBLKE = SY9REC.SY9KEY;
      move SQLCA to ERRSQLCA withV60Compat;
      VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
      VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
      sysLib.rollback();
      VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
      
      call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
      return;
    end
  end


end // end SY0HS30

// style/color tag processing
Function SY0HS31()


   /* ****************************************************/
   /* *  this statement group formats the tag record    **/
   /* *  and performs the add call to the db2 tag file  **/
   /* ****************************************************/


  SY9REC.XGPCD = SY2REC.XGPCD;
  SY9REC.SY1STNBR = SY2REC.SY1STNBR;
  SY9REC.SY2CLRID = SY2REC.SY2CLRID;
  SY9REC.XDMCD = SY2REC.XDMCD;

  SY9REC.ZZZSDT = SY0HW01.SY0HWDTE;
  SY9REC.ZZZSTM = SY0HW01.SY0HWWTM;

  call "IO0520" ("A ", SQLCA, SY9REC) {isNoRefresh = yes, isExternal = yes};

  if (SQLCA.VAGen_SQLCODE == -803)
    converseLib.validationFailed(37);
                                   /* unable to process update - try again*/
  else
    if (SQLCA.VAGen_SQLCODE != 0)
      converseLib.validationFailed(45); /* tag table error - call systems development*/
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "SY0H   ";
      TA1REC.TA1LOCAT[1] = "A        ";
      TA1REC.TA1LOCAT[2] = "SY0HS31  ";
      TA1REC.TA1LOCAT[3] = "IO0520   ";
      TA1REC.TA1LOCAT[4] = " ";
      TA1REC.TA1MAP = "SY0HM001";
      TA1REC.TA1DBASE = "SY9REC";
      TA1REC.TA1TBLVU = "DPROD.VSYTAG01";
      TA1TBLKE = SY9REC.SY9KEY;
      move SQLCA to ERRSQLCA withV60Compat;
      VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
      VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
      sysLib.rollback();
      VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
      
      call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
      return;
    end
  end


end // end SY0HS31

// style tag processing
Function SY0HS32()


   /* ****************************************************/
   /* *  this statement group formats the tag record    **/
   /* *  and performs the add call to the db2 tag file  **/
   /* ****************************************************/


  SY9REC.XGPCD = SY1REC.XGPCD;
  SY9REC.SY1STNBR = SY1REC.SY1STNBR;
  SY9REC.SY2CLRID = " ";
  SY9REC.XDMCD = " ";

  SY9REC.ZZZSDT = SY0HW01.SY0HWDTE;
  SY9REC.ZZZSTM = SY0HW01.SY0HWWTM;

  call "IO0520" ("A ", SQLCA, SY9REC) {isNoRefresh = yes, isExternal = yes};

  if (SQLCA.VAGen_SQLCODE == -803)
    converseLib.validationFailed(37);
                                   /* unable to process update - try again*/
  else
    if (SQLCA.VAGen_SQLCODE != 0)
      converseLib.validationFailed(45); /* tag table error - call systems development*/
      TA1REC.TA1TYPE = "DB2 ";
      TA1REC.TA1FUNC = "RETN";
      TA1REC.TA1PGMNM = "SY0H   ";
      TA1REC.TA1LOCAT[1] = "A        ";
      TA1REC.TA1LOCAT[2] = "SY0HS32  ";
      TA1REC.TA1LOCAT[3] = "IO0520   ";
      TA1REC.TA1LOCAT[4] = " ";
      TA1REC.TA1MAP = "SY0HM001";
      TA1REC.TA1DBASE = "SY9REC";
      TA1REC.TA1TBLVU = "DPROD.VSYTAG01";
      TA1TBLKE = SY9REC.SY9KEY;
      move SQLCA to ERRSQLCA withV60Compat;
      VAGen_EZEREPLY = VGVar.handleSysLibraryErrors;	  // save value
      VGVar.handleSysLibraryErrors = 0;		// VAGEN (REPLY option omitted
      sysLib.rollback();
      VGVar.handleSysLibraryErrors = VAGen_EZEREPLY;		//restore value
      
      call "TA0020" (TA1REC, ERRSQLCA) {isExternal = yes};
      return;
    end
  end


end // end SY0HS32

// test for nulls in 1st cost
Function SY0HSM1()

   /* this statement group is used in a test nulls statement*/
   /* to check a modified field for nulls. if test is true*/
   /* the user has not really entered anything in the field*/
   /* and we will set the modified flag to no.*/

  SY0HW01.SY0HW1MD[SY0HWIDX] = "N";
end // end SY0HSM1

// test for nulls in 2nd cost
Function SY0HSM2()

   /* this statement group is used in a test nulls statement*/
   /* to check a modified field for nulls. if test is true*/
   /* the user has not really entered anything in the field*/
   /* and we will set the modified flag to no.*/

  SY0HW01.SY0HW2MD[SY0HWIDX] = "N";
end // end SY0HSM2

// set costs modified
Function SY0HSSM()
  SY0HWIDX = 1;
  while (SY0HWIDX <= 8)
    if (SY0HM001.SY0HMN1P[SY0HWIDX] is modified)
      SY0HW01.SY0HW1MD[SY0HWIDX] = "Y";
      if (SY0HM001.SY0HMN1P[SY0HWIDX] is blanks)
        SY0HSM1();
      end
    else
      SY0HW01.SY0HW1MD[SY0HWIDX] = "N";
    end
    if (SY0HM001.SY0HMN2P[SY0HWIDX] is modified)
      SY0HW01.SY0HW2MD[SY0HWIDX] = "Y";
      if (SY0HM001.SY0HMN2P[SY0HWIDX] is blanks)
        SY0HSM2();
      end
    else
      SY0HW01.SY0HW2MD[SY0HWIDX] = "N";
    end
    SY0HWIDX = SY0HWIDX + 1;
  end
end // end SY0HSSM

//*** RECORD=SY0HW01 ****
// /***********************************************************
// /*
// /*          02-24-93 JRAMOS Added SY0HWSFL - Color store
// /*                          flag. This flag indicates if a
// /*                          color is OK to store or not.
// /*
// /***********************************************************
// ***********************
Record SY0HW01 type basicRecord
  5 SY0HW-PCEDT-MMDDYY SY0HW-PCEDT-MMDDYY ; 
    10 SY0HW-PCEDT-MMDD SY0HW-PCEDT-MMDD ; 
    10 SY0HW-PCEDT-YY SY0HW-PCEDT-YY ; 
  5 SY0HWSAV SY0HWSAV [200] ; 
    10 SY2CLRID SY2CLRID ; 
    10 XDMCD XDMCD ; 
    10 XLCCD XLCCD ; 
    10 SY0HWE1P SY0HWE1P ; 
    10 SY0HWEFF SY0HWEFF ; 
    10 SY0HWE2P SY0HWE2P ; 
    10 SY0HW-UPD-SY2 SY0HW-UPD-SY2 ; 
  5 SY0HWCLD SY0HWCLD [200] ; 
    10 SY0HWCLR SY0HWCLR ; 
    10 SY0HWDIM SY0HWDIM ; 
    10 SY0HWLCY SY0HWLCY ; 
  5 SY0HWSLC SY0HWSLC [8] ; 
  5 SY0HW-PROT-XLC SY0HW-PROT-XLC [8] ; 
  5 SY0HWPRC SY0HWPRC ; 
  5 SY0HWCT1 SY0HWCT1 ; 
  5 SY0HWCT2 SY0HWCT2 ; 
  5 SY0HWCT3 SY0HWCT3 ; 
  5 SY0HWCT4 SY0HWCT4 ; 
  5 SY0HWCT5 SY0HWCT5 ; 
  5 SY0HWCT6 SY0HWCT6 ; 
  5 SY0HWDTE SY0HWDTE ; 
  5 SY0HWDT1 SY0HWDT1 ; 
  5 SY0HWAAA SY0HWAAA ; 
  5 SY0HWBBB SY0HWBBB ; 
  5 SY0HWCCC SY0HWCCC ; 
  5 SY0HWDDD SY0HWDDD ; 
  5 SY0HWZTM SY0HWZTM ; 
    10 SY0HWZHR SY0HWZHR ; 
    10 * char(1) ; 
    10 SY0HWZMN SY0HWZMN ; 
  5 SY0HWWTM SY0HWWTM ; 
    10 SY0HWWHR SY0HWWHR ; 
    10 SY0HWWMN SY0HWWMN ; 
  5 SY0HWSW1 SY0HWSW1 ; 
  5 SY0HWSW2 SY0HWSW2 ; 
  5 SY0HWEDT SY0HWEDT ; 
  5 SY0HWMES SY0HWMES ; 
    10 SY0HWNUM SY0HWNUM ; 
    10 SY0HWRST SY0HWRST ; 
  5 SY0HWARN SY0HWARN [9] ; 
  5 SY1DATA SY1DATA ; 
  5 SY0HWIDX SY0HWIDX ; 
  5 SY0HWMDT SY0HWMDT [8] ; 
    10 SY0HW1MD SY0HW1MD ; 
    10 SY0HW2MD SY0HW2MD ; 
  5 SY0HWSFL SY0HWSFL ; 
  5 SY0HW-SYEUTBL-FLAG SY0HW-SYEUTBL-FLAG ; 
end // end SY0HW01

// W.S. FOR pcedt-MMDD
DataItem SY0HW-PCEDT-MMDD num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// W.S. FOR pcedt-MMDDYY
DataItem SY0HW-PCEDT-MMDDYY num(6)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// W.S. FOR pcedt-YY
DataItem SY0HW-PCEDT-YY num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// Protect XLC on Screen Flag
DataItem SY0HW-PROT-XLC char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Found row in SYEUTBL
DataItem SY0HW-SYEUTBL-FLAG char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Ok to Upd color
DataItem SY0HW-UPD-SY2 char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// 1st qual price modified
DataItem SY0HW1MD char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// 2nd qual price modified
DataItem SY0HW2MD char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// 2nd price calc
DataItem SY0HWAAA num(10,2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// Eff. date warning flags
DataItem SY0HWARN char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// 2nd price calc
DataItem SY0HWBBB num(18,9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// 2nd price calc
DataItem SY0HWCCC num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// color/dim hold area
DataItem SY0HWCLD char(7)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// saved color
DataItem SY0HWCLR char(3)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// work subscript
DataItem SY0HWCT1 smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// work subscript
DataItem SY0HWCT2 smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// work subscript
DataItem SY0HWCT3 smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// work subscript
DataItem SY0HWCT4 smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// work subscript
DataItem SY0HWCT5 smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// work subscript
DataItem SY0HWCT6 smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// 2nd price calc
DataItem SY0HWDDD num(9,9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// saved dimension
DataItem SY0HWDIM char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// current date - 1 year
DataItem SY0HWDT1 num(8)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// current date
DataItem SY0HWDTE num(8)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// existing 1st qlty price
DataItem SY0HWE1P num(10,2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// existing 2nd qlty price
DataItem SY0HWE2P num(10,2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// work effective date
DataItem SY0HWEDT num(8)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// work exstng eff date
DataItem SY0HWEFF num(6)  {
  currency = no, numericSeparator = no, sign = none, align = left, 
  fillCharacter = nullFill, inputRequired = no
}
end

// index for modified flags
DataItem SY0HWIDX smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// saved life cycle code
DataItem SY0HWLCY char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// price modified flags
DataItem SY0HWMDT char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// save message area
DataItem SY0HWMES char(78)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// numeric portion
DataItem SY0HWNUM num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// price
DataItem SY0HWPRC num(10,2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// rest of the area
DataItem SY0HWRST char(76)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// screeen save area
DataItem SY0HWSAV char(34)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Color store flag
DataItem SY0HWSFL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// saved l.c. for compare
DataItem SY0HWSLC char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// style update switch
DataItem SY0HWSW1 char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// life cycle update switch
DataItem SY0HWSW2 char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// work record hour
DataItem SY0HWWHR num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// work record minute
DataItem SY0HWWMN num(2)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// work record time
DataItem SY0HWWTM num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// system hour
DataItem SY0HWZHR char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// system minute
DataItem SY0HWZMN char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// work system time
DataItem SY0HWZTM char(5)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

