package sy0u;
import corpcom1.*;
import corpcom2.*;
import corpcom3.*;
import corpcom4.*;
import corpcom5.*;
import corpcom6.*;
import corpcom7.*;
import corpx1.*;
import corpx2.*;
import corpy2.*;
import corpz3.*;
import fk.common.*;
import fy.common.*;
import mn.common.*;
import op.common.*;
import pc.common.*;
import pg.common.*;
import sy.common.*;
import ta.common.*;
import vv.common.*;
import ww.common.*;
//*** PROGRAM=SY0U ****
//                LOCAL LANGUAGES
// 
// Provide a menu and supporting screens so a Country can:
//      1. Add/Maintain translation of Product Style Name,
//         both long & short versions.
//      2. Add/Maintain translation of Lab Color description
//         and both long & short abbreviations.
//      3. Maintain translation of Product Color description,
//         both long & short versions.
// 
// Translations are held in the databases by Country Code,
//   Language Code and GPC code.
// These databases use the Style ID (cross-referenced by GPC
//   and Style Number) and the Color ID (cross-referenced by
//   GPC, Style Number and Color Code ID).
// 
// Databases used are:
//      DPROD.VSTYTS01  Translated Style Name
//      DPROD.VSTYTSJ1  Translated Style join to Cross Ref.
//      DPROD.VSTYLE01  English Style Name
//      DPROD.VPRDTS01  Translated Product Color Name
//      DPROD.VPRDTSJ1  Translated Product join Cross Ref.
//      DPROD.VCOLOR01  English Product Color Description
//      DPROD.VLBCLR01  Translated Lab Color
//      DCORP.VXCL0001  U.S.A. Lab Colors
//      DPROD.VSTYXF01  Cross reference Style ID
//      DPROD.VPRDXF01  Cross reference Product ID
// 
// ************************************************************
// Maintenance Log
// --------  ------  ------------------------------------------
// 03-15-96  BCourt  Created Application
// 04-02-96  BCourt  Remove 'N/A' if no trademarks to show on
//                   Map 22 -prevents error 228 that trdmark
//                   'N/A' is required in translation.
// 05-16-96  BCourt  When INQUIRY mode, show message instead
//                   of empty list.
//                   Show dates in Euro format dd.mm.yy.
// 05-14-98  MHALST  Change calling parms for SY1580
// 11-19-98  HMACAL  Added Region Code/Desc fields on SY0UM001
//                   and corresponding validation;
//                   Added new DECLARE/FETCH/CLOSE SGRPs for
//                   SY1590 and SY1610 for Japan Region Code;
//                   Added XDRTBL and SYRGTBL TBLE entries;
//                   Added MNVREC RECD;
//                   Added ERRSQLCA RECD for XPSY009; As a
//                   result, certain PROCESS groups need to be
//                   modified to qualify item SQLCODE (SQLCA
//                   vs. ERRSQLCA);
// 12-02-98  MHALST  Added SGRP to convert lower case to upper
//                   case letters for certain map description
//                   fields when Language Code is NOT 'JP'.
// 12-03-98  HMACAL  Modified Search Style logic in SY0UM021
//                   and SY0UM041 screens.
// 04-05-00  MHALST  Correct season validation for Japan
// *********************
Program SY0U type textUIProgram //VAGen Info - main text program
  {
  includeReferencedFunctions = yes, allowUnqualifiedItemReferences = yes, 
  throwNrfEofExceptions = yes, handleHardIOErrors = no, V60ExceptionCompatibility = yes, 
  I4GLItemsNullable = no, textLiteralDefaultIsString = no, localSQLScope = yes, 
  msgTablePrefix = "SY00", inputRecord = COMMAREA, segmented = yes
  }

  // Data Declarations
  COMMAREA COMMAREA ; // record
  ERRSQLCA ERRSQLCA; // record
  MNVREC MNVREC; // record
  SQLCA SQLCA; // record
  SY0UW00 SY0UW00; // record
  SY0UW01 SY0UW01; // record
  SY0UW02 SY0UW02; // record
  SY0UW03 SY0UW03; // record
  SY0UW04 SY0UW04; // record
  SY0UW05 SY0UW05; // record
  SY0UW06 SY0UW06; // record
  SY1REC SY1REC; // record
  SY2REC SY2REC; // record
  SYWREC SYWREC; // record
  TA1REC TA1REC; // record
  TA2REC TA2REC; // record
  TA5REC TA5REC; // record
  TAEREC TAEREC; // record
  VLBCLR01 VLBCLR01; // record
  VPRDTS01 VPRDTS01; // record
  VPRDTSJ1 VPRDTSJ1; // record
  VPRDXF01 VPRDXF01; // record
  VSTYTS01 VSTYTS01; // record
  VSTYTSJ1 VSTYTSJ1; // record
  VSTYXF01 VSTYXF01; // record
  VTRDTS01 VTRDTS01; // record
  WSY1460 WSY1460; // record
  WSY1550 WSY1550; // record
  WSY1580 WSY1580; // record
  WSY1590 WSY1590; // record
  WSY1600 WSY1600; // record
  WSY1610 WSY1610; // record
  XX0XW01 XX0XW01; // record
  XX0XW02 XX0XW02; // record

  // VAGen Info - items needed for migration
  VAGen_EZESYS char(8);
  VAGen_EZEREPLY num(1);
  VAGen_EZE_WAIT_TIME bin(9,2);
  VAGen_EZE_ITEMLEN int;

  // Use Declarations
  use SYRGTBL {deleteAfterUse = yes}; // table
  use XCLTBL {deleteAfterUse = yes}; // table
  use XCTTBL {deleteAfterUse = yes}; // table
  use XDRTBL {deleteAfterUse = yes}; // table
  use XGPTBL {deleteAfterUse = yes}; // table
  use XSETBL {deleteAfterUse = yes}; // table
  use XSNTBL {deleteAfterUse = yes}; // table
  use ZFLTBL {deleteAfterUse = yes}; // table
  use SY0UM.SY0UM001,  // forms
      SY0UM.SY0UM021, 
      SY0UM.SY0UM022, 
      SY0UM.SY0UM031, 
      SY0UM.SY0UM032, 
      SY0UM.SY0UM041, 
      SY0UM.SY0UM042, 
      SY0UM.SY0UM051, 
      SY0UM.XX0XM001
   {
    pfKeyEquate = yes
  };

  function main()
    // VAGen Info - initialization needed for migration
    VAGen_EZESYS = VGLib.getVAGSysType();
    XPSY-00000: XPSY-00000();
     /* ------------------------------------------------------------*/
     /* Initialize working storage and display storage areas.*/
     /* ------------------------------------------------------------*/

    set SY0UM001 initial; /* Menu*/
    set SY0UM021 initial; /* Style List*/
    set SY0UM022 initial; /* Style Change*/
    set SY0UM031 initial; /* Lab Color List*/
    set SY0UM032 initial; /* Lab Color Change*/
    set SY0UM041 initial; /* Product Color List*/
    set SY0UM042 initial; /* Product Color Change*/
    set SY0UW00 empty; /* Working storage*/
    set SY0UW01 empty; /* M001 display storage*/
    set SY0UW02 empty; /* M021 & M022 display storage*/
    set SY0UW03 empty; /* M031 & M032 display storage*/
    set SY0UW04 empty; /* M041 & M042 display storage*/
    set SY0UW05 empty; /* M051 & M052 display storage*/
    set TA5REC empty; /* Temp.Storage Queue*/

    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    SY0UW00.SY0UW-CURR-DT-LESS-2YR = TA2REC.TA2GRGGN; /* Date was calc*/
          /* in 'before' segment since a 'call' cannot occur in 'flow'.*/

     /* ------------------------------------------------------------*/
     /* Initialize any fields passed from another application.*/
     /* ------------------------------------------------------------*/

    SY0UW01.XGP-GPC-CD = COMMAREA.XGPCD; /* GPC code*/

     /* ------------------------------------------------------------*/
     /* Since SY0N option 19 was chosen by the user,*/
     /* force to Inquiry mode. If option 20 for change was used*/
     /* or fastpath was used to get here here, then use*/
     /* default inquiry/change flags from the User ID.*/
     /* ------------------------------------------------------------*/

    SY0UW00.SY0UW-MAP-MODE = "M"; /* Default to Maintenance*/

    if (COMMAREA.CAUSERA == "I") /* SY0N used option 19, not 20.*/
      SY0UW00.SY0UW-MAP-MODE = "I"; /* Inquiry*/
    else
      if (COMMAREA.CACHGFL == "Y") /* User ID allows change*/
        SY0UW00.SY0UW-MAP-MODE = "M"; /* Maintenance*/
      else
        SY0UW00.SY0UW-MAP-MODE = "I"; /* Inquiry*/
      end
    end

     /* ------------------------------------------------------------*/
     /* When no region code is assigned to the User, default to*/
     /* Inquiry Mode regardless of COMMAREA flags*/
     /* ------------------------------------------------------------*/

    if (SYWREC.SYW-REG-TBL-SIZE == 0)
      SY0UW00.SY0UW-MAP-MODE = "I"; /* Inquiry*/
    end

     /* ------------------------------------------------------------*/
     /* Set default screen values*/
     /* ------------------------------------------------------------*/

    if (SYWREC.SYW-ALL-REGIONS-FL == "N" && 
    SYWREC.SYW-REG-TBL-SIZE == 1)
      SY0UW01.XDR-PROD-REG-CD = SYWREC.XDR-PROD-REG-CD[1];
    end
    if (SY0UW01.XDR-PROD-REG-CD == "06") /* Japan Region Code*/
      SY0UW01.XSE-SESN-CD = "00";
      SY0UW01.XSN-SESN-YR-RNG = 0;
      SY0UW01.ZFL-LANG-CD = "JP";
      SY0UW01.XCT-CTRY-CD = "JAPA";
    end

     /* ------------------------------------------------------------*/
     /* Initialize Lengths for Temporary Storage Areas for each*/
     /* Map that shows a data list.  These values are used in each*/
     /* Add and Read of Temp. Storage TA0050.*/
     /* ------------------------------------------------------------*/

    SY0UW00.SY0UW-SY0UW02-LNTH = 1370; /* Styles Map 21*/
    SY0UW00.SY0UW-SY0UW03-LNTH = 845; /* Lab Colors Map 31*/
    SY0UW00.SY0UW-SY0UW04-LNTH = 1468; /* Products Map 41*/
    SY0UW00.SY0UW-SY0UW05-LNTH = 936; /* Style Inquiry Map 51*/

    SY0UW00.XXX-INX-LMT-NBR = 14; /* Number of lines on page*/

    SY0UW00.SY0UW-KEY-DASH1 = "-"; /* Display readable error info.*/
    SY0UW00.SY0UW-KEY-DASH2 = "-";
    SY0UW00.SY0UW-KEY-DASH3 = "-";
    SY0UW00.SY0UW-KEY-SLASH1 = "/";
    SY0UW00.SY0UW-KEY-SLASH2 = "/";
    SY0UW00.SY0UW-KEY-SLASH3 = "/";
    SY0UW00.SY0UW-KEY-SLASH4 = "/";

     /* ------------------------------------------------------------*/
     /* Flow to converse the main process used to display a map.*/
     /* ------------------------------------------------------------*/

    SY0UW00.XXX-MAP-DSP-CD = "1"; /* Map to be displayed=Menu*/

    goto SY0U-00000; /* Decide which map to show*/


    SY0U-00000: SY0U-00000();
     /* ------------------------------------------------------------*/
     /* Flow to converse the main process used to display a map.*/
     /* ------------------------------------------------------------*/

    goto SY0U-00000; /* Converse the main process*/


  end // end main
end // end SY0U

// Main process,choose which map
Function SY0U-00000()
   /* ------------------------------------------------------------*/
   /* This is the main process used to display a map.  Processing*/
   /* always returns to the top of this process and falls through*/
   /* subordinate processes until an error is found or a valid*/
   /* request is processed.  Processing sequence is as follows:*/

   /* 1) Format the map output area and display the map.*/
   /* 2) Check the attention identifier used to respond.*/
   /* 3) Verify the data that was entered.*/
   /* 4) Process a valid input request.*/

   /* In all subordinate processes, "EZEFLO" is used to exit to*/
   /* redisplay the map when an error is found.  This is done to*/
   /* minimize the coding effort required to skip subsequent*/
   /* processing under error conditions.*/
   /* ------------------------------------------------------------*/
   /* Maintenance Log*/
   /* Jan. 10, 1996  BCourt  Modified to show multiple maps.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MAP-DSP-CD == "1") /* Map 1 = Menu*/

    SY0U-1-10000(); /* Format and display the map*/

    SY0U-1-20000(); /* Check attention identifier*/

    SY0U-1-30000(); /* Verify the data that was entered*/

    SY0U-1-40000(); /* Process valid input request*/

    exit stack;

  end


  if (SY0UW00.XXX-MAP-DSP-CD == "2") /* Map 2 = Style Translation List*/

    SY0U-2-11000(); /* Obtain the data to display*/

    SY0U-2-12000(); /* Format and display the map*/

    SY0U-2-13000(); /* Check attention identifier*/

    SY0U-2-14000(); /* Verify the data that was entered*/

    SY0U-2-15000(); /* Process valid input request*/

    exit stack;

  end


  if (SY0UW00.XXX-MAP-DSP-CD == "B") /* Map B = Style Translation Change*/

    SY0U-2-21000(); /* Obtain the data to display*/

    SY0U-2-22000(); /* Format and display the map*/

    SY0U-2-23000(); /* Check attention identifier*/

    SY0U-2-24000(); /* Verify the entered data*/

    SY0U-2-25000(); /* Process valid input request*/

    exit stack;

  end


  if (SY0UW00.XXX-MAP-DSP-CD == "3") /* Map 3 = Lab-Color Translation List*/

    SY0U-3-11000(); /* Obtain the data to display*/

    SY0U-3-12000(); /* Format and display the map*/

    SY0U-3-13000(); /* Check attention identifier*/

    SY0U-3-14000(); /* Verify the data that was entered*/

    SY0U-3-15000(); /* Process valid input request*/

    exit stack;

  end


  if (SY0UW00.XXX-MAP-DSP-CD == "C") /* Map C = Lab Color Transl. Change*/

    SY0U-3-21000(); /* Obtain the data to display*/

    SY0U-3-22000(); /* Format and display the map*/

    SY0U-3-23000(); /* Check attention identifier*/

    SY0U-3-24000(); /* Verify the entered data*/

    SY0U-3-25000(); /* Process valid input request*/

    exit stack;

  end


  if (SY0UW00.XXX-MAP-DSP-CD == "4") /* Map 4 = Product Color Translations*/

    SY0U-4-11000(); /* Obtain the data to display*/

    SY0U-4-12000(); /* Format and display the map*/

    SY0U-4-13000(); /* Check attention identifier*/

    SY0U-4-14000(); /* Verify the data that was entered*/

    SY0U-4-15000(); /* Process valid input request*/

    exit stack;

  end


  if (SY0UW00.XXX-MAP-DSP-CD == "D") /* Map D = Product Color Trans. Change*/

    SY0U-4-21000(); /* Obtain the data to display*/

    SY0U-4-22000(); /* Format and display the map*/

    SY0U-4-23000(); /* Check attention identifier*/

    SY0U-4-24000(); /* Verify the entered data*/

    SY0U-4-25000(); /* Process valid input request*/

    exit stack;

  end


  if (SY0UW00.XXX-MAP-DSP-CD == "5") /* Map 5 = Style & Season Inquiry List*/

    SY0U-5-11000(); /* Obtain the data to display*/

    SY0U-5-12000(); /* Format and display the map*/

    SY0U-5-13000(); /* Check attention identifier*/

    SY0U-5-14000(); /* Verify the entered data*/

    SY0U-5-15000(); /* Process valid input request*/

    exit stack;

  end


end // end SY0U-00000

// Format + Converse Menu map
Function SY0U-1-10000()
   /* ------------------------------------------------------------------*/
   /* Modification History*/
   /* Date     Userid     Description*/
   /* ----------  ------  ----------------------------------------------*/
   /* 11-19-1998  HMACAL  Added SET statement for Region Code*/
   /* ------------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* If an error was found, save the error message number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    SY0UW00.XXX-MSG-NBR = converseVar.validationMsgNum; /* Message number*/
  end

   /* ------------------------------------------------------------*/
   /* If the map must be formatted, format the data in the map.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MAP-FMAT-FL == "Y") /* Map must be formatted*/
    SY0U-1-11000(); /* Format the data in the map*/
  end

   /* ------------------------------------------------------------*/
   /* Determine whether to protect any of the modifiable fields.*/
   /* ------------------------------------------------------------*/

  SY0U-1-12000(); /* Check change authorization*/

   /* ------------------------------------------------------------*/
   /* Format any descriptions for codes that are displayed.*/
   /* ------------------------------------------------------------*/

   /* ????? any way to get country/language to show on first*/
   /* ????? map display??????*/

  if (SY0UM001.XGP-GPC-CD in XGPTBL.XGPCD /* Code in table*/
   && XGPTBL.XXXSTAT[sysVar.arrayIndex] == "A") /* and active status*/

    SY0UM001.XGP-GPC-DESC = XGPTBL.XGPDESC[sysVar.arrayIndex]; /* Description*/
    SY0UW01.XGP-GPC-DESC = XGPTBL.XGPDESC[sysVar.arrayIndex]; /* Description*/
  else
    SY0UM001.XGP-GPC-DESC = " "; /* No description*/

  end

  if (SY0UM001.ZFL-LANG-CD in ZFLTBL.ZFLCD /* Code in table*/
   && ZFLTBL.XXXSTAT[sysVar.arrayIndex] == "A") /* and active status*/

    SY0UW01.ZFL-LANG-DESC = ZFLTBL.ZFLDESC[sysVar.arrayIndex];
    SY0UM001.ZFL-LANG-DESC = ZFLTBL.ZFLDESC[sysVar.arrayIndex];
  else
    SY0UM001.ZFL-LANG-DESC = " "; /* No description*/
  end

  if (SY0UM001.XCT-CTRY-CD in XCTTBL.XCTCD /* Code in table*/
   && XCTTBL.XXXSTAT[sysVar.arrayIndex] == "A") /* and active status*/

    SY0UW01.XCT-CTRY-DESC = XCTTBL.XCTDESC[sysVar.arrayIndex];
    SY0UM001.XCT-CTRY-DESC = XCTTBL.XCTDESC[sysVar.arrayIndex];
  else
    SY0UM001.XCT-CTRY-DESC = " ";
  end

  if (SY0UM001.XDR-PROD-REG-CD in XDRTBL.XDR-PROD-REG-CD /* Code in table*/
   && XDRTBL.XXX-STAT[sysVar.arrayIndex] == "A")         /* and active status*/

    SY0UM001.XDR-PROD-REG-DESC = XDRTBL.XDR-PROD-REG-DESC[sysVar.arrayIndex]; /* Description*/
    SY0UW01.XDR-PROD-REG-DESC = XDRTBL.XDR-PROD-REG-DESC[sysVar.arrayIndex]; /* Description*/
  else
    SY0UW01.XDR-PROD-REG-DESC = " "; /* Description*/

  end

   /* ------------------------------------------------------------*/
   /* Format the current date and any FAST PATH information.*/
   /* ------------------------------------------------------------*/

  SY0UM001.XXX-CURR-DT = VGVar.currentShortGregorianDate; /* Current date*/

  SY0UM001.CATOAP = COMMAREA.CATOAP; /* TO application*/
  SY0UM001.CAITEM = COMMAREA.CAITEM; /* Application data*/

   /* ------------------------------------------------------------*/
   /* If a message to display, indicate sound audible alarm.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MSG-NBR != 0 /* Message to display*/
   || COMMAREA.CAMSG != " ")   /* or message text*/

    if (SY0UW00.XXX-MSG-NBR != 0) /* Message to display*/

      if (SY0UW00.XXX-MSG-NBR == 9999)
        converseLib.validationFailed();
      else
        converseLib.validationFailed(SY0UW00.XXX-MSG-NBR);
      end /* Message number*/
    else
      SY0UM001.VAGen_EZEMSG = COMMAREA.CAMSG; /* Message text*/

    end

    SY0UM001.XXX-MSG-LOC-ID = SY0UW00.XXX-MSG-LOC-ID;
                                   /* Message location*/

    set SY0UM001 alarm; /* Indicate sound alarm*/

  end

  converse SY0UM001 ;

   /* ------------------------------------------------------------*/
   /* Clear the message fields and save FAST PATH information.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-MSG-LOC-ID = " "; /* Message location*/
  SY0UW00.XXX-MSG-NBR = 0; /* Message number*/
  COMMAREA.CAMSG = " "; /* Message text*/

  COMMAREA.CATOAP = SY0UM001.CATOAP; /* TO application*/
  COMMAREA.CAITEM = SY0UM001.CAITEM; /* Application data*/

   /* ------------------------------------------------------------*/
   /* Reset modifiable field attributes to normal intensity.*/
   /* ------------------------------------------------------------*/

  set SY0UM001.XXX-MENU-SEL-CD normal; /* Menu selection*/
  set SY0UM001.XGP-GPC-CD normal; /* GPC code*/
  set SY0UM001.XDR-PROD-REG-CD normal; /* Region Code*/
  set SY0UM001.XCT-CTRY-CD normal; /* Country code*/
  set SY0UM001.ZFL-LANG-CD normal; /* Language code*/
  set SY0UM001.XSE-SESN-CD normal; /* Season Code*/
  set SY0UM001.XSN-SESN-YR-RNG normal; /* Season Year*/
  set SY0UM001.CATOAP normal; /* TO application*/
  set SY0UM001.CAITEM normal; /* Application data*/


end // end SY0U-1-10000

// Format the data in the map
Function SY0U-1-11000()
   /* ------------------------------------------------------------------*/
   /* Modification History*/
   /* Date     Userid     Description*/
   /* ----------  ------  ----------------------------------------------*/
   /* 11-19-1998  HMACAL  Added MOVE statement for Region Code and Desc*/
   /* ------------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* Clear the fields in the map storage area to be formatted.*/
   /* ------------------------------------------------------------*/

  set SY0UM001 initial; /* M001 input/output area*/

  SY0UW00.XXX-MAP-FMAT-FL = "N"; /* Format the map flag*/

   /* ------------------------------------------------------------*/
   /* Format the map fields from the display storage area.*/
   /* ------------------------------------------------------------*/

  SY0UM001.XGP-GPC-CD = SY0UW01.XGP-GPC-CD; /* GPC code*/
  SY0UM001.XGP-GPC-DESC = SY0UW01.XGP-GPC-DESC; /* GPC Desc*/
  SY0UM001.XDR-PROD-REG-CD = SY0UW01.XDR-PROD-REG-CD; /* Region Code*/
  SY0UM001.XDR-PROD-REG-DESC = SY0UW01.XDR-PROD-REG-DESC;
                                                             /* Region Desc*/
  SY0UM001.XCT-CTRY-CD = SY0UW01.XCT-CTRY-CD; /* Country Code*/
  SY0UM001.XCT-CTRY-DESC = SY0UW01.XCT-CTRY-DESC; /* Country Desc*/
  SY0UM001.ZFL-LANG-CD = SY0UW01.ZFL-LANG-CD; /* Language Code*/
  SY0UM001.ZFL-LANG-DESC = SY0UW01.ZFL-LANG-DESC; /* Language Desc*/
  SY0UM001.XSE-SESN-CD = SY0UW01.XSE-SESN-CD; /* Season Code*/
  SY0UM001.XSE-SESN-DESC = SY0UW01.XSE-SESN-DESC; /* Season Desc*/
  SY0UM001.XSN-SESN-YR-RNG = SY0UW01.XSN-SESN-YR-RNG; /* Season Year*/


end // end SY0U-1-11000

// Check change authoriztion
Function SY0U-1-12000()
   /* ------------------------------------------------------------------*/
   /* Modification History*/
   /* Date     Userid     Description*/
   /* ----------  ------  ----------------------------------------------*/
   /* 11-19-1998  HMACAL  Added SET statement for Region Code*/
   /* ------------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* If the user is authorized to change data on the screen,*/
   /* return to the previous process.*/
   /* ------------------------------------------------------------*/

   /* ???? need to execute Vern's job to check for country validity?*/
   /* ???? maybe not - since country not yet entered !*/
   /* ???? OR get country from logon theater of operations.*/

  if (SY0UW00.SY0UW-MAP-MODE == "I") /* User authorized to inquire*/
    SY0UM001.SY0UW-MAP-MODE = "(INQUIRE)";
    return; /* Return to previous process*/
  end

  if (SY0UW00.SY0UW-MAP-MODE == "M") /* User authorized to change*/
    SY0UM001.SY0UW-MAP-MODE = " ";
    return; /* Return to previous process*/
  end

   /* ------------------------------------------------------------*/
   /* Otherwise, protect the modifiable fields on the screen.*/
   /* ------------------------------------------------------------*/

  set SY0UM001.XGP-GPC-CD skip; /* GPC code*/
  set SY0UM001.XDR-PROD-REG-CD skip; /* Region code*/
  set SY0UM001.XCT-CTRY-CD skip; /* Country*/
  set SY0UM001.ZFL-LANG-CD skip; /* Language*/
  set SY0UM001.XSE-SESN-CD skip; /* Season Code*/
  set SY0UM001.XSN-SESN-YR-RNG skip; /* Season Year*/


end // end SY0U-1-12000

// Check attention Identifier
Function SY0U-1-20000()
   /* ------------------------------------------------------------*/
   /* If CANCEL was requested, clear the map fields and exit.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pa2) /* PA2 was pressed*/

    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    COMMAREA.CATOAP = " "; /* TO application*/
    COMMAREA.CAITEM = " "; /* Application data*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* If FAST PATH was requested, transfer to the application.*/
   /* ------------------------------------------------------------*/

  if (SY0UM001.CATOAP > " ") /* FAST PATH was requested*/

    if (converseVar.eventKey is enter) /* ENTER was pressed*/

      XSSYS-EXIT(); /* Exit to another application*/

      set SY0UM001.CATOAP cursor, bold; /* Highlight*/

    else

      SY0UW00.XXX-MSG-LOC-ID = "20000"; /* Message location*/
      converseLib.validationFailed(19); /* PA/PF key may not be used*/

    end

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* If a PF key transfer requested, exit to another application.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf1 /* PF1 was pressed*/
   || converseVar.eventKey is pf3 /* or PF3 was pressed*/
   || converseVar.eventKey is pf4) /* or PF4 was pressed*/

    if (converseVar.eventKey is pf1) /* PF1 was pressed*/
      COMMAREA.CATOAP = "GD0G"; /* Application find code*/
    end

    if (converseVar.eventKey is pf3) /* PF3 was pressed*/
      COMMAREA.CATOAP = "SY0N"; /* Product Menu*/
    end

    if (converseVar.eventKey is pf4) /* PF4 was pressed*/
      COMMAREA.CATOAP = "MN0M"; /* Master Menu*/
    end

    XSSYS-EXIT(); /* Exit to another application*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Determine whether a valid attention identifier was used to*/
   /* invoke the transaction.  Display an error message to the*/
   /* user if the PF key used is not supported.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey not enter) /* ENTER was not pressed*/

    SY0UW00.XXX-MSG-LOC-ID = "20000"; /* Message location*/
    converseLib.validationFailed(19); /* PA/PF key pressed is not valid*/

    if (converseVar.eventKey is pakey) /* PA key was pressed*/
      converseLib.clearScreen();
       /* Clear screen before display*/
    end

    exit stack; /* Exit to display map*/

  end


end // end SY0U-1-20000

// Verify data that was entered
Function SY0U-1-30000()
   /* ------------------------------------------------------------------*/
   /* Modification History*/
   /* Date     Userid     Description*/
   /* ----------  ------  ----------------------------------------------*/
   /* 11-19-1998  HMACAL  Added SY0U-1-32000 for Region Code Popup;*/
   /* Added validation logic for Region Code using*/
   /* XDRTBL and SYWREC.SYW-REGION-TABLE data;*/
   /* Expanded validation on Country Code to check*/
   /* against the WSY1550-TABLE entries returned by*/
   /* XPSY009;*/
   /* Allow Season Code and Year to be '00' and zeroes*/
   /* respectively, if Region Code is JAPAN ('06');*/
   /*  */
   /* ------------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* If any lists were requested, display the requested lists.*/
   /* ------------------------------------------------------------*/

  if (SY0UM001.XDR-PROD-REG-CD == "?") /* Region Code list requested*/
    SY0U-1-32000(); /* Display corporate table lists*/
  end

  if (SY0UM001.XGP-GPC-CD == "?") /* GPC list requested*/
    SY0U-1-31000(); /* Display corporate table lists*/
  end

   /* ------------------------------------------------------------*/
   /* Highlight any application data that was entered.*/
   /* ------------------------------------------------------------*/

  if (COMMAREA.CAITEM > " ") /* Application data was entered*/

    SY0UW00.XXX-MSG-LOC-ID = "30000"; /* Message location*/
    converseLib.validationFailed(3); /* Enter only with FAST PATH*/
    set SY0UM001.CAITEM cursor, bold; /* Highlight*/

  end

   /* ------------------------------------------------------------*/
   /* Verify the Language Code.*/
   /* ------------------------------------------------------------*/

  if (SY0UM001.ZFL-LANG-CD == " ") /* Nothing to edit*/
    SY0UM001.ZFL-LANG-DESC = " "; /* No descrip found*/
  else
    if (SY0UM001.ZFL-LANG-CD in ZFLTBL.ZFLCD /* Code in table*/
     && ZFLTBL.XXXSTAT[sysVar.arrayIndex] == "A") /* and active status*/

      SY0UW01.ZFL-LANG-DESC = ZFLTBL.ZFLDESC[sysVar.arrayIndex];
      SY0UM001.ZFL-LANG-DESC = ZFLTBL.ZFLDESC[sysVar.arrayIndex];

    else

      /* ------------------------------------------------------------*/
      /* If not found or inactive, indicate missing or invalid.*/
      /* ------------------------------------------------------------*/

      SY0UW00.XXX-MSG-LOC-ID = "30000"; /* Message location*/
      converseLib.validationFailed(40); /* Reg'd.Field invalid*/
      set SY0UM001.ZFL-LANG-CD cursor, bold; /* Highlight*/
      SY0UM001.ZFL-LANG-DESC = " "; /* No descrip found*/

    end

  end


   /* ------------------------------------------------------------*/
   /* Verify the Country Code.*/
   /* ------------------------------------------------------------*/

  if (SY0UM001.XCT-CTRY-CD == " ") /* Nothing to edit*/
    SY0UM001.XCT-CTRY-DESC = " "; /* No descrip found*/
  else
    if (SY0UM001.XCT-CTRY-CD in XCTTBL.XCTCD /* Code in table*/
     && XCTTBL.XXXSTAT[sysVar.arrayIndex] == "A") /* and active status*/

      SY0UW01.XCT-CTRY-DESC = XCTTBL.XCTDESC[sysVar.arrayIndex];
      SY0UM001.XCT-CTRY-DESC = XCTTBL.XCTDESC[sysVar.arrayIndex];

      if (SYWREC.SYW-ALL-REGIONS-FL == "N") /* If Not Global User*/
        if (SYWREC.SYW-REG-TBL-SIZE > 0 &&  /* check if assigned region*/
        WSY1550.WSY1550-TABLE-SIZE > 0)     /* and if assigned ctry*/
          SY0UW00.SY0UW-INX = 1;
          SY0UW00.SY0UW-FLAG = "N"; /* Set Flag to Not found*/

          while (SY0UW00.SY0UW-INX <= WSY1550.WSY1550-TABLE-SIZE)
            if (SY0UM001.XCT-CTRY-CD == 
            WSY1550.XCT-CTRY-CD[SY0UW-INX])
              SY0UW00.SY0UW-FLAG = "Y";
              SY0UW00.SY0UW-INX = WSY1550.WSY1550-TABLE-SIZE + 1;
            else
              SY0UW00.SY0UW-INX = SY0UW00.SY0UW-INX + 1;
            end
          end

          if (SY0UW00.SY0UW-FLAG == "N") /* Country Code not found*/
            SY0UW00.XXX-MSG-LOC-ID = "30000"; /* Message location*/
            converseLib.validationFailed(127); /* User not auth. for Country*/
            set SY0UM001.XCT-CTRY-CD cursor, bold; /* Highlight*/
            SY0UM001.XCT-CTRY-DESC = " "; /* No descrip found*/
          end
        end
      end

    else

      /* ------------------------------------------------------------*/
      /* If not found or inactive, indicate missing or invalid.*/
      /* ------------------------------------------------------------*/

      SY0UW00.XXX-MSG-LOC-ID = "30000"; /* Message location*/
      converseLib.validationFailed(40); /* Reg'd.Field invalid*/
      set SY0UM001.XCT-CTRY-CD cursor, bold; /* Highlight*/
      SY0UM001.XCT-CTRY-DESC = " "; /* No descrip found*/

    end

  end


   /* ------------------------------------------------------------*/
   /* Verify the Region Code*/
   /* ------------------------------------------------------------*/

  if (SY0UM001.XDR-PROD-REG-CD in XDRTBL.XDR-PROD-REG-CD /* Code in table*/
   && XDRTBL.XXX-STAT[sysVar.arrayIndex] == "A")         /* and active status*/

    SY0UW01.XDR-PROD-REG-DESC = XDRTBL.XDR-PROD-REG-DESC[sysVar.arrayIndex];
    SY0UM001.XDR-PROD-REG-DESC = XDRTBL.XDR-PROD-REG-DESC[sysVar.arrayIndex];

    if (SYWREC.SYW-ALL-REGIONS-FL == "N") /* If Not Global User*/
      if (SYWREC.SYW-REG-TBL-SIZE > 0) /* check if assigned region*/
        SY0UW00.SY0UW-INX = 1;
        SY0UW00.SY0UW-FLAG = "N"; /* Set Flag to N for Not found*/

        while (SY0UW00.SY0UW-INX <= SYWREC.SYW-REG-TBL-SIZE)
          if (SY0UM001.XDR-PROD-REG-CD == 
          SYWREC.XDR-PROD-REG-CD[SY0UW-INX])
            SY0UW00.SY0UW-FLAG = "Y";
            SY0UW00.SY0UW-INX = SYWREC.SYW-REG-TBL-SIZE + 1;
          else
            SY0UW00.SY0UW-INX = SY0UW00.SY0UW-INX + 1;
          end
        end

        if (SY0UW00.SY0UW-FLAG == "N") /* Region Code not found*/
          SY0UW00.XXX-MSG-LOC-ID = "30000"; /* Message location*/
          converseLib.validationFailed(126); /* User not auth. for region*/
          set SY0UM001.XDR-PROD-REG-CD cursor, bold; /* Highlight*/
          SY0UM001.XDR-PROD-REG-DESC = " "; /* No descrip found*/
        end
      end
    end

  else

    /* ------------------------------------------------------------*/
    /* If not found or inactive, indicate missing or invalid.*/
    /* ------------------------------------------------------------*/

    SY0UW00.XXX-MSG-LOC-ID = "30000"; /* Message location*/
    converseLib.validationFailed(40); /* Reg'd.Field invalid*/
    set SY0UM001.XDR-PROD-REG-CD cursor, bold; /* Highlight*/
    SY0UM001.XDR-PROD-REG-DESC = " "; /* No descrip found*/

  end

   /* ------------------------------------------------------------*/
   /* Verify the General Product Class code.*/
   /* ------------------------------------------------------------*/

  if (SY0UM001.XGP-GPC-CD in XGPTBL.XGPCD /* Code in table*/
   && XGPTBL.XXXSTAT[sysVar.arrayIndex] == "A") /* and active status*/

    SY0UW01.XGP-GPC-DESC = XGPTBL.XGPDESC[sysVar.arrayIndex];
    SY0UM001.XGP-GPC-DESC = XGPTBL.XGPDESC[sysVar.arrayIndex];

  else

    /* ------------------------------------------------------------*/
    /* If not found or inactive, indicate missing or invalid.*/
    /* ------------------------------------------------------------*/

    SY0UW00.XXX-MSG-LOC-ID = "30000"; /* Message location*/
    converseLib.validationFailed(40); /* Reg'd.Field invalid*/
    set SY0UM001.XGP-GPC-CD cursor, bold; /* Highlight*/
    SY0UM001.XGP-GPC-DESC = " "; /* No descrip found*/

  end

   /* ------------------------------------------------------------*/
   /* Verify the Season Year.*/
   /* ------------------------------------------------------------*/

  if (SY0UM001.XSN-SESN-YR-RNG == 0) /* Year edit not required*/
  else
    if (SY0UM001.XSN-SESN-YR-RNG in XSNTBL.XSNYR /* Year in table*/
     && SY0UM001.XSE-SESN-CD in XSNTBL.XSECD)    /* Code in table*/
      if (XSNTBL.XXXSTAT[sysVar.arrayIndex] == "A") /* and active status*/

      else

        /* ------------------------------------------------------------*/
        /* If not found or inactive, indicate missing or invalid.*/
        /* ------------------------------------------------------------*/

        SY0UW00.XXX-MSG-LOC-ID = "30000"; /* Message location*/
        converseLib.validationFailed(3); /* Field missing or invalid*/
        set SY0UM001.XSN-SESN-YR-RNG cursor, bold; /* Highlight*/

      end
    else

      /* ------------------------------------------------------------*/
      /* If not found or inactive, indicate missing or invalid.*/
      /* ------------------------------------------------------------*/

      SY0UW00.XXX-MSG-LOC-ID = "30000"; /* Message location*/
      converseLib.validationFailed(3); /* Field missing or invalid*/
      set SY0UM001.XSN-SESN-YR-RNG cursor, bold; /* Highlight*/

    end

  end

   /* ------------------------------------------------------------*/
   /* Verify the Season Code.*/
   /* ------------------------------------------------------------*/

  if (SY0UM001.XSE-SESN-CD == " " ||  /* Code not required*/
  (SY0UM001.XSE-SESN-CD == "00" &&    /* Code used if Japan Region Code*/
  SY0UM001.XDR-PROD-REG-CD == "06")) 
    SY0UM001.XSE-SESN-DESC = " "; /* No descrip found*/
    SY0UW01.XSE-SESN-DESC = " ";
  else
    if (SY0UM001.XSE-SESN-CD in XSETBL.XSECD /* Code in table*/
     && XSETBL.XXXSTAT[sysVar.arrayIndex] == "A") /* and active status*/

      SY0UW01.XSE-SESN-DESC = XSETBL.XSEDESC[sysVar.arrayIndex];
      SY0UM001.XSE-SESN-DESC = XSETBL.XSEDESC[sysVar.arrayIndex];

    else

      /* ------------------------------------------------------------*/
      /* If not found or inactive, indicate missing or invalid.*/
      /* ------------------------------------------------------------*/

      SY0UW00.XXX-MSG-LOC-ID = "30000"; /* Message location*/
      converseLib.validationFailed(3); /* Field missing or invalid*/
      set SY0UM001.XSE-SESN-CD cursor, bold; /* Highlight*/

    end

  end

   /* ------------------------------------------------------------*/
   /* Verify the menu selection that was entered.*/
   /* ------------------------------------------------------------*/

  if (SY0UM001.XXX-MENU-SEL-CD == 1 /* Styles*/
   || SY0UM001.XXX-MENU-SEL-CD == 2 /* Lab Colors*/
   || SY0UM001.XXX-MENU-SEL-CD == 3 /* Product Colors*/
   || SY0UM001.XXX-MENU-SEL-CD == 4) /* Inquiry by Style*/

     /* NEXT SENTENCE*/

  else

    /* ------------------------------------------------------------*/
    /* If not found, indicate missing or invalid.*/
    /* ------------------------------------------------------------*/

    SY0UW00.XXX-MSG-LOC-ID = "30000"; /* Message location*/
    converseLib.validationFailed(3); /* Field missing or invalid*/
    set SY0UM001.XXX-MENU-SEL-CD cursor, bold; /* Highlight*/

  end


   /* ------------------------------------------------------------*/
   /* Language & Country required for Option 1, 2 and 3.*/
   /* ------------------------------------------------------------*/

  if (SY0UM001.XXX-MENU-SEL-CD == 1 /* Styles*/
   || SY0UM001.XXX-MENU-SEL-CD == 2 /* Lab Colors*/
   || SY0UM001.XXX-MENU-SEL-CD == 3) /* Products*/
    if (SY0UM001.ZFL-LANG-CD == " ") /* Need Language*/

      SY0UW00.XXX-MSG-LOC-ID = "30000"; /* Message location*/
      converseLib.validationFailed(40); /* Reguired field*/
      set SY0UM001.ZFL-LANG-CD cursor, bold; /* Highlight*/
    end
    if (SY0UM001.XCT-CTRY-CD == " ") /* Need Country*/

      SY0UW00.XXX-MSG-LOC-ID = "30000"; /* Message location*/
      converseLib.validationFailed(40); /* Reguired field*/
      set SY0UM001.XCT-CTRY-CD cursor, bold; /* Highlight*/
    end
  end


   /* ------------------------------------------------------------*/
   /* Season required for Option 1 and 3.*/
   /* ------------------------------------------------------------*/

  if (SY0UM001.XXX-MENU-SEL-CD == 1 /* Styles*/
   || SY0UM001.XXX-MENU-SEL-CD == 3) /* Products*/
    if (SY0UM001.XDR-PROD-REG-CD == "06") /* If Japan Region Code*/
      if (SY0UM001.XSE-SESN-CD != "00" /* Japan can only use 00*/
       || SY0UM001.XSN-SESN-YR-RNG != 0)
        SY0UW00.XXX-MSG-LOC-ID = "30000";
        converseLib.validationFailed(234); /* Only season 00 valid for Japan*/
        set SY0UM001.XSE-SESN-CD cursor, bold;
        set SY0UM001.XSN-SESN-YR-RNG bold;
      end
    else
      if (SY0UM001.XSN-SESN-YR-RNG == 0) /* Need Season Year*/
        SY0UW00.XXX-MSG-LOC-ID = "30000"; /* Message location*/
        converseLib.validationFailed(40); /* Reguired field*/
        set SY0UM001.XSN-SESN-YR-RNG cursor, bold; /* Highlight*/
      end
    end
    if (SY0UM001.XSE-SESN-CD == " ") /* Need Season Code*/

      SY0UW00.XXX-MSG-LOC-ID = "30000"; /* Message location*/
      converseLib.validationFailed(40); /* Reguired field*/
      set SY0UM001.XSE-SESN-CD cursor, bold; /* Highlight*/
    end
  end


   /* ------------------------------------------------------------*/
   /* Footwear cannot view Styles, since translation not allowed.*/
   /* However, if region code is '06' (JAPAN) translation is allowed.*/
   /* ------------------------------------------------------------*/

  if (SY0UM001.XXX-MENU-SEL-CD == 1 /* Styles*/
   || SY0UM001.XXX-MENU-SEL-CD == 4) /* Styles Inquiry*/
    if (SY0UM001.XGP-GPC-CD == "02") /* Footwear*/

      if (SY0UM001.XDR-PROD-REG-CD == "06") /* Japan region code*/
         /* continue*/
      else
        SY0UW00.XXX-MSG-LOC-ID = "30000"; /* Message location*/
        converseLib.validationFailed(230); /* Transl.of Style not allowed for Ftwr*/
        set SY0UM001.XXX-MENU-SEL-CD cursor, bold; /* Highlight*/
      end
    end
  end


   /* ------------------------------------------------------------*/
   /* If any error was found, exit to display the map.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    exit stack; /* Exit to display map*/
  end


end // end SY0U-1-30000

// Display corporate table lists
Function SY0U-1-31000()
   /* ------------------------------------------------------------*/
   /* Determine whether ENTER was pressed to request the lists.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey not enter) /* ENTER was not pressed*/

    SY0UW00.XXX-MSG-LOC-ID = "31000"; /* Message location*/
    converseLib.validationFailed(19); /* PA/PF key may not be used*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* If requested, display the list of GPC codes.*/
   /* ------------------------------------------------------------*/

  if (SY0UM001.XGP-GPC-CD == "?") /* GPC list requested*/

    XPXX001(); /* Window initialization*/

    XX0XW02.XX0XWHDR = "  GPC"; /* Heading*/

    while (XX0XW02.XX0XWEND == "N") /* Until end of request*/
      XPXGP01(); /* Display the list*/
    end

    if (XX0XW02.XX0XWPIX == 0) /* No selection made*/

      SY0UM001.XGP-GPC-CD = SY0UW01.XGP-GPC-CD; /* Restore prior code*/
    else
      SY0UM001.XGP-GPC-CD = XGPTBL.XGPCD[XX0XWPIX]; /* Selected code*/

    end

    set SY0UM001.XGP-GPC-CD cursor; /* Establish cursor position*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the requested lists have been displayed and*/
   /* that ENTER must be pressed to process any changes.*/
   /* ------------------------------------------------------------*/

  converseLib.clearScreen();
   /* Clear screen before display*/

  SY0UW00.XXX-MSG-LOC-ID = "31000"; /* Message location*/
  converseLib.validationFailed(14); /* Requested list(s) displayed*/

  exit stack; /* Exit to display map*/


end // end SY0U-1-31000

// Display corporate table lists
Function SY0U-1-32000()
   /* ------------------------------------------------------------------*/
   /* Modification History*/
   /* Date     Userid     Description*/
   /* ----------  ------  ----------------------------------------------*/
   /* 11-19-1998  HMACAL  Added Popup logic for Region Code*/
   /* ------------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* Determine whether ENTER was pressed to request the lists.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey not enter) /* ENTER was not pressed*/

    SY0UW00.XXX-MSG-LOC-ID = "31000"; /* Message location*/
    converseLib.validationFailed(19); /* PA/PF key may not be used*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* If requested, display the list of GPC codes.*/
   /* ------------------------------------------------------------*/

  if (SY0UM001.XDR-PROD-REG-CD == "?") /* Region list requested*/

    XPXX001(); /* Window initialization*/

    XX0XW02.XX0XWHDR = "  XDR"; /* Heading*/

    while (XX0XW02.XX0XWEND == "N") /* Until end of request*/
      XPXDR01(); /* Display the list*/
    end

    if (XX0XW02.XX0XWPIX == 0) /* No selection made*/

      SY0UM001.XDR-PROD-REG-CD = SY0UW01.XDR-PROD-REG-CD; /* Restore prior*/
      SY0UM001.XDR-PROD-REG-DESC = SY0UW01.XDR-PROD-REG-DESC;
    else
      SY0UM001.XDR-PROD-REG-CD = XDRTBL.XDR-PROD-REG-CD[XX0XWPIX]; /* Selected Code*/
      SY0UM001.XDR-PROD-REG-DESC = XDRTBL.XDR-PROD-REG-DESC[XX0XWPIX];

    end

    set SY0UM001.XDR-PROD-REG-CD cursor; /* Establish cursor position*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the requested lists have been displayed and*/
   /* that ENTER must be pressed to process any changes.*/
   /* ------------------------------------------------------------*/

  converseLib.clearScreen();
   /* Clear screen before display*/

  SY0UW00.XXX-MSG-LOC-ID = "31000"; /* Message location*/
  converseLib.validationFailed(14); /* Requested list(s) displayed*/

  exit stack; /* Exit to display map*/


end // end SY0U-1-32000

// Process valid input request
Function SY0U-1-40000()
   /* ------------------------------------------------------------------*/
   /* Modification History*/
   /* Date     Userid     Description*/
   /* ----------  ------  ----------------------------------------------*/
   /* 11-19-1998  HMACAL  Added MOVE statement for Region Code*/
   /* ------------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* Save any work record fields that may have been modified.*/
   /* ------------------------------------------------------------*/

  SY0UW01.XGP-GPC-CD = SY0UM001.XGP-GPC-CD; /* GPC code*/
  SY0UW01.XDR-PROD-REG-CD = SY0UM001.XDR-PROD-REG-CD; /* Region Code*/
  SY0UW01.XCT-CTRY-CD = SY0UM001.XCT-CTRY-CD; /* Country*/
  SY0UW01.ZFL-LANG-CD = SY0UM001.ZFL-LANG-CD; /* Language*/
  SY0UW01.XSE-SESN-CD = SY0UM001.XSE-SESN-CD; /* Season code*/
  SY0UW01.XSN-SESN-YR-RNG = SY0UM001.XSN-SESN-YR-RNG; /* Season Year*/

   /* ------------------------------------------------------------*/
   /* Invoke the application indicated by the map selection code.*/
   /* ------------------------------------------------------------*/
   /* FYI - we do not actually change applications as the original*/
   /* skeleton application did.  We go to another seqment in SY0U.*/

  if (SY0UM001.XXX-MENU-SEL-CD == 1)
    SY0UW00.XXX-RQT-DATA-FL = "Y"; /* Get data to list*/
    SY0UW00.XXX-MAP-DSP-CD = "2"; /* Styles*/
  end

  if (SY0UM001.XXX-MENU-SEL-CD == 2)
    SY0UW00.XXX-RQT-DATA-FL = "Y"; /* Get data to list*/
    SY0UW00.XXX-MAP-DSP-CD = "3"; /* Lab Colors*/
  end

  if (SY0UM001.XXX-MENU-SEL-CD == 3)
    SY0UW00.XXX-RQT-DATA-FL = "Y"; /* Get data to list*/
    SY0UW00.XXX-MAP-DSP-CD = "4"; /* Product Colors*/
  end

  if (SY0UM001.XXX-MENU-SEL-CD == 4)
    SY0UW00.XXX-MAP-DSP-CD = "5"; /* All ctry,lang,sesns for style*/
  end

  SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Move stored data to map 021*/

  exit stack; /* Return to display next map.*/


end // end SY0U-1-40000

// Obtain the data to display
Function SY0U-2-11000()
   /* ------------------------------------------------------------------*/
   /* Modification History*/
   /* Date     Userid     Description*/
   /* ----------  ------  ----------------------------------------------*/
   /* 11-19-1998  HMACAL  Added Region Code in setting WSY1590 key and*/
   /* used Declare/Open/Fetch/Close cursor 2 for Japan*/
   /* ------------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* If data was not requested or an error was found, return to*/
   /* the previous process.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-RQT-DATA-FL != "Y" /* Data was not requested*/
   || converseVar.validationMsgNum != 0) /* or an error was found*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If no message to display, reset the page number to display.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MSG-NBR == 0) /* No message to display*/
    SY0UW00.XXX-CURR-PAGE-NBR = 1; /* Page number to display*/
  end

   /* ------------------------------------------------------------*/
   /* Purge any pages from temporary storage and save key fields.*/
   /* ------------------------------------------------------------*/

  SY0US-TA0050-W02-P(); /* Purge any temporary storage*/

  SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

  SY0UW02.SY0UM-SY-STY-NBR = SY0UM021.SY0UM-SY-STY-NBR; /* Style number*/

  if (converseVar.validationMsgNum != 0) /* If error already found, go show*/
                                  /* message*/
    exit stack;
  end

   /* ------------------------------------------------------------*/
   /* Select and open the cursor for the set to be formatted.*/
   /* ------------------------------------------------------------*/

  set WSY1590 empty; /* Clear row storage area*/

  WSY1590.XCT-CTRY-CD = SY0UW01.XCT-CTRY-CD; /* Country Code*/
  WSY1590.ZFL-LANG-CD = SY0UW01.ZFL-LANG-CD; /* Language Code*/
  WSY1590.XGP-GPC-CD = SY0UW01.XGP-GPC-CD; /* GPC Code*/
  WSY1590.XDR-PROD-REG-CD = SY0UW01.XDR-PROD-REG-CD; /* Region Code*/
  WSY1590.XSE-SESN-CD = SY0UW01.XSE-SESN-CD; /* Season code*/
  WSY1590.XSN-SESN-YR-RNG = SY0UW01.XSN-SESN-YR-RNG; /* Season Yr*/
  WSY1590-CURR-DT-LESS-2YR = SY0UW00.SY0UW-CURR-DT-LESS-2YR; /* Use Closeouts > 2yrs old*/

  if (WSY1590.XDR-PROD-REG-CD == "06") /* If JAPAN Region*/
    SY0US-SY1590-S2(); /* Select set and open cursor 2*/
  else
    SY0US-SY1590-SS(); /* Select set and open cursor*/
  end

   /* ------------------------------------------------------------*/
   /* Fetch and format the data into pages until end of cursor.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  SY0UW00.SY0UW-STY-EOF-FL = "N"; /* End of cursor flag*/

  while (SY0UW00.SY0UW-STY-EOF-FL == "N") /* Until end of cursor*/

    if (WSY1590.XDR-PROD-REG-CD == "06") /* If JAPAN Region*/
      SY0US-SY1590-N2(); /* Fetch next row in cursor 2*/
    else
      SY0US-SY1590-SN(); /* Fetch next row in cursor*/
    end

    /* ------------------------------------------------------------*/
    /* If not end of cursor, save the data in display storage.*/
    /* ------------------------------------------------------------*/

    if (SY0UW00.SY0UW-STY-EOF-FL == "N") /* Not end of cursor*/

      /* ------------------------------------------------------------*/
      /* If first line on subsequent page, save heading information.*/
      /* ------------------------------------------------------------*/

      if (SY0UW00.XXX-HI-PAGE-NBR > 0 /* Not the first page*/
       && SY0UW00.XXX-INX-FLD-NBR == 1) /* and first line on page*/

        SY0UW02.SY0UM-SY-STY-NBR = SY0UM021.SY0UM-SY-STY-NBR;
                                   /* Style number*/

      end

      /* ------------------------------------------------------------*/
      /* Save the data from the table row into display storage.*/
      /* Now get U.S.A. values for Style Name and Short Name.*/
      /* ------------------------------------------------------------*/

      SY0UW02.SY-STY-NBR[XXX-INX-FLD-NBR] = WSY1590.SY-STY-NBR;
      SY0UW02.SY-STY-ID[XXX-INX-FLD-NBR] = WSY1590.SY-STY-ID;
                                   /* Style number*/
      SY0UW02.SY-TRSL-STY-NM[XXX-INX-FLD-NBR] = WSY1590.SY-TRSL-STY-NM;
                                   /* Style name - long*/
      SY0UW02.SY-TRSL-SH-STY-NM[XXX-INX-FLD-NBR] = WSY1590.SY-TRSL-SH-STY-NM;
                                   /* Style name - short*/
      SY0UW02.SY-STY-NM[XXX-INX-FLD-NBR] = WSY1590.SY-STY-NM;
                                   /* Style name-U.S.A.*/
      SY0UW02.SY-SHORT-STY-NM[XXX-INX-FLD-NBR] = WSY1590.SY-SHORT-STY-NM;
                                   /* Style name-U.S.A.-short*/

      /* ------------------------------------------------------------*/
      /* Increment the line index to the next row in display storage.*/
      /* ------------------------------------------------------------*/

      SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-FLD-NBR + 1;
                                   /* Increment line index*/

    end

    /* ------------------------------------------------------------*/
    /* If the page is full, add the page to the storage queue.*/
    /* ------------------------------------------------------------*/

    if (SY0UW00.XXX-INX-FLD-NBR > SY0UW00.XXX-INX-LMT-NBR) /* Page is full*/

      SY0US-TA0050-W02-A(); /* Add page to temporary storage*/

      SY0UW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

    end

  end

   /* ------------------------------------------------------------*/
   /* Add any partially formatted last page to the queue.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-INX-FLD-NBR > 1) /* Page was formatted*/
    SY0US-TA0050-W02-A(); /* Add page to temporary storage*/
  end

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  if (WSY1590.XDR-PROD-REG-CD == "06") /* If JAPAN Region*/
    SY0US-SY1590-C2(); /* Close selected set cursor 2*/
  else
    SY0US-SY1590-CS(); /* Close selected set cursor*/
  end

   /* ------------------------------------------------------------*/
   /* If no pages were formatted, indicate no data to display.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-HI-PAGE-NBR == 0) /* No pages formatted*/

    SY0UW00.XXX-MSG-LOC-ID = "11000"; /* Message location*/
    converseLib.validationFailed(218); /* No data was found to display*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/


end // end SY0U-2-11000

// Format+Converse Style List map
Function SY0U-2-12000()
   /* ------------------------------------------------------------*/
   /* If an error was found, save the error message number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    SY0UW00.XXX-MSG-NBR = converseVar.validationMsgNum; /* Message number*/
  end

   /* ------------------------------------------------------------*/
   /* If the map must be formatted, format the data in the map.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MAP-FMAT-FL == "Y") /* Map must be formatted*/
    SY0U-2-12100(); /* Format the data in the map*/
  end

   /* ------------------------------------------------------------*/
   /* Format the current date and any FAST PATH information.*/
   /* ------------------------------------------------------------*/

  SY0UM021.XXX-CURR-DT = VGVar.currentShortGregorianDate; /* Current date*/

   /* ------------------------------------------------------------*/
   /* If a message to display, indicate sound audible alarm.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MSG-NBR != 0 /* Message to display*/
   || COMMAREA.CAMSG != " ")   /* or message text*/

    if (SY0UW00.XXX-MSG-NBR != 0) /* Message to display*/

      if (SY0UW00.XXX-MSG-NBR == 9999)
        converseLib.validationFailed();
      else
        converseLib.validationFailed(SY0UW00.XXX-MSG-NBR);
      end /* Message number*/
    else
      SY0UM021.VAGen_EZEMSG = COMMAREA.CAMSG; /* Message text*/

    end

    SY0UM021.XXX-MSG-LOC-ID = SY0UW00.XXX-MSG-LOC-ID;
                                   /* Message location*/

    set SY0UM021 alarm; /* Indicate sound alarm*/

  end

  converse SY0UM021 ;

   /* ------------------------------------------------------------*/
   /* Clear the message fields and save FAST PATH information.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-MSG-LOC-ID = " "; /* Message location*/
  SY0UW00.XXX-MSG-NBR = 0; /* Message number*/
  COMMAREA.CAMSG = " "; /* Message text*/

   /* ------------------------------------------------------------*/
   /* Reset modifiable field attributes to normal intensity.*/
   /* ------------------------------------------------------------*/

  set SY0UM021.SY0UM-SY-STY-NBR normal; /* Style number*/

  SY0UW00.XXX-INX-FLD-NBR = 1; /* Initialize line index*/

  while (SY0UW00.XXX-INX-FLD-NBR <= SY0UW00.XXX-INX-LMT-NBR
   /* Until end of screen*/
   && SY0UM021.SY-STY-NBR[XXX-INX-FLD-NBR] > " ")
                                   /* or end of formatted lines*/

    set SY0UM021.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] normal;
                                   /* Select indicator*/

    SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-FLD-NBR + 1;
                                   /* Increment line index*/

  end


end // end SY0U-2-12000

// Format the data into the map
Function SY0U-2-12100()
   /* ------------------------------------------------------------*/
   /* Clear the fields in the map storage area to be formatted.*/
   /* ------------------------------------------------------------*/

  set SY0UM021 initial; /* m021 input/output area*/

  SY0UW00.XXX-MAP-FMAT-FL = "N"; /* Format the map flag*/

   /* ------------------------------------------------------------*/
   /* If the page in storage is not the page to be displayed,*/
   /* obtain the desired page from temporary storage.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-HI-PAGE-NBR > 0) /* Pages were formatted*/

    if (SY0UW00.XXX-CURR-PAGE-NBR != TA5REC.TA5TSQIX)
                                   /* Desired page not current*/

      /* ------------------------------------------------------------*/
      /* If the current page has been changed, update the page in*/
      /* storage before obtaining the next one to display.*/
      /* ------------------------------------------------------------*/

      if (SY0UW00.XXX-PAGE-UPD-FL == "Y") /* Current page was changed*/

        SY0US-TA0050-W02-U(); /* Update temporary storage page*/

        SY0UW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

      end

      /* ------------------------------------------------------------*/
      /* If the desired page number is greater than the highest page*/
      /* in storage, default to the highest page number.*/
      /* ------------------------------------------------------------*/

      if (SY0UW00.XXX-CURR-PAGE-NBR > SY0UW00.XXX-HI-PAGE-NBR)
                                   /* Desired greater highest*/
        SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-HI-PAGE-NBR;
                                   /* Default to highest*/
      end

      SY0US-TA0050-W02-R(); /* Read temporary storage page*/

    end

    /* ------------------------------------------------------------*/
    /* Display the page information on the screen.*/
    /* ------------------------------------------------------------*/

    set SY0UM021.XXX-CURR-PAGE-DESC skip; /* "PAGE" literal*/
    SY0UM021.XXX-CURR-PAGE-NBR = SY0UW00.XXX-CURR-PAGE-NBR;
                                   /* Current page*/
    set SY0UM021.XXX-HI-PAGE-DESC skip; /* "OF" literal*/
    SY0UM021.XXX-HI-PAGE-NBR = SY0UW00.XXX-HI-PAGE-NBR;
                                   /* Highest page*/

  end

   /* ------------------------------------------------------------*/
   /* Format the map fields from the display storage area.*/
   /* ------------------------------------------------------------*/

  SY0UM021.XGP-GPC-CD = SY0UW01.XGP-GPC-CD; /* GPC code*/
  SY0UM021.XGP-GPC-DESC = SY0UW01.XGP-GPC-DESC; /* GPC Descrip*/
  SY0UM021.XCT-CTRY-CD = SY0UW01.XCT-CTRY-CD; /* Country*/
  SY0UM021.ZFL-LANG-CD = SY0UW01.ZFL-LANG-CD; /* Language*/
  SY0UM021.XCT-CTRY-DESC = SY0UW01.XCT-CTRY-DESC; /* Country*/
  SY0UM021.ZFL-LANG-DESC = SY0UW01.ZFL-LANG-DESC; /* Language*/
  SY0UM021.XSE-SESN-CD = SY0UW01.XSE-SESN-CD; /* season cd*/
  SY0UM021.XSN-SESN-YR-RNG = SY0UW01.XSN-SESN-YR-RNG; /* sesn year*/
  SY0UM021.XSE-SESN-DESC = SY0UW01.XSE-SESN-DESC; /* sesn descrip*/
  SY0UM021.SY0UM-SY-STY-NBR = SY0UW02.SY0UM-SY-STY-NBR; /* Style #*/

  SY0UW00.XXX-INX-FLD-NBR = 1; /* Initialize line index*/

  while (SY0UW00.XXX-INX-FLD-NBR <= SY0UW00.XXX-INX-LMT-NBR
   /* Until screen is full*/
   && SY0UW02.SY-STY-NBR[XXX-INX-FLD-NBR] > " ") /* or end of data*/

    if (SY0UW00.XXX-INX-FLD-NBR == 1) /* First select field*/

      set SY0UM021.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] cursor, normal;
    else
      set SY0UM021.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] normal;

    end

    SY0UM021.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] = SY0UW02.XXX-LN-SEL-IND[XXX-INX-FLD-NBR]; /* Line Select*/
    SY0UM021.SY-STY-NBR[XXX-INX-FLD-NBR] = SY0UW02.SY-STY-NBR[XXX-INX-FLD-NBR]; /* Style Nbr*/
    SY0UM021.SY-TRSL-STY-NM[XXX-INX-FLD-NBR] = SY0UW02.SY-TRSL-STY-NM[XXX-INX-FLD-NBR]; /* Translation*/
    SY0UM021.SY-STY-NM[XXX-INX-FLD-NBR] = SY0UW02.SY-STY-NM[XXX-INX-FLD-NBR]; /* U.S.A. English*/

    SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-FLD-NBR + 1;
                                   /* Increment line index*/

  end


end // end SY0U-2-12100

// Check attention identifier
Function SY0U-2-13000()
   /* ------------------------------------------------------------*/
   /* If CANCEL was requested, clear the map fields and exit.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pa2) /* PA2 was pressed*/

    if (SY0UW00.XXX-RQT-DATA-FL == "Y") /* Request for data pending*/
      set SY0UW02 empty; /* M021 display storage*/
    end

    SY0UW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/
    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    COMMAREA.CATOAP = " "; /* TO application*/
    COMMAREA.CAITEM = " "; /* Application data*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* If a PF key transfer requested, exit to another application.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf3) /* PF3 was pressed*/
    SY0UW00.XXX-MAP-DSP-CD = "1"; /* Language Menu*/
    SY0UW00.XXX-MAP-FMAT-FL = "Y";
    SY0UW00.XXX-RQT-DATA-FL = "Y";

    SY0US-TA0050-W02-P(); /* Purge any temporary storage*/

    exit stack; /* exit*/

  end

  if (converseVar.eventKey is pf1) /* PF1 was pressed*/
    COMMAREA.CATOAP = "GD0G"; /* Goal documentation*/
  end

  if (converseVar.eventKey is pf4) /* PF4 was pressed*/
    COMMAREA.CATOAP = "MN0M"; /* Goal Menu*/
  end

  if (converseVar.eventKey is pf1
   || converseVar.eventKey is pf4)

    SY0US-TA0050-W02-P(); /* Purge any temporary storage*/

    XSSYS-EXIT(); /* Exit to another application*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Determine whether a valid attention identifier was used to*/
   /* invoke the transaction.  Display an error message to the*/
   /* user if the PF key used is not supported.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey not enter /* ENTER was not pressed*/
   && converseVar.eventKey not pf7   /* and PF7 was not pressed*/
   && converseVar.eventKey not pf8)  /* and PF8 was not pressed*/

    SY0UW00.XXX-MSG-LOC-ID = "13000"; /* Message location*/
    converseLib.validationFailed(19); /* PA/PF key pressed is not valid*/

    if (converseVar.eventKey is pakey) /* PA key was pressed*/
      converseLib.clearScreen();
       /* Clear screen before display*/
    end

    exit stack; /* Exit to display map*/

  end


end // end SY0U-2-13000

// Verify entered data
Function SY0U-2-14000()
   /* ------------------------------------------------------------*/
   /* Highlight any application data that was entered.*/
   /* ------------------------------------------------------------*/
   /* If scroll requested, determine if any other field changed.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf7 /* Scroll back request*/
   || converseVar.eventKey is pf8) /* or scroll forward request*/

    SY0U-2-14100(); /* If lines changed, show error*/
    SY0U-2-14200(); /* If style # changed, show error*/

    /* ------------------------------------------------------------*/
    /* Determine whether a valid request to scroll was entered.*/
    /* ------------------------------------------------------------*/

    SY0U-2-14300(); /* Verify scroll OK with page #*/

  end

   /* ------------------------------------------------------------*/
   /* If any error was found, exit to display the map.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* If key field changed, determine if any other field changed.*/
   /* ------------------------------------------------------------*/

  if (SY0UM021.SY0UM-SY-STY-NBR != 
  SY0UW02.SY0UM-SY-STY-NBR) /* Style changed*/

    SY0U-2-14100(); /* If lines changed, show error*/

    /* ------------------------------------------------------------*/
    /* Verify that a style number was entered.*/
    /* ------------------------------------------------------------*/

    if (SY0UM021.SY0UM-SY-STY-NBR <= " ") /* Style not entered*/

      SY0UW00.XXX-MSG-LOC-ID = "14000"; /* Message location*/
      converseLib.validationFailed(3); /* Field missing or invalid*/
      set SY0UM021.SY0UM-SY-STY-NBR cursor, bold; /* Highlight*/

    end

  end

      /* ------------------------------------------------------------*/
      /* Otherwise, verify any modifiable data that was changed.*/
      /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-HI-PAGE-NBR > 0) /* Page was formatted*/

    SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-LMT-NBR;
                                   /* Line index*/

    while (SY0UW00.XXX-INX-FLD-NBR > 0) /* Until end of lines*/

      SY0U-2-14400(); /* Verify line select is 'S'*/

      SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-FLD-NBR - 1;
                                   /* Decrement line number*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If any error was found, exit to display the map.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    exit stack; /* Exit to display map*/
  end


end // end SY0U-2-14000

// Highlight Lines changed in err
Function SY0U-2-14100()
   /* ------------------------------------------------------------*/
   /* If a modifiable field was changed, indicate that field may*/
   /* not be changed when key is changed or a pf key is pressed.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-LMT-NBR; /* Line index*/

  while (SY0UW00.XXX-INX-FLD-NBR > 0) /* Until end of lines*/

    if (SY0UM021.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] != 
    SY0UW02.XXX-LN-SEL-IND[XXX-INX-FLD-NBR])

      SY0UW00.XXX-MSG-LOC-ID = "14100"; /* Message location*/
      converseLib.validationFailed(226); /* Field may not change*/
      set SY0UM021.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] cursor, bold;
                                   /* Highlight*/

    end

    SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-FLD-NBR - 1;
                                   /* Decrement line number*/

  end


end // end SY0U-2-14100

// Highlight Sty # chngd in error
Function SY0U-2-14200()
   /* ------------------------------------------------------------*/
   /* Indicate key field 3 can't change when scroll is requested.*/
   /* ------------------------------------------------------------*/

  if (SY0UM021.SY0UM-SY-STY-NBR != SY0UW02.SY0UM-SY-STY-NBR) /* Style change*/

    SY0UW00.XXX-MSG-LOC-ID = "14200"; /* Message location*/
    converseLib.validationFailed(226); /* Field may not change*/
    set SY0UM021.SY0UM-SY-STY-NBR cursor, bold; /* Highlight*/

  end

end // end SY0U-2-14200

// Verify scroll request
Function SY0U-2-14300()
   /* ------------------------------------------------------------*/
   /* If scroll back was requested, ensure that pages exist.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf7 /* Scroll back request*/
   && SY0UW00.XXX-CURR-PAGE-NBR < 2) /* and no previous pages*/

    SY0UW00.XXX-MSG-LOC-ID = "14300"; /* Message location*/
    converseLib.validationFailed(69); /* No previous page to display*/

  end

   /* ------------------------------------------------------------*/
   /* If scroll forward was requested, ensure that pages exist.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf8 /* Scroll forward request*/
   && SY0UW00.XXX-CURR-PAGE-NBR >= SY0UW00.XXX-HI-PAGE-NBR)
                                   /* and no more pages*/

    SY0UW00.XXX-MSG-LOC-ID = "14300"; /* Message location*/
    converseLib.validationFailed(70); /* No more pages to display*/

  end


end // end SY0U-2-14300

// Verify line select cd. is 'S'
Function SY0U-2-14400()
   /* ------------------------------------------------------------*/
   /* If selection was entered and is not a "S", indicate that*/
   /* only "S" may be entered to select a line.*/
   /* ------------------------------------------------------------*/

  if (SY0UM021.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] != 
  SY0UW02.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] /* Selection entered*/
   && SY0UM021.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] != "S")
                                   /* and is not a "S"*/

    SY0UW00.XXX-MSG-LOC-ID = "14400"; /* Message location*/
    converseLib.validationFailed(108); /* Only "S" may be entered*/
    set SY0UM021.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] cursor, bold;
                                   /* Highlight*/

  end


end // end SY0U-2-14400

// Process valid input request
Function SY0U-2-15000()
   /* ------------------------------------------------------------------*/
   /* Modification History*/
   /* Date     Userid     Description*/
   /* ----------  ------  ----------------------------------------------*/
   /* 12-03-1998  HMACAL  Commented out logic that adds 1 to current page*/
   /* number.*/
   /* ------------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* If scroll backward was requested, decrement the page number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf7) /* Scroll back requested*/

    SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-CURR-PAGE-NBR - 1;
                                   /* Decrement page number*/

    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If scroll forward was requested, increment the page number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf8) /* Scroll forward requested*/

    SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-CURR-PAGE-NBR + 1;
                                   /* Increment page number*/

    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If list start point changed, find starting point in Temp.Storg.*/
   /* ------------------------------------------------------------*/

  if (SY0UM021.SY0UM-SY-STY-NBR != SY0UW02.SY0UM-SY-STY-NBR) /* Style changed*/

    SY0UW02.SY0UM-SY-STY-NBR = SY0UM021.SY0UM-SY-STY-NBR; /* Style #*/

    SY0U-2-15100(); /* Find correct tsq page #*/

    SY0UW00.XXX-MAP-FMAT-FL = "Y";

    return; /* Return to previous process*/

  end


   /* ------------------------------------------------------------*/
   /* Save any field that was changed in the map display storage.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-INX-FLD-NBR = 1; /* Initialize line index*/

  while (SY0UW00.XXX-INX-FLD-NBR <= SY0UW00.XXX-INX-LMT-NBR)
                                   /* Until end of lines*/

    if (SY0UM021.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] != 
    SY0UW02.XXX-LN-SEL-IND[XXX-INX-FLD-NBR])

      SY0UW02.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] = SY0UM021.XXX-LN-SEL-IND[XXX-INX-FLD-NBR];

      SY0UW00.XXX-PAGE-UPD-FL = "Y"; /* Page update flag*/

    end

    SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-FLD-NBR + 1;
                                   /* Increment line index*/

  end

   /* ------------------------------------------------------------*/
   /* If a line was selected, format the key fields and indicate*/
   /* that map 022 is to be displayed.*/
   /* ------------------------------------------------------------*/

  if ("S" in SY0UW02.XXX-LN-SEL-IND) /* Line was selected*/

    SY0UW00.XXX-INX-FLD-NBR = sysVar.arrayIndex; /* Map line index*/

    SY0UW00.XXX-RQT-DATA-FL = "Y"; /* Request for data flag*/
    SY0UW00.XXX-MAP-DSP-CD = "B"; /* Style Change Map to be displayed*/

    return; /* does this belong here ???????????*/

  end

   /* does the code below belong here ??????????*/
   /* ------------------------------------------------------------*/
   /* If all above finished, then advance one page.*/
   /* ------------------------------------------------------------*/
   /* HMACAL - 12-03-1998 commented out*/
   /* SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-CURR-PAGE-NBR + 1;*/

end // end SY0U-2-15000

// Get TSQ Page # 4 Start'g Style
Function SY0U-2-15100()
   /* ------------------------------------------------------------------*/
   /* Modification History*/
   /* Date     Userid     Description*/
   /* ----------  ------  ----------------------------------------------*/
   /* 12-03-1998  HMACAL  Modified Search Style logic*/
   /* ------------------------------------------------------------------*/

   /* --------------------------------------------------------------*/
   /* Start reading TSQ at page 1 and continue reading until*/
   /* reach the page containing the Starting Style # entered on Map.*/
   /* NOTE - index value '14' needs to be max # lines on screen.*/
   /* --------------------------------------------------------------*/

  SY0UW00.XXX-CURR-PAGE-NBR = 1; /* Begin at page 1*/

  while (SY0UW00.XXX-CURR-PAGE-NBR <= SY0UW00.XXX-HI-PAGE-NBR)

    SY0US-TA0050-W02-R(); /* Read temporary storage queue page*/

   /* IF SY0UW02.SY-STY-NBR(14) GE SY0UM021.SY0UM-SY-STY-NBR;/*If beyond pt.*/
   /* EZERTN;                      /* Use current page*/
   /* END;*/

    SY0UW00.SY0UW-INX = 1;

    while (SY0UW00.SY0UW-INX <= 14)

      if (SY0UW02.SY-TRSL-STY-NM[SY0UW-INX] == " ")
        if (SY0UM021.SY0UM-SY-STY-NBR == SY0UW02.SY-STY-NBR[SY0UW-INX])
          return;
        else
             /* continue search*/
        end
      else
        if (SY0UM021.SY0UM-SY-STY-NBR < SY0UW02.SY-STY-NBR[SY0UW-INX])
          return;
        else
             /* continue search*/
        end
      end

      SY0UW00.SY0UW-INX = SY0UW00.SY0UW-INX + 1;

    end

    SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-CURR-PAGE-NBR + 1; /* Try next pg*/

  end

  SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-HI-PAGE-NBR;
                                  /* Force to last page*/

end // end SY0U-2-15100

// Obtain the data to display
Function SY0U-2-21000()
   /* ------------------------------------------------------------*/
   /* If data was not requested or an error was found, return to*/
   /* the previous process.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-RQT-DATA-FL == "Y") /* Data was requested*/

    if (converseVar.validationMsgNum == 0 /* and no error found*/
     || converseVar.validationMsgNum == 231) /* or message is 'next selection'*/
      /* next sentence*/
    else
      return; /* Return to previous process*/
    end

  else

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Set to show the map.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

   /* The request for data is not actually done here since*/
   /* data was moved in SY0U-2-11000 for Map 21 & 22 together.*/

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/


end // end SY0U-2-21000

// Format+Converse Sty change map
Function SY0U-2-22000()
   /* ------------------------------------------------------------*/
   /* If an error was found, save the error message number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    SY0UW00.XXX-MSG-NBR = converseVar.validationMsgNum; /* Message number*/
  end

   /* ------------------------------------------------------------*/
   /* If the map must be formatted, format the data in the map.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MAP-FMAT-FL == "Y") /* Map must be formatted*/
    SY0U-2-22100(); /* Format the data in the map*/
  end

   /* ------------------------------------------------------------*/
   /* Determine whether to protect any of the modifiable fields.*/
   /* ------------------------------------------------------------*/

  SY0U-2-22200(); /* Check change authorization*/

   /* ------------------------------------------------------------*/
   /* Format the current date and any FAST PATH information.*/
   /* ------------------------------------------------------------*/

  SY0UM022.XXX-CURR-DT = VGVar.currentShortGregorianDate; /* Current date*/

   /* ------------------------------------------------------------*/
   /* If a message to display, indicate sound audible alarm.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MSG-NBR != 0 /* Message to display*/
   || COMMAREA.CAMSG != " ")   /* or message text*/

    if (SY0UW00.XXX-MSG-NBR != 0) /* Message to display*/

      if (SY0UW00.XXX-MSG-NBR == 9999)
        converseLib.validationFailed();
      else
        converseLib.validationFailed(SY0UW00.XXX-MSG-NBR);
      end /* Message number*/
    else
      SY0UM022.VAGen_EZEMSG = COMMAREA.CAMSG; /* Message text*/

    end

    SY0UM022.XXX-MSG-LOC-ID = SY0UW00.XXX-MSG-LOC-ID;
                                   /* Message location*/

    set SY0UM022 alarm; /* Indicate sound alarm*/

  end

  converse SY0UM022 ;

   /* ------------------------------------------------------------*/
   /* Clear the message fields and save FAST PATH information.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-MSG-LOC-ID = " "; /* Message location*/
  SY0UW00.XXX-MSG-NBR = 0; /* Message number*/
  COMMAREA.CAMSG = " "; /* Message text*/

   /* ------------------------------------------------------------*/
   /* Reset modifiable field attributes to normal intensity.*/
   /* ------------------------------------------------------------*/

  set SY0UM022.SY-TRSL-STY-NM normal; /* Translated style name*/
  set SY0UM022.SY-TRSL-SH-STY-NM normal; /* Translated short style nm.*/

  sysVar.arrayIndex = 1; /* Reset color on Trademark words*/
  while (sysVar.arrayIndex <= 12)
    set SY0UM022.WSY1460-STY-NM-WORD[sysVar.arrayIndex] yellow; /* Reset from white*/
    sysVar.arrayIndex = sysVar.arrayIndex + 1;
  end

   /* ------------------------------------------------------------*/
   /* If language is not Japanese, convert lower to upper case.*/
   /* ------------------------------------------------------------*/

  if (SY0UM022.ZFL-LANG-CD != "JP") /* Not Japanese*/
    SY0UW00.SY0UW-CNVT-NM-LEN = 30; /* Set length*/
    SY0UW00.SY0UW-CNVT-NM = SY0UM022.SY-TRSL-STY-NM;
    SY0US-CNVT-LOWER(); /* Convert lower to upper*/
    SY0UM022.SY-TRSL-STY-NM = SY0UW00.SY0UW-CNVT-NM;

    SY0UW00.SY0UW-CNVT-NM-LEN = 12; /* Set length*/
    SY0UW00.SY0UW-CNVT-NM = SY0UM022.SY-TRSL-SH-STY-NM;
    SY0US-CNVT-LOWER(); /* Convert lower to upper*/
    SY0UM022.SY-TRSL-SH-STY-NM = SY0UW00.SY0UW-CNVT-NM;
  end


   /* ------------------------------------------------------------*/
   /* Change the selection indicator to show the line was viewed.*/
   /* ------------------------------------------------------------*/

  SY0UW02.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] = "V";
                                   /* Select indicator*/


end // end SY0U-2-22000

// Format the data in the map
Function SY0U-2-22100()
   /* ------------------------------------------------------------------*/
   /* Modification History*/
   /* Date     Userid     Description*/
   /* ----------  ------  ----------------------------------------------*/
   /* 11-19-1998  HMACAL  Bypass Trademark validation if Region Code is*/
   /* Japan ('06')*/
   /*  */
   /* ------------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* Clear the fields in the map storage area to be formatted.*/
   /* ------------------------------------------------------------*/

  set SY0UM022 initial; /* M002 input/output area*/

  SY0UW00.XXX-MAP-FMAT-FL = "N"; /* Format the map flag*/

   /* ------------------------------------------------------------*/
   /* Format the map fields from the display storage area.*/
   /* ------------------------------------------------------------*/

  SY0UM022.XCT-CTRY-CD = SY0UW01.XCT-CTRY-CD; /* Country Cd*/
  SY0UM022.XCT-CTRY-DESC = SY0UW01.XCT-CTRY-DESC; /* Country Desc*/
  SY0UM022.ZFL-LANG-CD = SY0UW01.ZFL-LANG-CD; /* Country Cd*/
  SY0UM022.ZFL-LANG-DESC = SY0UW01.ZFL-LANG-DESC; /* Country Desc*/
  SY0UM022.XGP-GPC-CD = SY0UW01.XGP-GPC-CD; /* G.P.C.*/
  SY0UM022.XSE-SESN-CD = SY0UW01.XSE-SESN-CD; /* Season Code*/
  SY0UM022.XSN-SESN-YR-RNG = SY0UW01.XSN-SESN-YR-RNG;
                                   /* Season Year*/
  SY0UM022.XSE-SESN-DESC = SY0UW01.XSE-SESN-DESC;
                                   /* Season Description*/
  SY0UM022.SY-STY-NBR = SY0UW02.SY-STY-NBR[XXX-INX-FLD-NBR];
                                   /* Style Number*/
  SY0UM022.SY-TRSL-STY-NM = SY0UW02.SY-TRSL-STY-NM[XXX-INX-FLD-NBR]; /* Translated Style Name*/
  SY0UM022.SY-STY-NM = SY0UW02.SY-STY-NM[XXX-INX-FLD-NBR];
                                   /* U.S.A. Style Name*/
  SY0UM022.SY-TRSL-SH-STY-NM = SY0UW02.SY-TRSL-SH-STY-NM[XXX-INX-FLD-NBR]; /* Translated Style Name -Short*/
  SY0UM022.SY-SHORT-STY-NM = SY0UW02.SY-SHORT-STY-NM[XXX-INX-FLD-NBR]; /* U.S.A. Style Name - Short*/

   /* ------------------------------------------------------------*/
   /* Bypass Trademark Words processing if Region Code is JAPAN (06)*/
   /* ------------------------------------------------------------*/

  if (SY0UW01.XDR-PROD-REG-CD == "06") /* Japan Region Code*/
    return;
  end

   /* ------------------------------------------------------------*/
   /* Display Trademark Words in the USA Style Name*/
   /* ------------------------------------------------------------*/

  set WSY1460 empty;

  WSY1460.WSY1460-SY-STY-NM = SY0UM022.SY-STY-NM; /* USA Style Nm.*/

  SY0US-SY1460-CK(); /* Get Trademarks in USA Style Name*/

      /* Move Trademark words and phrases to the map.*/
      /* NOTE - if WORD-CNT eq zero, then we move nothing = OK.*/
      /* Tdmks for previous style blanked by 'setmap clear'above.*/

  sysVar.arrayIndex = 1; /* Loop through Edited Data*/
  SY0UW00.SY0UW-INX = 1; /* Loop through Map fields*/

  while (sysVar.arrayIndex <= WSY1460.WSY1460-WORD-CNT)
                                   /* Chk.each word in USA Style Nm*/
    if (WSY1460.WSY1460-STY-NM-RSTR[sysVar.arrayIndex] != " ") /* If is Trademark*/
   /* move to map*/
      SY0UM022.WSY1460-STY-NM-WORD[SY0UW-INX] = WSY1460.WSY1460-STY-NM-WORD[sysVar.arrayIndex];
      SY0UW00.SY0UW-INX = SY0UW00.SY0UW-INX + 1; /* Increment Map field*/
    else
         /* Nothing to move to map*/
    end

    sysVar.arrayIndex = sysVar.arrayIndex + 1; /* Increment Edited Data*/

  end

  if (SY0UW00.SY0UW-MAP-MODE == "M") /* If in Change mode*/
    if (SY0UW00.SY0UW-INX > 1 /* If had at least 1 trademark,*/
    )                        
      if (SY0UW00.XXX-MSG-NBR == 0) /* Show this message only when no*/
                                   /* pending message.*/
        SY0UW00.XXX-MSG-LOC-ID = "24000";
        SY0UW00.XXX-MSG-NBR = 227; /* Trademark Word or Phrase Required*/
      end

    else

      SY0UM022.WSY1460-STY-NM-WORD[1] = " "; /* Not applicable*/

    end

  end


end // end SY0U-2-22100

// Check change authorization
Function SY0U-2-22200()
   /* ------------------------------------------------------------------*/
   /* Modification History*/
   /* Date     Userid     Description*/
   /* ----------  ------  ----------------------------------------------*/
   /* 11-19-1998  HMACAL  Removed check for GPC 02 since this is now being*/
   /* done in SY0U-1-30000; For Japan region only,*/
   /* Footwear styles CAN BE CHANGED;*/
   /* ------------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* If requested data was found and the user is authorized to*/
   /* change data on the screen, return to the previous process.*/
   /* Note - Footwear Styles cannot be changed by anyone.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-RQT-DATA-FL == "N" /* Requested data was found*/
   && SY0UW00.SY0UW-MAP-MODE == "M") /* and user authorized to change*/
   /* AND SY0UW01.XGP-GPC-CD NE '02';/* and not Footwear*/

    set SY0UM022.SY0UM-PF12 normal; /* Allow use of PF12 to edit data*/

    SY0UM022.SY0UM-TTL-NM = "MAINTENANCE";

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Protect the modifiable fields on the screen.*/
   /* ------------------------------------------------------------*/

  set SY0UM022.SY-TRSL-STY-NM skip; /* Translated style name*/
  set SY0UM022.SY-TRSL-SH-STY-NM skip; /* Translated short style nm.*/
  set SY0UM022.SY0UM-PF12 invisible, cursor; /* Prevent use of PF12 to edit data*/

  SY0UM022.SY0UM-TTL-NM = "INQUIRY";


end // end SY0U-2-22200

// Check attention identifier
Function SY0U-2-23000()
   /* ------------------------------------------------------------*/
   /* If CANCEL was requested, clear the map fields and exit.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pa2) /* PA2 was pressed*/

    if (SY0UW00.XXX-RQT-DATA-FL == "Y") /* Request for data pending*/
      converseLib.clearScreen();
       /* Clear screen before display*/
    end

    SY0UW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/
    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    COMMAREA.CATOAP = " "; /* TO application*/
    COMMAREA.CAITEM = " "; /* Application data*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* If a PF key transfer requested, exit to another application.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf3) /* PF3 was pressed*/

    SY0UW00.XXX-MAP-DSP-CD = "1"; /* Language Menu=map shown*/
    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/
    SY0UW00.XXX-RQT-DATA-FL = "Y";

    SY0US-TA0050-W02-P(); /* Purge any temporary storage*/

    exit stack; /* Exit to display map*/

  end

  if (converseVar.eventKey is pf1) /* PF1 was pressed*/
    COMMAREA.CATOAP = "GD0G"; /* Goal documentation*/
  end

  if (converseVar.eventKey is pf4) /* PF4 was pressed*/
    COMMAREA.CATOAP = "MN0M"; /* Goal Menu*/
  end

  if (converseVar.eventKey is pf1 /* PF1 was pressed*/
   || converseVar.eventKey is pf4 /* or PF4 was pressed*/
  )                              
    SY0US-TA0050-W02-P(); /* Purge any temporary storage*/

    XSSYS-EXIT(); /* Exit to another application*/

    SY0UW00.XXX-MAP-DSP-CD = "1"; /* Map to be displayed*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Determine whether a valid attention identifier was used to*/
   /* invoke the transaction.  Display an error message to the*/
   /* user if the PF key used is not supported.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey not enter /* ENTER was not pressed*/
   && converseVar.eventKey not pf12) /* and PF12 was not pressed*/

    SY0UW00.XXX-MSG-LOC-ID = "23000"; /* Message location*/
    converseLib.validationFailed(19); /* PA/PF key pressed is not valid*/

    if (converseVar.eventKey is pakey) /* PA key was pressed*/
      converseLib.clearScreen();
       /* Clear screen before display*/
    end

    exit stack; /* Exit to display map*/

  end


end // end SY0U-2-23000

// Verify entered data
Function SY0U-2-24000()
   /* ------------------------------------------------------------*/
   /* If Style Translation changed, Confirm Trademark Words*/
   /* in USA Style Name are also found in the Translation.*/
   /* ------------------------------------------------------------*/

  if (SY0UM022.SY-TRSL-STY-NM == 
  SY0UW02.SY-TRSL-STY-NM[XXX-INX-FLD-NBR])
    /* No edit*/
  else

    SY0U-2-24100(); /* Edit Transl for USA Trademarks*/

    if (SY0UW00.XXX-MSG-NBR != 0) /* Failed Tdmk edit*/
      exit stack; /* Exit to display map*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If EDIT requested, indicate edit completed and no errors.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf12) /* PF12 was pressed*/

    SY0UW00.XXX-MSG-LOC-ID = "24000"; /* Message location*/
    converseLib.validationFailed(14); /* Edit completed and no errors*/

    exit stack; /* Exit to display map*/

  end


end // end SY0U-2-24000

// Edit Trsl.Style for USA Tdmk.
Function SY0U-2-24100()
   /* ------------------------------------------------------------------*/
   /* Modification History*/
   /* Date     Userid     Description*/
   /* ----------  ------  ----------------------------------------------*/
   /* 11-19-1998  HMACAL  Qualified SQLCODE with SQLCA;*/
   /* ------------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* Split Translated Style Name into component words*/
   /* ------------------------------------------------------------*/

  set WSY1460 empty;

  WSY1460.WSY1460-SY-STY-NM = SY0UM022.SY-TRSL-STY-NM;

  SY0US-SY1460-CK(); /* Split Trsl.Style Name into Words*/

   /* ------------------------------------------------------------*/
   /* Move Trsl. component words to array so we can test existence*/
   /* using the 'IF IN array' statement.*/
   /* ------------------------------------------------------------*/

  set SY0UW06 empty; /* Table of Words in Trnsltd Style*/

  sysVar.arrayIndex = 1;

  while (WSY1460.WSY1460-STY-NM-WORD[sysVar.arrayIndex] != " ") /* All words in Name*/

    SY0UW06.SY0UW-STY-NM-WORD[sysVar.arrayIndex] = WSY1460.WSY1460-STY-NM-WORD[sysVar.arrayIndex]; /* Hold Trsl.word*/

    sysVar.arrayIndex = sysVar.arrayIndex + 1;

  end

   /* ------------------------------------------------------------*/
   /* Check that USA trademark is in table of Transl. words.*/
   /* ------------------------------------------------------------*/

  SY0UW00.SY0UW-INX = 1; /* Loop through USA Tdmks on Map22*/

  while (SY0UM022.WSY1460-STY-NM-WORD[SY0UW-INX] != " ") /* USA Trademark*/
    if (SY0UM022.WSY1460-STY-NM-WORD[SY0UW-INX]
     in SY0UW06.SY0UW-STY-NM-WORD) /* Transl.component word array*/

        /* USA trdmk is in Transl. Style*/

    else

         /* Since USA word not in Transl.Style, get translation*/
         /* of USA word and then check if it is in Transl.Style*/

       /* ????? but the USA is a 'word' while the VTRDTS may*/
      /* ??? be a 'word' or a 'phrase'.  Maybe have a 'like'*/
      /* ??? function in VTRDTS01 i/o mod ???????*/

      /* ?? change sy1460 to have 'build' option to build phrase*/
      /* ?? Copy code from sy1510 into sy1460?*/

      set VTRDTS01 empty;

      VTRDTS01.XCT-CTRY-CD = SY0UW01.XCT-CTRY-CD;
      VTRDTS01.ZFL-LANG-CD = SY0UW01.ZFL-LANG-CD;
      VTRDTS01.SY-TDMK-TXT = SY0UM022.WSY1460-STY-NM-WORD[SY0UW-INX];

      SY0US-VTRDTS01-S(); /* Get transl. of USA trdmk word*/

      if (SQLCA.VAGen_SQLCODE == 0) /* Found transl.*/
        if (VTRDTS01.SY-TDMK-TXT in SY0UW06.SY0UW-STY-NM-WORD)
            /* USA trdmk's transl. is in Transl. Style*/
        else
          SY0UW00.XXX-MSG-LOC-ID = "24000";
          SY0UW00.XXX-MSG-NBR = 228; /* Trademark Word Required*/
          set SY0UM022.SY-TRSL-STY-NM cursor, bold;
          set SY0UM022.WSY1460-STY-NM-WORD[SY0UW-INX] white;

        end
      else
        SY0UW00.XXX-MSG-LOC-ID = "24000";
        SY0UW00.XXX-MSG-NBR = 228; /* Trademark Word Required*/
        set SY0UM022.SY-TRSL-STY-NM cursor, bold;
        set SY0UM022.WSY1460-STY-NM-WORD[SY0UW-INX] white;

      end

    end

    SY0UW00.SY0UW-INX = SY0UW00.SY0UW-INX + 1; /* Increment Map field*/

  end


end // end SY0U-2-24100

// Process valid input request
Function SY0U-2-25000()
   /* ------------------------------------------------------------------*/
   /* Modification History*/
   /* Date     Userid     Description*/
   /* ----------  ------  ----------------------------------------------*/
   /* 11-19-1998  HMACAL  Qualified SQLCODE with SQLCA;*/
   /* ------------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* If no modifiable data changed, search for next selection.*/
   /* ------------------------------------------------------------*/

  if (SY0UM022.SY-TRSL-STY-NM == SY0UW02.SY-TRSL-STY-NM[XXX-INX-FLD-NBR]
   && SY0UM022.SY-TRSL-SH-STY-NM == 
  SY0UW02.SY-TRSL-SH-STY-NM[XXX-INX-FLD-NBR])

    SY0U-2-25100(); /* Search for next selection*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Obtain the current date and time.*/
   /* ------------------------------------------------------------*/

  XX0XS01(); /* Obtain date and time*/

   /* ------------------------------------------------------------*/
   /* Build key data to search for table row.*/
   /* ------------------------------------------------------------*/

  VSTYTS01.SY-STY-ID = SY0UW02.SY-STY-ID[XXX-INX-FLD-NBR]; /* Key*/
  VSTYTS01.XCT-CTRY-CD = SY0UW01.XCT-CTRY-CD; /* Country*/
  VSTYTS01.ZFL-LANG-CD = SY0UW01.ZFL-LANG-CD; /* Language*/
  VSTYTS01.XSE-SESN-CD = SY0UW01.XSE-SESN-CD; /* Season Code*/
  VSTYTS01.XSN-SESN-YR-RNG = SY0UW01.XSN-SESN-YR-RNG; /* Season Year*/

  SY0US-VSTYTS01-S(); /* Select row to check for existence*/

  VSTYTS01.SY-TRSL-STY-NM = SY0UM022.SY-TRSL-STY-NM; /* Trans. style name*/
  VSTYTS01.SY-TRSL-SH-STY-NM = SY0UM022.SY-TRSL-SH-STY-NM; /* Trans. short style name*/

  SY0UW02.SY-TRSL-STY-NM[XXX-INX-FLD-NBR] = SY0UM022.SY-TRSL-STY-NM; /* Trans. style name*/
  SY0UW02.SY-TRSL-SH-STY-NM[XXX-INX-FLD-NBR] = SY0UM022.SY-TRSL-SH-STY-NM;
                                   /* Trans. short style name*/

  SY0UW00.XXX-PAGE-UPD-FL = "Y";

  VSTYTS01.ZZ-CHNG-DT = XX0XW01.XX0XWDAT; /* Change date*/
  VSTYTS01.ZZ-CHNG-HHMM = XX0XW01.XX0XWTIM; /* Change time*/

  if (SQLCA.VAGen_SQLCODE == 0) /* If row already exists,*/
    SY0US-VSTYTS01-U(); /* Update the table row*/
  else
    VSTYTS01.ZZ-SDT = XX0XW01.XX0XWDAT; /* Setup date*/
    VSTYTS01.ZZ-CHNG-CNT = 0; /* Change count*/
    SY0US-VSTYTS01-A(); /* Else add a new row*/
  end

   /* ------------------------------------------------------------*/
   /* Commit all changes and refresh the data to be displayed.*/
   /* ------------------------------------------------------------*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.commit(); /* Commit all changes*/

  SY0UW00.XXX-MSG-LOC-ID = "25000"; /* Message location*/
  SY0UW00.XXX-MSG-NBR = 11; /* Table update was completed*/

   /* skip request for data since just want to show err mesg.*/
   /* MOVE 'Y' TO SY0UW00.XXX-RQT-DATA-FL;/* Request for data flag*/


end // end SY0U-2-25000

// Search for next selection
Function SY0U-2-25100()
   /* ------------------------------------------------------------*/
   /* Determine if another line was selected for viewing.*/
   /* ------------------------------------------------------------*/

  if ("S" in SY0UW02.XXX-LN-SEL-IND) /* Line was selected*/

    SY0UW00.XXX-INX-FLD-NBR = sysVar.arrayIndex; /* Map line index*/

    SY0UM022.XGP-GPC-CD = SY0UW01.XGP-GPC-CD; /* GPC code*/
    SY0UM022.XSE-SESN-CD = SY0UW01.XSE-SESN-CD; /* Season code*/
    SY0UM022.XSN-SESN-YR-RNG = SY0UW01.XSN-SESN-YR-RNG; /* Season Yr*/
    SY0UM022.XSE-SESN-DESC = SY0UW01.XSE-SESN-DESC;
                                   /* Season description*/
    SY0UM022.SY-STY-NBR = SY0UW02.SY-STY-NBR[XXX-INX-FLD-NBR];
                                   /* Style number*/
    SY0UM022.SY-TRSL-STY-NM = SY0UW02.SY-TRSL-STY-NM[XXX-INX-FLD-NBR]; /* Translated Style Name*/
    SY0UM022.SY-STY-NM = SY0UW02.SY-STY-NM[XXX-INX-FLD-NBR];
                                   /* U.S.A. Style Name*/
    SY0UM022.SY-TRSL-SH-STY-NM = SY0UW02.SY-TRSL-SH-STY-NM[XXX-INX-FLD-NBR]; /* Translated Style Name-Short*/
    SY0UM022.SY-SHORT-STY-NM = SY0UW02.SY-SHORT-STY-NM[XXX-INX-FLD-NBR]; /* U.S.A. Style Name-Short*/

    SY0UW00.XXX-RQT-DATA-FL = "Y"; /* Request for data flag*/

    SY0UW00.XXX-MSG-LOC-ID = "25100";
    converseLib.validationFailed(231); /* This is the next Selection*/

  else

    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/
    SY0UW00.XXX-MAP-DSP-CD = "2"; /* Style List is next map shown*/

  end


end // end SY0U-2-25100

// Obtain the data to display
Function SY0U-3-11000()
   /* ------------------------------------------------------------*/
   /* If data was not requested or an error was found, return to*/
   /* the previous process.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-RQT-DATA-FL != "Y" /* Data was not requested*/
   || converseVar.validationMsgNum != 0) /* or an error was found*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If no message to display, reset the page number to display.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MSG-NBR == 0) /* No message to display*/
    SY0UW00.XXX-CURR-PAGE-NBR = 1; /* Page number to display*/
  end

   /* ------------------------------------------------------------*/
   /* Purge any pages from temporary storage and save key fields.*/
   /* ------------------------------------------------------------*/

  SY0US-TA0050-W03-P(); /* Purge any temporary storage*/

  SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

  SY0UW03.SY0UM-XCL-COLR-CD = SY0UM031.SY0UM-XCL-COLR-CD; /* Lab Colr.cd*/

  if (converseVar.validationMsgNum != 0) /* If error already found, go show*/
                                  /* message*/
    exit stack;
  end

   /* ------------------------------------------------------------*/
   /* Select and open the cursor for the set to be formatted.*/
   /* ------------------------------------------------------------*/

  set WSY1600 empty; /* Clear row storage area*/

  WSY1600.XCT-CTRY-CD = SY0UW01.XCT-CTRY-CD; /* Country Code*/
  WSY1600.ZFL-LANG-CD = SY0UW01.ZFL-LANG-CD; /* Language Code*/

  SY0US-SY1600-SS(); /* Select set and open cursor*/

   /* ------------------------------------------------------------*/
   /* Fetch and format the data into pages until end of cursor.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  SY0UW00.SY0UW-STY-EOF-FL = "N"; /* End of cursor flag*/

  while (SY0UW00.SY0UW-STY-EOF-FL == "N") /* Until end of cursor*/

    SY0US-SY1600-SN(); /* Fetch next row in cursor*/

    /* ------------------------------------------------------------*/
    /* If not end of cursor, save the data in display storage.*/
    /* ------------------------------------------------------------*/

    if (SY0UW00.SY0UW-STY-EOF-FL == "N") /* Not end of cursor*/

      /* ------------------------------------------------------------*/
      /* If first line on subsequent page, save heading information.*/
      /* ------------------------------------------------------------*/

      if (SY0UW00.XXX-HI-PAGE-NBR > 0 /* Not the first page*/
       && SY0UW00.XXX-INX-FLD-NBR == 1) /* and first line on page*/

        SY0UW03.SY0UM-XCL-COLR-CD = SY0UM031.SY0UM-XCL-COLR-CD;
                                   /* Lab Color code*/

      end

      /* ------------------------------------------------------------*/
      /* Save the data from the table row into display storage.*/
      /* ------------------------------------------------------------*/

      SY0UW03.XCL-COLR-CD[XXX-INX-FLD-NBR] = WSY1600.XCL-COLR-CD;
                                   /* Lab Color Code*/
      SY0UW03.XCL-COLR-DESC[XXX-INX-FLD-NBR] = WSY1600.XCL-COLR-DESC;
                                   /* Color descrip - full*/
      SY0UW03.SY0UM-USA-COLR-DESC[XXX-INX-FLD-NBR] = WSY1600.SY0UM-USA-COLR-DESC;
                                   /* USA descrip - full*/
      SY0UW03.XCL-COLR-ABRV1[XXX-INX-FLD-NBR] = WSY1600.XCL-COLR-ABRV1;
                                   /* Color abbrev - short*/
      SY0UW03.SY0UM-USA-COLR-ABRV1[XXX-INX-FLD-NBR] = WSY1600.SY0UM-USA-COLR-ABRV1;
                                   /* USA abbrev - short*/
      SY0UW03.XCL-COLR-ABRV2[XXX-INX-FLD-NBR] = WSY1600.XCL-COLR-ABRV2;
                                   /* Color abbrev - long*/
      SY0UW03.SY0UM-USA-COLR-ABRV2[XXX-INX-FLD-NBR] = WSY1600.SY0UM-USA-COLR-ABRV2;
                                   /* USA abbrev - long*/

      /* ------------------------------------------------------------*/
      /* Increment the line index to the next row in display storage.*/
      /* ------------------------------------------------------------*/

      SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-FLD-NBR + 1;
                                   /* Increment line index*/

    end

    /* ------------------------------------------------------------*/
    /* If the page is full, add the page to the storage queue.*/
    /* ------------------------------------------------------------*/

    if (SY0UW00.XXX-INX-FLD-NBR > SY0UW00.XXX-INX-LMT-NBR) /* Page is full*/

      SY0US-TA0050-W03-A(); /* Add page to temporary storage*/

      SY0UW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

    end

  end

   /* ------------------------------------------------------------*/
   /* Add any partially formatted last page to the queue.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-INX-FLD-NBR > 1) /* Page was formatted*/
    SY0US-TA0050-W03-A(); /* Add page to temporary storage*/
  end

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  SY0US-SY1600-CS(); /* Close selected set cursor*/

   /* ------------------------------------------------------------*/
   /* If no pages were formatted, indicate no data to display.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-HI-PAGE-NBR == 0) /* No pages formatted*/

    SY0UW00.XXX-MSG-LOC-ID = "11000"; /* Message location*/
    converseLib.validationFailed(218); /* No data was found to display*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/


end // end SY0U-3-11000

// Format+Converse Lab list map
Function SY0U-3-12000()
   /* ------------------------------------------------------------*/
   /* If an error was found, save the error message number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    SY0UW00.XXX-MSG-NBR = converseVar.validationMsgNum; /* Message number*/
  end

   /* ------------------------------------------------------------*/
   /* If the map must be formatted, format the data in the map.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MAP-FMAT-FL == "Y") /* Map must be formatted*/
    SY0U-3-12100(); /* Format the data in the map*/
  end

   /* ------------------------------------------------------------*/
   /* Format the current date and any FAST PATH information.*/
   /* ------------------------------------------------------------*/

  SY0UM031.XXX-CURR-DT = VGVar.currentShortGregorianDate; /* Current date*/

   /* ------------------------------------------------------------*/
   /* If a message to display, indicate sound audible alarm.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MSG-NBR != 0 /* Message to display*/
   || COMMAREA.CAMSG != " ")   /* or message text*/

    if (SY0UW00.XXX-MSG-NBR != 0) /* Message to display*/

      if (SY0UW00.XXX-MSG-NBR == 9999)
        converseLib.validationFailed();
      else
        converseLib.validationFailed(SY0UW00.XXX-MSG-NBR);
      end /* Message number*/
    else
      SY0UM031.VAGen_EZEMSG = COMMAREA.CAMSG; /* Message text*/

    end

    SY0UM031.XXX-MSG-LOC-ID = SY0UW00.XXX-MSG-LOC-ID;
                                   /* Message location*/

    set SY0UM031 alarm; /* Indicate sound alarm*/

  end

  converse SY0UM031 ;

   /* ------------------------------------------------------------*/
   /* Clear the message fields and save FAST PATH information.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-MSG-LOC-ID = " "; /* Message location*/
  SY0UW00.XXX-MSG-NBR = 0; /* Message number*/
  COMMAREA.CAMSG = " "; /* Message text*/

   /* ------------------------------------------------------------*/
   /* Reset modifiable field attributes to normal intensity.*/
   /* ------------------------------------------------------------*/

  set SY0UM031.SY0UM-XCL-COLR-CD normal; /* Lab Color*/

  SY0UW00.XXX-INX-FLD-NBR = 1; /* Initialize line index*/

  while (SY0UW00.XXX-INX-FLD-NBR <= SY0UW00.XXX-INX-LMT-NBR
   /* Until end of screen*/
   && SY0UM031.XCL-COLR-CD[XXX-INX-FLD-NBR] > " ")
                                   /* or end of formatted lines*/

    set SY0UM031.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] normal;
                                   /* Select indicator*/

    SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-FLD-NBR + 1;
                                   /* Increment line index*/

  end


end // end SY0U-3-12000

// Format the data into the map
Function SY0U-3-12100()
   /* ------------------------------------------------------------*/
   /* Clear the fields in the map storage area to be formatted.*/
   /* ------------------------------------------------------------*/

  set SY0UM031 initial; /* m031 input/output area*/

  SY0UW00.XXX-MAP-FMAT-FL = "N"; /* Format the map flag*/

   /* ------------------------------------------------------------*/
   /* If the page in storage is not the page to be displayed,*/
   /* obtain the desired page from temporary storage.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-HI-PAGE-NBR > 0) /* Pages were formatted*/

    if (SY0UW00.XXX-CURR-PAGE-NBR != TA5REC.TA5TSQIX)
                                   /* Desired page not current*/

      /* ------------------------------------------------------------*/
      /* If the current page has been changed, update the page in*/
      /* storage before obtaining the next one to display.*/
      /* ------------------------------------------------------------*/

      if (SY0UW00.XXX-PAGE-UPD-FL == "Y") /* Current page was changed*/

        SY0US-TA0050-W03-U(); /* Update temporary storage page*/

        SY0UW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

      end

      /* ------------------------------------------------------------*/
      /* If the desired page number is greater than the highest page*/
      /* in storage, default to the highest page number.*/
      /* ------------------------------------------------------------*/

      if (SY0UW00.XXX-CURR-PAGE-NBR > SY0UW00.XXX-HI-PAGE-NBR)
                                   /* Desired greater highest*/
        SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-HI-PAGE-NBR;
                                   /* Default to highest*/
      end

      SY0US-TA0050-W03-R(); /* Read temporary storage page*/

    end

    /* ------------------------------------------------------------*/
    /* Display the page information on the screen.*/
    /* ------------------------------------------------------------*/

    set SY0UM031.XXX-CURR-PAGE-DESC skip; /* "PAGE" literal*/
    SY0UM031.XXX-CURR-PAGE-NBR = SY0UW00.XXX-CURR-PAGE-NBR;
                                   /* Current page*/
    set SY0UM031.XXX-HI-PAGE-DESC skip; /* "OF" literal*/
    SY0UM031.XXX-HI-PAGE-NBR = SY0UW00.XXX-HI-PAGE-NBR;
                                   /* Highest page*/

  end

   /* ------------------------------------------------------------*/
   /* Format the map fields from the display storage area.*/
   /* ------------------------------------------------------------*/

  SY0UM031.XCT-CTRY-CD = SY0UW01.XCT-CTRY-CD; /* Country*/
  SY0UM031.ZFL-LANG-CD = SY0UW01.ZFL-LANG-CD; /* Language*/
  SY0UM031.XCT-CTRY-DESC = SY0UW01.XCT-CTRY-DESC; /* Country*/
  SY0UM031.ZFL-LANG-DESC = SY0UW01.ZFL-LANG-DESC; /* Language*/
  SY0UM031.SY0UM-XCL-COLR-CD = SY0UW03.SY0UM-XCL-COLR-CD; /* Lab Color*/

  SY0UW00.XXX-INX-FLD-NBR = 1; /* Initialize line index*/

  while (SY0UW00.XXX-INX-FLD-NBR <= SY0UW00.XXX-INX-LMT-NBR
   /* Until screen is full*/
   && SY0UW03.XCL-COLR-CD[XXX-INX-FLD-NBR] > " ") /* or end of data*/

    if (SY0UW00.XXX-INX-FLD-NBR == 1) /* First select field*/

      set SY0UM031.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] cursor, normal;
    else
      set SY0UM031.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] normal;

    end

    SY0UM031.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] = SY0UW03.XXX-LN-SEL-IND[XXX-INX-FLD-NBR]; /* Line Select*/
    SY0UM031.XCL-COLR-CD[XXX-INX-FLD-NBR] = SY0UW03.XCL-COLR-CD[XXX-INX-FLD-NBR]; /* Lab Color Code*/
    SY0UM031.XCL-COLR-DESC[XXX-INX-FLD-NBR] = SY0UW03.XCL-COLR-DESC[XXX-INX-FLD-NBR]; /* Color Descrip.*/
    SY0UM031.SY0UM-USA-COLR-DESC[XXX-INX-FLD-NBR] = SY0UW03.SY0UM-USA-COLR-DESC[XXX-INX-FLD-NBR]; /* USA Colr Dscrp.*/

    SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-FLD-NBR + 1;
                                   /* Increment line index*/

  end


end // end SY0U-3-12100

// Check attention identifier
Function SY0U-3-13000()
   /* ------------------------------------------------------------*/
   /* If CANCEL was requested, clear the map fields and exit.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pa2) /* PA2 was pressed*/

    if (SY0UW00.XXX-RQT-DATA-FL == "Y") /* Request for data pending*/
      set SY0UW03 empty; /* m031 display storage*/
    end

    SY0UW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/
    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    COMMAREA.CATOAP = " "; /* TO application*/
    COMMAREA.CAITEM = " "; /* Application data*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* If a PF key transfer requested, exit to another application.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf3) /* PF3 was pressed*/
    SY0UW00.XXX-MAP-DSP-CD = "1"; /* Language Menu*/
    SY0UW00.XXX-MAP-FMAT-FL = "Y";
    SY0UW00.XXX-RQT-DATA-FL = "Y";

    SY0US-TA0050-W03-P(); /* Purge any temporary storage*/

    exit stack; /* exit*/

  end

  if (converseVar.eventKey is pf1) /* PF1 was pressed*/
    COMMAREA.CATOAP = "GD0G"; /* Goal documentation*/
  end

  if (converseVar.eventKey is pf4) /* PF4 was pressed*/
    COMMAREA.CATOAP = "MN0M"; /* Goal Menu*/
  end

  if (converseVar.eventKey is pf1
   || converseVar.eventKey is pf4)

    SY0US-TA0050-W03-P(); /* Purge any temporary storage*/

    XSSYS-EXIT(); /* Exit to another application*/

    SY0UW00.XXX-MAP-DSP-CD = "1"; /* Language Menu*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Determine whether a valid attention identifier was used to*/
   /* invoke the transaction.  Display an error message to the*/
   /* user if the PF key used is not supported.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey not enter /* ENTER was not pressed*/
   && converseVar.eventKey not pf7   /* and PF7 was not pressed*/
   && converseVar.eventKey not pf8)  /* and PF8 was not pressed*/

    SY0UW00.XXX-MSG-LOC-ID = "13000"; /* Message location*/
    converseLib.validationFailed(19); /* PA/PF key pressed is not valid*/

    if (converseVar.eventKey is pakey) /* PA key was pressed*/
      converseLib.clearScreen();
       /* Clear screen before display*/
    end

    exit stack; /* Exit to display map*/

  end


end // end SY0U-3-13000

// Verify entered data
Function SY0U-3-14000()
   /* ------------------------------------------------------------*/
   /* Highlight any application data that was entered.*/
   /* ------------------------------------------------------------*/
   /* If scroll requested, determine if any other field changed.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf7 /* Scroll back request*/
   || converseVar.eventKey is pf8) /* or scroll forward request*/

    SY0U-3-14100(); /* If lines changed, show error*/
    SY0U-3-14200(); /* If lab # changed, show error*/

    /* ------------------------------------------------------------*/
    /* Determine whether a valid request to scroll was entered.*/
    /* ------------------------------------------------------------*/

    SY0U-3-14300(); /* Verify scroll OK with page #*/

  end

   /* ------------------------------------------------------------*/
   /* If any error was found, exit to display the map.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* If key field changed, determine if any other field changed.*/
   /* ------------------------------------------------------------*/

  if (SY0UM031.SY0UM-XCL-COLR-CD != 
  SY0UW03.SY0UM-XCL-COLR-CD) /* Lab Color changed*/

    SY0U-3-14100(); /* If lines changed, show error*/

    /* ------------------------------------------------------------*/
    /* Verify that a Lab Color Cd.was entered.*/
    /* ------------------------------------------------------------*/

    if (SY0UM031.SY0UM-XCL-COLR-CD <= " ") /* Lab not entered*/

      SY0UW00.XXX-MSG-LOC-ID = "14000"; /* Message location*/
      converseLib.validationFailed(3); /* Field missing or invalid*/
      set SY0UM031.SY0UM-XCL-COLR-CD cursor, bold; /* Highlight*/

    end

  end

      /* ------------------------------------------------------------*/
      /* Otherwise, verify any modifiable data that was changed.*/
      /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-HI-PAGE-NBR > 0) /* Page was formatted*/

    SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-LMT-NBR;
                                   /* Line index*/

    while (SY0UW00.XXX-INX-FLD-NBR > 0) /* Until end of lines*/

      SY0U-3-14400(); /* Verify line select is 'S'*/

      SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-FLD-NBR - 1;
                                   /* Decrement line number*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If any error was found, exit to display the map.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    exit stack; /* Exit to display map*/
  end


end // end SY0U-3-14000

// Highlight lines changed in err
Function SY0U-3-14100()
   /* ------------------------------------------------------------*/
   /* If a modifiable field was changed, indicate that field may*/
   /* not be changed when key is changed or a pf key is pressed.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-LMT-NBR; /* Line index*/

  while (SY0UW00.XXX-INX-FLD-NBR > 0) /* Until end of lines*/

    if (SY0UM031.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] != 
    SY0UW03.XXX-LN-SEL-IND[XXX-INX-FLD-NBR])

      SY0UW00.XXX-MSG-LOC-ID = "14100"; /* Message location*/
      converseLib.validationFailed(226); /* Field may not change*/
      set SY0UM031.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] cursor, bold;
                                   /* Highlight*/

    end

    SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-FLD-NBR - 1;
                                   /* Decrement line number*/

  end


end // end SY0U-3-14100

// Highlight Lab Cd.chngd in err
Function SY0U-3-14200()
   /* ------------------------------------------------------------*/
   /* Indicate key field can't change when scroll is requested.*/
   /* ------------------------------------------------------------*/

  if (SY0UM031.SY0UM-XCL-COLR-CD != SY0UW03.SY0UM-XCL-COLR-CD) /* Lab Colr.*/

    SY0UW00.XXX-MSG-LOC-ID = "14200"; /* Message location*/
    converseLib.validationFailed(226); /* Field may not change*/
    set SY0UM031.SY0UM-XCL-COLR-CD cursor, bold; /* Highlight*/

  end

end // end SY0U-3-14200

// Verify scroll request
Function SY0U-3-14300()
   /* ------------------------------------------------------------*/
   /* If scroll back was requested, ensure that pages exist.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf7 /* Scroll back request*/
   && SY0UW00.XXX-CURR-PAGE-NBR < 2) /* and no previous pages*/

    SY0UW00.XXX-MSG-LOC-ID = "14300"; /* Message location*/
    converseLib.validationFailed(69); /* No previous page to display*/

  end

   /* ------------------------------------------------------------*/
   /* If scroll forward was requested, ensure that pages exist.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf8 /* Scroll forward request*/
   && SY0UW00.XXX-CURR-PAGE-NBR >= SY0UW00.XXX-HI-PAGE-NBR)
                                   /* and no more pages*/

    SY0UW00.XXX-MSG-LOC-ID = "14300"; /* Message location*/
    converseLib.validationFailed(70); /* No more pages to display*/

  end


end // end SY0U-3-14300

// Verify line select cd. is 'S'
Function SY0U-3-14400()
   /* ------------------------------------------------------------*/
   /* If selection was entered and is not a "S", indicate that*/
   /* only "S" may be entered to select a line.*/
   /* ------------------------------------------------------------*/

  if (SY0UM031.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] != 
  SY0UW03.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] /* Selection entered*/
   && SY0UM031.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] != "S")
                                   /* and is not a "S"*/

    SY0UW00.XXX-MSG-LOC-ID = "14400"; /* Message location*/
    converseLib.validationFailed(108); /* Only "S" may be entered*/
    set SY0UM031.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] cursor, bold;
                                   /* Highlight*/

  end


end // end SY0U-3-14400

// Process valie input request
Function SY0U-3-15000()
   /* ------------------------------------------------------------*/
   /* If scroll backward was requested, decrement the page number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf7) /* Scroll back requested*/

    SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-CURR-PAGE-NBR - 1;
                                   /* Decrement page number*/

    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If scroll forward was requested, increment the page number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf8) /* Scroll forward requested*/

    SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-CURR-PAGE-NBR + 1;
                                   /* Increment page number*/

    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If list start point changed, find starting point in Temp.Storg.*/
   /* ------------------------------------------------------------*/

  if (SY0UM031.SY0UM-XCL-COLR-CD != SY0UW03.SY0UM-XCL-COLR-CD) /* Lab changed*/

    SY0UW03.SY0UM-XCL-COLR-CD = SY0UM031.SY0UM-XCL-COLR-CD; /* Lab Cd.*/

    SY0U-3-15100(); /* Find correct tsq page #*/

    SY0UW00.XXX-MAP-FMAT-FL = "Y";

    return; /* Return to previous process*/

  end


   /* ------------------------------------------------------------*/
   /* Save any field that was changed in the map display storage.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-INX-FLD-NBR = 1; /* Initialize line index*/

  while (SY0UW00.XXX-INX-FLD-NBR <= SY0UW00.XXX-INX-LMT-NBR)
                                   /* Until end of lines*/

    if (SY0UM031.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] != 
    SY0UW03.XXX-LN-SEL-IND[XXX-INX-FLD-NBR])

      SY0UW03.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] = SY0UM031.XXX-LN-SEL-IND[XXX-INX-FLD-NBR];

      SY0UW00.XXX-PAGE-UPD-FL = "Y"; /* Page update flag*/

    end

    SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-FLD-NBR + 1;
                                   /* Increment line index*/

  end

   /* ------------------------------------------------------------*/
   /* If a line was selected, format the key fields and indicate*/
   /* that map 032 is to be displayed.*/
   /* ------------------------------------------------------------*/

  if ("S" in SY0UW03.XXX-LN-SEL-IND) /* Line was selected*/

    SY0UW00.XXX-INX-FLD-NBR = sysVar.arrayIndex; /* Map line index*/

    SY0UW00.XXX-RQT-DATA-FL = "Y"; /* Request for data flag*/
    SY0UW00.XXX-MAP-DSP-CD = "C"; /* Lab Change Map to be displayed*/

    return; /* does this belong here ???????????*/

  end

   /* does the code below belong here ??????????*/
   /* ------------------------------------------------------------*/
   /* If all above finished, then advance one page.*/
   /* ------------------------------------------------------------*/
  SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-CURR-PAGE-NBR + 1;

end // end SY0U-3-15000

// Get TSQ Page # 4 Strt'g Lab Cd
Function SY0U-3-15100()
   /* --------------------------------------------------------------*/
   /* Start reading TSQ at page 1 and continue reading until*/
   /* reach the page containing the Starting Lab Code entered on Map.*/
   /* NOTE - index value '14' needs to be max # lines on screen.*/
   /* --------------------------------------------------------------*/

  SY0UW00.XXX-CURR-PAGE-NBR = 1; /* Begin at page 1*/

  while (SY0UW00.XXX-CURR-PAGE-NBR <= SY0UW00.XXX-HI-PAGE-NBR)

    SY0US-TA0050-W03-R(); /* Read temporary storage queue page*/

    if (SY0UW03.XCL-COLR-CD[14] >= SY0UM031.SY0UM-XCL-COLR-CD) /* If beynd pt.*/
      return; /* Use current page*/
    end

    SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-CURR-PAGE-NBR + 1; /* Try next pg*/

  end


  SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-HI-PAGE-NBR;
                                  /* Force to last page*/

end // end SY0U-3-15100

// Obtain the data to display
Function SY0U-3-21000()
   /* ------------------------------------------------------------*/
   /* If data was not requested or an error was found, return to*/
   /* the previous process.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-RQT-DATA-FL == "Y") /* Data was requested*/

    if (converseVar.validationMsgNum == 0 /* and no error found*/
     || converseVar.validationMsgNum == 231) /* or message is 'next selection'*/
      /* next sentence*/
    else
      return; /* Return to previous process*/
    end

  else

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Set to show the map.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

   /* The request for data is not actually done here since*/
   /* data was moved in SY0U-3-11000 for Map 31 & 32 together.*/

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/


end // end SY0U-3-21000

// Format+Converse Lab change map
Function SY0U-3-22000()
   /* ------------------------------------------------------------*/
   /* If an error was found, save the error message number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    SY0UW00.XXX-MSG-NBR = converseVar.validationMsgNum; /* Message number*/
  end

   /* ------------------------------------------------------------*/
   /* If the map must be formatted, format the data in the map.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MAP-FMAT-FL == "Y") /* Map must be formatted*/
    SY0U-3-22100(); /* Format the data in the map*/
  end

   /* ------------------------------------------------------------*/
   /* Determine whether to protect any of the modifiable fields.*/
   /* ------------------------------------------------------------*/

  SY0U-3-22200(); /* Check change authorization*/

   /* ------------------------------------------------------------*/
   /* Format the current date and any FAST PATH information.*/
   /* ------------------------------------------------------------*/

  SY0UM032.XXX-CURR-DT = VGVar.currentShortGregorianDate; /* Current date*/

   /* ------------------------------------------------------------*/
   /* If a message to display, indicate sound audible alarm.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MSG-NBR != 0 /* Message to display*/
   || COMMAREA.CAMSG != " ")   /* or message text*/

    if (SY0UW00.XXX-MSG-NBR != 0) /* Message to display*/

      if (SY0UW00.XXX-MSG-NBR == 9999)
        converseLib.validationFailed();
      else
        converseLib.validationFailed(SY0UW00.XXX-MSG-NBR);
      end /* Message number*/
    else
      SY0UM032.VAGen_EZEMSG = COMMAREA.CAMSG; /* Message text*/

    end

    SY0UM032.XXX-MSG-LOC-ID = SY0UW00.XXX-MSG-LOC-ID;
                                   /* Message location*/

    set SY0UM032 alarm; /* Indicate sound alarm*/

  end

  converse SY0UM032 ;

   /* ------------------------------------------------------------*/
   /* Clear the message fields and save FAST PATH information.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-MSG-LOC-ID = " "; /* Message location*/
  SY0UW00.XXX-MSG-NBR = 0; /* Message number*/
  COMMAREA.CAMSG = " "; /* Message text*/

   /* ------------------------------------------------------------*/
   /* Reset modifiable field attributes to normal intensity.*/
   /* ------------------------------------------------------------*/

  set SY0UM032.XCL-COLR-DESC normal; /* Translated Lab Color*/
  set SY0UM032.XCL-COLR-ABRV2 normal; /* Translated long Lab Color Abrv*/
  set SY0UM032.XCL-COLR-ABRV1 normal; /* Translated short Lab Color Abrv*/

   /* ------------------------------------------------------------*/
   /* If language is not Japanese, convert lower case to upper.*/
   /* ------------------------------------------------------------*/

  if (SY0UM032.ZFL-LANG-CD != "JP") /* Language not Japanese*/
    SY0UW00.SY0UW-CNVT-NM-LEN = 15; /* Set length*/
    SY0UW00.SY0UW-CNVT-NM = SY0UM032.XCL-COLR-DESC;
    SY0US-CNVT-LOWER(); /* Convert lower to upper case*/
    SY0UM032.XCL-COLR-DESC = SY0UW00.SY0UW-CNVT-NM;

    SY0UW00.SY0UW-CNVT-NM-LEN = 06; /* Set length*/
    SY0UW00.SY0UW-CNVT-NM = SY0UM032.XCL-COLR-ABRV2;
    SY0US-CNVT-LOWER(); /* Convert lower to upper case*/
    SY0UM032.XCL-COLR-ABRV2 = SY0UW00.SY0UW-CNVT-NM;

    SY0UW00.SY0UW-CNVT-NM-LEN = 06; /* Set length*/
    SY0UW00.SY0UW-CNVT-NM = SY0UM032.XCL-COLR-ABRV1;
    SY0US-CNVT-LOWER(); /* Convert lower to upper case*/
    SY0UM032.XCL-COLR-ABRV1 = SY0UW00.SY0UW-CNVT-NM;
  end

   /* ------------------------------------------------------------*/
   /* Change the selection indicator to show the line was viewed.*/
   /* ------------------------------------------------------------*/

  SY0UW03.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] = "V";
                                   /* Select indicator*/


end // end SY0U-3-22000

// Format the data in the map
Function SY0U-3-22100()
   /* ------------------------------------------------------------*/
   /* Clear the fields in the map storage area to be formatted.*/
   /* ------------------------------------------------------------*/

  set SY0UM032 initial; /* M032 input/output area*/

  SY0UW00.XXX-MAP-FMAT-FL = "N"; /* Format the map flag*/

   /* ------------------------------------------------------------*/
   /* Format the map fields from the display storage area.*/
   /* ------------------------------------------------------------*/

  SY0UM032.XCT-CTRY-CD = SY0UW01.XCT-CTRY-CD; /* Country Cd*/
  SY0UM032.XCT-CTRY-DESC = SY0UW01.XCT-CTRY-DESC; /* Country Desc*/
  SY0UM032.ZFL-LANG-CD = SY0UW01.ZFL-LANG-CD; /* Country Cd*/
  SY0UM032.ZFL-LANG-DESC = SY0UW01.ZFL-LANG-DESC; /* Country Desc*/
  SY0UM032.XCL-COLR-CD = SY0UW03.XCL-COLR-CD[XXX-INX-FLD-NBR]; /* Lab Color code*/
  SY0UM032.XCL-COLR-DESC = SY0UW03.XCL-COLR-DESC[XXX-INX-FLD-NBR]; /* Lab Color description*/
  SY0UM032.SY0UM-USA-COLR-DESC = SY0UW03.SY0UM-USA-COLR-DESC[XXX-INX-FLD-NBR]; /* USA Descrip.*/
  SY0UM032.XCL-COLR-ABRV1 = SY0UW03.XCL-COLR-ABRV1[XXX-INX-FLD-NBR];
                                   /* Lab short abbrev.*/
  SY0UM032.SY0UM-USA-COLR-ABRV1 = SY0UW03.SY0UM-USA-COLR-ABRV1[XXX-INX-FLD-NBR]; /* USA short abrv*/
  SY0UM032.XCL-COLR-ABRV2 = SY0UW03.XCL-COLR-ABRV2[XXX-INX-FLD-NBR];
                                   /* Lab long  abbrev.*/
  SY0UM032.SY0UM-USA-COLR-ABRV2 = SY0UW03.SY0UM-USA-COLR-ABRV2[XXX-INX-FLD-NBR]; /* USA long abrv*/


end // end SY0U-3-22100

// Check change authorization
Function SY0U-3-22200()
   /* ------------------------------------------------------------*/
   /* If requested data was found and the user is authorized to*/
   /* change data on the screen, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-RQT-DATA-FL == "N" /* Requested data was found*/
   && SY0UW00.SY0UW-MAP-MODE == "M") /* and user authorized to change*/

    set SY0UM032.SY0UM-PF12 normal; /* Allow use of PF12 to edit data*/

    SY0UM032.SY0UM-TTL-NM = "MAINTENANCE";

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, protect the modifiable fields on the screen.*/
   /* ------------------------------------------------------------*/

  set SY0UM032.XCL-COLR-DESC skip; /* Translated Lab Color descrip.*/
  set SY0UM032.XCL-COLR-ABRV1 skip; /* Translated Lab abbrev short*/
  set SY0UM032.XCL-COLR-ABRV2 skip; /* Translated Lab abbrev long*/
  set SY0UM032.SY0UM-PF12 invisible, cursor; /* Prevent use of PF12 to edit data*/

  SY0UM032.SY0UM-TTL-NM = "INQUIRY";


end // end SY0U-3-22200

// Check attention identifier
Function SY0U-3-23000()
   /* ------------------------------------------------------------*/
   /* If CANCEL was requested, clear the map fields and exit.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pa2) /* PA2 was pressed*/

    if (SY0UW00.XXX-RQT-DATA-FL == "Y") /* Request for data pending*/
      converseLib.clearScreen();
       /* Clear screen before display*/
    end

    SY0UW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/
    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    COMMAREA.CATOAP = " "; /* TO application*/
    COMMAREA.CAITEM = " "; /* Application data*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* If a PF key transfer requested, exit to another application.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf3) /* PF3 was pressed*/

    SY0UW00.XXX-MAP-DSP-CD = "1"; /* Lanaguage Menu = next map*/
    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/
    SY0UW00.XXX-RQT-DATA-FL = "Y";

    SY0US-TA0050-W03-P(); /* Purge any temporary storage*/

    exit stack;

  end

  if (converseVar.eventKey is pf1) /* PF1 was pressed*/
    COMMAREA.CATOAP = "GD0G"; /* Goal documentation*/
  end

  if (converseVar.eventKey is pf4) /* PF4 was pressed*/
    COMMAREA.CATOAP = "MN0M"; /* Goal master menu*/
  end

  if (converseVar.eventKey is pf1
   || converseVar.eventKey is pf4)

    SY0US-TA0050-W03-P(); /* Purge any temporary storage*/

    XSSYS-EXIT(); /* Exit to another application*/

    SY0UW00.XXX-MAP-DSP-CD = "1"; /* Language Menu*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Determine whether a valid attention identifier was used to*/
   /* invoke the transaction.  Display an error message to the*/
   /* user if the PF key used is not supported.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey not enter /* ENTER was not pressed*/
   && converseVar.eventKey not pf12) /* and PF12 was not pressed*/

    SY0UW00.XXX-MSG-LOC-ID = "23000"; /* Message location*/
    converseLib.validationFailed(19); /* PA/PF key pressed is not valid*/

    if (converseVar.eventKey is pakey) /* PA key was pressed*/
      converseLib.clearScreen();
       /* Clear screen before display*/
    end

    exit stack; /* Exit to display map*/

  end


end // end SY0U-3-23000

// Verify entered data
Function SY0U-3-24000()
   /* ------------------------------------------------------------*/
   /* If EDIT requested, indicate edit completed and no errors.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf12) /* PF12 was pressed*/

    SY0UW00.XXX-MSG-LOC-ID = "24000"; /* Message location*/
    converseLib.validationFailed(14); /* Edit completed and no errors*/

    exit stack; /* Exit to display map*/

  end


end // end SY0U-3-24000

// Process valid input request
Function SY0U-3-25000()
   /* ------------------------------------------------------------------*/
   /* Modification History*/
   /* Date     Userid     Description*/
   /* ----------  ------  ----------------------------------------------*/
   /* 11-19-1998  HMACAL  Qualified SQLCODE with SQLCA;*/
   /* ------------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* If no modifiable data changed, search for next selection.*/
   /* ------------------------------------------------------------*/

  if (SY0UM032.XCL-COLR-DESC == SY0UW03.XCL-COLR-DESC[XXX-INX-FLD-NBR]
   && SY0UM032.XCL-COLR-ABRV1 == 
  SY0UW03.XCL-COLR-ABRV1[XXX-INX-FLD-NBR]
   && SY0UM032.XCL-COLR-ABRV2 == 
  SY0UW03.XCL-COLR-ABRV2[XXX-INX-FLD-NBR])

    SY0U-3-25100(); /* Search for next selection*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Obtain the current date and time.*/
   /* ------------------------------------------------------------*/

  XX0XS01(); /* Obtain date and time*/

   /* ------------------------------------------------------------*/
   /* Build key data to search for table row.*/
   /* ------------------------------------------------------------*/

  VLBCLR01.XCL-COLR-CD = SY0UW03.XCL-COLR-CD[XXX-INX-FLD-NBR];
  VLBCLR01.XCT-CTRY-CD = SY0UW01.XCT-CTRY-CD; /* Country*/
  VLBCLR01.ZFL-LANG-CD = SY0UW01.ZFL-LANG-CD; /* Language*/

  SY0US-VLBCLR01-S(); /* Select row to check for existence*/

  VLBCLR01.XCL-COLR-DESC = SY0UM032.XCL-COLR-DESC; /* Trans. Lab Color descrip.*/
  VLBCLR01.XCL-COLR-ABRV1 = SY0UM032.XCL-COLR-ABRV1; /* Trans. short Lab color*/
  VLBCLR01.XCL-COLR-ABRV2 = SY0UM032.XCL-COLR-ABRV2; /* Trans. long  Lab color*/

  SY0UW03.XCL-COLR-DESC[XXX-INX-FLD-NBR] = SY0UM032.XCL-COLR-DESC; /* Trans. Lab descrip.*/
  SY0UW03.XCL-COLR-ABRV1[XXX-INX-FLD-NBR] = SY0UM032.XCL-COLR-ABRV1; /* Trans. short Lab abbrev.*/
  SY0UW03.XCL-COLR-ABRV2[XXX-INX-FLD-NBR] = SY0UM032.XCL-COLR-ABRV2; /* Trans. long  Lab abbrev.*/
  SY0UW00.XXX-PAGE-UPD-FL = "Y";

  VLBCLR01.ZZ-CHNG-DT = XX0XW01.XX0XWDAT; /* Change date*/
  VLBCLR01.ZZ-CHNG-HHMM = XX0XW01.XX0XWTIM; /* Change time*/

  if (SQLCA.VAGen_SQLCODE == 0) /* If row already exists,*/
    SY0US-VLBCLR01-U(); /* Update the table row*/
  else
    VLBCLR01.ZZ-SDT = XX0XW01.XX0XWDAT; /* Setup date*/
    VLBCLR01.ZZ-CHNG-CNT = 0; /* Change count*/
    SY0US-VLBCLR01-A(); /* Else add a new row*/
  end

   /* ------------------------------------------------------------*/
   /* Commit all changes and refresh the data to be displayed.*/
   /* ------------------------------------------------------------*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.commit(); /* Commit all changes*/

  SY0UW00.XXX-MSG-LOC-ID = "25000"; /* Message location*/
  SY0UW00.XXX-MSG-NBR = 11; /* Table update was completed*/

  SY0UW00.XXX-RQT-DATA-FL = "Y"; /* Request for data flag*/


end // end SY0U-3-25000

// Search for next selection
Function SY0U-3-25100()
   /* ------------------------------------------------------------*/
   /* Determine if another line was selected for viewing.*/
   /* ------------------------------------------------------------*/

  if ("S" in SY0UW03.XXX-LN-SEL-IND) /* Line was selected*/

    SY0UW00.XXX-INX-FLD-NBR = sysVar.arrayIndex; /* Map line index*/

    SY0UM032.XCL-COLR-CD = SY0UW03.XCL-COLR-CD[XXX-INX-FLD-NBR];
                                   /* Lab Color code*/
    SY0UM032.XCL-COLR-DESC = SY0UW03.XCL-COLR-DESC[XXX-INX-FLD-NBR]; /* Translated Lab Descrip.*/
    SY0UM032.SY0UM-USA-COLR-DESC = SY0UW03.SY0UM-USA-COLR-DESC[XXX-INX-FLD-NBR]; /* USA Lab Color descrip.*/
    SY0UM032.XCL-COLR-ABRV1 = SY0UW03.XCL-COLR-ABRV1[XXX-INX-FLD-NBR]; /* Translated Lab short abbrev.*/
    SY0UM032.SY0UM-USA-COLR-ABRV1 = SY0UW03.SY0UM-USA-COLR-ABRV1[XXX-INX-FLD-NBR]; /* USA Lab Color short abrv.*/
    SY0UM032.XCL-COLR-ABRV2 = SY0UW03.XCL-COLR-ABRV2[XXX-INX-FLD-NBR]; /* Translated Lab abbrev - long*/
    SY0UM032.SY0UM-USA-COLR-ABRV2 = SY0UW03.SY0UM-USA-COLR-ABRV2[XXX-INX-FLD-NBR]; /* USA Lab Color long abrv.*/

    SY0UW00.XXX-RQT-DATA-FL = "Y"; /* Request for data flag*/

    SY0UW00.XXX-MSG-LOC-ID = "25100";
    converseLib.validationFailed(231); /* This is the next Selection*/

  else

    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/
    SY0UW00.XXX-MAP-DSP-CD = "3"; /* Lab List is next map shown*/

  end


end // end SY0U-3-25100

// Obtain the data to display
Function SY0U-4-11000()
   /* ------------------------------------------------------------------*/
   /* Modification History*/
   /* Date     Userid     Description*/
   /* ----------  ------  ----------------------------------------------*/
   /* 11-19-1998  HMACAL  Added Region Code in setting WSY1610 key and*/
   /* used Declare/Open/Fetch/Close cursor 2 for Japan*/
   /*  */
   /* ------------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* If data was not requested or an error was found, return to*/
   /* the previous process.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-RQT-DATA-FL != "Y" /* Data was not requested*/
   || converseVar.validationMsgNum != 0) /* or an error was found*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If no message to display, reset the page number to display.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MSG-NBR == 0) /* No message to display*/
    SY0UW00.XXX-CURR-PAGE-NBR = 1; /* Page number to display*/
  end

   /* ------------------------------------------------------------*/
   /* Purge any pages from temporary storage and save key fields.*/
   /* ------------------------------------------------------------*/

  SY0US-TA0050-W04-P(); /* Purge any temporary storage*/

  SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

  SY0UW04.SY0UM-SY-STY-NBR = SY0UM041.SY0UM-SY-STY-NBR; /* Style Nbr.*/

  if (converseVar.validationMsgNum != 0) /* If error already found, go show*/
                                  /* message*/
    exit stack;
  end

   /* ------------------------------------------------------------*/
   /* Select and open the cursor for the set to be formatted.*/
   /* ------------------------------------------------------------*/

  set WSY1610 empty; /* Clear row storage area*/

  WSY1610.XCT-CTRY-CD = SY0UW01.XCT-CTRY-CD; /* Country Code*/
  WSY1610.ZFL-LANG-CD = SY0UW01.ZFL-LANG-CD; /* Language Code*/
  WSY1610.XGP-GPC-CD = SY0UW01.XGP-GPC-CD; /* G.P.C.*/
  WSY1610.XDR-PROD-REG-CD = SY0UW01.XDR-PROD-REG-CD; /* Region Code*/
  WSY1610.XSE-SESN-CD = SY0UW01.XSE-SESN-CD; /* Season Code*/
  WSY1610.XSN-SESN-YR-RNG = SY0UW01.XSN-SESN-YR-RNG; /* Season Year*/
  WSY1610.WSY1610-CURR-DT-LESS-2YR = SY0UW00.SY0UW-CURR-DT-LESS-2YR; /* Get closeouts for last 2 yr*/

  if (WSY1610.XDR-PROD-REG-CD == "06") /* If JAPAN Region*/
    SY0US-SY1610-S2(); /* Select set and open cursor 2*/
  else
    SY0US-SY1610-SS(); /* Select set and open cursor*/
  end

   /* ------------------------------------------------------------*/
   /* Fetch and format the data into pages until end of cursor.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  SY0UW00.SY0UW-STY-EOF-FL = "N"; /* End of cursor flag*/

  while (SY0UW00.SY0UW-STY-EOF-FL == "N" /* Until end of cursor*/
  )
    if (WSY1610.XDR-PROD-REG-CD == "06") /* If JAPAN Region*/
      SY0US-SY1610-N2(); /* Fetch next row in cursor 2*/
    else
      SY0US-SY1610-SN(); /* Fetch next row in cursor*/
    end

    /* ------------------------------------------------------------*/
    /* If not end of cursor, save the data in display storage.*/
    /* ------------------------------------------------------------*/

    if (SY0UW00.SY0UW-STY-EOF-FL == "N") /* Not end of cursor*/

      /* ------------------------------------------------------------*/
      /* If first line on subsequent page, save heading information.*/
      /* ------------------------------------------------------------*/

      if (SY0UW00.XXX-HI-PAGE-NBR > 0 /* Not the first page*/
       && SY0UW00.XXX-INX-FLD-NBR == 1) /* and first line on page*/

        SY0UW04.SY0UM-SY-STY-NBR = SY0UM041.SY0UM-SY-STY-NBR;
                                   /* Requested Style Nbr*/

      end

      /* ------------------------------------------------------------*/
      /* Save the data from the table row into display storage.*/
      /* ------------------------------------------------------------*/

      SY0UW04.SY-PROD-ID[XXX-INX-FLD-NBR] = WSY1610.SY-PROD-ID;
                                   /* Product ID*/
      SY0UW04.SY-STY-NBR[XXX-INX-FLD-NBR] = WSY1610.SY-STY-NBR;
                                   /* Style Nbr*/
      SY0UW04.SY-COLR-CD-ID[XXX-INX-FLD-NBR] = WSY1610.SY-COLR-CD-ID;
                                   /* Color code*/
      SY0UW04.XDM-DIM-CD[XXX-INX-FLD-NBR] = WSY1610.XDM-DIM-CD;
                                   /* Dimension Code*/
      SY0UW04.SY-TRSL-COLR-NM[XXX-INX-FLD-NBR] = WSY1610.SY-TRSL-COLR-NM;
                                   /* Color descrip*/
      SY0UW04.SY-STY-COLR-DESC[XXX-INX-FLD-NBR] = WSY1610.SY-STY-COLR-DESC;
                                   /* USA Color descrip.*/
      SY0UW04.SY-TRSL-SH-COLR-NM[XXX-INX-FLD-NBR] = WSY1610.SY-TRSL-SH-COLR-NM;
                                   /* Color descrip - short*/
      SY0UW04.SY-STY-COLR-ABRV[XXX-INX-FLD-NBR] = WSY1610.SY-STY-COLR-ABRV;
                                   /* USA Color abbreviation*/

      /* ------------------------------------------------------------*/
      /* Increment the line index to the next row in display storage.*/
      /* ------------------------------------------------------------*/

      SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-FLD-NBR + 1;
                                   /* Increment line index*/

    end

    /* ------------------------------------------------------------*/
    /* If the page is full, add the page to the storage queue.*/
    /* ------------------------------------------------------------*/

    if (SY0UW00.XXX-INX-FLD-NBR > SY0UW00.XXX-INX-LMT-NBR) /* Page is full*/

      SY0US-TA0050-W04-A(); /* Add page to temporary storage*/

      SY0UW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

    end

  end

   /* ------------------------------------------------------------*/
   /* Add any partially formatted last page to the queue.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-INX-FLD-NBR > 1) /* Page was formatted*/
    SY0US-TA0050-W04-A(); /* Add page to temporary storage*/
  end

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  if (WSY1610.XDR-PROD-REG-CD == "06") /* If JAPAN Region*/
    SY0US-SY1610-C2(); /* Close selected set cursor 2*/
  else
    SY0US-SY1610-CS(); /* Close selected set cursor*/
  end

   /* ------------------------------------------------------------*/
   /* If no pages were formatted, indicate no data to display.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-HI-PAGE-NBR == 0) /* No pages formatted*/

    SY0UW00.XXX-MSG-LOC-ID = "11000"; /* Message location*/
    converseLib.validationFailed(218); /* No data was found to display*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/


end // end SY0U-4-11000

// Format+Converse Color List map
Function SY0U-4-12000()
   /* ------------------------------------------------------------*/
   /* If an error was found, save the error message number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    SY0UW00.XXX-MSG-NBR = converseVar.validationMsgNum; /* Message number*/
  end

   /* ------------------------------------------------------------*/
   /* If the map must be formatted, format the data in the map.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MAP-FMAT-FL == "Y") /* Map must be formatted*/
    SY0U-4-12100(); /* Format the data in the map*/
  end

   /* ------------------------------------------------------------*/
   /* Format the current date and any FAST PATH information.*/
   /* ------------------------------------------------------------*/

  SY0UM041.XXX-CURR-DT = VGVar.currentShortGregorianDate; /* Current date*/

   /* ------------------------------------------------------------*/
   /* If a message to display, indicate sound audible alarm.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MSG-NBR != 0 /* Message to display*/
   || COMMAREA.CAMSG != " ")   /* or message text*/

    if (SY0UW00.XXX-MSG-NBR != 0) /* Message to display*/

      if (SY0UW00.XXX-MSG-NBR == 9999)
        converseLib.validationFailed();
      else
        converseLib.validationFailed(SY0UW00.XXX-MSG-NBR);
      end /* Message number*/
    else
      SY0UM041.VAGen_EZEMSG = COMMAREA.CAMSG; /* Message text*/

    end

    SY0UM041.XXX-MSG-LOC-ID = SY0UW00.XXX-MSG-LOC-ID;
                                   /* Message location*/

    set SY0UM041 alarm; /* Indicate sound alarm*/

  end

  converse SY0UM041 ;

   /* ------------------------------------------------------------*/
   /* Clear the message fields and save FAST PATH information.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-MSG-LOC-ID = " "; /* Message location*/
  SY0UW00.XXX-MSG-NBR = 0; /* Message number*/
  COMMAREA.CAMSG = " "; /* Message text*/

   /* ------------------------------------------------------------*/
   /* Reset modifiable field attributes to normal intensity.*/
   /* ------------------------------------------------------------*/

  set SY0UM041.SY0UM-SY-STY-NBR normal; /* Style number*/

  SY0UW00.XXX-INX-FLD-NBR = 1; /* Initialize line index*/

  while (SY0UW00.XXX-INX-FLD-NBR <= SY0UW00.XXX-INX-LMT-NBR
   /* Until end of screen*/
   && SY0UM041.SY-STY-NBR[XXX-INX-FLD-NBR] > " ")
                                   /* or end of formatted lines*/

    set SY0UM041.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] normal;
                                   /* Select indicator*/

    SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-FLD-NBR + 1;
                                   /* Increment line index*/

  end


end // end SY0U-4-12000

// Format the data to the map
Function SY0U-4-12100()
   /* ------------------------------------------------------------*/
   /* Clear the fields in the map storage area to be formatted.*/
   /* ------------------------------------------------------------*/

  set SY0UM041 initial; /* m041 input/output area*/

  SY0UW00.XXX-MAP-FMAT-FL = "N"; /* Format the map flag*/

   /* ------------------------------------------------------------*/
   /* If the page in storage is not the page to be displayed,*/
   /* obtain the desired page from temporary storage.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-HI-PAGE-NBR > 0) /* Pages were formatted*/

    if (SY0UW00.XXX-CURR-PAGE-NBR != TA5REC.TA5TSQIX)
                                   /* Desired page not current*/

      /* ------------------------------------------------------------*/
      /* If the current page has been changed, update the page in*/
      /* storage before obtaining the next one to display.*/
      /* ------------------------------------------------------------*/

      if (SY0UW00.XXX-PAGE-UPD-FL == "Y") /* Current page was changed*/

        SY0US-TA0050-W04-U(); /* Update temporary storage page*/

        SY0UW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

      end

      /* ------------------------------------------------------------*/
      /* If the desired page number is greater than the highest page*/
      /* in storage, default to the highest page number.*/
      /* ------------------------------------------------------------*/

      if (SY0UW00.XXX-CURR-PAGE-NBR > SY0UW00.XXX-HI-PAGE-NBR)
                                   /* Desired greater highest*/
        SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-HI-PAGE-NBR;
                                   /* Default to highest*/
      end

      SY0US-TA0050-W04-R(); /* Read temporary storage page*/

    end

    /* ------------------------------------------------------------*/
    /* Display the page information on the screen.*/
    /* ------------------------------------------------------------*/

    set SY0UM041.XXX-CURR-PAGE-DESC skip; /* "PAGE" literal*/
    SY0UM041.XXX-CURR-PAGE-NBR = SY0UW00.XXX-CURR-PAGE-NBR;
                                   /* Current page*/
    set SY0UM041.XXX-HI-PAGE-DESC skip; /* "OF" literal*/
    SY0UM041.XXX-HI-PAGE-NBR = SY0UW00.XXX-HI-PAGE-NBR;
                                   /* Highest page*/

  end

   /* ------------------------------------------------------------*/
   /* Format the map fields from the display storage area.*/
   /* ------------------------------------------------------------*/

  SY0UM041.XCT-CTRY-CD = SY0UW01.XCT-CTRY-CD; /* Country*/
  SY0UM041.ZFL-LANG-CD = SY0UW01.ZFL-LANG-CD; /* Language*/
  SY0UM041.XGP-GPC-CD = SY0UW01.XGP-GPC-CD; /* G.P.C.*/
  SY0UM041.XCT-CTRY-DESC = SY0UW01.XCT-CTRY-DESC; /* Country*/
  SY0UM041.ZFL-LANG-DESC = SY0UW01.ZFL-LANG-DESC; /* Language*/
  SY0UM041.XGP-GPC-DESC = SY0UW01.XGP-GPC-DESC; /* GPC Descrip*/
  SY0UM041.XSE-SESN-CD = SY0UW01.XSE-SESN-CD; /* Season Code*/
  SY0UM041.XSE-SESN-DESC = SY0UW01.XSE-SESN-DESC; /* Season Desc*/
  SY0UM041.XSN-SESN-YR-RNG = SY0UW01.XSN-SESN-YR-RNG; /* Season Year*/
  SY0UM041.SY0UM-SY-STY-NBR = SY0UW04.SY0UM-SY-STY-NBR; /* Style Nbr*/

  SY0UW00.XXX-INX-FLD-NBR = 1; /* Initialize line index*/

  while (SY0UW00.XXX-INX-FLD-NBR <= SY0UW00.XXX-INX-LMT-NBR
   /* Until screen is full*/
   && SY0UW04.SY-STY-NBR[XXX-INX-FLD-NBR] > " ") /* or end of data*/

    if (SY0UW00.XXX-INX-FLD-NBR == 1) /* First select field*/

      set SY0UM041.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] cursor, normal;
    else
      set SY0UM041.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] normal;

    end

    SY0UM041.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] = SY0UW04.XXX-LN-SEL-IND[XXX-INX-FLD-NBR]; /* Line Select*/
    SY0UM041.SY-STY-NBR[XXX-INX-FLD-NBR] = SY0UW04.SY-STY-NBR[XXX-INX-FLD-NBR]; /* Style Nbr.*/
    SY0UM041.SY-COLR-CD-ID[XXX-INX-FLD-NBR] = SY0UW04.SY-COLR-CD-ID[XXX-INX-FLD-NBR]; /* Color ID*/
    SY0UM041.XDM-DIM-CD[XXX-INX-FLD-NBR] = SY0UW04.XDM-DIM-CD[XXX-INX-FLD-NBR]; /* Dimension*/
    SY0UM041.SY-TRSL-COLR-NM[XXX-INX-FLD-NBR] = SY0UW04.SY-TRSL-COLR-NM[XXX-INX-FLD-NBR]; /* Color Descrip.*/
    SY0UM041.SY-STY-COLR-DESC[XXX-INX-FLD-NBR] = SY0UW04.SY-STY-COLR-DESC[XXX-INX-FLD-NBR]; /* USA Colr Dscrp.*/

    SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-FLD-NBR + 1;
                                   /* Increment line index*/

  end


end // end SY0U-4-12100

// Check attention identifier
Function SY0U-4-13000()
   /* ------------------------------------------------------------*/
   /* If CANCEL was requested, clear the map fields and exit.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pa2) /* PA2 was pressed*/

    if (SY0UW00.XXX-RQT-DATA-FL == "Y") /* Request for data pending*/
      set SY0UW04 empty; /* m041 display storage*/
    end

    SY0UW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/
    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    COMMAREA.CATOAP = " "; /* TO application*/
    COMMAREA.CAITEM = " "; /* Application data*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* If a PF key transfer requested, exit to another application.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf3) /* PF3 was pressed*/
    SY0UW00.XXX-MAP-DSP-CD = "1"; /* Language Menu*/
    SY0UW00.XXX-MAP-FMAT-FL = "Y";
    SY0UW00.XXX-RQT-DATA-FL = "Y";

    SY0US-TA0050-W04-P(); /* Purge any temporary storage*/

    exit stack; /* exit*/

  end

  if (converseVar.eventKey is pf1) /* PF1 was pressed*/
    COMMAREA.CATOAP = "GD0G"; /* Goal documentation*/
  end

  if (converseVar.eventKey is pf4) /* PF4 was pressed*/
    COMMAREA.CATOAP = "MN0M"; /* Goal Menu*/
  end

  if (converseVar.eventKey is pf1
   || converseVar.eventKey is pf4)

    SY0US-TA0050-W04-P(); /* Purge any temporary storage*/

    XSSYS-EXIT(); /* Exit to another application*/

    SY0UW00.XXX-MAP-DSP-CD = "1"; /* Language Menu*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Determine whether a valid attention identifier was used to*/
   /* invoke the transaction.  Display an error message to the*/
   /* user if the PF key used is not supported.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey not enter /* ENTER was not pressed*/
   && converseVar.eventKey not pf7   /* and PF7 was not pressed*/
   && converseVar.eventKey not pf8)  /* and PF8 was not pressed*/

    SY0UW00.XXX-MSG-LOC-ID = "13000"; /* Message location*/
    converseLib.validationFailed(19); /* PA/PF key pressed is not valid*/

    if (converseVar.eventKey is pakey) /* PA key was pressed*/
      converseLib.clearScreen();
       /* Clear screen before display*/
    end

    exit stack; /* Exit to display map*/

  end


end // end SY0U-4-13000

// Verify entered data
Function SY0U-4-14000()
   /* ------------------------------------------------------------*/
   /* Highlight any application data that was entered.*/
   /* ------------------------------------------------------------*/
   /* If scroll requested, determine if any other field changed.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf7 /* Scroll back request*/
   || converseVar.eventKey is pf8) /* or scroll forward request*/

    SY0U-4-14100(); /* If lines changed, show error*/
    SY0U-4-14200(); /* If style changed, show error*/

    /* ------------------------------------------------------------*/
    /* Determine whether a valid request to scroll was entered.*/
    /* ------------------------------------------------------------*/

    SY0U-4-14300(); /* Verify scroll OK with page #*/

  end

   /* ------------------------------------------------------------*/
   /* If any error was found, exit to display the map.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    exit stack; /* Exit to display map*/
  end

   /* ------------------------------------------------------------*/
   /* If key field changed, determine if any other field changed.*/
   /* ------------------------------------------------------------*/

  if (SY0UM041.SY0UM-SY-STY-NBR
   != SY0UW04.SY0UM-SY-STY-NBR) /* Style Nbr changed*/

    SY0U-4-14100(); /* If lines changed, show error*/

    /* ------------------------------------------------------------*/
    /* Verify that a Style Nbr was entered.*/
    /* ------------------------------------------------------------*/

    if (SY0UM041.SY0UM-SY-STY-NBR <= " ") /* Style not entered*/

      SY0UW00.XXX-MSG-LOC-ID = "14000"; /* Message location*/
      converseLib.validationFailed(3); /* Field missing or invalid*/
      set SY0UM041.SY0UM-SY-STY-NBR cursor, bold; /* Highlight*/

    end

  end

      /* ------------------------------------------------------------*/
      /* Otherwise, verify any modifiable data that was changed.*/
      /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-HI-PAGE-NBR > 0) /* Page was formatted*/

    SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-LMT-NBR;
                                   /* Line index*/

    while (SY0UW00.XXX-INX-FLD-NBR > 0) /* Until end of lines*/

      SY0U-4-14400(); /* Verify line select is 'S'*/

      SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-FLD-NBR - 1;
                                   /* Decrement line number*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If any error was found, exit to display the map.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    exit stack; /* Exit to display map*/
  end


end // end SY0U-4-14000

// Highlight lines chgnd.in error
Function SY0U-4-14100()
   /* ------------------------------------------------------------*/
   /* If a modifiable field was changed, indicate that field may*/
   /* not be changed when key is changed or a pf key is pressed.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-LMT-NBR; /* Line index*/

  while (SY0UW00.XXX-INX-FLD-NBR > 0) /* Until end of lines*/

    if (SY0UM041.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] != 
    SY0UW04.XXX-LN-SEL-IND[XXX-INX-FLD-NBR])

      SY0UW00.XXX-MSG-LOC-ID = "14100"; /* Message location*/
      converseLib.validationFailed(226); /* Field may not change*/
      set SY0UM041.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] cursor, bold;
                                   /* Highlight*/

    end

    SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-FLD-NBR - 1;
                                   /* Decrement line number*/

  end


end // end SY0U-4-14100

// Highlight Style chngd.in error
Function SY0U-4-14200()
   /* ------------------------------------------------------------*/
   /* Indicate key field can't change when scroll is requested.*/
   /* ------------------------------------------------------------*/

  if (SY0UM041.SY0UM-SY-STY-NBR != SY0UW04.SY0UM-SY-STY-NBR) /* Style Nbr.*/

    SY0UW00.XXX-MSG-LOC-ID = "14200"; /* Message location*/
    converseLib.validationFailed(226); /* Field may not change*/
    set SY0UM041.SY0UM-SY-STY-NBR cursor, bold; /* Highlight*/

  end

end // end SY0U-4-14200

// Verify scroll request
Function SY0U-4-14300()
   /* ------------------------------------------------------------*/
   /* If scroll back was requested, ensure that pages exist.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf7 /* Scroll back request*/
   && SY0UW00.XXX-CURR-PAGE-NBR < 2) /* and no previous pages*/

    SY0UW00.XXX-MSG-LOC-ID = "14300"; /* Message location*/
    converseLib.validationFailed(69); /* No previous page to display*/

  end

   /* ------------------------------------------------------------*/
   /* If scroll forward was requested, ensure that pages exist.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf8 /* Scroll forward request*/
   && SY0UW00.XXX-CURR-PAGE-NBR >= SY0UW00.XXX-HI-PAGE-NBR)
                                   /* and no more pages*/

    SY0UW00.XXX-MSG-LOC-ID = "14300"; /* Message location*/
    converseLib.validationFailed(70); /* No more pages to display*/

  end


end // end SY0U-4-14300

// Verify line select cd is 'S'
Function SY0U-4-14400()
   /* ------------------------------------------------------------*/
   /* If selection was entered and is not a "S", indicate that*/
   /* only "S" may be entered to select a line.*/
   /* ------------------------------------------------------------*/

  if (SY0UM041.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] != 
  SY0UW04.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] /* Selection entered*/
   && SY0UM041.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] != "S")
                                   /* and is not a "S"*/

    SY0UW00.XXX-MSG-LOC-ID = "14400"; /* Message location*/
    converseLib.validationFailed(108); /* Only "S" may be entered*/
    set SY0UM041.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] cursor, bold;
                                   /* Highlight*/

  end


end // end SY0U-4-14400

// Process valid input request
Function SY0U-4-15000()
   /* ------------------------------------------------------------------*/
   /* Modification History*/
   /* Date     Userid     Description*/
   /* ----------  ------  ----------------------------------------------*/
   /* 12-03-1998  HMACAL  Commented out logic that adds 1 to current page*/
   /* number.*/
   /* ------------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* If scroll backward was requested, decrement the page number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf7) /* Scroll back requested*/

    SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-CURR-PAGE-NBR - 1;
                                   /* Decrement page number*/

    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If scroll forward was requested, increment the page number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf8) /* Scroll forward requested*/

    SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-CURR-PAGE-NBR + 1;
                                   /* Increment page number*/

    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If list start point changed, find starting point in Temp.Storg.*/
   /* ------------------------------------------------------------*/

  if (SY0UM041.SY0UM-SY-STY-NBR != SY0UW04.SY0UM-SY-STY-NBR) /* Style chngd.*/

    SY0UW04.SY0UM-SY-STY-NBR = SY0UM041.SY0UM-SY-STY-NBR;

    SY0U-4-15100(); /* Find correct tsq page #*/

    SY0UW00.XXX-MAP-FMAT-FL = "Y";

    return; /* Return to previous process*/

  end


   /* ------------------------------------------------------------*/
   /* Save any field that was changed in the map display storage.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-INX-FLD-NBR = 1; /* Initialize line index*/

  while (SY0UW00.XXX-INX-FLD-NBR <= SY0UW00.XXX-INX-LMT-NBR)
                                   /* Until end of lines*/

    if (SY0UM041.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] != 
    SY0UW04.XXX-LN-SEL-IND[XXX-INX-FLD-NBR])

      SY0UW04.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] = SY0UM041.XXX-LN-SEL-IND[XXX-INX-FLD-NBR];

      SY0UW00.XXX-PAGE-UPD-FL = "Y"; /* Page update flag*/

    end

    SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-FLD-NBR + 1;
                                   /* Increment line index*/

  end

   /* ------------------------------------------------------------*/
   /* If a line was selected, format the key fields and indicate*/
   /* that map 042 is to be displayed.*/
   /* ------------------------------------------------------------*/

  if ("S" in SY0UW04.XXX-LN-SEL-IND) /* Line was selected*/

    SY0UW00.XXX-INX-FLD-NBR = sysVar.arrayIndex; /* Map line index*/

    SY0UW00.XXX-RQT-DATA-FL = "Y"; /* Request for data flag*/
    SY0UW00.XXX-MAP-DSP-CD = "D"; /* Product Chng.Map next display*/

    return; /* does this belong here ???????????*/

  end

   /* does the code below belong here ??????????*/
   /* ------------------------------------------------------------*/
   /* If all above finished, then advance one page.*/
   /* ------------------------------------------------------------*/
   /* HMACAL 12-03-1998 commented out*/
   /* SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-CURR-PAGE-NBR + 1;*/

end // end SY0U-4-15000

// Get TSQ Page # 4 Start'g Style
Function SY0U-4-15100()
   /* ------------------------------------------------------------------*/
   /* Modification History*/
   /* Date     Userid     Description*/
   /* ----------  ------  ----------------------------------------------*/
   /* 12-03-1998  HMACAL  Modified Search Style logic*/
   /* ------------------------------------------------------------------*/

   /* --------------------------------------------------------------*/
   /* Start reading TSQ at page 1 and continue reading until*/
   /* reach the page containing the Starting Style # entered on Map.*/
   /* NOTE - index value '14' needs to be max # lines on screen.*/
   /* --------------------------------------------------------------*/

  SY0UW00.XXX-CURR-PAGE-NBR = 1; /* Begin at page 1*/

  while (SY0UW00.XXX-CURR-PAGE-NBR <= SY0UW00.XXX-HI-PAGE-NBR)

    SY0US-TA0050-W04-R(); /* Read temporary storage queue page*/

   /* IF SY0UW04.SY-STY-NBR(14) GE SY0UM041.SY0UM-SY-STY-NBR;/*If beynd pt.*/
   /* EZERTN;                      /* Use current page*/
   /* END;*/

    SY0UW00.SY0UW-INX = 1;

    while (SY0UW00.SY0UW-INX <= 14)

      if (SY0UW04.SY-TRSL-COLR-NM[SY0UW-INX] == " ")
        if (SY0UM041.SY0UM-SY-STY-NBR == SY0UW04.SY-STY-NBR[SY0UW-INX])
          return;
        else
             /* continue search*/
        end
      else
        if (SY0UM041.SY0UM-SY-STY-NBR < SY0UW04.SY-STY-NBR[SY0UW-INX])
          return;
        else
             /* continue search*/
        end
      end

      SY0UW00.SY0UW-INX = SY0UW00.SY0UW-INX + 1;

    end

    SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-CURR-PAGE-NBR + 1; /* Try next pg*/

  end


  SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-HI-PAGE-NBR;
                                  /* Force to last page*/

end // end SY0U-4-15100

// Obtain data to display
Function SY0U-4-21000()
   /* ------------------------------------------------------------*/
   /* If data was not requested or an error was found, return to*/
   /* the previous process.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-RQT-DATA-FL == "Y") /* Data was requested*/

    if (converseVar.validationMsgNum == 0 /* and no error found*/
     || converseVar.validationMsgNum == 231) /* or message is 'next selection'*/
      /* next sentence*/
    else
      return; /* Return to previous process*/
    end

  else

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Set to show the map.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

   /* The request for data is not actually done here since*/
   /* data was moved in SY0U-4-11000 for Map 41 & 42 together.*/

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/


end // end SY0U-4-21000

// Format+Converse Color chng map
Function SY0U-4-22000()
   /* ------------------------------------------------------------*/
   /* If an error was found, save the error message number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    SY0UW00.XXX-MSG-NBR = converseVar.validationMsgNum; /* Message number*/
  end

   /* ------------------------------------------------------------*/
   /* If the map must be formatted, format the data in the map.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MAP-FMAT-FL == "Y") /* Map must be formatted*/
    SY0U-4-22100(); /* Format the data in the map*/
  end

   /* ------------------------------------------------------------*/
   /* Determine whether to protect any of the modifiable fields.*/
   /* ------------------------------------------------------------*/

  SY0U-4-22200(); /* Check change authorization*/

   /* ------------------------------------------------------------*/
   /* Format the current date and any FAST PATH information.*/
   /* ------------------------------------------------------------*/

  SY0UM042.XXX-CURR-DT = VGVar.currentShortGregorianDate; /* Current date*/

   /* ------------------------------------------------------------*/
   /* If a message to display, indicate sound audible alarm.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MSG-NBR != 0 /* Message to display*/
   || COMMAREA.CAMSG != " ")   /* or message text*/

    if (SY0UW00.XXX-MSG-NBR != 0) /* Message to display*/

      if (SY0UW00.XXX-MSG-NBR == 9999)
        converseLib.validationFailed();
      else
        converseLib.validationFailed(SY0UW00.XXX-MSG-NBR);
      end /* Message number*/
    else
      SY0UM042.VAGen_EZEMSG = COMMAREA.CAMSG; /* Message text*/

    end

    SY0UM042.XXX-MSG-LOC-ID = SY0UW00.XXX-MSG-LOC-ID;
                                   /* Message location*/

    set SY0UM042 alarm; /* Indicate sound alarm*/

  end

  converse SY0UM042 ;

   /* ------------------------------------------------------------*/
   /* Clear the message fields and save FAST PATH information.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-MSG-LOC-ID = " "; /* Message location*/
  SY0UW00.XXX-MSG-NBR = 0; /* Message number*/
  COMMAREA.CAMSG = " "; /* Message text*/

   /* ------------------------------------------------------------*/
   /* Reset modifiable field attributes to normal intensity.*/
   /* ------------------------------------------------------------*/

  set SY0UM042.SY-TRSL-COLR-NM normal; /* Translated Product Color*/
  set SY0UM042.SY-TRSL-SH-COLR-NM normal; /* Translated Product Color-short*/

   /* ------------------------------------------------------------*/
   /* If language not Japanese, convert lower to upper case.*/
   /* ------------------------------------------------------------*/

  if (SY0UM042.ZFL-LANG-CD != "JP") /* Language not Japanese*/
    SY0UW00.SY0UW-CNVT-NM-LEN = 30; /* set length*/
    SY0UW00.SY0UW-CNVT-NM = SY0UM042.SY-TRSL-COLR-NM;
    SY0US-CNVT-LOWER(); /* Convert lower to upper case*/
    SY0UM042.SY-TRSL-COLR-NM = SY0UW00.SY0UW-CNVT-NM;

    SY0UW00.SY0UW-CNVT-NM-LEN = 13; /* set length*/
    SY0UW00.SY0UW-CNVT-NM = SY0UM042.SY-TRSL-SH-COLR-NM;
    SY0US-CNVT-LOWER(); /* Convert lower to upper case*/
    SY0UM042.SY-TRSL-SH-COLR-NM = SY0UW00.SY0UW-CNVT-NM;
  end

   /* ------------------------------------------------------------*/
   /* Change the selection indicator to show the line was viewed.*/
   /* ------------------------------------------------------------*/

  SY0UW04.XXX-LN-SEL-IND[XXX-INX-FLD-NBR] = "V";
                                   /* Select indicator*/


end // end SY0U-4-22000

// Format the data to the map
Function SY0U-4-22100()
   /* ------------------------------------------------------------------*/
   /* Modification History*/
   /* Date     Userid     Description*/
   /* ----------  ------  ----------------------------------------------*/
   /* 11-19-1998  HMACAL  Qualified SQLCODE with SQLCA;*/
   /* ------------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* Clear the fields in the map storage area to be formatted.*/
   /* ------------------------------------------------------------*/

  set SY0UM042 initial; /* m042 input/output area*/

  SY0UW00.XXX-MAP-FMAT-FL = "N"; /* Format the map flag*/

   /* ------------------------------------------------------------*/
   /* Format the map fields from the display storage area.*/
   /* ------------------------------------------------------------*/

  SY0UM042.XCT-CTRY-CD = SY0UW01.XCT-CTRY-CD; /* Country Cd*/
  SY0UM042.XCT-CTRY-DESC = SY0UW01.XCT-CTRY-DESC; /* Country Desc*/
  SY0UM042.ZFL-LANG-CD = SY0UW01.ZFL-LANG-CD; /* LanguageCd*/
  SY0UM042.ZFL-LANG-DESC = SY0UW01.ZFL-LANG-DESC; /* LanguageDesc*/
  SY0UM042.XSE-SESN-CD = SY0UW01.XSE-SESN-CD; /* Season Code*/
  SY0UM042.XSE-SESN-DESC = SY0UW01.XSE-SESN-DESC; /* Season Desc*/
  SY0UM042.XSN-SESN-YR-RNG = SY0UW01.XSN-SESN-YR-RNG; /* Season Year*/
  SY0UM042.XGP-GPC-CD = SY0UW01.XGP-GPC-CD; /* G.P.C.*/
  SY0UM042.SY-STY-NBR = SY0UW04.SY-STY-NBR[XXX-INX-FLD-NBR]; /* Style*/
  SY0UM042.SY-COLR-CD-ID = SY0UW04.SY-COLR-CD-ID[XXX-INX-FLD-NBR]; /* Col*/
  SY0UM042.XDM-DIM-CD = SY0UW04.XDM-DIM-CD[XXX-INX-FLD-NBR]; /* Dimension*/
  SY0UM042.SY-TRSL-COLR-NM = SY0UW04.SY-TRSL-COLR-NM[XXX-INX-FLD-NBR]; /* Transl. Product Color*/
  SY0UM042.SY-STY-COLR-DESC = SY0UW04.SY-STY-COLR-DESC[XXX-INX-FLD-NBR]; /* USA Descrip.*/
  SY0UM042.SY-TRSL-SH-COLR-NM = SY0UW04.SY-TRSL-SH-COLR-NM[XXX-INX-FLD-NBR]; /* Transl.Product short name*/
  SY0UM042.SY-STY-COLR-ABRV = SY0UW04.SY-STY-COLR-ABRV[XXX-INX-FLD-NBR]; /* USA short name*/

   /* ------------------------------------------------------------*/
   /* Get Style Name*/
   /* ------------------------------------------------------------*/

  VSTYTSJ1.XCT-CTRY-CD = SY0UW01.XCT-CTRY-CD; /* Country Cd*/
  VSTYTSJ1.ZFL-LANG-CD = SY0UW01.ZFL-LANG-CD; /* Language*/
  VSTYTSJ1.XSE-SESN-CD = SY0UW01.XSE-SESN-CD; /* Season Code*/
  VSTYTSJ1.XSN-SESN-YR-RNG = SY0UW01.XSN-SESN-YR-RNG; /* Season Year*/
  VSTYTSJ1.XGP-GPC-CD = SY0UW01.XGP-GPC-CD;
  VSTYTSJ1.SY-STY-NBR = SY0UW04.SY-STY-NBR[XXX-INX-FLD-NBR];

  SY0US-VSTYTSJ1-SA(); /* Get Transl. Style Name*/

  SY0UM042.SY0UM-STY-TYP = " "; /* Blank type = transl.shown*/

  if (SQLCA.VAGen_SQLCODE == 0)
    SY0UM042.SY-TRSL-STY-NM = VSTYTSJ1.SY-TRSL-STY-NM; /* Transl.Style*/
  else

    SY1REC.XGPCD = SY0UW01.XGP-GPC-CD;
    SY1REC.SY1STNBR = SY0UW04.SY-STY-NBR[XXX-INX-FLD-NBR];

    SY0US-SY1REC-S(); /* Get USA Style Name*/

    if (SQLCA.VAGen_SQLCODE == 0)
      SY0UM042.SY-TRSL-STY-NM = SY1REC.SY1STYNM; /* USA Style Name*/
      SY0UM042.SY0UM-STY-TYP = "U.S.A.";
    else
      SY0UM042.SY-TRSL-STY-NM = " ";
    end
  end

   /* ------------------------------------------------------------*/
   /* Get Lab Color Data to display.*/
   /* ------------------------------------------------------------*/

  SY2REC.XGPCD = SY0UW01.XGP-GPC-CD; /* G.P.C.*/
  SY2REC.SY1STNBR = SY0UW04.SY-STY-NBR[XXX-INX-FLD-NBR]; /* Styl*/
  SY2REC.SY2CLRID = SY0UW04.SY-COLR-CD-ID[XXX-INX-FLD-NBR]; /* Col*/
  SY2REC.XDMCD = SY0UW04.XDM-DIM-CD[XXX-INX-FLD-NBR]; /* Dimension*/

  SY0US-SY2REC-S(); /* Get four lab color codes for product*/

  SY0UM042.XCL-COLR-CD[1] = SY2REC.XCLCD1; /* Move Lab Codes*/
  SY0UM042.XCL-COLR-CD[2] = SY2REC.XCLCD2;
  SY0UM042.XCL-COLR-CD[3] = SY2REC.XCLCD3;
  SY0UM042.XCL-COLR-CD[4] = SY2REC.XCLCD4;

  SY0U-4-22110(); /* Get lab color names for all 4 cds.*/


end // end SY0U-4-22100

// Move Transl or USA Lab Colors
Function SY0U-4-22110()
   /* ------------------------------------------------------------------*/
   /* Modification History*/
   /* Date     Userid     Description*/
   /* ----------  ------  ----------------------------------------------*/
   /* 11-19-1998  HMACAL  Qualified SQLCODE with SQLCA;*/
   /* ------------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* Move either translation or USA description of Lab Color to map.*/
   /* ------------------------------------------------------------*/

  SY0UW00.SY0UW-INX = 1;

  VLBCLR01.XCT-CTRY-CD = SY0UW01.XCT-CTRY-CD; /* Build transl.key*/
  VLBCLR01.ZFL-LANG-CD = SY0UW01.ZFL-LANG-CD;

  while (SY0UW-INX < 5)

    VLBCLR01.XCL-COLR-CD = SY0UM042.XCL-COLR-CD[SY0UW-INX];

    SY0US-VLBCLR01-S(); /* Find transl. for Lab Code*/

    if (SQLCA.VAGen_SQLCODE == 0)
      SY0UM042.XCL-COLR-DESC[SY0UW-INX] = VLBCLR01.XCL-COLR-DESC;
      SY0UM042.XCL-COLR-ABRV1[SY0UW-INX] = VLBCLR01.XCL-COLR-ABRV1;
      SY0UM042.XCL-COLR-ABRV2[SY0UW-INX] = VLBCLR01.XCL-COLR-ABRV2;
      SY0UM042.SY0UM-XCL-TYP[SY0UW-INX] = " ";
    else

      if (SY0UM042.XCL-COLR-CD[SY0UW-INX] in XCLTBL.XCLCD)
                                   /* Find USA descriptions.*/
        SY0UM042.XCL-COLR-DESC[SY0UW-INX] = XCLTBL.XCLDESC[sysVar.arrayIndex];
        SY0UM042.XCL-COLR-ABRV1[SY0UW-INX] = XCLTBL.XCLABRV1[sysVar.arrayIndex];
        SY0UM042.XCL-COLR-ABRV2[SY0UW-INX] = XCLTBL.XCLABRV2[sysVar.arrayIndex];

        SY0UM042.SY0UM-XCL-TYP[SY0UW-INX] = "U.S.A.";

      else
        SY0UM042.XCL-COLR-DESC[SY0UW-INX] = " "; /* No descrips.*/
        SY0UM042.XCL-COLR-ABRV1[SY0UW-INX] = " ";
        SY0UM042.XCL-COLR-ABRV2[SY0UW-INX] = " ";

        SY0UM042.SY0UM-XCL-TYP[SY0UW-INX] = " ";
      end

    end

    SY0UW-INX = SY0UW-INX + 1;

  end


end // end SY0U-4-22110

// Check change authorization
Function SY0U-4-22200()
   /* ------------------------------------------------------------*/
   /* If requested data was found and the user is authorized to*/
   /* change data on the screen, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-RQT-DATA-FL == "N" /* Requested data was found*/
   && SY0UW00.SY0UW-MAP-MODE == "M") /* and user authorized to change*/

    set SY0UM042.SY0UM-PF12 normal; /* Allow use of PF12 to edit data*/

    SY0UM042.SY0UM-TTL-NM = "MAINTENANCE";

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, protect the modifiable fields on the screen.*/
   /* ------------------------------------------------------------*/

  set SY0UM042.SY-TRSL-COLR-NM skip; /* Translated Product Color desc.*/
  set SY0UM042.SY-TRSL-SH-COLR-NM skip; /* Translated Product -short*/
  set SY0UM042.SY0UM-PF12 invisible, cursor; /* Prevent use of PF12 to edit data*/

  SY0UM042.SY0UM-TTL-NM = "INQUIRY";


end // end SY0U-4-22200

// Check attention identifier
Function SY0U-4-23000()
   /* ------------------------------------------------------------*/
   /* If CANCEL was requested, clear the map fields and exit.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pa2) /* PA2 was pressed*/

    if (SY0UW00.XXX-RQT-DATA-FL == "Y") /* Request for data pending*/
      converseLib.clearScreen();
       /* Clear screen before display*/
    end

    SY0UW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/
    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    COMMAREA.CATOAP = " "; /* TO application*/
    COMMAREA.CAITEM = " "; /* Application data*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* If a PF key transfer requested, exit to another application.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf3) /* PF3 was pressed*/

    SY0UW00.XXX-MAP-DSP-CD = "1"; /* Language Menu=next map shown*/
    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/
    SY0UW00.XXX-RQT-DATA-FL = "Y";

    SY0US-TA0050-W04-P(); /* Purge any temporary storage*/

    exit stack;

  end

  if (converseVar.eventKey is pf1) /* PF1 was pressed*/
    COMMAREA.CATOAP = "GD0G"; /* Goal documentation*/
  end

  if (converseVar.eventKey is pf4) /* PF4 was pressed*/
    COMMAREA.CATOAP = "MN0M"; /* Goal master menu*/
  end

  if (converseVar.eventKey is pf1
   || converseVar.eventKey is pf4)

    SY0US-TA0050-W04-P(); /* Purge any temporary storage*/

    XSSYS-EXIT(); /* Exit to another application*/

    SY0UW00.XXX-MAP-DSP-CD = "1"; /* Language Menu*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Determine whether a valid attention identifier was used to*/
   /* invoke the transaction.  Display an error message to the*/
   /* user if the PF key used is not supported.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey not enter /* ENTER was not pressed*/
   && converseVar.eventKey not pf12) /* and PF12 was not pressed*/

    SY0UW00.XXX-MSG-LOC-ID = "23000"; /* Message location*/
    converseLib.validationFailed(19); /* PA/PF key pressed is not valid*/

    if (converseVar.eventKey is pakey) /* PA key was pressed*/
      converseLib.clearScreen();
       /* Clear screen before display*/
    end

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* If user limited to inquiry, then PF12 'Build Color' is bad.*/
   /* ------------------------------------------------------------*/
  if (converseVar.eventKey is pf12 /* Prevent change during Inquiry*/
   && SY0UW00.SY0UW-MAP-MODE == "I") /**/
    SY0UW00.XXX-MSG-LOC-ID = "23000";
    converseLib.validationFailed(19); /* this option not available*/

    exit stack;
  end

end // end SY0U-4-23000

// Verify entered data
Function SY0U-4-24000()
   /* ------------------------------------------------------------*/
   /* If DEFAULT NAMES requested, auto.build Product Colors*/
   /* from four Lab Colors.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf12) /* PF12 was NOT pressed, skip this*/
  else
    return;
  end

  set WSY1580 empty;
  WSY1580.XGP-GPC-CD = SY0UM042.XGP-GPC-CD;

  sysVar.arrayIndex = 1;
  while (sysVar.arrayIndex < 5) /* Pass Lab Colors to sub-pgm.*/
    if (SY0UM042.XCL-COLR-CD[sysVar.arrayIndex] == "000") /* Skip 'not applicable'*/
      WSY1580.XCL-COLR-DESC[sysVar.arrayIndex] = " ";
      WSY1580.XCL-COLR-ABRV1[sysVar.arrayIndex] = " ";
      WSY1580.XCL-COLR-ABRV2[sysVar.arrayIndex] = " ";
    else
      WSY1580.XCL-COLR-DESC[sysVar.arrayIndex] = SY0UM042.XCL-COLR-DESC[sysVar.arrayIndex];
      WSY1580.XCL-COLR-ABRV1[sysVar.arrayIndex] = SY0UM042.XCL-COLR-ABRV1[sysVar.arrayIndex];
      WSY1580.XCL-COLR-ABRV2[sysVar.arrayIndex] = SY0UM042.XCL-COLR-ABRV2[sysVar.arrayIndex];
    end
    sysVar.arrayIndex = sysVar.arrayIndex + 1;
  end

    /* Long Color Name     ----------------------------------------*/
  WSY1580-OPT-CD = "NM"; /* Build full product color name*/
  SY0US-SY1580(); /* Build Color*/

  SY0UM042.SY-TRSL-COLR-NM = WSY1580.SY-TRSL-COLR-NM;

  WSY1580.SY-TRSL-COLR-NM = " "; /* Reset output data for next call*/

    /* Short Color Name    ----------------------------------------*/
  WSY1580-OPT-CD = "SH"; /* Build short product color name*/
  SY0US-SY1580(); /* Build Color*/

  SY0UM042.SY-TRSL-SH-COLR-NM = WSY1580.SY-TRSL-SH-COLR-NM;

  SY0UW00.XXX-MSG-LOC-ID = "24000"; /* Message location*/
  converseLib.validationFailed(229); /* New Color names from Lab Colors*/

  exit stack; /* Exit to display map*/


end // end SY0U-4-24000

// Process valid input request
Function SY0U-4-25000()
   /* ------------------------------------------------------------------*/
   /* Modification History*/
   /* Date     Userid     Description*/
   /* ----------  ------  ----------------------------------------------*/
   /* 11-19-1998  HMACAL  Qualified SQLCODE with SQLCA;*/
   /* ------------------------------------------------------------------*/

   /* ------------------------------------------------------------*/
   /* If no modifiable data changed, search for next selection.*/
   /* ------------------------------------------------------------*/

  if (SY0UM042.SY-TRSL-COLR-NM == SY0UW04.SY-TRSL-COLR-NM[XXX-INX-FLD-NBR]
   && SY0UM042.SY-TRSL-SH-COLR-NM == 
  SY0UW04.SY-TRSL-SH-COLR-NM[XXX-INX-FLD-NBR])

    SY0U-4-25100(); /* Search for next selection*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Obtain the current date and time.*/
   /* ------------------------------------------------------------*/

  XX0XS01(); /* Obtain date and time*/

   /* ------------------------------------------------------------*/
   /* Build key data to search for table row.*/
   /* ------------------------------------------------------------*/

  VPRDTS01.SY-PROD-ID = SY0UW04.SY-PROD-ID[XXX-INX-FLD-NBR]; /* Product*/
  VPRDTS01.XCT-CTRY-CD = SY0UW01.XCT-CTRY-CD; /* Country*/
  VPRDTS01.ZFL-LANG-CD = SY0UW01.ZFL-LANG-CD; /* Language*/

  SY0US-VPRDTS01-S(); /* Select row to check for existence*/

  VPRDTS01.SY-TRSL-COLR-NM = SY0UM042.SY-TRSL-COLR-NM; /* Trans. Product Color descrip.*/
  VPRDTS01.SY-TRSL-SH-COLR-NM = SY0UM042.SY-TRSL-SH-COLR-NM; /* Trans. Product Color short name*/

  SY0UW04.SY-TRSL-COLR-NM[XXX-INX-FLD-NBR] = SY0UM042.SY-TRSL-COLR-NM; /* Trans. Color descrip.*/
  SY0UW04.SY-TRSL-SH-COLR-NM[XXX-INX-FLD-NBR] = SY0UM042.SY-TRSL-SH-COLR-NM; /* Trans.short name*/

  SY0UW00.XXX-PAGE-UPD-FL = "Y";

  VPRDTS01.ZZ-CHNG-DT = XX0XW01.XX0XWDAT; /* Change date*/
  VPRDTS01.ZZ-CHNG-HHMM = XX0XW01.XX0XWTIM; /* Change time*/

  if (SQLCA.VAGen_SQLCODE == 0) /* If row already exists,*/
    SY0US-VPRDTS01-U(); /* Update the table row*/
  else
    VPRDTS01.ZZ-SDT = XX0XW01.XX0XWDAT; /* Setup date*/
    VPRDTS01.ZZ-CHNG-CNT = 0; /* Change count*/
    SY0US-VPRDTS01-A(); /* Else add a new row*/
  end

   /* ------------------------------------------------------------*/
   /* Commit all changes and refresh the data to be displayed.*/
   /* ------------------------------------------------------------*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.commit(); /* Commit all changes*/

  SY0UW00.XXX-MSG-LOC-ID = "25000"; /* Message location*/
  SY0UW00.XXX-MSG-NBR = 11; /* Table update was completed*/

   /* skip the 'rqt-data' since want to show message ??????*/
   /* MOVE 'Y' TO SY0UW00.XXX-RQT-DATA-FL;/* Request for data flag*/


end // end SY0U-4-25000

// Search for next selection/load
Function SY0U-4-25100()
   /* ------------------------------------------------------------*/
   /* Determine if another line was selected for viewing.*/
   /* ------------------------------------------------------------*/

  if ("S" in SY0UW04.XXX-LN-SEL-IND) /* Line was selected*/

    SY0UW00.XXX-INX-FLD-NBR = sysVar.arrayIndex; /* Map line index*/

    /* ???????  need to move xct,zfl,xse & xsn ??????*/
    /* probably not since fmt fl = 'y'*/
    SY0UM042.XGP-GPC-CD = SY0UW01.XGP-GPC-CD; /* G.P.C.*/
    SY0UM042.SY-STY-NBR = SY0UW04.SY-STY-NBR[XXX-INX-FLD-NBR]; /* Style*/
    SY0UM042.SY-COLR-CD-ID = SY0UW04.SY-COLR-CD-ID[XXX-INX-FLD-NBR]; /* Color Code*/
    SY0UM042.XDM-DIM-CD = SY0UW04.XDM-DIM-CD[XXX-INX-FLD-NBR]; /* Dimension*/

    SY2REC.XGPCD = SY0UW01.XGP-GPC-CD; /* G.P.C.*/
    SY2REC.SY1STNBR = SY0UW04.SY-STY-NBR[XXX-INX-FLD-NBR]; /* Style*/
    SY2REC.SY2CLRID = SY0UW04.SY-COLR-CD-ID[XXX-INX-FLD-NBR]; /* Col*/
    SY2REC.XDMCD = SY0UW04.XDM-DIM-CD[XXX-INX-FLD-NBR]; /* Dimension*/
    SY0US-SY2REC-S(); /* Get four lab color codes for product*/

    SY0UM042.XCL-COLR-CD[1] = SY2REC.XCLCD1; /* Move Lab Codes*/
    SY0UM042.XCL-COLR-CD[2] = SY2REC.XCLCD2;
    SY0UM042.XCL-COLR-CD[3] = SY2REC.XCLCD3;
    SY0UM042.XCL-COLR-CD[4] = SY2REC.XCLCD4;

    SY0U-4-22110(); /* Get lab color names for all 4 cds.*/

    SY0UM042.SY-TRSL-COLR-NM = SY0UW04.SY-TRSL-COLR-NM[XXX-INX-FLD-NBR]; /* Transl. Product Color*/
    SY0UM042.SY-STY-COLR-DESC = SY0UW04.SY-STY-COLR-DESC[XXX-INX-FLD-NBR]; /* USA Descrip.*/
    SY0UM042.SY-TRSL-SH-COLR-NM = SY0UW04.SY-TRSL-SH-COLR-NM[XXX-INX-FLD-NBR]; /* Transl.Product short name*/
    SY0UM042.SY-STY-COLR-ABRV = SY0UW04.SY-STY-COLR-ABRV[XXX-INX-FLD-NBR]; /* USA short name*/

    SY0UW00.XXX-RQT-DATA-FL = "Y"; /* Request for data flag*/

    SY0UW00.XXX-MSG-LOC-ID = "25100";
    converseLib.validationFailed(231); /* This is the next Selection*/

  else

    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/
    SY0UW00.XXX-MAP-DSP-CD = "4"; /* Product Color List = next map*/

  end


end // end SY0U-4-25100

// Obtain the data to display
Function SY0U-5-11000()
   /* ------------------------------------------------------------*/
   /* If data was not requested or an error was found, return to*/
   /* the previous process.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-RQT-DATA-FL != "Y" /* Data was not requested*/
   || converseVar.validationMsgNum != 0) /* or an error was found*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If no message to display, reset the page number to display.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MSG-NBR == 0) /* No message to display*/
    SY0UW00.XXX-CURR-PAGE-NBR = 1; /* Page number to display*/
  end

   /* ------------------------------------------------------------*/
   /* Purge any pages from temporary storage and save key fields.*/
   /* ------------------------------------------------------------*/

  SY0US-TA0050-W05-P(); /* Purge any temporary storage*/

  SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

  SY0UW05.SY-STY-NBR = SY0UM051.SY-STY-NBR; /* Style number*/

   /* ------------------------------------------------------------*/
   /* Select the information to display in the map heading.*/
   /* ------------------------------------------------------------*/
   /* First get U.S.A. Style Name for heading.*/
   /* ------------------------------------------------------------*/

  set SY1REC empty; /* Clear row storage area*/

  SY1REC.XGPCD = SY0UW01.XGP-GPC-CD; /* GPC*/
  SY1REC.SY1STNBR = SY0UW05.SY-STY-NBR; /* Style Nbr*/

  SY0US-SY1REC-S(); /* Select the table row*/

  if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/

    SY0UW05.SY-STY-NM = SY1REC.SY1STYNM; /* USA Name*/

  else
    SY0UW05.SY-STY-NM = "* NOT FOUND *"; /* Default name*/

    SY0UW00.XXX-MSG-LOC-ID = "11000"; /* Message location*/
    converseLib.validationFailed(218); /* No data found*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Select and open the cursor for the set to be formatted.*/
   /* ------------------------------------------------------------*/

  set VSTYTSJ1 empty; /* Clear row storage area*/


  VSTYTSJ1.XGP-GPC-CD = SY0UW01.XGP-GPC-CD; /* G.P.C.*/
  VSTYTSJ1.SY-STY-NBR = SY0UW05.SY-STY-NBR; /* Style Nbr*/

  SY0US-VSTYTSJ1-S2(); /* Select set and open cursor*/

   /* ------------------------------------------------------------*/
   /* Fetch and format the data into pages until end of cursor.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

  SY0UW00.SY0UW-STY-EOF-FL = "N"; /* End of cursor flag*/

  while (SY0UW00.SY0UW-STY-EOF-FL == "N") /* Until end of cursor*/

    SY0US-VSTYTSJ1-N2(); /* Fetch next row in cursor*/

    /* ------------------------------------------------------------*/
    /* If not end of cursor, save the data in display storage.*/
    /* ------------------------------------------------------------*/

    if (SY0UW00.SY0UW-STY-EOF-FL == "N") /* Not end of cursor*/

      /* ------------------------------------------------------------*/
      /* If first line on subsequent page, save heading information.*/
      /* ------------------------------------------------------------*/

      if (SY0UW00.XXX-HI-PAGE-NBR > 0 /* Not the first page*/
       && SY0UW00.XXX-INX-FLD-NBR == 1) /* and first line on page*/

        SY0UW05.SY-STY-NBR = SY0UM051.SY-STY-NBR; /* Style Nbr*/
        SY0UW05.SY-STY-ID = VSTYTSJ1.SY-STY-ID; /* Style ID*/
        /* note - style ID is the same for all rows fetched.*/
        SY0UW05.SY-STY-NM = SY0UM051.SY-STY-NM; /* Style Name*/

      end

      /* ------------------------------------------------------------*/
      /* Save the data from the table row into display storage.*/
      /* ------------------------------------------------------------*/

      SY0UW05.XCT-CTRY-CD[XXX-INX-FLD-NBR] = VSTYTSJ1.XCT-CTRY-CD;
                                   /* Country*/
      SY0UW05.ZFL-LANG-CD[XXX-INX-FLD-NBR] = VSTYTSJ1.ZFL-LANG-CD;
                                   /* Language*/
      SY0UW05.XSE-SESN-CD[XXX-INX-FLD-NBR] = VSTYTSJ1.XSE-SESN-CD;
                                   /* Season Code*/
      SY0UW05.XSN-SESN-YR-RNG[XXX-INX-FLD-NBR] = VSTYTSJ1.XSN-SESN-YR-RNG;
                                   /* Season Year*/
      SY0UW05.SY-TRSL-STY-NM[XXX-INX-FLD-NBR] = VSTYTSJ1.SY-TRSL-STY-NM;
                                   /* Style name - long*/
      SY0UW05.SY-TRSL-SH-STY-NM[XXX-INX-FLD-NBR] = VSTYTSJ1.SY-TRSL-SH-STY-NM;
                                   /* Style name - short*/

      /* ------------------------------------------------------------*/
      /* Get Abbreviations for Country and Language.*/
      /* ------------------------------------------------------------*/

      if (VSTYTSJ1.XCT-CTRY-CD in XCTTBL.XCTCD /* Code in table*/
       && XCTTBL.XXXSTAT[sysVar.arrayIndex] == "A") /* and active status*/

        SY0UW05.XCT-CTRY-ABRV[XXX-INX-FLD-NBR] = XCTTBL.XCTABRV[sysVar.arrayIndex];
      else
        SY0UW05.XCT-CTRY-ABRV[XXX-INX-FLD-NBR] = " ";
      end

      if (VSTYTSJ1.ZFL-LANG-CD in ZFLTBL.ZFLCD /* Code in table*/
       && ZFLTBL.XXXSTAT[sysVar.arrayIndex] == "A") /* and active status*/

        SY0UW05.ZFL-LANG-ABRV[XXX-INX-FLD-NBR] = ZFLTBL.ZFLABRV[sysVar.arrayIndex];
      else
        SY0UW05.ZFL-LANG-ABRV[XXX-INX-FLD-NBR] = " ";
      end

      /* ------------------------------------------------------------*/
      /* Increment the line index to the next row in display storage.*/
      /* ------------------------------------------------------------*/

      SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-FLD-NBR + 1;
                                   /* Increment line index*/

    end

    /* ------------------------------------------------------------*/
    /* If the page is full, add the page to the storage queue.*/
    /* ------------------------------------------------------------*/

    if (SY0UW00.XXX-INX-FLD-NBR > SY0UW00.XXX-INX-LMT-NBR) /* Page is full*/

      SY0US-TA0050-W05-A(); /* Add page to temporary storage*/

      SY0UW00.XXX-INX-FLD-NBR = 1; /* Display line index*/

    end

  end

   /* ------------------------------------------------------------*/
   /* Add any partially formatted last page to the queue.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-INX-FLD-NBR > 1) /* Page was formatted*/
    SY0US-TA0050-W05-A(); /* Add page to temporary storage*/
  end

   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set.*/
   /* ------------------------------------------------------------*/

  SY0US-VSTYTSJ1-C2(); /* Close selected set cursor*/

   /* ------------------------------------------------------------*/
   /* If no pages were formatted, indicate no data to display.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-HI-PAGE-NBR == 0) /* No pages formatted*/

    SY0UW00.XXX-MSG-LOC-ID = "11000"; /* Message location*/
    converseLib.validationFailed(218); /* No data was found to display*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that the request for data is complete.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/


end // end SY0U-5-11000

// Format+Converse Style List map
Function SY0U-5-12000()
   /* ------------------------------------------------------------*/
   /* If an error was found, save the error message number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    SY0UW00.XXX-MSG-NBR = converseVar.validationMsgNum; /* Message number*/
  end

   /* ------------------------------------------------------------*/
   /* If the map must be formatted, format the data in the map.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MAP-FMAT-FL == "Y") /* Map must be formatted*/
    SY0U-5-12100(); /* Format the data in the map*/
  end

   /* ------------------------------------------------------------*/
   /* Format the current date and any FAST PATH information.*/
   /* ------------------------------------------------------------*/

  SY0UM051.XXX-CURR-DT = VGVar.currentShortGregorianDate; /* Current date*/

   /* ------------------------------------------------------------*/
   /* If a message to display, indicate sound audible alarm.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-MSG-NBR != 0 /* Message to display*/
   || COMMAREA.CAMSG != " ")   /* or message text*/

    if (SY0UW00.XXX-MSG-NBR != 0) /* Message to display*/

      if (SY0UW00.XXX-MSG-NBR == 9999)
        converseLib.validationFailed();
      else
        converseLib.validationFailed(SY0UW00.XXX-MSG-NBR);
      end /* Message number*/
    else
      SY0UM051.VAGen_EZEMSG = COMMAREA.CAMSG; /* Message text*/

    end

    SY0UM051.XXX-MSG-LOC-ID = SY0UW00.XXX-MSG-LOC-ID;
                                   /* Message location*/

    set SY0UM051 alarm; /* Indicate sound alarm*/

  end

  converse SY0UM051 ;

   /* ------------------------------------------------------------*/
   /* Clear the message fields and save FAST PATH information.*/
   /* ------------------------------------------------------------*/

  SY0UW00.XXX-MSG-LOC-ID = " "; /* Message location*/
  SY0UW00.XXX-MSG-NBR = 0; /* Message number*/
  COMMAREA.CAMSG = " "; /* Message text*/

   /* ------------------------------------------------------------*/
   /* Reset modifiable field attributes to normal intensity.*/
   /* ------------------------------------------------------------*/

  set SY0UM051.SY-STY-NBR normal; /* Style number*/


end // end SY0U-5-12000

// Format the data into the map
Function SY0U-5-12100()
   /* ------------------------------------------------------------*/
   /* Clear the fields in the map storage area to be formatted.*/
   /* ------------------------------------------------------------*/

  set SY0UM051 initial; /* M001 input/output area*/

  SY0UW00.XXX-MAP-FMAT-FL = "N"; /* Format the map flag*/

   /* ------------------------------------------------------------*/
   /* If the page in storage is not the page to be displayed,*/
   /* obtain the desired page from temporary storage.*/
   /* ------------------------------------------------------------*/

  if (SY0UW00.XXX-HI-PAGE-NBR > 0) /* Pages were formatted*/

    if (SY0UW00.XXX-CURR-PAGE-NBR != TA5REC.TA5TSQIX)
                                   /* Desired page not current*/

      /* ------------------------------------------------------------*/
      /* If the current page has been changed, update the page in*/
      /* storage before obtaining the next one to display.*/
      /* ------------------------------------------------------------*/

      if (SY0UW00.XXX-PAGE-UPD-FL == "Y") /* Current page was changed*/

        SY0US-TA0050-W05-U(); /* Update temporary storage page*/

        SY0UW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

      end

      /* ------------------------------------------------------------*/
      /* If the desired page number is greater than the highest page*/
      /* in storage, default to the highest page number.*/
      /* ------------------------------------------------------------*/

      if (SY0UW00.XXX-CURR-PAGE-NBR > SY0UW00.XXX-HI-PAGE-NBR)
                                   /* Desired greater highest*/
        SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-HI-PAGE-NBR;
                                   /* Default to highest*/
      end

      SY0US-TA0050-W05-R(); /* Read temporary storage page*/

    end

    /* ------------------------------------------------------------*/
    /* Display the page information on the screen.*/
    /* ------------------------------------------------------------*/

    set SY0UM051.XXX-CURR-PAGE-DESC skip; /* "PAGE" literal*/
    SY0UM051.XXX-CURR-PAGE-NBR = SY0UW00.XXX-CURR-PAGE-NBR;
                                   /* Current page*/
    set SY0UM051.XXX-HI-PAGE-DESC skip; /* "OF" literal*/
    SY0UM051.XXX-HI-PAGE-NBR = SY0UW00.XXX-HI-PAGE-NBR;
                                   /* Highest page*/

  end

   /* ------------------------------------------------------------*/
   /* Format the map fields from the display storage area.*/
   /* ------------------------------------------------------------*/

  SY0UM051.XGP-GPC-CD = SY0UW01.XGP-GPC-CD; /* GPC code*/
  SY0UM051.XGP-GPC-DESC = SY0UW01.XGP-GPC-DESC; /* GPC Descrip*/
  SY0UM051.SY-STY-NBR = SY0UW05.SY-STY-NBR; /* Style #*/
  SY0UM051.SY-STY-NM = SY0UW05.SY-STY-NM; /* USA name*/
  SY0UM051.SY0UM-STY-TYP = "U.S.A."; /* 'USA'*/
                                   /* Style name*/

  SY0UW00.XXX-INX-FLD-NBR = 1; /* Initialize line index*/

  while (SY0UW00.XXX-INX-FLD-NBR <= SY0UW00.XXX-INX-LMT-NBR
   /* Until screen is full*/
   && SY0UW05.XCT-CTRY-CD[XXX-INX-FLD-NBR] > " ") /* or end of data*/

    SY0UM051.XCT-CTRY-ABRV[XXX-INX-FLD-NBR] = SY0UW05.XCT-CTRY-ABRV[XXX-INX-FLD-NBR]; /* Country*/
    SY0UM051.ZFL-LANG-ABRV[XXX-INX-FLD-NBR] = SY0UW05.ZFL-LANG-ABRV[XXX-INX-FLD-NBR]; /* Language*/
    SY0UM051.XSE-SESN-CD[XXX-INX-FLD-NBR] = SY0UW05.XSE-SESN-CD[XXX-INX-FLD-NBR]; /* Season Code*/
    SY0UM051.XSN-SESN-YR-RNG[XXX-INX-FLD-NBR] = SY0UW05.XSN-SESN-YR-RNG[XXX-INX-FLD-NBR]; /* Season Year*/
    SY0UM051.SY-TRSL-STY-NM[XXX-INX-FLD-NBR] = SY0UW05.SY-TRSL-STY-NM[XXX-INX-FLD-NBR]; /* Translation*/
    SY0UM051.SY-TRSL-SH-STY-NM[XXX-INX-FLD-NBR] = SY0UW05.SY-TRSL-SH-STY-NM[XXX-INX-FLD-NBR]; /* Short Translation*/

    SY0UW00.XXX-INX-FLD-NBR = SY0UW00.XXX-INX-FLD-NBR + 1;
                                   /* Increment line index*/

  end


end // end SY0U-5-12100

// Check attention identifier
Function SY0U-5-13000()
   /* ------------------------------------------------------------*/
   /* If CANCEL was requested, clear the map fields and exit.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pa2) /* PA2 was pressed*/

    if (SY0UW00.XXX-RQT-DATA-FL == "Y") /* Request for data pending*/
      set SY0UW05 empty; /* m051 display storage*/
    end

    SY0UW00.XXX-RQT-DATA-FL = "N"; /* Request for data flag*/
    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    COMMAREA.CATOAP = " "; /* TO application*/
    COMMAREA.CAITEM = " "; /* Application data*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* If a PF key transfer requested, exit to another application.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf3) /* PF3 was pressed*/
    SY0UW00.XXX-MAP-DSP-CD = "1"; /* Language menu*/
    SY0UW00.XXX-MAP-FMAT-FL = "Y";
    SY0UW00.XXX-RQT-DATA-FL = "Y";

    SY0US-TA0050-W05-P(); /* Purge any temporary storage*/

    exit stack;
  end

  if (converseVar.eventKey is pf1) /* PF1 was pressed*/
    COMMAREA.CATOAP = "GD0G"; /* Application find code*/
  end

  if (converseVar.eventKey is pf4) /* PF4 was pressed*/
    COMMAREA.CATOAP = "MN0M"; /* GOAL Menu*/
  end

  if (converseVar.eventKey is pf1
   || converseVar.eventKey is pf4)
    SY0US-TA0050-W05-P(); /* Purge any temporary storage*/

    XSSYS-EXIT(); /* Exit to another application*/

    SY0UW00.XXX-MAP-DSP-CD = "1"; /* Selection Menu*/

    exit stack; /* Exit to display map*/

  end

   /* ------------------------------------------------------------*/
   /* Determine whether a valid attention identifier was used to*/
   /* invoke the transaction.  Display an error message to the*/
   /* user if the PF key used is not supported.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey not enter /* ENTER was not pressed*/
   && converseVar.eventKey not pf7   /* and PF7 was not pressed*/
   && converseVar.eventKey not pf8)  /* and PF8 was not pressed*/

    SY0UW00.XXX-MSG-LOC-ID = "13000"; /* Message location*/
    converseLib.validationFailed(19); /* PA/PF key pressed is not valid*/

    if (converseVar.eventKey is pakey) /* PA key was pressed*/
      converseLib.clearScreen();
       /* Clear screen before display*/
    end

    exit stack; /* Exit to display map*/

  end


end // end SY0U-5-13000

// Verify entered data
Function SY0U-5-14000()
   /* ------------------------------------------------------------*/
   /* If scroll requested, determine if any other field changed.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf7 /* Scroll back request*/
   || converseVar.eventKey is pf8) /* or scroll forward request*/

    SY0U-5-14100(); /* Highlight other changed fields*/

    /* ------------------------------------------------------------*/
    /* Determine whether a valid request to scroll was entered.*/
    /* ------------------------------------------------------------*/

    SY0U-5-14200(); /* Verify scroll request*/

  else

    /* ------------------------------------------------------------*/
    /* If key field changed, determine if any other field changed.*/
    /* ------------------------------------------------------------*/

    if (SY0UM051.SY-STY-NBR != 
    SY0UW05.SY-STY-NBR) /* Style changed*/

      /* ------------------------------------------------------------*/
      /* Determine if all the required key fields were entered.*/
      /* ------------------------------------------------------------*/

      SY0U-5-14300(); /* Check for required key fields*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If any error was found, exit to display the map.*/
   /* ------------------------------------------------------------*/

  if (converseVar.validationMsgNum != 0) /* Error was found*/
    exit stack; /* Exit to display map*/
  end


end // end SY0U-5-14000

// Highlight other changed fields
Function SY0U-5-14100()
   /* ------------------------------------------------------------*/
   /* If a modifiable field was changed, indicate that field may*/
   /* not be changed when key is changed or a pf key is pressed.*/
   /* ------------------------------------------------------------*/

  if (SY0UW05.SY-STY-NBR != SY0UM051.SY-STY-NBR) /* Style Nbr changed*/

    SY0UW00.XXX-MSG-LOC-ID = "14100"; /* Message location*/
    converseLib.validationFailed(226); /* Field may not change*/
    set SY0UM051.SY-STY-NBR cursor, bold; /* Highlight*/

  end


end // end SY0U-5-14100

// Verify scroll request
Function SY0U-5-14200()
   /* ------------------------------------------------------------*/
   /* If scroll back was requested, ensure that pages exist.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf7 /* Scroll back request*/
   && SY0UW00.XXX-CURR-PAGE-NBR < 2) /* and no previous pages*/

    SY0UW00.XXX-MSG-LOC-ID = "14200"; /* Message location*/
    converseLib.validationFailed(69); /* No previous page to display*/

  end

   /* ------------------------------------------------------------*/
   /* If scroll forward was requested, ensure that pages exist.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf8 /* Scroll forward request*/
   && SY0UW00.XXX-CURR-PAGE-NBR >= SY0UW00.XXX-HI-PAGE-NBR)
                                   /* and no more pages*/

    SY0UW00.XXX-MSG-LOC-ID = "14200"; /* Message location*/
    converseLib.validationFailed(70); /* No more pages to display*/

  end


end // end SY0U-5-14200

// Check for required key fields
Function SY0U-5-14300()
   /* ------------------------------------------------------------*/
   /* Verify that a style number was entered.*/
   /* ------------------------------------------------------------*/

  if (SY0UM051.SY-STY-NBR <= " ") /* Style not entered*/

    SY0UW00.XXX-MSG-LOC-ID = "14300"; /* Message location*/
    converseLib.validationFailed(40); /* Field missing or invalid*/
    set SY0UM051.SY-STY-NBR cursor, bold; /* Highlight*/

  end


end // end SY0U-5-14300

// Process valid input request
Function SY0U-5-15000()
   /* ------------------------------------------------------------*/
   /* If the key fields changed, request the data to display.*/
   /* Save any work record fields that may have been modified.*/
   /* ------------------------------------------------------------*/

  if (SY0UM051.SY-STY-NBR != SY0UW05.SY-STY-NBR) /* Style changed*/

    SY0UW05.SY-STY-NBR = SY0UM051.SY-STY-NBR; /* Style #*/

    SY0UW00.XXX-RQT-DATA-FL = "Y"; /* Request for data flag*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If scroll backward was requested, decrement the page number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf7) /* Scroll back requested*/

    SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-CURR-PAGE-NBR - 1;
                                   /* Decrement page number*/

    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If scroll forward was requested, increment the page number.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf8) /* Scroll forward requested*/

    SY0UW00.XXX-CURR-PAGE-NBR = SY0UW00.XXX-CURR-PAGE-NBR + 1;
                                   /* Increment page number*/

    SY0UW00.XXX-MAP-FMAT-FL = "Y"; /* Format the map flag*/

    return; /* Return to previous process*/

  end


end // end SY0U-5-15000

// Convert Lower to Upper Case
Function SY0US-CNVT-LOWER()
   /* Convert Lower Case to Upper case*/
   /* NOTE: This routine will use SYWINDEX*/

  SY0UW00.SY0UW-LOWER-TBL = "abcdefghijklmnopqrstuvwxyz";
  SY0UW00.SY0UW-UPPER-TBL = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";

  SYWREC.SYWINDEX = 1;
  while (SYWREC.SYWINDEX <= SY0UW00.SY0UW-CNVT-NM-LEN)
    sysVar.arrayIndex = 1;
    if (SY0UW00.SY0UW-CNVT-CHAR[SYWINDEX]
     in SY0UW00.SY0UW-LOWER-CHAR)
      SY0UW00.SY0UW-CNVT-CHAR[SYWINDEX] = SY0UW00.SY0UW-UPPER-CHAR[sysVar.arrayIndex];
    end
    SYWREC.SYWINDEX = SYWREC.SYWINDEX + 1;
  end

end // end SY0US-CNVT-LOWER

// Check USA Style for Trademarks
Function SY0US-SY1460-CK()
   /* ------------------------------------------------------------*/
   /* Get Trademark Words in the USA Style Name*/
   /* ------------------------------------------------------------*/

  WSY1460.WSY1460-OPTION-CODE = "CK"; /* Check for Trdmk.*/

  call "SY1460" (WSY1460) {isNoRefresh = yes, isExternal = yes}; /* Check for Trmk Restrictions*/

  if (WSY1460.WSY1460-RETURN-CODE < 10) /* Good return*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = " "; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "SY1460CK"; /* Message location*/

  if (WSY1460-RETURN-CODE == 98) /* Resource not available, -911*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SY1460 CHECK"; /* Description*/
  TA1REC.TA1DBASE = "        "; /* Data base name*/
  TA1REC.TA1TBLVU = "TRDMK "; /* Table view name*/
      /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = SY0UW01.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = SY0UW01.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = SY0UW01.XSE-SESN-CD;
  SY0UW00.SY0UW-KEY-XSN-YR = SY0UW01.XSN-SESN-YR-RNG;
  SY0UW00.SY0UW-KEY-XGP-GPC = SY0UW01.XGP-GPC-CD;
  SY0UW00.SY0UW-KEY-STY-NBR = SY0UW02.SY-STY-NBR[XXX-INX-FLD-NBR];
  SY0UW00.SY0UW-KEY-STY-ID = SY0UW02.SY-STY-ID[XXX-INX-FLD-NBR];
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-SY1460-CK

// Default Prod.Colr from Lab Clr
Function SY0US-SY1580()
   /* ------------------------------------------------------------*/
   /* Call NIKEBOTH sub-program to Auto Build Product Color*/
   /* ------------------------------------------------------------*/

  call "SY1580" (WSY1580) {isNoRefresh = yes, isExternal = yes};

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (WSY1580-RETURN-CD == " ") /* Call successful*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = "SY0U"; /* CSP return code*/
   /* what about filling taerec ??????*/
   /* mov SQLCA.SQLCAREC TO TAEREC.SQLCAREC;/* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "SY1580  "; /* Message location*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  converseLib.clearScreen();
   /* Clear screen before display*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SY1580 BUILD COLOR"; /* Description*/
  TA1REC.TA1TBLKE = WSY1580-GROUP;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-SY1580

// Close Set Trsl+USA Styles
Function SY0US-SY1590-C2()
   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set of table rows.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "SY1590" ("C2", SQLCA, WSY1590) {isNoRefresh = yes, isExternal = yes};
  end /* Close cursor*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "SY1590-C"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SY1590-CLO 2 SET"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VSTYTS"; /* Table view name*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-SY1590-C2

// Close Set Trsl+USA Styles
Function SY0US-SY1590-CS()
   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set of table rows.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "SY1590" ("CS", SQLCA, WSY1590) {isNoRefresh = yes, isExternal = yes};
  end /* Close cursor*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "SY1590-C"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SY1590-CLOSE SET"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VSTYTS"; /* Table view name*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-SY1590-CS

// Select Next Trsl+USA Styles
Function SY0US-SY1590-N2()
   /* ------------------------------------------------------------*/
   /* Fetch the next row that was selected from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "SY1590" ("N2", SQLCA, WSY1590) {isNoRefresh = yes, isExternal = yes};
  end /* Fetch next row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/
      return; /* Return to previous process*/
    end

    /* ------------------------------------------------------------*/
    /* If end of the selected set, indicate end of cursor.*/
    /* ------------------------------------------------------------*/

    if (SQLCA.VAGen_SQLCODE == 100) /* End of selected set*/

      SY0UW00.SY0UW-STY-EOF-FL = "Y"; /* End of cursor*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "SY1590-N"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SY1590-FET 2 NEXT"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VSTYTS"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = WSY1590.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = WSY1590.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = WSY1590.XSE-SESN-CD;
  SY0UW00.SY0UW-KEY-XSN-YR = WSY1590.XSN-SESN-YR-RNG;
  SY0UW00.SY0UW-KEY-XDR-REG = WSY1590.XDR-PROD-REG-CD;
  SY0UW00.SY0UW-KEY-XGP-GPC = WSY1590.XGP-GPC-CD;
  SY0UW00.SY0UW-KEY-STY-NBR = WSY1590.SY-STY-NBR;
  SY0UW00.SY0UW-KEY-STY-ID = WSY1590.SY-STY-ID;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-SY1590-N2

// Select Set Trsl+USA Styles
Function SY0US-SY1590-S2()
   /* ------------------------------------------------------------*/
   /* Select the requested set of rows from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "SY1590" ("S2", SQLCA, WSY1590) {isNoRefresh = yes, isExternal = yes};
  end /* Select set*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "SY1590S2"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SY1590 SEL 2  SET"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VSTYTS"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = WSY1590.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = WSY1590.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = WSY1590.XSE-SESN-CD;
  SY0UW00.SY0UW-KEY-XSN-YR = WSY1590.XSN-SESN-YR-RNG;
  SY0UW00.SY0UW-KEY-XDR-REG = WSY1590.XDR-PROD-REG-CD;
  SY0UW00.SY0UW-KEY-XGP-GPC = WSY1590.XGP-GPC-CD;
  SY0UW00.SY0UW-KEY-STY-NBR = WSY1590.SY-STY-NBR;
  SY0UW00.SY0UW-KEY-STY-ID = WSY1590.SY-STY-ID;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-SY1590-S2

// Select Next Trsl+USA Styles
Function SY0US-SY1590-SN()
   /* ------------------------------------------------------------*/
   /* Fetch the next row that was selected from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "SY1590" ("SN", SQLCA, WSY1590) {isNoRefresh = yes, isExternal = yes};
  end /* Fetch next row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/
      return; /* Return to previous process*/
    end

    /* ------------------------------------------------------------*/
    /* If end of the selected set, indicate end of cursor.*/
    /* ------------------------------------------------------------*/

    if (SQLCA.VAGen_SQLCODE == 100) /* End of selected set*/

      SY0UW00.SY0UW-STY-EOF-FL = "Y"; /* End of cursor*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "SY1590-N"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SY1590-FETCH NEXT"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VSTYTS"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = WSY1590.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = WSY1590.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = WSY1590.XSE-SESN-CD;
  SY0UW00.SY0UW-KEY-XSN-YR = WSY1590.XSN-SESN-YR-RNG;
  SY0UW00.SY0UW-KEY-XGP-GPC = WSY1590.XGP-GPC-CD;
  SY0UW00.SY0UW-KEY-STY-NBR = WSY1590.SY-STY-NBR;
  SY0UW00.SY0UW-KEY-STY-ID = WSY1590.SY-STY-ID;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-SY1590-SN

// Select Set Trsl+USA Styles
Function SY0US-SY1590-SS()
   /* ------------------------------------------------------------*/
   /* Select the requested set of rows from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "SY1590" ("SS", SQLCA, WSY1590) {isNoRefresh = yes, isExternal = yes};
  end /* Select set*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "SY1590SS"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SY1590 SELECT SET"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VSTYTS"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = WSY1590.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = WSY1590.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = WSY1590.XSE-SESN-CD;
  SY0UW00.SY0UW-KEY-XSN-YR = WSY1590.XSN-SESN-YR-RNG;
  SY0UW00.SY0UW-KEY-XGP-GPC = WSY1590.XGP-GPC-CD;
  SY0UW00.SY0UW-KEY-STY-NBR = WSY1590.SY-STY-NBR;
  SY0UW00.SY0UW-KEY-STY-ID = WSY1590.SY-STY-ID;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-SY1590-SS

// Close Set trsl+USA Lab Colors
Function SY0US-SY1600-CS()
   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set of table rows.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "SY1600" ("CS", SQLCA, WSY1600) {isNoRefresh = yes, isExternal = yes};
  end /* Close cursor*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "SY1600-C"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "CLOSE SET "; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "SY1600"; /* Table view name*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-SY1600-CS

// Select Next trsl/USA Lab Color
Function SY0US-SY1600-SN()
   /* ------------------------------------------------------------*/
   /* Fetch the next row that was selected from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "SY1600" ("SN", SQLCA, WSY1600) {isNoRefresh = yes, isExternal = yes};
  end /* Fetch next row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/
      return; /* Return to previous process*/
    end

    /* ------------------------------------------------------------*/
    /* If end of the selected set, indicate end of cursor.*/
    /* ------------------------------------------------------------*/

    if (SQLCA.VAGen_SQLCODE == 100) /* End of selected set*/

      SY0UW00.SY0UW-STY-EOF-FL = "Y"; /* End of cursor*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "SY1600-N"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "FETCH NEXT ROW"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "SY1600"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = WSY1600.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = WSY1600.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-STY-NBR = " ";
  SY0UW00.SY0UW-KEY-XSE-SESN = " ";
  SY0UW00.SY0UW-KEY-XSN-YR = 0;
  SY0UW00.SY0UW-KEY-XGP-GPC = " ";
  SY0UW00.SY0UW-KEY-STY-NBR = " ";
  SY0UW00.SY0UW-KEY-STY-ID = 0;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-SY1600-SN

// Select Set trsl+USA Lab Colors
Function SY0US-SY1600-SS()
   /* ------------------------------------------------------------*/
   /* Select the requested set of rows from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "SY1600" ("SS", SQLCA, WSY1600) {isNoRefresh = yes, isExternal = yes};
  end /* Select set*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "SY1600-S"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "LAB COLOR SELECT SET"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "SY1600"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = WSY1600.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = WSY1600.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-STY-NBR = " ";
  SY0UW00.SY0UW-KEY-XSE-SESN = " ";
  SY0UW00.SY0UW-KEY-XSN-YR = 0;
  SY0UW00.SY0UW-KEY-XGP-GPC = " ";
  SY0UW00.SY0UW-KEY-STY-NBR = " ";
  SY0UW00.SY0UW-KEY-STY-ID = 0;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-SY1600-SS

// Close Set trsl & USA Products
Function SY0US-SY1610-C2()
   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set of table rows.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "SY1610" ("C2", SQLCA, WSY1610) {isNoRefresh = yes, isExternal = yes};
  end /* Close cursor*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "SY1610-C"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "CLOSE SET CURS 2"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "SY1610"; /* Table view name*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-SY1610-C2

// Close Set trsl & USA Products
Function SY0US-SY1610-CS()
   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set of table rows.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "SY1610" ("CS", SQLCA, WSY1610) {isNoRefresh = yes, isExternal = yes};
  end /* Close cursor*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "SY1610-C"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "CLOSE SET CURSOR"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "SY1610"; /* Table view name*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-SY1610-CS

// Fetch Next trsl & USA Product
Function SY0US-SY1610-N2()
   /* ------------------------------------------------------------*/
   /* Fetch the next row that was selected from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "SY1610" ("N2", SQLCA, WSY1610) {isNoRefresh = yes, isExternal = yes};
  end /* Fetch next row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/
      return; /* Return to previous process*/
    end

    /* ------------------------------------------------------------*/
    /* If end of the selected set, indicate end of cursor.*/
    /* ------------------------------------------------------------*/

    if (SQLCA.VAGen_SQLCODE == 100) /* End of selected set*/

      SY0UW00.SY0UW-STY-EOF-FL = "Y"; /* End of cursor*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "SY1610-N"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "FET 2 NEXT ROW"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "SY1610"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = WSY1610.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = WSY1610.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = " ";
  SY0UW00.SY0UW-KEY-XSN-YR = 0;
  SY0UW00.SY0UW-KEY-XGP-GPC = WSY1610.XGP-GPC-CD;
  SY0UW00.SY0UW-KEY-STY-NBR = " ";
  SY0UW00.SY0UW-KEY-STY-ID = 0;
  SY0UW00.SY0UW-KEY-XDR-REG = WSY1610.XDR-PROD-REG-CD;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-SY1610-N2

// Select Set trsl & USA Products
Function SY0US-SY1610-S2()
   /* ------------------------------------------------------------*/
   /* Select the requested set of rows from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "SY1610" ("S2", SQLCA, WSY1610) {isNoRefresh = yes, isExternal = yes};
  end /* Select set*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "SY1610-S"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SELECT SET & OPEN CURS 2"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "SY1610"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = WSY1610.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = WSY1610.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = " ";
  SY0UW00.SY0UW-KEY-XSN-YR = 0;
  SY0UW00.SY0UW-KEY-XGP-GPC = WSY1610.XGP-GPC-CD;
  SY0UW00.SY0UW-KEY-STY-NBR = " ";
  SY0UW00.SY0UW-KEY-STY-ID = 0;
  SY0UW00.SY0UW-KEY-XDR-REG = WSY1610.XDR-PROD-REG-CD;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-SY1610-S2

// Fetch Next trsl & USA Product
Function SY0US-SY1610-SN()
   /* ------------------------------------------------------------*/
   /* Fetch the next row that was selected from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "SY1610" ("SN", SQLCA, WSY1610) {isNoRefresh = yes, isExternal = yes};
  end /* Fetch next row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/
      return; /* Return to previous process*/
    end

    /* ------------------------------------------------------------*/
    /* If end of the selected set, indicate end of cursor.*/
    /* ------------------------------------------------------------*/

    if (SQLCA.VAGen_SQLCODE == 100) /* End of selected set*/

      SY0UW00.SY0UW-STY-EOF-FL = "Y"; /* End of cursor*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "SY1610-N"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "FETCH NEXT ROW"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "SY1610"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = WSY1610.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = WSY1610.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = " ";
  SY0UW00.SY0UW-KEY-XSN-YR = 0;
  SY0UW00.SY0UW-KEY-XGP-GPC = WSY1610.XGP-GPC-CD;
  SY0UW00.SY0UW-KEY-STY-NBR = " ";
  SY0UW00.SY0UW-KEY-STY-ID = 0;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-SY1610-SN

// Select Set trsl & USA Products
Function SY0US-SY1610-SS()
   /* ------------------------------------------------------------*/
   /* Select the requested set of rows from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "SY1610" ("SS", SQLCA, WSY1610) {isNoRefresh = yes, isExternal = yes};
  end /* Select set*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "SY1610-S"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SELECT SET & OPEN CURSOR"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "SY1610"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = WSY1610.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = WSY1610.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = " ";
  SY0UW00.SY0UW-KEY-XSN-YR = 0;
  SY0UW00.SY0UW-KEY-XGP-GPC = WSY1610.XGP-GPC-CD;
  SY0UW00.SY0UW-KEY-STY-NBR = " ";
  SY0UW00.SY0UW-KEY-STY-ID = 0;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-SY1610-SS

// Select USA Style unique row
Function SY0US-SY1REC-S()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "IO0120" ("S ", SQLCA, SY1REC) {isNoRefresh = yes, isExternal = yes};
  end /* Select one*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (SQLCA.VAGen_SQLCODE == 0 /* and normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or not-found return code*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "SY1REC-S"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SELECT UNIQUE"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VSTYLE01"; /* Table view name*/
  TA1REC.TA1TBLKE = SY1REC.SY1KEY; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-SY1REC-S

// Select VCOLOR-get 4 Lab Codes
Function SY0US-SY2REC-S()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "IO0130" ("S ", SQLCA, SY2REC) {isNoRefresh = yes, isExternal = yes};
  end /* Select one*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (SQLCA.VAGen_SQLCODE == 0 /* and normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or not-found return code*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "SY2REC-S"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SELECT UNIQUE"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "SY2REC"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = SY0UW01.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = SY0UW01.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = " ";
  SY0UW00.SY0UW-KEY-XGP-GPC = SY2REC.XGPCD;
  SY0UW00.SY0UW-KEY-STY-NBR = SY2REC.SY1STNBR;
  SY0UW00.SY0UW-KEY-XSN-YR = 0;
  SY0UW00.SY0UW-KEY-STY-ID = 0;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-SY2REC-S

// Add page to temporary storage
Function SY0US-TA0050-W02-A()
   /* ------------------------------------------------------------*/
   /* Add the next page to the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  SY0UW02.XXX-TEMP-STG-LNTH = SY0UW00.SY0UW-SY0UW02-LNTH;
                                   /* Temporary storage length*/

  TA5REC.TA5APPID = COMMAREA.CACURRAP; /* Application identification*/

  TA5REC.TA5FNCCD = "A"; /* Function code*/

  try
    call "TA0050" (SY0UW02, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Add page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, initialize the storage area and*/
   /* indicators to be used and return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA5REC.TA5RTNCD == 0)          /* and normal return code*/

    sysVar.arrayIndex = 1; /* Clear stored line data for Map 021*/
    while (sysVar.arrayIndex <= SY0UW00.XXX-INX-LMT-NBR)
      SY0UW02.SY-STY-NBR[sysVar.arrayIndex] = " ";
      SY0UW02.SY-STY-ID[sysVar.arrayIndex] = 0;
      SY0UW02.SY-TRSL-STY-NM[sysVar.arrayIndex] = " ";
      SY0UW02.SY-STY-NM[sysVar.arrayIndex] = " ";
      SY0UW02.SY-TRSL-SH-STY-NM[sysVar.arrayIndex] = " ";
      SY0UW02.SY-SHORT-STY-NM[sysVar.arrayIndex] = " ";
      sysVar.arrayIndex = sysVar.arrayIndex + 1;
    end

    SY0UW00.XXX-HI-PAGE-NBR = TA5REC.TA5TSQIX; /* Highest page number*/

    TA5REC.TA5TSQIX = 0; /* Clear last page number*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  SY0UW00.XXX-MSG-LOC-ID = "TS-W02-A"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "ADD W02 PAGE TO TEMP.STORAGE "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-TA0050-W02-A

// Purge any temporary storage
Function SY0US-TA0050-W02-P()
   /* ------------------------------------------------------------*/
   /* Initialize the storage areas and indicators to be used.*/
   /* ------------------------------------------------------------*/

  set SY0UW02 empty; /* M021 display storage*/

  SY0UW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

  TA5REC.TA5TSQIX = 0; /* Displayed page number*/
  SY0UW00.XXX-HI-PAGE-NBR = 0; /* Highest page number*/

   /* ------------------------------------------------------------*/
   /* Purge any temporary storage for this application.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5APPID = COMMAREA.CACURRAP; /* Application identification*/

  TA5REC.TA5FNCCD = "P"; /* Function code*/

  try
    call "TA0050" (SY0UW02, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Purge storage*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA5REC.TA5RTNCD == 0)          /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  SY0UW00.XXX-MSG-LOC-ID = "TA0050-P"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "PURGE ANY TEMPORARY STORAGE"; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-TA0050-W02-P

// Read page in temp.storage
Function SY0US-TA0050-W02-R()
   /* ------------------------------------------------------------*/
   /* Read the next page from the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  SY0UW02.XXX-TEMP-STG-LNTH = SY0UW00.SY0UW-SY0UW02-LNTH;
                                   /* Temporary storage length*/

  TA5REC.TA5APPID = COMMAREA.CACURRAP; /* Application identification*/
  TA5REC.TA5TSQIX = SY0UW00.XXX-CURR-PAGE-NBR; /* Page number*/

  TA5REC.TA5FNCCD = "R"; /* Function code*/

  try
    call "TA0050" (SY0UW02, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Read page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA5REC.TA5RTNCD == 0)          /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  SY0UW00.XXX-MSG-LOC-ID = "TS-W02-R"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "READ TEMP.STORAGE W02 PAGE"; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-TA0050-W02-R

// Update page in temp.storage
Function SY0US-TA0050-W02-U()
   /* ------------------------------------------------------------*/
   /* Update the page in the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5FNCCD = "U"; /* Function code*/

  try
    call "TA0050" (SY0UW02, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Update page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA5REC.TA5RTNCD == 0)          /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  SY0UW00.XXX-MSG-LOC-ID = "TS-W02U"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "UPDATE TEMP.STORAGE W02 PAGE"; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-TA0050-W02-U

// Add page to temporary storage
Function SY0US-TA0050-W03-A()
   /* ------------------------------------------------------------*/
   /* Add the next page to the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  SY0UW03.XXX-TEMP-STG-LNTH = SY0UW00.SY0UW-SY0UW03-LNTH;
                                   /* Temporary storage length*/

  TA5REC.TA5APPID = COMMAREA.CACURRAP; /* Application identification*/

  TA5REC.TA5FNCCD = "A"; /* Function code*/

  try
    call "TA0050" (SY0UW03, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Add page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, initialize the storage area and*/
   /* indicators to be used and return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA5REC.TA5RTNCD == 0)          /* and normal return code*/

    sysVar.arrayIndex = 1; /* Clear stored line data for Map 031*/
    while (sysVar.arrayIndex <= SY0UW00.XXX-INX-LMT-NBR)
      SY0UW03.XCL-COLR-CD[sysVar.arrayIndex] = " ";
      SY0UW03.XCL-COLR-DESC[sysVar.arrayIndex] = " ";
      SY0UW03.XCL-COLR-ABRV1[sysVar.arrayIndex] = " ";
      SY0UW03.XCL-COLR-ABRV2[sysVar.arrayIndex] = " ";
   /* ???? also USA values*/
      sysVar.arrayIndex = sysVar.arrayIndex + 1;
    end

    SY0UW00.XXX-HI-PAGE-NBR = TA5REC.TA5TSQIX; /* Highest page number*/

    TA5REC.TA5TSQIX = 0; /* Clear last page number*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  SY0UW00.XXX-MSG-LOC-ID = "TS-W03-A"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "ADD W03 PAGE TO TEMP.STORAGE "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-TA0050-W03-A

// Purge any temporary storage
Function SY0US-TA0050-W03-P()
   /* ------------------------------------------------------------*/
   /* Initialize the storage areas and indicators to be used.*/
   /* ------------------------------------------------------------*/

  set SY0UW03 empty; /* M021 display storage*/

  SY0UW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

  TA5REC.TA5TSQIX = 0; /* Displayed page number*/
  SY0UW00.XXX-HI-PAGE-NBR = 0; /* Highest page number*/

   /* ------------------------------------------------------------*/
   /* Purge any temporary storage for this application.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5APPID = COMMAREA.CACURRAP; /* Application identification*/

  TA5REC.TA5FNCCD = "P"; /* Function code*/

  try
    call "TA0050" (SY0UW03, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Purge storage*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA5REC.TA5RTNCD == 0)          /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  SY0UW00.XXX-MSG-LOC-ID = "TA0050-P"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "PURGE ANY TEMPORARY STORAGE"; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-TA0050-W03-P

// Read page in temp.storage
Function SY0US-TA0050-W03-R()
   /* ------------------------------------------------------------*/
   /* Read the next page from the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  SY0UW03.XXX-TEMP-STG-LNTH = SY0UW00.SY0UW-SY0UW03-LNTH;
                                   /* Temporary storage length*/

  TA5REC.TA5APPID = COMMAREA.CACURRAP; /* Application identification*/
  TA5REC.TA5TSQIX = SY0UW00.XXX-CURR-PAGE-NBR; /* Page number*/

  TA5REC.TA5FNCCD = "R"; /* Function code*/

  try
    call "TA0050" (SY0UW03, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Read page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA5REC.TA5RTNCD == 0)          /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  SY0UW00.XXX-MSG-LOC-ID = "TS-W03-R"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "READ TEMP.STORAGE W03 PAGE"; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-TA0050-W03-R

// Update page in temp.storage
Function SY0US-TA0050-W03-U()
   /* ------------------------------------------------------------*/
   /* Update the page in the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5FNCCD = "U"; /* Function code*/

  try
    call "TA0050" (SY0UW03, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Update page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA5REC.TA5RTNCD == 0)          /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  SY0UW00.XXX-MSG-LOC-ID = "TS-W03U"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "UPDATE TEMP.STORAGE W03 PAGE"; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-TA0050-W03-U

// Add Temp Storage for Prods
Function SY0US-TA0050-W04-A()
   /* ------------------------------------------------------------*/
   /* Add the next page to the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  SY0UW04.XXX-TEMP-STG-LNTH = SY0UW00.SY0UW-SY0UW04-LNTH;
                                   /* Temporary storage length*/

  TA5REC.TA5APPID = COMMAREA.CACURRAP; /* Application identification*/

  TA5REC.TA5FNCCD = "A"; /* Function code*/

  try
    call "TA0050" (SY0UW04, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Add page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, initialize the storage area and*/
   /* indicators to be used and return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA5REC.TA5RTNCD == 0)          /* and normal return code*/

    sysVar.arrayIndex = 1; /* Clear stored line data for Map 041*/
    while (sysVar.arrayIndex <= SY0UW00.XXX-INX-LMT-NBR)
      SY0UW04.SY-STY-NBR[sysVar.arrayIndex] = " ";
      SY0UW04.SY-COLR-CD-ID[sysVar.arrayIndex] = " ";
      SY0UW04.XDM-DIM-CD[sysVar.arrayIndex] = " ";
      SY0UW04.SY-PROD-ID[sysVar.arrayIndex] = 0;
      SY0UW04.SY-TRSL-COLR-NM[sysVar.arrayIndex] = " ";
      SY0UW04.SY-STY-COLR-DESC[sysVar.arrayIndex] = " ";
      SY0UW04.SY-TRSL-SH-COLR-NM[sysVar.arrayIndex] = " ";
      SY0UW04.SY-STY-COLR-ABRV[sysVar.arrayIndex] = " ";
      sysVar.arrayIndex = sysVar.arrayIndex + 1;
    end

    SY0UW00.XXX-HI-PAGE-NBR = TA5REC.TA5TSQIX; /* Highest page number*/

    TA5REC.TA5TSQIX = 0; /* Clear last page number*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  SY0UW00.XXX-MSG-LOC-ID = "TS-W04-A"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "ADD W04 PAGE TO TEMP.STORAGE "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-TA0050-W04-A

// Purge Temp Storage for Prods.
Function SY0US-TA0050-W04-P()
   /* ------------------------------------------------------------*/
   /* Initialize the storage areas and indicators to be used.*/
   /* ------------------------------------------------------------*/

  set SY0UW04 empty; /* M021 display storage*/

  SY0UW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

  TA5REC.TA5TSQIX = 0; /* Displayed page number*/
  SY0UW00.XXX-HI-PAGE-NBR = 0; /* Highest page number*/

   /* ------------------------------------------------------------*/
   /* Purge any temporary storage for this application.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5APPID = COMMAREA.CACURRAP; /* Application identification*/

  TA5REC.TA5FNCCD = "P"; /* Function code*/

  try
    call "TA0050" (SY0UW04, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Purge storage*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA5REC.TA5RTNCD == 0)          /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  SY0UW00.XXX-MSG-LOC-ID = "TA0050-P"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "PURGE ANY TEMPORARY STORAGE"; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-TA0050-W04-P

// Read Temp Storage.Products
Function SY0US-TA0050-W04-R()
   /* ------------------------------------------------------------*/
   /* Read the next page from the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  SY0UW04.XXX-TEMP-STG-LNTH = SY0UW00.SY0UW-SY0UW04-LNTH;
                                   /* Temporary storage length*/

  TA5REC.TA5APPID = COMMAREA.CACURRAP; /* Application identification*/
  TA5REC.TA5TSQIX = SY0UW00.XXX-CURR-PAGE-NBR; /* Page number*/

  TA5REC.TA5FNCCD = "R"; /* Function code*/

  try
    call "TA0050" (SY0UW04, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Read page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA5REC.TA5RTNCD == 0)          /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  SY0UW00.XXX-MSG-LOC-ID = "TS-W04-R"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "READ TEMP.STORAGE W04 PAGE"; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-TA0050-W04-R

// Update Temp Storg.Products
Function SY0US-TA0050-W04-U()
   /* ------------------------------------------------------------*/
   /* Update the page in the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5FNCCD = "U"; /* Function code*/

  try
    call "TA0050" (SY0UW04, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Update page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA5REC.TA5RTNCD == 0)          /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  SY0UW00.XXX-MSG-LOC-ID = "TS-W04U"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "UPDATE TEMP.STORAGE W04 PAGE"; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-TA0050-W04-U

// Add temp.storage for Styles
Function SY0US-TA0050-W05-A()
   /* ------------------------------------------------------------*/
   /* Add the next page to the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  SY0UW05.XXX-TEMP-STG-LNTH = SY0UW00.SY0UW-SY0UW05-LNTH;
                                   /* Temporary storage length*/

  TA5REC.TA5APPID = COMMAREA.CACURRAP; /* Application identification*/

  TA5REC.TA5FNCCD = "A"; /* Function code*/

  try
    call "TA0050" (SY0UW05, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Add page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, initialize the storage area and*/
   /* indicators to be used and return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA5REC.TA5RTNCD == 0)          /* and normal return code*/

    sysVar.arrayIndex = 1; /* Clear stored line data for Map 051*/
    while (sysVar.arrayIndex <= SY0UW00.XXX-INX-LMT-NBR)
      SY0UW05.XCT-CTRY-CD[sysVar.arrayIndex] = " ";
      SY0UW05.ZFL-LANG-CD[sysVar.arrayIndex] = " ";
      SY0UW05.XSE-SESN-CD[sysVar.arrayIndex] = " ";
      SY0UW05.XSN-SESN-YR-RNG[sysVar.arrayIndex] = 0;
      SY0UW05.SY-TRSL-STY-NM[sysVar.arrayIndex] = " ";
      SY0UW05.SY-TRSL-SH-STY-NM[sysVar.arrayIndex] = " ";
      sysVar.arrayIndex = sysVar.arrayIndex + 1;
    end

    SY0UW00.XXX-HI-PAGE-NBR = TA5REC.TA5TSQIX; /* Highest page number*/

    TA5REC.TA5TSQIX = 0; /* Clear last page number*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  SY0UW00.XXX-MSG-LOC-ID = "TS-W05-A"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "ADD W05 PAGE TO TEMP.STORAGE "; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-TA0050-W05-A

// Purge temp.storage for Styles
Function SY0US-TA0050-W05-P()
   /* ------------------------------------------------------------*/
   /* Initialize the storage areas and indicators to be used.*/
   /* ------------------------------------------------------------*/

  set SY0UW05 empty; /* M051 display storage*/

  SY0UW00.XXX-PAGE-UPD-FL = "N"; /* Page update flag*/

  TA5REC.TA5TSQIX = 0; /* Displayed page number*/
  SY0UW00.XXX-HI-PAGE-NBR = 0; /* Highest page number*/

   /* ------------------------------------------------------------*/
   /* Purge any temporary storage for this application.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5APPID = COMMAREA.CACURRAP; /* Application identification*/

  TA5REC.TA5FNCCD = "P"; /* Function code*/

  try
    call "TA0050" (SY0UW05, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Purge storage*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA5REC.TA5RTNCD == 0)          /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  SY0UW00.XXX-MSG-LOC-ID = "TA0050-P"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "PURGE ANY TEMPORARY STORAGE"; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-TA0050-W05-P

// Read temp.storage for Styles
Function SY0US-TA0050-W05-R()
   /* ------------------------------------------------------------*/
   /* Read the next page from the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  SY0UW05.XXX-TEMP-STG-LNTH = SY0UW00.SY0UW-SY0UW05-LNTH;
                                   /* Temporary storage length*/

  TA5REC.TA5APPID = COMMAREA.CACURRAP; /* Application identification*/
  TA5REC.TA5TSQIX = SY0UW00.XXX-CURR-PAGE-NBR; /* Page number*/

  TA5REC.TA5FNCCD = "R"; /* Function code*/

  try
    call "TA0050" (SY0UW05, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Read page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA5REC.TA5RTNCD == 0)          /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  SY0UW00.XXX-MSG-LOC-ID = "TS-W05-R"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "READ TEMP.STORAGE W05 PAGE"; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-TA0050-W05-R

// Update temp.storg.for Styles
Function SY0US-TA0050-W05-U()
   /* ------------------------------------------------------------*/
   /* Update the page in the temporary storage queue.*/
   /* ------------------------------------------------------------*/

  TA5REC.TA5FNCCD = "U"; /* Function code*/

  try
    call "TA0050" (SY0UW05, TA5REC) {isNoRefresh = yes, isExternal = yes};
  end /* Update page*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && TA5REC.TA5RTNCD == 0)          /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.TAEDESC1 = TA5REC.TA5DATA; /* Subroutine parameters*/

  SY0UW00.XXX-MSG-LOC-ID = "TS-W05U"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "APPL"; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "UPDATE TEMP.STORAGE W05 PAGE"; /* Description*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-TA0050-W05-U

// Add Trsl.Lab Color row
Function SY0US-VLBCLR01-A()
   /* ------------------------------------------------------------*/
   /* ADD the requested row to the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "VLBCLR01" ("A ", SQLCA, VLBCLR01) {isNoRefresh = yes, isExternal = yes};
  end /* Add*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If ADD did not work, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "VLBCLR-A"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "ADD          "; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VLBCLR01"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = VLBCLR01.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = VLBCLR01.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = " ";
  SY0UW00.SY0UW-KEY-XSN-YR = 0;
  SY0UW00.SY0UW-KEY-XGP-GPC = " ";
  SY0UW00.SY0UW-KEY-STY-NBR = " ";
  SY0UW00.SY0UW-KEY-STY-ID = 0;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-VLBCLR01-A

// Select Trsl.Lab Color by code
Function SY0US-VLBCLR01-S()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "VLBCLR01" ("S ", SQLCA, VLBCLR01) {isNoRefresh = yes, isExternal = yes};
  end /* Select one*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (SQLCA.VAGen_SQLCODE == 0 /* and normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or not-found return code*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "VLBCLR-S"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SELECT UNIQUE"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VLBCLR01"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = VLBCLR01.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = VLBCLR01.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = " ";
  SY0UW00.SY0UW-KEY-XGP-GPC = " ";
  SY0UW00.SY0UW-KEY-STY-NBR = " ";
  SY0UW00.SY0UW-KEY-XSN-YR = 0;
  SY0UW00.SY0UW-KEY-STY-ID = 0;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-VLBCLR01-S

// Update Trsl.Lab Color row
Function SY0US-VLBCLR01-U()
   /* ------------------------------------------------------------*/
   /* UPDATE the requested row from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "VLBCLR01" ("U ", SQLCA, VLBCLR01) {isNoRefresh = yes, isExternal = yes};
  end /* Update*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "VLBCLR-U"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "UPDATE       "; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VLBCLR01"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = VLBCLR01.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = VLBCLR01.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = " ";
  SY0UW00.SY0UW-KEY-XSN-YR = 0;
  SY0UW00.SY0UW-KEY-XGP-GPC = " ";
  SY0UW00.SY0UW-KEY-STY-NBR = " ";
  SY0UW00.SY0UW-KEY-STY-ID = 0;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-VLBCLR01-U

// Add Trsl.Product row
Function SY0US-VPRDTS01-A()
   /* ------------------------------------------------------------*/
   /* ADD the requested row to the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "VPRDTS01" ("A ", SQLCA, VPRDTS01) {isNoRefresh = yes, isExternal = yes};
  end /* Add*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If ADD did not work, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "VPRDTS-A"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "ADD          "; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VPRDTS01"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = VPRDTS01.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = VPRDTS01.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = " ";
  SY0UW00.SY0UW-KEY-XSN-YR = 0;
  SY0UW00.SY0UW-KEY-XGP-GPC = " ";
  SY0UW00.SY0UW-KEY-STY-NBR = " ";
  SY0UW00.SY0UW-KEY-STY-ID = VPRDTS01.SY-PROD-ID;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-VPRDTS01-A

// Select Trsl.Product row
Function SY0US-VPRDTS01-S()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "VPRDTS01" ("S ", SQLCA, VPRDTS01) {isNoRefresh = yes, isExternal = yes};
  end /* Select one*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (SQLCA.VAGen_SQLCODE == 0 /* and normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or not-found return code*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "VPRDTS-S"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SELECT UNIQUE"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VPRDTS01"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = VPRDTS01.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = VPRDTS01.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = " ";
  SY0UW00.SY0UW-KEY-XSN-YR = 0;
  SY0UW00.SY0UW-KEY-XGP-GPC = " ";
  SY0UW00.SY0UW-KEY-STY-NBR = " ";
  SY0UW00.SY0UW-KEY-STY-ID = VPRDTS01.SY-PROD-ID;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-VPRDTS01-S

// Update Trsl.Product row
Function SY0US-VPRDTS01-U()
   /* ------------------------------------------------------------*/
   /* UPDATE the requested row from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "VPRDTS01" ("U ", SQLCA, VPRDTS01) {isNoRefresh = yes, isExternal = yes};
  end /* Update*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "VPRDTS-U"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "UPDATE       "; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VPRDTS01"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = VPRDTS01.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = VPRDTS01.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = " ";
  SY0UW00.SY0UW-KEY-XSN-YR = 0;
  SY0UW00.SY0UW-KEY-XGP-GPC = " ";
  SY0UW00.SY0UW-KEY-STY-NBR = " ";
  SY0UW00.SY0UW-KEY-STY-ID = VPRDTS01.SY-PROD-ID;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-VPRDTS01-U

// Add a table row
Function SY0US-VSTYTS01-A()
   /* ------------------------------------------------------------*/
   /* ADD the requested row to the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "VSTYTS01" ("A ", SQLCA, VSTYTS01) {isNoRefresh = yes, isExternal = yes};
  end /* Add*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If ADD did not work, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "VSTYTS-A"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "ADD          "; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VSTYTS01"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = VSTYTS01.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = VSTYTS01.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = VSTYTS01.XSE-SESN-CD;
  SY0UW00.SY0UW-KEY-XSN-YR = VSTYTS01.XSN-SESN-YR-RNG;
  SY0UW00.SY0UW-KEY-XGP-GPC = " ";
  SY0UW00.SY0UW-KEY-STY-NBR = " ";
  SY0UW00.SY0UW-KEY-STY-ID = VSTYTS01.SY-STY-ID;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-VSTYTS01-A

// Select Style Lang unique row
Function SY0US-VSTYTS01-S()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "VSTYTS01" ("S ", SQLCA, VSTYTS01) {isNoRefresh = yes, isExternal = yes};
  end /* Select one*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (SQLCA.VAGen_SQLCODE == 0 /* and normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or not-found return code*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "VSTYTS-S"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SELECT UNIQUE"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VSTYTS01"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = VSTYTS01.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = VSTYTS01.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = VSTYTS01.XSE-SESN-CD;
  SY0UW00.SY0UW-KEY-XSN-YR = VSTYTS01.XSN-SESN-YR-RNG;
  SY0UW00.SY0UW-KEY-XGP-GPC = " ";
  SY0UW00.SY0UW-KEY-STY-NBR = " ";
  SY0UW00.SY0UW-KEY-STY-ID = VSTYTS01.SY-STY-ID;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-VSTYTS01-S

// Update the table row
Function SY0US-VSTYTS01-U()
   /* ------------------------------------------------------------*/
   /* UPDATE the requested row from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "VSTYTS01" ("U ", SQLCA, VSTYTS01) {isNoRefresh = yes, isExternal = yes};
  end /* Update*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "VSTYTS-U"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "UPDATE       "; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VSTYTS01"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = VSTYTS01.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = VSTYTS01.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = VSTYTS01.XSE-SESN-CD;
  SY0UW00.SY0UW-KEY-XSN-YR = VSTYTS01.XSN-SESN-YR-RNG;
  SY0UW00.SY0UW-KEY-XGP-GPC = " ";
  SY0UW00.SY0UW-KEY-STY-NBR = " ";
  SY0UW00.SY0UW-KEY-STY-ID = VSTYTS01.SY-STY-ID;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-VSTYTS01-U

// Close Set of Styles
Function SY0US-VSTYTSJ1-C2()
   /* ------------------------------------------------------------*/
   /* Close the cursor for the selected set of table rows.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "VSTYTSJ1" ("C2", SQLCA, VSTYTSJ1) {isNoRefresh = yes, isExternal = yes};
  end /* Close cursor*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "STYTS-C2"; /* Message location*/

  VGVar.handleSysLibraryErrors = 0;
  sysLib.rollback(); /* Roll back all changes*/

  converseLib.validationFailed(217); /* Unexpected error occurred*/
  TA1REC.TA1FUNC = "RETN"; /* Termination function*/

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "JOIN-CLOSE SET 2 CURSOR"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VSTYTSJ1"; /* Table view name*/

  call "TA0020" (TA1REC, TAEREC) {isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-VSTYTSJ1-C2

// Fetch next Ctry/Lang/Sesn Styl
Function SY0US-VSTYTSJ1-N2()
   /* ------------------------------------------------------------*/
   /* Fetch the next row that was selected from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "VSTYTSJ1" ("N2", SQLCA, VSTYTSJ1) {isNoRefresh = yes, isExternal = yes};
  end /* Fetch next row*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/

    if (SQLCA.VAGen_SQLCODE == 0) /* Normal return code*/
      return; /* Return to previous process*/
    end

    /* ------------------------------------------------------------*/
    /* If end of the selected set, indicate end of cursor.*/
    /* ------------------------------------------------------------*/

    if (SQLCA.VAGen_SQLCODE == 100) /* End of selected set*/

      SY0UW00.SY0UW-STY-EOF-FL = "Y"; /* End of cursor*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "STYTS-N2"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "JOIN-FETCH NEXT ROW"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VSTYTSJ1"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = " ";
  SY0UW00.SY0UW-KEY-ZFL-LANG = " ";
  SY0UW00.SY0UW-KEY-XSE-SESN = " ";
  SY0UW00.SY0UW-KEY-XSN-YR = 0;
  SY0UW00.SY0UW-KEY-XGP-GPC = VSTYTSJ1.XGP-GPC-CD;
  SY0UW00.SY0UW-KEY-STY-NBR = VSTYTSJ1.SY-STY-NBR;
  SY0UW00.SY0UW-KEY-STY-ID = 0;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-VSTYTSJ1-N2

// Select Ctry/Lang/Sesn for Styl
Function SY0US-VSTYTSJ1-S2()
   /* ------------------------------------------------------------*/
   /* Select the requested set of rows from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "VSTYTSJ1" ("S2", SQLCA, VSTYTSJ1) {isNoRefresh = yes, isExternal = yes};
  end /* Select set*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == 0)      /* and normal return code*/

    return; /* Return to previous process*/

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "STYTS-S2"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "JOIN-SELECT SET 2 &OPEN CURSOR"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VSTYTSJ1"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = " ";
  SY0UW00.SY0UW-KEY-ZFL-LANG = " ";
  SY0UW00.SY0UW-KEY-XSE-SESN = " ";
  SY0UW00.SY0UW-KEY-XSN-YR = 0;
  SY0UW00.SY0UW-KEY-XGP-GPC = VSTYTSJ1.XGP-GPC-CD;
  SY0UW00.SY0UW-KEY-STY-NBR = VSTYTSJ1.SY-STY-NBR;
  SY0UW00.SY0UW-KEY-STY-ID = 0;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-VSTYTSJ1-S2

// Select Style Name
Function SY0US-VSTYTSJ1-SA()
   /* ------------------------------------------------------------*/
   /* Select the requested  row from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "VSTYTSJ1" ("SA", SQLCA, VSTYTSJ1) {isNoRefresh = yes, isExternal = yes};
  end /* Select unique*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (SQLCA.VAGen_SQLCODE == 0 /* and normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or not-found return code*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "STYTS-SA"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "JOIN-SELECT ALTERNATE UNIQUE  "; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VSTYTSJ1"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = VSTYTSJ1.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = VSTYTSJ1.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = VSTYTSJ1.XSE-SESN-CD;
  SY0UW00.SY0UW-KEY-XSN-YR = VSTYTSJ1.XSN-SESN-YR-RNG;
  SY0UW00.SY0UW-KEY-XGP-GPC = VSTYTSJ1.XGP-GPC-CD;
  SY0UW00.SY0UW-KEY-STY-NBR = VSTYTSJ1.SY-STY-NBR;
  SY0UW00.SY0UW-KEY-STY-ID = VSTYTSJ1.SY-STY-ID;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR;

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-VSTYTSJ1-SA

// Select Tdmk. Translation
Function SY0US-VTRDTS01-S()
   /* ------------------------------------------------------------*/
   /* Select the requested row from the table.*/
   /* ------------------------------------------------------------*/

  set SQLCA empty;

  try
    call "VTRDTS01" ("S ", SQLCA, VTRDTS01) {isNoRefresh = yes, isExternal = yes};
  end /* Select one*/

   /* ------------------------------------------------------------*/
   /* If the call was successful, return to the previous process.*/
   /* ------------------------------------------------------------*/

  if (sysVar.errorCode == "00000000") /* Call successful*/
    if (SQLCA.VAGen_SQLCODE == 0 /* and normal return code*/
     || SQLCA.VAGen_SQLCODE == 100) /* or not-found return code*/

      return; /* Return to previous process*/

    end

  end

   /* ------------------------------------------------------------*/
   /* If data not available, return an error message to the user.*/
   /* Otherwise, indicate that an unexpected error has occurred.*/
   /* ------------------------------------------------------------*/

  TA1REC.TA1MAP = sysVar.errorCode; /* CSP return code*/
  TAEREC.SQLCAREC = SQLCA.SQLCAREC; /* SQL commarea*/

  SY0UW00.XXX-MSG-LOC-ID = "VTRDTS-S"; /* Message location*/

  if (sysVar.errorCode == "00000000" /* Call successful*/
   && SQLCA.VAGen_SQLCODE == -911)   /* and resource not available*/

    converseLib.validationFailed(101); /* Data in use by another*/
    TA1REC.TA1FUNC = "POST"; /* Termination function*/

  else

    VGVar.handleSysLibraryErrors = 0;
    sysLib.rollback(); /* Roll back all changes*/

    converseLib.validationFailed(217); /* Unexpected error occurred*/
    TA1REC.TA1FUNC = "RETN"; /* Termination function*/

    converseLib.clearScreen();
     /* Clear screen before display*/

  end

  TA1REC.TA1TYPE = "DB2 "; /* Type of error*/
  TA1REC.TA1PGMNM = SY0UW00.XXX-MSG-LOC-ID; /* Message location*/
  TA1REC.TA1LOC = "SELECT UNIQUE"; /* Description*/
  TA1REC.TA1DBASE = "DPROD   "; /* Data base name*/
  TA1REC.TA1TBLVU = "VTRDTS01"; /* Table view name*/
    /* Build readable key*/
  SY0UW00.SY0UW-KEY-XCT-CTRY = VTRDTS01.XCT-CTRY-CD;
  SY0UW00.SY0UW-KEY-ZFL-LANG = VTRDTS01.ZFL-LANG-CD;
  SY0UW00.SY0UW-KEY-XSE-SESN = " ";
  SY0UW00.SY0UW-KEY-XSN-YR = 0;
  SY0UW00.SY0UW-KEY-XGP-GPC = SY0UM022.XGP-GPC-CD;
  SY0UW00.SY0UW-KEY-STY-NBR = SY0UM022.SY-STY-NBR;
  SY0UW00.SY0UW-KEY-STY-ID = 0;
  TA1REC.TA1TBLKE = SY0UW00.SY0UW-KEY-ERR; /* Table key*/

  call "TA0020" (TA1REC, TAEREC) {isNoRefresh = yes, isExternal = yes}; /* Error diagnosis routine*/

  exit stack; /* Exit to display map*/


end // end SY0US-VTRDTS01-S

// Application initialization
Function XPSY-00000()
   /* ------------------------------------------------------------*/
   /* Ensure that the COMMAREA has been properly formatted.*/
   /* ------------------------------------------------------------*/

  XSENTRY(); /* Application entry validation*/

   /* ------------------------------------------------------------*/
   /* Initialize the segmented transaction identification.*/
   /* ------------------------------------------------------------*/

  XSSEGTR(); /* Set transaction identification*/

   /* ------------------------------------------------------------*/
   /* If control was passed to this transaction from another*/
   /* within the same application system, restore the work record*/
   /* from the COMMAREA.  Otherwise, initialize the work record.*/
   /* ------------------------------------------------------------*/

  if (COMMAREA.CAFRMSYS == COMMAREA.CACURSYS) /* Same system*/
    /* no work area is passed from sy0n.*/
    /* so there's nothing to initialize.*/

  else

    /* no work area is passed from sy0n.*/
    /* so there's nothing to initialize.*/

  end

   /* ------------------------------------------------------------*/
   /* Initialize CSP special function data items.*/
   /* ------------------------------------------------------------*/

  VGVar.handleHardIOErrors = 1; /* Return all file errors*/
  converseVar.commitOnConverse = 1; /* Commit on every converse*/

   /* ------------------------------------------------------------*/
   /* Get current date, then subtract two years from it.*/
   /* This is used in SY1590 and SY1610 to exclude listing*/
   /* Styles and Products that were closed out over 2 years ago.*/
   /* Note - this code belongs in the FLOW of this process, but*/
   /* CSP would not allow the 'call' in the FLOW.*/
   /* ------------------------------------------------------------*/

  set TA2REC empty;

  TA2REC.TA2DTOPT = "GETDATE";
  TA2REC.TA2DYAOD = -730; /* Subtract 2 years*/

  call "TA0040" (TA2REC) {isNoRefresh = yes, isExternal = yes};

   /* ------------------------------------------------------------*/
   /* Set-up table of valid regions/countries for user.*/
   /* ------------------------------------------------------------*/

  set WSY1550 empty;
  XPSY008(); /* Get users region*/
  if (SYWREC.SYW-REG-TBL-SIZE > 0)
    if (SYWREC.SYW-ALL-REGIONS-FL == "N")
      XPSY009(); /* Get countries for region*/
    end
  end

end // end XPSY-00000

// Exit to another application
Function XSSYS-EXIT()
   /* ------------------------------------------------------------*/
   /* Set the application to be invoked for PF1 or PF4.*/
   /* ------------------------------------------------------------*/

  if (converseVar.eventKey is pf1) /* PF1 was pressed*/
    COMMAREA.CATOAP = "GD0G"; /* Goal Documentation*/
  end

  if (converseVar.eventKey is pf4) /* PF4 was pressed*/
    COMMAREA.CATOAP = "MN0M"; /* Master Menu*/
  end

   /* ------------------------------------------------------------*/
   /* Save the system work record in the COMMAREA user area.*/
   /* ------------------------------------------------------------*/

  if (COMMAREA.CATOSYS == COMMAREA.CACURSYS) /* Same system*/

    /* next sentence*/

  else

    COMMAREA.CAUSERA = " "; /* Clear user area*/

  end

   /* ------------------------------------------------------------*/
   /* Transfer control to the specified application.*/
   /* ------------------------------------------------------------*/

  XSEXIT(); /* Exit to another application*/

  SY0UW00.XXX-MSG-LOC-ID = "XSEXIT"; /* Message location*/

   /* ------------------------------------------------------------*/
   /* Reestablish the COMMAREA application and item fields.*/
   /* ------------------------------------------------------------*/

  COMMAREA.CAEZSG3 = "0"; /* Force zero third character*/
  COMMAREA.CACURRAP = COMMAREA.CAEZSAP; /* Current application*/

  if (converseVar.eventKey is pfkey) /* PF key was pressed*/

    COMMAREA.CATOAP = " "; /* Clear TO application*/

    if (converseVar.eventKey is pf1) /* PF1 was pressed*/
      COMMAREA.CAITEM = " "; /* Clear map name from item*/
    end

  end


end // end XSSYS-EXIT

//*** RECORD=SY0UW00 ****
// ----------------------------
// Application working storage.
// 
// General fields to use during SY0U processing.
// These apply to all the maps in SY0U.
// 
// SY0UW-WORD-ARY is used in SY0U-2-24100 to edit for USA
// trademarks in Style Translation.
// 
// ----------------------------
// MAINTENANCE LOG:
// DATE     BY      WHY
// -------- ------  -------------------------------------------
// 11-19-98 HMACAL  Added SY0UW-FLAG, SY0UW-KEY-XDR-REG and
//                        SY0UW-KEY-SLASH4, thereby increasing
//                        SY0UW-KEY-ERR from 35 to 38 bytes.
// ***********************
Record SY0UW00 type basicRecord
  10 XXX-RQT-DATA-FL XXX-RQT-DATA-FL ; 
  10 XXX-MAP-FMAT-FL XXX-MAP-FMAT-FL ; 
  10 XXX-MAP-DSP-CD XXX-MAP-DSP-CD ; 
  10 SY0UW-MAP-MODE SY0UW-MAP-MODE ; 
  10 XXX-MSG-NBR XXX-MSG-NBR ; 
  10 XXX-MSG-LOC-ID XXX-MSG-LOC-ID ; 
  10 SY0UW-SY0UW02-LNTH SY0UW-SY0UW02-LNTH ; 
  10 SY0UW-SY0UW03-LNTH SY0UW-SY0UW03-LNTH ; 
  10 SY0UW-SY0UW04-LNTH SY0UW-SY0UW04-LNTH ; 
  10 SY0UW-SY0UW05-LNTH SY0UW-SY0UW05-LNTH ; 
  10 SY0UW-LOWER-TBL SY0UW-LOWER-TBL ; 
    15 SY0UW-LOWER-CHAR SY0UW-LOWER-CHAR [26] ; 
  10 SY0UW-UPPER-TBL SY0UW-UPPER-TBL ; 
    15 SY0UW-UPPER-CHAR SY0UW-UPPER-CHAR [26] ; 
  10 SY0UW-CNVT-NM-LEN SY0UW-CNVT-NM-LEN ; 
  10 SY0UW-CNVT-NM SY0UW-CNVT-NM ; 
    15 SY0UW-CNVT-CHAR SY0UW-CNVT-CHAR [30] ; 
  10 XXX-INX-LMT-NBR XXX-INX-LMT-NBR ; 
  10 XXX-INX-FLD-NBR XXX-INX-FLD-NBR ; 
  10 XXX-CURR-PAGE-NBR XXX-CURR-PAGE-NBR ; 
  10 XXX-HI-PAGE-NBR XXX-HI-PAGE-NBR ; 
  10 XXX-PAGE-UPD-FL XXX-PAGE-UPD-FL ; 
  10 SY0UW-STY-EOF-FL SY0UW-STY-EOF-FL ; 
  10 SY0UW-FLAG SY0UW-FLAG ; 
  10 SY0UW-INX SY0UW-INX ; 
  10 SY0UW-CURR-DT-LESS-2YR SY0UW-CURR-DT-LESS-2YR ; 
  10 SY0UW-KEY-ERR SY0UW-KEY-ERR ; 
    15 SY0UW-KEY-XCT-CTRY SY0UW-KEY-XCT-CTRY ; 
    15 SY0UW-KEY-DASH1 char(1) ; // dash
    15 SY0UW-KEY-ZFL-LANG SY0UW-KEY-ZFL-LANG ; 
    15 SY0UW-KEY-SLASH1 char(1) ; // slash
    15 SY0UW-KEY-XSE-SESN SY0UW-KEY-XSE-SESN ; 
    15 SY0UW-KEY-DASH2 char(1) ; // dash
    15 SY0UW-KEY-XSN-YR SY0UW-KEY-XSN-YR ; 
    15 SY0UW-KEY-SLASH2 char(1) ; // slash
    15 SY0UW-KEY-XGP-GPC SY0UW-KEY-XGP-GPC ; 
    15 SY0UW-KEY-DASH3 char(1) ; // dash
    15 SY0UW-KEY-STY-NBR SY0UW-KEY-STY-NBR ; 
    15 SY0UW-KEY-SLASH3 char(1) ; // slash
    15 SY0UW-KEY-STY-ID SY0UW-KEY-STY-ID ; 
    15 SY0UW-KEY-SLASH4 char(1) ; // slash
    15 SY0UW-KEY-XDR-REG SY0UW-KEY-XDR-REG ; 
end // end SY0UW00

//*** RECORD=SY0UW01 ****
// ------------------------
// Map 001 - MENU - display storage.
// 
// NOTE - fields common to all maps are kept only here:
//     XGP-GPC-CD, XCT-CTRY-CD, ZFL-LANG-CD,
//     XSE-SESN-CD, XSE-SESN-DESC + XSN-SESN-YR-RNG.
// ------------------------
// MAINTENANCE LOG:
// DATE     BY      WHY
// -------- ------  -------------------------------------------
// 11-19-98 HMACAL  Added XDR-PROD-REG-CD and XDR-PROD-REG-DESC
// ***********************
Record SY0UW01 type basicRecord
  10 XGP-GPC-CD XGP-GPC-CD ; 
  10 XGP-GPC-DESC XGP-GPC-DESC ; 
  10 XCT-CTRY-CD XCT-CTRY-CD ; 
  10 XCT-CTRY-DESC XCT-CTRY-DESC ; 
  10 ZFL-LANG-CD ZFL-LANG-CD ; 
  10 ZFL-LANG-DESC ZFL-LANG-DESC ; 
  10 XSE-SESN-CD XSE-SESN-CD ; 
  10 XSE-SESN-DESC XSE-SESN-DESC ; 
  10 XSN-SESN-YR-RNG XSN-SESN-YR-RNG ; 
  10 XDR-PROD-REG-CD XDR-PROD-REG-CD ; 
  10 XDR-PROD-REG-DESC XDR-PROD-REG-DESC ; 
end // end SY0UW01

//*** RECORD=SY0UW02 ****
// -------------------------------------------------------
// Map 021 and Map 022 display storage for Style Name List
// -------------------------------------------------------
// This is used for both maps since all information is
// obtained during the select set for the first List map.
// 
// Contains key/header information, plus line item info.
// for all 14 lines on the list map.
// 
// NOTE - the fields common to all maps are kept only in
// SY0UW01 from map 001:  XGP-GPC-CD, XCT-CTRY-CD, ZFL-LANG-CD.
//                        XSE-SESN-CD,XSN-SESN-YR-RNG.
// -------------------------------------------------------
// ***********************
Record SY0UW02 type basicRecord
  5 XXX-TEMP-STG-LNTH XXX-TEMP-STG-LNTH ; 
  5 * char(1370) ; 
    10 SY0UM-SY-STY-NBR SY0UM-SY-STY-NBR ; 
    10 SY0UM-SY-STY-ID SY0UM-SY-STY-ID ; 
    10 SY0UM-SY-TRSL-STY-NM SY0UM-SY-TRSL-STY-NM ; 
    10 XXX-LN-SEL-IND XXX-LN-SEL-IND [14] ; 
    10 SY-STY-NBR SY-STY-NBR [14] ; 
    10 SY-STY-ID SY-STY-ID [14] ; 
    10 SY-TRSL-STY-NM SY-TRSL-STY-NM [14] ; 
    10 SY-STY-NM SY-STY-NM [14] ; 
    10 SY-TRSL-SH-STY-NM SY-TRSL-SH-STY-NM [14] ; 
    10 SY-SHORT-STY-NM SY-SHORT-STY-NM [14] ; 
end // end SY0UW02

//*** RECORD=SY0UW03 ****
// -------------------------------------------------------
// Map 031 and Map 032 display storage for Lab Color List
// -------------------------------------------------------
// This is used for both maps since all information is
// obtained during the select set for the first List map.
// 
// Contains key/header information, plus line item info.
// for all 14 lines on the list map.
// 
// NOTE - the fields common to all maps are kept only in
// SY0UW01 for map 001: XGP-GPC-CD, XCT-CTRY-CD, ZFL-LANG-CD.
// -------------------------------------------------------
// ***********************
Record SY0UW03 type basicRecord
  5 XXX-TEMP-STG-LNTH XXX-TEMP-STG-LNTH ; 
  5 * char(845) ; 
    10 SY0UM-XCL-COLR-CD SY0UM-XCL-COLR-CD ; 
    10 SY0UM-XCL-COLR-DESC SY0UM-XCL-COLR-DESC ; 
    10 XXX-LN-SEL-IND XXX-LN-SEL-IND [14] ; 
    10 XCL-COLR-CD XCL-COLR-CD [14] ; 
    10 XCL-COLR-DESC XCL-COLR-DESC [14] ; 
    10 SY0UM-USA-COLR-DESC SY0UM-USA-COLR-DESC [14] ; 
    10 XCL-COLR-ABRV1 XCL-COLR-ABRV1 [14] ; 
    10 SY0UM-USA-COLR-ABRV1 SY0UM-USA-COLR-ABRV1 [14] ; 
    10 XCL-COLR-ABRV2 XCL-COLR-ABRV2 [14] ; 
    10 SY0UM-USA-COLR-ABRV2 SY0UM-USA-COLR-ABRV2 [14] ; 
end // end SY0UW03

//*** RECORD=SY0UW04 ****
// -------------------------------------------------------
// Map 041 and Map 042 display storage for Product Color List
// -------------------------------------------------------
// This is used for both maps since all information is
// obtained during the select set for the first List map.
// 
// Contains key/header information, plus line item info.
// for all 14 lines on the list map.
// 
// NOTE - fields common to all maps are kept only in
// SY0UW01 for map 001: XGP-GPC-CD, XCT-CTRY-CD, ZFL-LANG-CD.
// -------------------------------------------------------
// ***********************
Record SY0UW04 type basicRecord
  5 XXX-TEMP-STG-LNTH XXX-TEMP-STG-LNTH ; 
  5 * char(1468) ; 
    10 SY0UM-SY-STY-NBR SY0UM-SY-STY-NBR ; 
    10 SY0UM-SY-STY-ID SY0UM-SY-STY-ID ; 
    10 SY-TRSL-STY-NM SY-TRSL-STY-NM ; 
    10 XXX-LN-SEL-IND XXX-LN-SEL-IND [14] ; 
    10 SY-STY-NBR SY-STY-NBR [14] ; 
    10 SY-COLR-CD-ID SY-COLR-CD-ID [14] ; 
    10 XDM-DIM-CD XDM-DIM-CD [14] ; 
    10 SY-PROD-ID SY-PROD-ID [14] ; 
    10 SY-TRSL-COLR-NM SY-TRSL-COLR-NM [14] ; 
    10 SY-STY-COLR-DESC SY-STY-COLR-DESC [14] ; 
    10 SY-TRSL-SH-COLR-NM SY-TRSL-SH-COLR-NM [14] ; 
    10 SY-STY-COLR-ABRV SY-STY-COLR-ABRV [14] ; 
end // end SY0UW04

//*** RECORD=SY0UW05 ****
// -------------------------------------------------------
// Map 051 display storage for Style Name List
// -------------------------------------------------------
// Contains key/header information, plus line item info.
// for all 14 lines on the list map.
// 
// NOTE - the fields common to all maps are kept only in
// SY0UW01 from map 001:  XGP-GPC-CD.
// -----------------------------------------------------------
// Maintenance Log:
// 05-16-96  BCourt  Change for new map definition.
// -----------------------------------------------------------
// ***********************
Record SY0UW05 type basicRecord
  5 XXX-TEMP-STG-LNTH XXX-TEMP-STG-LNTH ; 
  5 * char(936) ; 
    10 SY-STY-NBR SY-STY-NBR ; 
    10 SY-STY-ID SY-STY-ID ; 
    10 SY-STY-NM SY-STY-NM ; 
    10 XCT-CTRY-CD XCT-CTRY-CD [14] ; 
    10 XCT-CTRY-ABRV XCT-CTRY-ABRV [14] ; 
    10 ZFL-LANG-CD ZFL-LANG-CD [14] ; 
    10 ZFL-LANG-ABRV ZFL-LANG-ABRV [14] ; 
    10 XSE-SESN-CD XSE-SESN-CD [14] ; 
    10 XSN-SESN-YR-RNG XSN-SESN-YR-RNG [14] ; 
    10 SY-TRSL-STY-NM SY-TRSL-STY-NM [14] ; 
    10 SY-TRSL-SH-STY-NM SY-TRSL-SH-STY-NM [14] ; 
end // end SY0UW05

//*** RECORD=SY0UW06 ****
// ----------------------------
// SY0UW06 is used in SY0U-2-24100 to edit for USA
// trademarks in Style Translation.
// 
// ----------------------------
// ***********************
Record SY0UW06 type basicRecord
  10 SY0UW-STY-NM-WORD SY0UW-STY-NM-WORD [12] ; 
end // end SY0UW06

//*** RECORD=VLBCLR01 ****
// *************  LAB COLORs   TRANSLATION TABLE  *************
// 
// DB2 TABLE:           DPROD.VLBCLR01
// 
// COPYLIB MEMBER:      DLBCLR01
// IO MODULE:           VLBCLR01
// 
// KEY TO DB2 TABLE:    XCL_COLR_CD
//                      XCT_CTRY_CD
//                      ZFL_LANG_CD
// 
// DATE CREATED:        January 16, 1996
// 
// NOTE:                AS FAR AS I KNOW, THERE'S NO REASON
//                      FOR XXX-STAT, SO NO CODING WILL BE DONE
//                      TO SUPPORT THIS ITEM.
// 
// MAINTENANCE LOG:
// DATE      INIT     COMMENTS
// --------  ------   -----------------------------------------
// 01-16-96  BCourt   Created csp record
// ************************************************************
// ************************
Record VLBCLR01 type basicRecord
  5 VLBCLR01-GROUP VLBCLR01-GROUP ; 
    10 VLBCLR01-KEY VLBCLR01-KEY ; 
      15 XCL-COLR-CD XCL-COLR-CD ; 
      15 XCT-CTRY-CD XCT-CTRY-CD ; 
      15 ZFL-LANG-CD ZFL-LANG-CD ; 
    10 XCL-COLR-DESC XCL-COLR-DESC ; 
    10 XCL-COLR-ABRV1 XCL-COLR-ABRV1 ; 
    10 XCL-COLR-ABRV2 XCL-COLR-ABRV2 ; 
    10 XXX-STAT XXX-STAT ; 
    10 ZZ-SDT ZZ-SDT ; 
    10 ZZ-CHNG-DT ZZ-CHNG-DT ; 
    10 ZZ-CHNG-HHMM ZZ-CHNG-HHMM ; 
    10 ZZ-CHNG-CNT ZZ-CHNG-CNT ; 
end // end VLBCLR01

//*** RECORD=VPRDTS01 ****
// ******************  PRODUCT TRANSLATION TABLE  *************
// 
// DB2 TABLE:           DPROD.VPRDTS01
// 
// COPYLIB MEMBER:      DPRDTS01
// IO MODULE:           VPRDTS01
// 
// KEY TO DB2 TABLE:    SY_PROD_ID
//                        (xref. to SY_COLR_CD_ID, XDM_DIM_CD
//                         and XGP_GPC_CD on DPROD.VPRDXF01)
//                      XCT_CTRY_CD
//                      ZFL_LANG_CD
// 
// DATE CREATED:        January 10, 1996
// 
// MAINTENANCE LOG:
// DATE      INIT     COMMENTS
// --------  ------   -----------------------------------------
// 01-10-96  BCourt   Created csp record
// ************************************************************
// ************************
Record VPRDTS01 type basicRecord
  5 VPRDTS01-GROUP VPRDTS01-GROUP ; 
    10 VPRDTS01-KEY VPRDTS01-KEY ; 
      15 SY-PROD-ID SY-PROD-ID ; 
      15 XCT-CTRY-CD XCT-CTRY-CD ; 
      15 ZFL-LANG-CD ZFL-LANG-CD ; 
    10 SY-TRSL-COLR-NM SY-TRSL-COLR-NM ; 
    10 SY-TRSL-SH-COLR-NM SY-TRSL-SH-COLR-NM ; 
    10 ZZ-SDT ZZ-SDT ; 
    10 ZZ-CHNG-DT ZZ-CHNG-DT ; 
    10 ZZ-CHNG-HHMM ZZ-CHNG-HHMM ; 
    10 ZZ-CHNG-CNT ZZ-CHNG-CNT ; 
end // end VPRDTS01

//*** RECORD=VPRDTSJ1 ****
// ****  PRODUCT TRANSLATION join with PRODUCT X-REF view *****
// 
// DB2 TABLE:           DPROD.VPRDTSJ1
// 
// COPYLIB MEMBER:      DPRDTSJ1
// IO MODULE:           VPRDTSJ1
// 
// KEY 1 TO DB2 TABLE:  SY_PROD_ID
// 
// KEY 2 to DB2 VIEW:   XGP_GPC_CD
//                      SY_STY_NBR
//                      SY_COLR_CD_ID
//                      XDM_DIM_CD
// 
// DATE CREATED:        March 4, 1996
// 
// MAINTENANCE LOG:
// DATE      INIT     COMMENTS
// --------  ------   -----------------------------------------
// 03-04-96  BCourt   Created csp record
// ************************************************************
// ************************
Record VPRDTSJ1 type basicRecord
  5 VPRDTSJ1-GROUP VPRDTSJ1-GROUP ; 
    10 SY-PROD-ID SY-PROD-ID ; 
    10 XGP-GPC-CD XGP-GPC-CD ; 
    10 SY-STY-NBR SY-STY-NBR ; 
    10 SY-COLR-CD-ID SY-COLR-CD-ID ; 
    10 XDM-DIM-CD XDM-DIM-CD ; 
    10 XCT-CTRY-CD XCT-CTRY-CD ; 
    10 ZFL-LANG-CD ZFL-LANG-CD ; 
    10 SY-TRSL-COLR-NM SY-TRSL-COLR-NM ; 
    10 SY-TRSL-SH-COLR-NM SY-TRSL-SH-COLR-NM ; 
end // end VPRDTSJ1

//*** RECORD=VSTYTS01 ****
// *************  Style Translation Table  ****************
// 
// DB2 TABLE:           DPROD.VSTYTS01
// 
// COPYLIB MEMBER:      DSTYTS01
// IO MODULE:           VSTYTS01
// 
// KEY TO DB2 TABLE:    SY_STY_ID
//                        xref. to SY_STY_NBR & XGP_GPC_CD
//                        in DPROD.VSTYXF01
//                      XCT_CTRY_CD
//                      ZFL_LANG_CD
//                      XSE_SESN_CD
//                      XSN_SESN_YR_RNG
// 
// DATE CREATED:        January 10, 1996
// 
// MAINTENANCE LOG:
// DATE     BY      WHY
// -------- ------  -------------------------------------------
// 01-10-96 BCourt  Created CSP record
// ************************
Record VSTYTS01 type basicRecord
  5 VSTYTS01-GROUP VSTYTS01-GROUP ; 
    10 VSTYTS01-KEY VSTYTS01-KEY ; 
      15 SY-STY-ID SY-STY-ID ; 
      15 XCT-CTRY-CD XCT-CTRY-CD ; 
      15 ZFL-LANG-CD ZFL-LANG-CD ; 
      15 XSE-SESN-CD XSE-SESN-CD ; 
      15 XSN-SESN-YR-RNG XSN-SESN-YR-RNG ; 
    10 SY-TRSL-STY-NM SY-TRSL-STY-NM ; 
    10 SY-TRSL-SH-STY-NM SY-TRSL-SH-STY-NM ; 
    10 ZZ-SDT ZZ-SDT ; 
    10 ZZ-CHNG-DT ZZ-CHNG-DT ; 
    10 ZZ-CHNG-HHMM ZZ-CHNG-HHMM ; 
    10 ZZ-CHNG-CNT ZZ-CHNG-CNT ; 
end // end VSTYTS01

//*** RECORD=VSTYTSJ1 ****
// ****  Style Translation join with Style Cross-Reference view
// 
// DB2 TABLE:           DPROD.VSTYTSJ1
// 
// COPYLIB MEMBER:      DSTYTSJ1
// IO MODULE:           VSTYTSJ1
// 
// KEY 1 TO DB2 TABLE:  SY_STY_ID
//                      XCT_CTRY_CD
//                      ZFL_LANG_CD
//                      XSE_SESN_CD
//                      XSN_SESN_YR_RNG
// 
// KEY 2 to DB2 VIEW:   SY_STY_NBR
//                      XGP_GPC_CD
//                      XCT_CTRY_CD
//                      ZFL_LANG_CD
//                      XSE_SESN_CD
//                      XSN_SESN_YR_RNG
// 
// DATE CREATED:        March 4, 1996
// 
// MAINTENANCE LOG:
// DATE     BY      WHY
// -------- ------  -------------------------------------------
// 03-04-96 BCourt  Created CSP record
// ************************
Record VSTYTSJ1 type basicRecord
  5 VSTYTSJ1-GROUP VSTYTSJ1-GROUP ; 
    10 SY-STY-ID SY-STY-ID ; 
    10 XGP-GPC-CD XGP-GPC-CD ; 
    10 SY-STY-NBR SY-STY-NBR ; 
    10 XCT-CTRY-CD XCT-CTRY-CD ; 
    10 ZFL-LANG-CD ZFL-LANG-CD ; 
    10 XSE-SESN-CD XSE-SESN-CD ; 
    10 XSN-SESN-YR-RNG XSN-SESN-YR-RNG ; 
    10 SY-TRSL-STY-NM SY-TRSL-STY-NM ; 
    10 SY-TRSL-SH-STY-NM SY-TRSL-SH-STY-NM ; 
end // end VSTYTSJ1

//*** RECORD=WSY1580 ****
// ******  Lab Color Concatenation into Product Color  *******
// 
// note - record length MUST match length of record included
//   in the NIKEBOTH cobol program SY1580 (e.g., 1024).
// 
// COPYLIB MEMBER:      WSY1580
// IO MODULE:           SY1580
// 
// MAINTENANCE LOG:
// DATE     BY      WHY
// -------- ------  -------------------------------------------
// 03-14-96 BCourt  Created CSP record
// 05-14-98 MHALST  Added XGP-GPC-CD to passing data
// ***********************
Record WSY1580 type basicRecord
  5 WSY1580-GROUP WSY1580-GROUP ; 
    10 WSY1580-INPUT-INFO WSY1580-INPUT-INFO ; 
      15 WSY1580-OPT-CD WSY1580-OPT-CD ; 
      15 XGP-GPC-CD XGP-GPC-CD ; 
      15 XCL-COLR-DESC XCL-COLR-DESC [4] ; 
      15 XCL-COLR-ABRV1 XCL-COLR-ABRV1 [4] ; 
      15 XCL-COLR-ABRV2 XCL-COLR-ABRV2 [4] ; 
    10 WSY1580-OUTPUT-INFO WSY1580-OUTPUT-INFO ; 
      15 WSY1580-RETURN-CD WSY1580-RETURN-CD ; 
      15 SY-TRSL-COLR-NM SY-TRSL-COLR-NM ; 
      15 SY-TRSL-SH-COLR-NM SY-TRSL-SH-COLR-NM ; 
    10 WSY1580-FILLER WSY1580-FILLER ; 
end // end WSY1580

//*** RECORD=WSY1590 ****
// *************  Style Translation Table  ****************
// 
// DB2 TABLES:          DPROD.VSTYTSJ1
//                      DPROD.VSTYLE01
// 
// COPYLIB MEMBER:      WSY1590
// IO MODULE:           SY1590
// 
// KEY TO DB2 TABLE:    XGP_GPC_CD
//                      XCT_CTRY_CD
//                      ZFL_LANG_CD
//                      XDR_PROD_REG_CD
//                      XSE_SESN_CD
//                      XSN_SESN_YR_RNG
//                      WSY1590-CURR-DT-LESS-2YR
// 
// MAINTENANCE LOG:
// DATE     BY      WHY
// -------- ------  -------------------------------------------
// 03-09-96 BCourt  Created CSP record
// 11-19-98 MHALST  Add XDR-PROD-REG-CD TO RECORD
// ***********************
Record WSY1590 type basicRecord
  5 WSY1590-GROUP WSY1590-GROUP ; 
    10 WSY1590-KEY WSY1590-KEY ; 
      15 XGP-GPC-CD XGP-GPC-CD ; 
      15 XCT-CTRY-CD XCT-CTRY-CD ; 
      15 ZFL-LANG-CD ZFL-LANG-CD ; 
      15 XDR-PROD-REG-CD XDR-PROD-REG-CD ; 
      15 XSE-SESN-CD XSE-SESN-CD ; 
      15 XSN-SESN-YR-RNG XSN-SESN-YR-RNG ; 
      15 WSY1590-CURR-DT-LESS-2YR WSY1590-CURR-DT-LESS-2YR ; 
    10 WSY1590-SORT-SEQ WSY1590-SORT-SEQ ; 
    10 SY-STY-NBR SY-STY-NBR ; 
    10 SY-STY-ID SY-STY-ID ; 
    10 SY-TRSL-STY-NM SY-TRSL-STY-NM ; 
    10 SY-STY-NM SY-STY-NM ; 
    10 SY-TRSL-SH-STY-NM SY-TRSL-SH-STY-NM ; 
    10 SY-SHORT-STY-NM SY-SHORT-STY-NM ; 
end // end WSY1590

//*** RECORD=WSY1600 ****
// *************  Lab Color Translations   ****************
// 
// Select set of translations with their USA descriptions
// and any USA codes without translation for the Country
// and Language being shown on the map SY0UM031.
// 
// DB2 TABLES:          DPROD.VLBCLR01
//                      DCORP.VXCL0001
// 
// COPYLIB MEMBER:      WSY1600
// IO MODULE:           SY1600
// 
// KEY TO DB2 TABLE:    XCT_CTRY_CD
//                      ZFL_LANG_CD
// 
// MAINTENANCE LOG:
// DATE     BY      WHY
// -------- ------  -------------------------------------------
// 03-11-96 BCourt  Created CSP record
// ***********************
Record WSY1600 type basicRecord
  5 WSY1600-GROUP WSY1600-GROUP ; 
    10 WSY1600-KEY WSY1600-KEY ; 
      15 XCT-CTRY-CD XCT-CTRY-CD ; 
      15 ZFL-LANG-CD ZFL-LANG-CD ; 
    10 XCL-COLR-CD XCL-COLR-CD ; 
    10 XCL-COLR-DESC XCL-COLR-DESC ; 
    10 SY0UM-USA-COLR-DESC SY0UM-USA-COLR-DESC ; 
    10 XCL-COLR-ABRV1 XCL-COLR-ABRV1 ; 
    10 SY0UM-USA-COLR-ABRV1 SY0UM-USA-COLR-ABRV1 ; 
    10 XCL-COLR-ABRV2 XCL-COLR-ABRV2 ; 
    10 SY0UM-USA-COLR-ABRV2 SY0UM-USA-COLR-ABRV2 ; 
end // end WSY1600

//*** RECORD=WSY1610 ****
// *************  Product Colors for Translation & USA  ***
// 
// Select set of translations with their USA descriptions
// and any USA codes without translation for the Country
// and Language being shown on the map SY0UM041.
// 
// DB2 TABLES:          DPROD.VPRDTS01
//                      DPROD.VCOLOR01
// 
// COPYLIB MEMBER:      WSY1610
// IO MODULE:           SY1610
// 
// KEY TO DB2 TABLE:    XCT_CTRY_CD
//                      ZFL_LANG_CD
//                      XGP_GPC_CD
//                      XDR_PROD_REG_CD
//                      SY1610-CURR-DT-LESS-2YR
// 
// MAINTENANCE LOG:
// DATE     BY      WHY
// -------- ------  -------------------------------------------
// 03-11-96 BCourt  Created CSP record
// 11-19-98 MHALST  ADD XDR-PROD-REG-CD TO RECORD
// ***********************
Record WSY1610 type basicRecord
  5 WSY1610-GROUP WSY1610-GROUP ; 
    10 WSY1610-KEY WSY1610-KEY ; 
      15 XCT-CTRY-CD XCT-CTRY-CD ; 
      15 ZFL-LANG-CD ZFL-LANG-CD ; 
      15 XGP-GPC-CD XGP-GPC-CD ; 
      15 XDR-PROD-REG-CD XDR-PROD-REG-CD ; 
      15 XSE-SESN-CD XSE-SESN-CD ; 
      15 XSN-SESN-YR-RNG XSN-SESN-YR-RNG ; 
      15 WSY1610-CURR-DT-LESS-2YR WSY1610-CURR-DT-LESS-2YR ; 
    10 WSY1610-SORT-SEQ WSY1610-SORT-SEQ ; 
    10 SY-STY-NBR SY-STY-NBR ; 
    10 SY-COLR-CD-ID SY-COLR-CD-ID ; 
    10 XDM-DIM-CD XDM-DIM-CD ; 
    10 SY-PROD-ID SY-PROD-ID ; 
    10 SY-TRSL-COLR-NM SY-TRSL-COLR-NM ; 
    10 SY-STY-COLR-DESC SY-STY-COLR-DESC ; 
    10 SY-TRSL-SH-COLR-NM SY-TRSL-SH-COLR-NM ; 
    10 SY-STY-COLR-ABRV SY-STY-COLR-ABRV ; 
end // end WSY1610

// SY_STY_COLR_ABRV
DataItem SY-STY-COLR-ABRV char(13)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// SY_TRSL_COLR_NM
DataItem SY-TRSL-COLR-NM char(30)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// SY_TRSL_SH_COLR_NM
DataItem SY-TRSL-SH-COLR-NM char(13)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// SY_TRSL_SH_STY_NM
DataItem SY-TRSL-SH-STY-NM char(12)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// SY_TRSL_STY_NM
DataItem SY-TRSL-STY-NM char(30)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Requested SY_STY_ID
DataItem SY0UM-SY-STY-ID int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// Requested SY_STY_NBR
DataItem SY0UM-SY-STY-NBR char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Requested SY_TRSL_STY_NM
DataItem SY0UM-SY-TRSL-STY-NM char(30)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// XCL_COLR_ABRV1 for U.S.A.
DataItem SY0UM-USA-COLR-ABRV1 char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// XCL_COLR_ABRV2 for U.S.A.
DataItem SY0UM-USA-COLR-ABRV2 char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// XCL_COLR_DESC for U.S.A.
DataItem SY0UM-USA-COLR-DESC char(15)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Requested XCL_COLR_CD
DataItem SY0UM-XCL-COLR-CD char(3)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Requested XCL_COLR_DESC
DataItem SY0UM-XCL-COLR-DESC char(30)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Char array for lower to upper
DataItem SY0UW-CNVT-CHAR char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Data field for lower to upper
DataItem SY0UW-CNVT-NM char(30)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Length of data in CNVT-NM
DataItem SY0UW-CNVT-NM-LEN smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// Use close-out prods < 2yr old
DataItem SY0UW-CURR-DT-LESS-2YR int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// work flag
DataItem SY0UW-FLAG char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Index for Trademark Words/Phrs
DataItem SY0UW-INX smallint {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// Display Key data on DB2 error
DataItem SY0UW-KEY-ERR char(38)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// style I.D.
DataItem SY0UW-KEY-STY-ID num(9)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// style number
DataItem SY0UW-KEY-STY-NBR char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// country code
DataItem SY0UW-KEY-XCT-CTRY char(4)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// region
DataItem SY0UW-KEY-XDR-REG char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// g.p.c.
DataItem SY0UW-KEY-XGP-GPC char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// season code
DataItem SY0UW-KEY-XSE-SESN char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// season year
DataItem SY0UW-KEY-XSN-YR num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// language code
DataItem SY0UW-KEY-ZFL-LANG char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Lower case characters
DataItem SY0UW-LOWER-CHAR char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Lower case char table
DataItem SY0UW-LOWER-TBL char(26)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Inquiry or Maintence mode
DataItem SY0UW-MAP-MODE char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Cursor end-of-file flag
DataItem SY0UW-STY-EOF-FL char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Component words in Style Name
DataItem SY0UW-STY-NM-WORD char(19)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Temporary storage length-Map21
DataItem SY0UW-SY0UW02-LNTH num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = "0", inputRequired = no
}
end

// Temporary storage length-Map31
DataItem SY0UW-SY0UW03-LNTH num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = "0", inputRequired = no
}
end

// Temporary storage length-Map41
DataItem SY0UW-SY0UW04-LNTH num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = "0", inputRequired = no
}
end

// Temporary storage length-Map51
DataItem SY0UW-SY0UW05-LNTH num(4)  {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = "0", inputRequired = no
}
end

// Upper case characters
DataItem SY0UW-UPPER-CHAR char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Upper case char table
DataItem SY0UW-UPPER-TBL char(26)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Data group VPRDTS01
DataItem VLBCLR01-GROUP char(49)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Key into Table VPRDTS01
DataItem VLBCLR01-KEY char(9)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Data group VPRDTS01
DataItem VPRDTS01-GROUP char(65)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Key into Table VPRDTS01
DataItem VPRDTS01-KEY char(10)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Data group VPRDTSJ1
DataItem VPRDTSJ1-GROUP char(66)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// group level VSTYTS01
DataItem VSTYTS01-GROUP char(68)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// key for VSTYTS01
DataItem VSTYTS01-KEY char(14)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// group level VSTYTS01
DataItem VSTYTSJ1-GROUP char(64)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// filler for grp.length 1024
DataItem WSY1580-FILLER char(867)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// group level wsy1580
DataItem WSY1580-GROUP char(1024)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// input information
DataItem WSY1580-INPUT-INFO char(112)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// option:build short or long nme
DataItem WSY1580-OPT-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// output information
DataItem WSY1580-OUTPUT-INFO char(45)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// return code:' ' or '99'
DataItem WSY1580-RETURN-CD char(2)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Current date less 2 years
DataItem WSY1590-CURR-DT-LESS-2YR int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// group level wsy1590
DataItem WSY1590-GROUP char(113)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// key for wsy1590
DataItem WSY1590-KEY char(18)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Sort USA blanks before trsl.
DataItem WSY1590-SORT-SEQ char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// group level wsy1590
DataItem WSY1600-GROUP char(63)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// key for wsy1590
DataItem WSY1600-KEY char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Current date less 2 years
DataItem WSY1610-CURR-DT-LESS-2YR int {
  currency = no, numericSeparator = no, sign = none, align = right, 
  fillCharacter = " ", inputRequired = no
}
end

// group level wsy1590
DataItem WSY1610-GROUP char(120)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// key for wsy1590
DataItem WSY1610-KEY char(18)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// Sort USA blanks before trsl.
DataItem WSY1610-SORT-SEQ char(1)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// XGP_GPC_DESC
DataItem XGP-GPC-DESC char(25)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

// XSE_SESN_DESC
DataItem XSE-SESN-DESC char(15)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

DataItem ZFL-LANG-ABRV char(6)  {
  align = left, fillCharacter = nullFill, inputRequired = no
}
end

